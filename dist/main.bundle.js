webpackJsonp([1],[,,,function(t,e,n){"use strict";function o(t){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}Object.defineProperty(e,"__esModule",{value:!0}),o(n(469)),o(n(470)),o(n(253)),o(n(1100)),o(n(1101)),o(n(1102)),o(n(1103)),o(n(471)),o(n(1104)),o(n(472)),o(n(1105)),o(n(1106)),o(n(1108)),o(n(1109)),o(n(1110))},,,function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(23);n(406),n(413);var a=function(){function t(){}return e=t,t.prototype.getObservable=function(t){return e.subject.filter(function(e){return e.eventType===t}).map(function(t){return t.value})},t.prototype.onSelectProperty=function(t,n,o){var r={propertyId:t,isNewProperty:n,shouldOpenEditor:o},i=new s(c.SELECT_PROPERTY,r);e.subject.next(i)},t.prototype.onSelectRoom=function(t,n){var o={roomId:t,isNewProperty:n},r=new s(c.SELECT_ROOM,o);e.subject.next(r)},t.prototype.onModalMessage=function(t,n,o,r,i){var a={header:t,body:n,isMessage:o,onDismiss:r,onAccept:i},u=new s(c.MODAL_MESSAGE,a);e.subject.next(u)},t.prototype.onStartLoading=function(){e.subject.next(new s(c.START_LOADING,null))},t.prototype.onStopLoading=function(){e.subject.next(new s(c.STOP_LOADING,null))},t.prototype.onShareableModal=function(t,n){var o={userId:t,projectId:n};e.subject.next(new s(c.SHAREABLE_MODAL,o))},t.prototype.onExploreModal=function(){e.subject.next(new s(c.OPEN_EXPLORE_MODAL,null))},t.prototype.onOpenFileLoader=function(t){var n={acceptedFileType:t};e.subject.next(new s(c.OPEN_FILE_LOADER,n))},t.prototype.onMouseDown=function(t){var n=new s(c.MOUSE_DOWN,t);e.subject.next(n)},t.prototype.onHotspotVisibility=function(t){var n={isVisible:t},o=new s(c.HOTSPOT_EDITOR_VISIBILITY,n);e.subject.next(o)},t.subject=new i.Subject,t.staticConstructor=function(){window.addEventListener("mousedown",function(t){var n=new s(c.MOUSE_DOWN,t);e.subject.next(n)}),window.addEventListener("mousemove",function(t){var n=new s(c.MOUSE_MOVE,t);e.subject.next(n)}),window.addEventListener("mouseup",function(t){var n=new s(c.MOUSE_UP,t);e.subject.next(n)}),window.addEventListener("click",function(t){var n=new s(c.CLICK,t);e.subject.next(n)}),window.addEventListener("resize",function(t){var n={x:window.innerWidth,y:window.innerHeight},o=new s(c.WINDOW_RESIZE,n);e.subject.next(o)}),window.addEventListener("vrdisplaypresentchange",function(t){var n=new s(c.VR_DISPLAY_CHANGE,t);e.subject.next(n)})}(),t=e=o([r.Injectable()],t);var e}();e.EventBus=a;var s=function(){function t(t,e){this.eventType=t,this.value=e}return t}();e.Event=s;var c;!function(t){t[t.SELECT_PROPERTY=0]="SELECT_PROPERTY",t[t.SELECT_ROOM=1]="SELECT_ROOM",t[t.MOUSE_DOWN=2]="MOUSE_DOWN",t[t.MOUSE_MOVE=3]="MOUSE_MOVE",t[t.MOUSE_UP=4]="MOUSE_UP",t[t.CLICK=5]="CLICK",t[t.MODAL_MESSAGE=6]="MODAL_MESSAGE",t[t.START_LOADING=7]="START_LOADING",t[t.STOP_LOADING=8]="STOP_LOADING",t[t.OPEN_FILE_LOADER=9]="OPEN_FILE_LOADER",t[t.WINDOW_RESIZE=10]="WINDOW_RESIZE",t[t.SHAREABLE_MODAL=11]="SHAREABLE_MODAL",t[t.OPEN_EXPLORE_MODAL=12]="OPEN_EXPLORE_MODAL",t[t.VR_DISPLAY_CHANGE=13]="VR_DISPLAY_CHANGE",t[t.HOTSPOT_EDITOR_VISIBILITY=14]="HOTSPOT_EDITOR_VISIBILITY"}(c=e.EventType||(e.EventType={}))},,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(3),i=n(3),a=n(3),s=n(3),c=n(3),u=n(170),l=n(3);e.LUIDGenerator=function(){var t=1;return function(){return t++}}(),e.sha1=function(t){var e=s.stringToByteArray(t),n=new a.Sha1;n.update(e);var o=n.digest();return i.base64.encodeByteArray(o)};var p=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",o=0;o<t.length;o++)Array.isArray(t[o])||t[o]&&"object"==typeof t[o]&&"number"==typeof t[o].length?n+=p.apply(null,t[o]):"object"==typeof t[o]?n+=c.stringify(t[o]):n+=t[o],n+=" ";return n};e.logger=null;var d=!0;e.enableLogging=function(t,n){o.assert(!n||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?("undefined"!=typeof console&&("function"==typeof console.log?e.logger=console.log.bind(console):"object"==typeof console.log&&(e.logger=function(t){console.log(t)})),n&&u.SessionStorage.set("logging_enabled",!0)):"function"==typeof t?e.logger=t:(e.logger=null,u.SessionStorage.remove("logging_enabled"))},e.log=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];if(!0===d&&(d=!1,null===e.logger&&!0===u.SessionStorage.get("logging_enabled")&&e.enableLogging(!0)),e.logger){var o=p.apply(null,t);e.logger(o)}},e.logWrapper=function(t){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];e.log.apply(void 0,[t].concat(n))}},e.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE INTERNAL ERROR: "+p.apply(void 0,t);void 0!==console.error?console.error(n):console.log(n)}},e.fatal=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=p.apply(void 0,t);throw new Error("FIREBASE FATAL ERROR: "+n)},e.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("undefined"!=typeof console){var n="FIREBASE WARNING: "+p.apply(void 0,t);void 0!==console.warn?console.warn(n):console.log(n)}},e.warnIfPageIsSecure=function(){"undefined"!=typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&e.warn("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},e.warnAboutUnsupportedMethod=function(t){e.warn(t+" is unsupported and will likely change soon.  Please do not use.")},e.isInvalidJSONNumber=function(t){return"number"==typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},e.executeWhenDOMReady=function(t){if(l.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){if(!document.body)return void setTimeout(n,Math.floor(10));e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},e.MIN_NAME="[MIN_NAME]",e.MAX_NAME="[MAX_NAME]",e.nameCompare=function(t,n){if(t===n)return 0;if(t===e.MIN_NAME||n===e.MAX_NAME)return-1;if(n===e.MIN_NAME||t===e.MAX_NAME)return 1;var o=e.tryParseInt(t),r=e.tryParseInt(n);return null!==o?null!==r?o-r==0?t.length-n.length:o-r:-1:null!==r?1:t<n?-1:1},e.stringCompare=function(t,e){return t===e?0:t<e?-1:1},e.requireKey=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+c.stringify(e))},e.ObjectToUniqueKey=function(t){if("object"!=typeof t||null===t)return c.stringify(t);var n=[];for(var o in t)n.push(o);n.sort();for(var r="{",i=0;i<n.length;i++)0!==i&&(r+=","),r+=c.stringify(n[i]),r+=":",r+=e.ObjectToUniqueKey(t[n[i]]);return r+="}"},e.splitStringBySize=function(t,e){var n=t.length;if(n<=e)return[t];for(var o=[],r=0;r<n;r+=e)r+e>n?o.push(t.substring(r,n)):o.push(t.substring(r,r+e));return o},e.each=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else r.forEach(t,function(t,n){return e(n,t)})},e.bindCallback=function(t,e){return e?t.bind(e):t},e.doubleToIEEE754String=function(t){o.assert(!e.isInvalidJSONNumber(t),"Invalid JSON number");var n,r,i,a,s,c,u;for(0===t?(r=0,i=0,n=1/t==-1/0?1:0):(n=t<0,t=Math.abs(t),t>=Math.pow(2,-1022)?(a=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),r=a+1023,i=Math.round(t*Math.pow(2,52-a)-Math.pow(2,52))):(r=0,i=Math.round(t/Math.pow(2,-1074)))),c=[],s=52;s;s-=1)c.push(i%2?1:0),i=Math.floor(i/2);for(s=11;s;s-=1)c.push(r%2?1:0),r=Math.floor(r/2);c.push(n?1:0),c.reverse(),u=c.join("");var l="";for(s=0;s<64;s+=8){var p=parseInt(u.substr(s,8),2).toString(16);1===p.length&&(p="0"+p),l+=p}return l.toLowerCase()},e.isChromeExtensionContentScript=function(){return!("object"!=typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},e.isWindowsStoreApp=function(){return"object"==typeof Windows&&"object"==typeof Windows.UI},e.errorForServerCode=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var o=new Error(t+" at "+e.path.toString()+": "+n);return o.code=t.toUpperCase(),o},e.INTEGER_REGEXP_=new RegExp("^-?\\d{1,10}$"),e.tryParseInt=function(t){if(e.INTEGER_REGEXP_.test(t)){var n=Number(t);if(n>=-2147483648&&n<=2147483647)return n}return null},e.exceptionGuard=function(t){try{t()}catch(t){setTimeout(function(){var n=t.stack||"";throw e.warn("Exception was thrown by user callback.",n),t},Math.floor(0))}},e.callUserCallback=function(t){for(var n=[],o=1;o<arguments.length;o++)n[o-1]=arguments[o];"function"==typeof t&&e.exceptionGuard(function(){t.apply(void 0,n)})},e.beingCrawled=function(){return("object"==typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},e.exportPropGetter=function(t,e,n){Object.defineProperty(t,e,{get:n})},e.setTimeoutNonBlocking=function(t,e){var n=setTimeout(t,e);return"object"==typeof n&&n.unref&&n.unref(),n}},,,function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(93),s=n(181),c=n(136),u=function(){function t(t,e,n){this.roomManager=t,this.propertyBuilder=e,this.assetManager=n,this.getRoomIds().length||this.addRoom()}return t.prototype.getRoomIds=function(){return Array.from(this.roomManager.getRooms()).map(function(t){return t.getId()})},t.prototype.getRoomById=function(t){return this.roomManager.getRoomById(t)},t.prototype.addRoom=function(){var t=this.roomManager.getRooms().size+1,e="Room "+t,n=this.propertyBuilder.room(e);return this.roomManager.addRoom(n),this.activeRoomId=n.getId(),this.activeRoomId},t.prototype.removeRoom=function(t){if(this.getRoomIds().length<2)return void console.warn("user should not be allowed to remove last room");this.activeRoomId=null,this.roomManager.removeRoomById(t),Array.from(this.roomManager.getRooms()).map(function(t){return t.getDoors()}).reduce(function(e,n){return e.concat(Array.from(n).filter(function(e){return e.getRoomId()===t}))},new Array).forEach(function(t){return t.reset()})},t.prototype.getActiveRoomId=function(){return this.activeRoomId?this.activeRoomId:this.getRoomIds()[0]},t.prototype.setActiveRoomId=function(t){this.activeRoomId=t},t.prototype.getRoomProperties=function(t){var e=this.getRoomById(t);return e?Array.from(e.getText()).concat(Array.from(e.getAudio()),Array.from(e.getImages()),Array.from(e.getDoors()),Array.from(e.getLink())).sort(function(t,e){return t.getTimestamp()-e.getTimestamp()}):null},t.prototype.getPropertyById=function(t,e){return this.getRoomProperties(t).find(function(t){return t.getId()===e})},t.prototype.addText=function(t){var e=this.getRoomById(t).getText().size+1,n="Text "+e,o=this.propertyBuilder.text(n,"");return this.getRoomById(t).addText(o),o},t.prototype.removeText=function(t,e){this.getRoomById(t).removeText(e)},t.prototype.addAudio=function(t){var e=this.getRoomById(t).getAudio().size+1,n="Audio "+e,o=this.propertyBuilder.audio(n);return this.getRoomById(t).addAudio(o),o},t.prototype.removeAudio=function(t,e){this.getRoomById(t).removeAudio(e)},t.prototype.addImage=function(t){var e=this.getRoomById(t).getImages().size+1,n="Image "+e,o=this.propertyBuilder.image(n);return this.getRoomById(t).addImage(o),o},t.prototype.removeImage=function(t,e){this.getRoomById(t).removeImage(e)},t.prototype.addDoor=function(t){var e=this.getRoomIds().filter(function(e){return e!==t})[0],n=this.getRoomById(e).getName(),o=this.propertyBuilder.door(e,n);return this.getRoomIds().length>2&&o.reset(),this.getRoomById(t).addDoor(o),o},t.prototype.removeDoor=function(t,e){this.getRoomById(t).removeDoor(e)},t.prototype.addLink=function(t){var e=this.getRoomById(t).getLink().size+1,n="Link "+e,o=this.propertyBuilder.link(n,"");return this.getRoomById(t).addLink(o),o},t.prototype.removeLink=function(t,e){this.getRoomById(t).removeLink(e)},t.prototype.roomHasBackgroundImage=function(t){return this.getRoomById(t).hasBackgroundImage()},t.prototype.getHomeRoomId=function(){return this.roomManager.getHomeRoomId()},t.prototype.isHomeRoom=function(t){return t===this.roomManager.getHomeRoomId()},t.prototype.setHomeRoomId=function(t){this.roomManager.setHomeRoomId(t)},t.prototype.resetRoomManager=function(){this.roomManager.initValues(),this.assetManager.clearAssets(),this.addRoom()},t.prototype.setRoomName=function(t,e){var n=this;this.getRoomById(t).setName(e),this.getRoomIds().map(function(t){return n.getRoomById(t).getDoors()}).reduce(function(e,n){var o=Array.from(n).filter(function(e){return e.getRoomId()===t&&!e.hasCustomName()});return e.concat(o)},new Array).forEach(function(t){return t.setName(e)})},t=o([i.Injectable(),r("design:paramtypes",[a.RoomManager,s.PropertyBuilder,c.AssetManager])],t)}();e.SceneInteractor=u},,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(509),r={LOCAL:"http://127.0.0.1:8000",DEV:"https://staging-api.socialvrlab.com",PROD:"https://api.socialvrlab.com"},i=r[o]||r.PROD;e.BASE_URL=i,e.POST_PROJECT_URL_PATH="/socialVR/projects/",e.GET_PROJECT_URL_PATH="/socialVR/projects/",e.ICON_PATH="assets/icons/",e.IMAGE_PATH="assets/images/",e.DEFAULT_FILE_NAME="",e.DEFAULT_IMAGE_PATH=e.IMAGE_PATH+"default-background.png",e.DEFAULT_PROJECT_NAME="New Project",e.DEFAULT_PROJECT_DESCRIPTION="A short description of the project",e.DEFAULT_DOOR_NAME="Select ...",e.BACKGROUND_THUMBNAIL="background_thumnbnail.jpg",e.DEFAULT_VOLUME=.5,e.ROOM_ICON_BUFFER_WIDTH=40,e.ROOM_ICON_BUFFER_HEIGHT=24,e.MIME_TYPE_TEXT="text/plain",e.MIME_TYPE_UTF8="text/plain;charset=utf-8",e.MIME_TYPE_MP3="audio/mp3",e.MIME_TYPE_WAV="audio/wav",e.MIME_TYPE_AAC="audio/aac",e.MIME_TYPE_XM4A="audio/x-m4a",e.MIME_TYPE_MPEG="audio/mpeg",e.MIME_TYPE_XWAV="audio/x-wav",e.MIME_TYPE_PNG="image/png",e.MIME_TYPE_JPG="image/jpg",e.MIME_TYPE_JPEG="image/jpeg",e.MIME_TYPE_ZIP="application/zip",e.MIME_TYPE_X_ZIP="application/x-zip",e.MIME_TYPE_OCTET_STREAM="application/octet-stream",e.MIME_TYPE_X_ZIP_COMPRESSED="application/x-zip-compressed",e.MIME_TYPE_MP4="video/mp4",e.UINT8ARRAY="uint8array",e.STORY_FILE="story.yml",e.GROUP_TYPE={FEATURED:"FEATURED",EXTERNAL:"EXTERNAL"},e.ERROR_OPENING_PROJECT="Error opening project",e.FORMAT_ERROR="We had an issue trying to find that project. The link you tried may have been corrupted. Try using the original link again.",e.SERVER_ERROR="We had an issue trying to open the project. It might not be available anymore.",e.THREE_CONST={SPHERE_RADIUS:512,SPHERE_SLICES:128,RADIAL_DISTANCE:10,CAMERA_RETICLE:148,CAMERA_HOTSPOT:150,CAMERA_NAVPANEL:200,NAVPANEL_THETA:130,NAVPANEL_PHI:-90,NAVPANEL_OPACITY:.3,NAVEPANEL_NEAR:50,NAVEBUTT_ACTIVE:40,HOTSPOT_DIM:20,DASHCIRCLE_SEG:50,HOME_BACK_DIM:50,HOTSPOT_NEAR:30,HOTSPOT_ACTIVE:10,NAVPANEL_W:140,NAVPANEL_H:80,POINTLIGHT_Z:400,RETICLE_INNER:1,RETICLE_OUTER:2,RETICLE_SEGS:12,RETICLE_BACK_RADIUS:2,FOV_NORM:65,FOV_IN:20,FOV_OUT:110,FONT_URL:"https://fonts.googleapis.com/css?family=Nunito",FONT_HOTSPOT_SIZE:12,FONT_HOTSPOT_HEIGHT:3,TEXTPLANE_WIDTH:600,TEXTPLANE_HEIGHT:800,TEXTPLANE_FONTSIZE:26,HOTSPOT_MOD_FREQ:.005,HOTSPOT_ROT_FREQ:5e-4,HOTSPOT_MOD_MAG:.005,TWEEN_PLANE_IN:1500,TWEEN_PLANE_OUT:500,TWEEN_ICON_IN:500,TWEEN_ICON_OUT:500,TWEEN_PLANE_SCALE:2,TWEEN_ROOM_MOVE:250,TWEEN_ROOM_MOVEIN:400,TWEEN_ROOM_MOVETIMEOUT:1500,TWEEN_ROOM_MOVETIMEIN:1500,HOTSPOT_AUDIO_DELAY:1e3,HOTSPOT_DOOR_DELAY:1500}},,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=n(3),i=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[n]=this.pieces_[o],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],o=this.pieceNum_;o<this.pieces_.length;o++)n.push(this.pieces_[o]);if(e instanceof t)for(var o=e.pieceNum_;o<e.pieces_.length;o++)n.push(e.pieces_[o]);else for(var r=e.split("/"),o=0;o<r.length;o++)r[o].length>0&&n.push(r[o]);return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var o=e.getFront(),r=n.getFront();if(null===o)return n;if(o===r)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var a=o.nameCompare(n[i],r[i]);if(0!==a)return a}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}();e.Path=i;var a=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=r.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=r.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=r.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}();e.ValidationPath=a},,,,,,,,,,,function(t,e,n){"use strict";function o(t){a=t}function r(t){s=t}var i=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var a,s,c=n(172),u=n(9),l=n(45),p=n(173);e.setNodeFromJSON=o,e.setMaxNode=r;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),o=e.node.getPriority(),r=n.compareTo(o);return 0===r?u.nameCompare(t.name,e.name):r},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return l.NamedNode.MIN},e.prototype.maxPost=function(){return new l.NamedNode(u.MAX_NAME,new p.LeafNode("[PRIORITY-POST]",s))},e.prototype.makePost=function(t,e){var n=a(t);return new l.NamedNode(e,new p.LeafNode("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(c.Index);e.PriorityIndex=d,e.PRIORITY_INDEX=new d},,,function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(3),a=n(9),s=n(174),c=n(45),u=n(479),l=n(33),p=n(130),d=n(481),h=n(173),f=n(483),m=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&u.validatePriorityNode(this.priorityNode_),this.children_.isEmpty()&&i.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return r||(r=new t(new s.SortedMap(f.NAME_COMPARATOR),null,d.IndexMap.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||r},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?r:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(i.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var o=new c.NamedNode(e,n),a=void 0,s=void 0,u=void 0;return n.isEmpty()?(a=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(o,this.children_)):(a=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(o,this.children_)),u=a.isEmpty()?r:this.priorityNode_,new t(a,u,s)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;i.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var o=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,o)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},o=0,r=0,i=!0;if(this.forEachChild(l.PRIORITY_INDEX,function(a,s){n[a]=s.val(e),o++,i&&t.INTEGER_REGEXP_.test(a)?r=Math.max(r,Number(a)):i=!1}),!e&&i&&r<2*o){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+u.priorityHashText(this.getPriority().val())+":"),this.forEachChild(l.PRIORITY_INDEX,function(e,n){var o=n.hash();""!==o&&(t+=":"+e+":"+o)}),this.lazyHash_=""===t?"":a.sha1(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var o=this.resolveIndex_(n);if(o){var r=o.getPredecessorKey(new c.NamedNode(t,e));return r?r.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new c.NamedNode(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new c.NamedNode(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var o=this.children_.getIteratorFrom(t.name,c.NamedNode.Wrap),r=o.peek();null!=r&&e.compare(r,t)<0;)o.getNext(),r=o.peek();return o},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var o=this.children_.getReverseIteratorFrom(t.name,c.NamedNode.Wrap),r=o.peek();null!=r&&e.compare(r,t)>0;)o.getNext(),r=o.peek();return o},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===e.MAX_NODE?-1:0},t.prototype.withIndex=function(e){if(e===p.KEY_INDEX||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===p.KEY_INDEX||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(l.PRIORITY_INDEX),o=e.getIterator(l.PRIORITY_INDEX),r=n.getNext(),i=o.getNext();r&&i;){if(r.name!==i.name||!r.node.equals(i.node))return!1;r=n.getNext(),i=o.getNext()}return null===r&&null===i}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===p.KEY_INDEX?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}();e.ChildrenNode=m;var g=function(t){function e(){return t.call(this,new s.SortedMap(f.NAME_COMPARATOR),m.EMPTY_NODE,d.IndexMap.Default)||this}return o(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return m.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(m);e.MaxNode=g,e.MAX_NODE=new g,Object.defineProperties(c.NamedNode,{MIN:{value:new c.NamedNode(a.MIN_NAME,m.EMPTY_NODE)},MAX:{value:new c.NamedNode(a.MAX_NAME,e.MAX_NODE)}}),p.KeyIndex.__EMPTY_NODE=m.EMPTY_NODE,h.LeafNode.__childrenNodeConstructor=m,u.setMaxNode(e.MAX_NODE),l.setMaxNode(e.MAX_NODE)},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(93),s=function(){function t(t){this.roomManager=t}return t.prototype.getProjectName=function(){return this.roomManager.getProjectName()},t.prototype.setProjectName=function(t){this.roomManager.setProjectName(t)},t.prototype.getProjectDescription=function(){return this.roomManager.getProjectDescription()},t.prototype.setProjectDescription=function(t){this.roomManager.setProjectDescription(t)},t.prototype.projectIsEmpty=function(){return this.roomManager.getProjectIsEmpty()},t.prototype.getProjectTags=function(){return this.roomManager.getProjectTags()},t.prototype.setProjectTags=function(t){this.roomManager.setProjectTags(t)},t.prototype.getIsReadOnly=function(){return this.roomManager.getIsReadOnly()},t.prototype.setIsReadOnly=function(t){this.roomManager.setIsReadOnly(t)},t.prototype.getSoundtrack=function(){return this.roomManager.getSoundtrack()},t.prototype.setSoundtrack=function(t,e,n){return this.roomManager.setSoundtrack(t,e,n)},t.prototype.removeSoundtrack=function(){this.roomManager.removeSoundtrack()},t.prototype.setSoundtrackVolume=function(t){this.roomManager.setSoundtrackVolume(t)},t.prototype.getSoundtrackVolume=function(){return this.roomManager.getSoundtrackVolume()},t=o([i.Injectable(),r("design:paramtypes",[a.RoomManager])],t)}();e.MetaDataInteractor=s},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(94),s=n(185),c=n(183),u=n(512),l=n(1174);n(247);var p=function(){function t(t,e,n,o){this.apiService=t,this.userService=e,this.authenticationService=n,this.socialAuthenticationService=o}return t.prototype.logIn=function(t,e){var n=this;return this.apiService.logIn(t,e).do(function(t){n.authenticationService.setToken(t),n.authenticationService.setAuthenticationMethod(l.AuthenticationMethod.SOCIAL_VR)})},t.prototype.facebookLogin=function(){var t=this;return this.socialAuthenticationService.facebookLogin().do(function(e){t.authenticationService.setAuthenticationMethod(l.AuthenticationMethod.FACEBOOK)})},t.prototype.googleLogin=function(){var t=this;return this.socialAuthenticationService.googleLogin().do(function(e){t.authenticationService.setAuthenticationMethod(l.AuthenticationMethod.GOOGLE)})},t.prototype.isLoggedIn=function(){return this.authenticationService.isLoggedIn()},t.prototype.logOut=function(){var t=this;return this.apiService.logOut().do(function(e){t.authenticationService.logOut(),t.userService.clearUser()})},t.prototype.createUser=function(t,e,n,o,r){return this.apiService.createUser(t,e,n,o,r)},t.prototype.getUser=function(){var t=this;return this.apiService.getUser().do(function(e){return t.userService.setUser(e)})},t.prototype.getUserName=function(){return this.userService.getUserName()},t.prototype.getUserId=function(){return this.userService.getUserId()},t.prototype.getUserGroups=function(){return this.userService.getUserGroups()},t=o([i.Injectable(),r("design:paramtypes",[a.ApiService,s.UserService,c.AuthenticationService,u.SocialAuthenticationService])],t)}();e.UserInteractor=p},,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}();e.NamedNode=o},function(t,e,n){"use strict";function o(t){return null!=t}function r(t){return void 0!==t}function i(t){return"function"==typeof t}function a(t){return"object"==typeof t}function s(t){return a(t)&&null!==t}function c(t){return a(t)&&!Array.isArray(t)}function u(t){return"string"==typeof t||t instanceof String}function l(t){return"number"==typeof t||t instanceof Number}function p(t){return d()&&t instanceof Blob}function d(){return"undefined"!=typeof Blob}e.a=o,e.c=r,e.b=i,e.i=a,e.g=s,e.f=c,e.j=u,e.h=l,e.d=p,e.e=d},,,,,,,function(t,e,n){"use strict";function o(t){return new Array(14).fill(null).map(function(t,e){return Math.pow(2,e)}).map(function(e,n){return{distance:Math.abs(t-e),value:e}}).sort(function(t,e){return t.distance-e.distance})[0].value}function r(t,e,n){var o,r;return t>e&&t>n?(o=n,r=e/t*n):e>t&&e>n?(o=t/e*n,r=n):(o=t,r=e),new s.Vector2(o,r)}function i(t,e){return new Promise(function(n,o){try{var r=document.createElement("canvas"),i=new Image;i.onload=function(){var t=u[e](i.width,i.height);r.width=t.getX(),r.height=t.getY(),r.getContext("2d").drawImage(i,0,0,i.width,i.height,0,0,t.getX(),t.getY()),n(r.toDataURL(c.MIME_TYPE_JPEG,1))},i.src=t.changingThisBreaksApplicationSecurity?t.changingThisBreaksApplicationSecurity:t}catch(t){o(t)}})}function a(t,e){return u[e]?"backgroundImage"===e?Promise.all([i(t,"backgroundImage"),i(t,"projectThumbnail")]).then(function(t){return{backgroundImage:t[0],thumbnail:t[1]}}):i(t,e):Promise.reject("resizeImage must have a valid size option: "+Object.keys(u).join(", "))}Object.defineProperty(e,"__esModule",{value:!0});var s=n(75),c=n(14);e.fitToMax=r;var u={projectThumbnail:function(t,e){return new s.Vector2(336,168)},hotspotImage:function(t,e){return r(t,e,1024)},backgroundImage:function(t,e){if(t>=e){var n=o(t),r=Math.floor(e/t*n);return new s.Vector2(n,r)}var r=o(e),n=Math.floor(t/e*r);return new s.Vector2(n,r)}};e.resizeImage=a},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(272),s=n(273),c=n(94),u=n(93),l=n(511),p=n(136);n(251);var d=function(){function t(t,e,n,o,r,i){this.deserializationService=t,this.serializationService=e,this.roomManager=n,this.apiService=o,this.projectService=r,this.assetManager=i}return t.prototype.getProjects=function(t){return this.apiService.getProjects(t)},t.prototype.updateSharableStatus=function(t,e,n){return this.apiService.updateSharableStatus(t,e,n)},t.prototype.getProjectData=function(t,e){return this.apiService.getProjectData(t,e)},t.prototype.openProject=function(t,e){var n=this;return console.log("openProject"),this.apiService.getProjectUrl(t,e).switchMap(function(t){return n.apiService.getProject(t)}).switchMap(function(t){return console.log("projectArrayBuffer",t),n.deserializationService.unzipStoryFile(t)}).do(function(t){n.assetManager.clearAssets(),console.log("clearAssets"),n.projectService.setProjectId(e),console.log("setProjectId")})},t.prototype.openPublicProject=function(t){var e=this;return this.apiService.getProject(t).switchMap(function(t){return e.deserializationService.unzipStoryFile(t)}).do(function(t){e.assetManager.clearAssets(),e.projectService.setProjectId(null)})},t.prototype.createProject=function(t){var e=this,n=this.roomManager.getProjectName(),o=this.roomManager.getProjectTags(),r=this.getHomeroomThumbnail();return this.serializationService.zipStoryFile().switchMap(function(i){return e.apiService.createProject(t,n,o,i,r)}).do(function(t){return e.projectService.setProjectId(t.id)})},t.prototype.updateProject=function(t,e){var n=this,o=this.roomManager.getProjectName(),r=this.roomManager.getProjectTags(),i=this.getHomeroomThumbnail();return this.serializationService.zipStoryFile().switchMap(function(a){return n.apiService.updateProject(t,e,o,r,a,i)})},t.prototype.deleteProject=function(t,e){return this.apiService.deleteProject(t,e)},t.prototype.getProjectId=function(){return this.projectService.getProjectId()},t.prototype.setProjectId=function(t){this.projectService.setProjectId(t)},t.prototype.isWorkingOnSavedProject=function(){return this.projectService.isWorkingOnSavedProject()},t.prototype.getHomeroomThumbnail=function(){var t=this.roomManager.getHomeRoomId(),e=this.roomManager.getRoomById(t),n=e.getThumbnailImage();if(!n)return"";var o=n.changingThisBreaksApplicationSecurity?n.changingThisBreaksApplicationSecurity:n;return o.substring(o.indexOf(",")+1)},t=o([i.Injectable(),r("design:paramtypes",[a.DeserializationService,s.SerializationService,u.RoomManager,c.ApiService,l.ProjectService,p.AssetManager])],t)}();e.ProjectInteractor=d},,,,,,,function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(52),s=n(14);e.mimeTypeMap={video:[s.MIME_TYPE_MP4],audio:[s.MIME_TYPE_MP3,s.MIME_TYPE_WAV,s.MIME_TYPE_MPEG,s.MIME_TYPE_XWAV,s.MIME_TYPE_AAC,s.MIME_TYPE_XM4A],image:[s.MIME_TYPE_PNG,s.MIME_TYPE_JPG,s.MIME_TYPE_JPEG],zip:[s.MIME_TYPE_ZIP,s.MIME_TYPE_X_ZIP,s.MIME_TYPE_OCTET_STREAM,s.MIME_TYPE_X_ZIP_COMPRESSED]};var c=function(){function t(t){this.sanitizer=t}return t.prototype.validateFileLoadEvent=function(t,n){return new Promise(function(o,r){if(e.mimeTypeMap[n]||r("Accepted file type not valid"),e.mimeTypeMap[n].indexOf(t.type)<0){r("File is not a valid type, must be of type: "+n+".\nAccepted file types: "+e.mimeTypeMap[n].join(", "))}o(t)})},t.prototype.getBinaryFileData=function(t){var e=this;return new Promise(function(n,o){setTimeout(function(){var r=new FileReader;r.onloadend=function(){var t=e.sanitizer.bypassSecurityTrustUrl(r.result);console.log("fileLoader.onloadEnd",t),setTimeout(function(){return n(t)},2e3)},r.onerror=function(){var t=r.error;console.log("fileLoader.onerror",t),o(t)},r.readAsDataURL(t)})})},t=o([i.Injectable(),r("design:paramtypes",[a.DomSanitizer])],t)}();e.FileLoaderUtil=c},,,,,function(t,e,n){"use strict";function o(t){return"storage/"+t}function r(){return new I(E.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function i(t){return new I(E.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function a(t){return new I(E.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s(){return new I(E.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function c(t){return new I(E.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function u(){return new I(E.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function l(){return new I(E.CANCELED,"User canceled the upload/download.")}function p(t){return new I(E.INVALID_URL,"Invalid URL '"+t+"'.")}function d(t){return new I(E.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function h(){return new I(E.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function f(){return new I(E.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function m(){return new I(E.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function g(t,e,n){return new I(E.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function v(t,e,n,o){var r,i;return t===e?(r=t,i=1===t?"argument":"arguments"):(r="between "+t+" and "+e,i="arguments"),new I(E.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+r+" "+i+", received "+o+".")}function y(){return new I(E.APP_DELETED,"The Firebase app was deleted.")}function _(t){return new I(E.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function b(t,e){return new I(E.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function w(t){throw new I(E.INTERNAL_ERROR,"Internal error: "+t)}n.d(e,"a",function(){return E}),e.s=r,e.m=i,e.n=a,e.q=s,e.r=c,e.o=u,e.c=l,e.k=p,e.h=d,e.d=h,e.p=f,e.l=m,e.f=g,e.g=v,e.b=y,e.j=_,e.i=b,e.e=w;var I=(n(178),function(){function t(t,e){this.code_=o(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return o(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}()),E={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"}},,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"firebase",function(){return r});var o=n(1099),r=Object(o.a)();e.default=r},function(t,e,n){"use strict";function o(){return Math.random()>.5?-1:1}function r(){return o()*i*Math.random()}Object.defineProperty(e,"__esModule",{value:!0});var i=10,a=function(){function t(t,e){this.x=t,this.y=e}return t.build=function(){return new t(180+r(),r())},t.prototype.getX=function(){return this.x},t.prototype.setX=function(t){this.x=t},t.prototype.getY=function(){return this.y},t.prototype.setY=function(t){this.y=t},t.prototype.setPosition=function(t,e){this.x=t,this.y=e},t.prototype.toString=function(){return"<"+this.x+","+this.y+">"},t}();e.Vector2=a},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(136),s=function(){function t(t){this.assetManager=t}return t.prototype.loadTextures=function(t){return this.assetManager.loadTextures(t)},t.prototype.loadAudioBuffers=function(t){return this.assetManager.loadAudioBuffers(t)},t.prototype.getTextureById=function(t){return this.assetManager.getTextureById(t)},t.prototype.getAudioBufferById=function(t){return this.assetManager.getAudioBufferById(t)},t=o([i.Injectable(),r("design:paramtypes",[a.AssetManager])],t)}();e.AssetInteractor=s;var c=function(){function t(t,e,n){this.id=t,this.fileName=e,this.filePath=n}return t}();e.AssetModel=c},,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(22),r=n(3),i=n(9),a=n(3),s=n(3);e.INVALID_KEY_REGEX_=/[\[\].#$\/\u0000-\u001F\u007F]/,e.INVALID_PATH_REGEX_=/[\[\].#$\u0000-\u001F\u007F]/,e.MAX_LEAF_SIZE_=10485760,e.isValidKey=function(t){return"string"==typeof t&&0!==t.length&&!e.INVALID_KEY_REGEX_.test(t)},e.isValidPathString=function(t){return"string"==typeof t&&0!==t.length&&!e.INVALID_PATH_REGEX_.test(t)},e.isValidRootPathString=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),e.isValidPathString(t)},e.isValidPriority=function(t){return null===t||"string"==typeof t||"number"==typeof t&&!i.isInvalidJSONNumber(t)||t&&"object"==typeof t&&r.contains(t,".sv")},e.validateFirebaseDataArg=function(t,n,o,r,i){i&&void 0===o||e.validateFirebaseData(a.errorPrefix(t,n,i),o,r)},e.validateFirebaseData=function(t,n,a){var c=a instanceof o.Path?new o.ValidationPath(a,t):a;if(void 0===n)throw new Error(t+"contains undefined "+c.toErrorString());if("function"==typeof n)throw new Error(t+"contains a function "+c.toErrorString()+" with contents = "+n.toString());if(i.isInvalidJSONNumber(n))throw new Error(t+"contains "+n.toString()+" "+c.toErrorString());if("string"==typeof n&&n.length>e.MAX_LEAF_SIZE_/3&&s.stringLength(n)>e.MAX_LEAF_SIZE_)throw new Error(t+"contains a string greater than "+e.MAX_LEAF_SIZE_+" utf8 bytes "+c.toErrorString()+" ('"+n.substring(0,50)+"...')");if(n&&"object"==typeof n){var u=!1,l=!1;if(r.forEach(n,function(n,o){if(".value"===n)u=!0;else if(".priority"!==n&&".sv"!==n&&(l=!0,!e.isValidKey(n)))throw new Error(t+" contains an invalid key ("+n+") "+c.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');c.push(n),e.validateFirebaseData(t,o,c),c.pop()}),u&&l)throw new Error(t+' contains ".value" child '+c.toErrorString()+" in addition to actual children.")}},e.validateFirebaseMergePaths=function(t,n){var r,i;for(r=0;r<n.length;r++){i=n[r];for(var a=i.slice(),s=0;s<a.length;s++)if(".priority"===a[s]&&s===a.length-1);else if(!e.isValidKey(a[s]))throw new Error(t+"contains an invalid key ("+a[s]+") in path "+i.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}n.sort(o.Path.comparePaths);var c=null;for(r=0;r<n.length;r++){if(i=n[r],null!==c&&c.contains(i))throw new Error(t+"contains a path "+c.toString()+" that is ancestor of another path "+i.toString());c=i}},e.validateFirebaseMergeDataArg=function(t,n,i,s,c){if(!c||void 0!==i){var u=a.errorPrefix(t,n,c);if(!i||"object"!=typeof i||Array.isArray(i))throw new Error(u+" must be an object containing the children to replace.");var l=[];r.forEach(i,function(t,n){var r=new o.Path(t);if(e.validateFirebaseData(u,n,s.child(r)),".priority"===r.getBack()&&!e.isValidPriority(n))throw new Error(u+"contains an invalid value for '"+r.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");l.push(r)}),e.validateFirebaseMergePaths(u,l)}},e.validatePriority=function(t,n,o,r){if(!r||void 0!==o){if(i.isInvalidJSONNumber(o))throw new Error(a.errorPrefix(t,n,r)+"is "+o.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!e.isValidPriority(o))throw new Error(a.errorPrefix(t,n,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},e.validateEventType=function(t,e,n,o){if(!o||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(a.errorPrefix(t,e,o)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},e.validateKey=function(t,n,o,r){if(!(r&&void 0===o||e.isValidKey(o)))throw new Error(a.errorPrefix(t,n,r)+'was an invalid key = "'+o+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},e.validatePathString=function(t,n,o,r){if(!(r&&void 0===o||e.isValidPathString(o)))throw new Error(a.errorPrefix(t,n,r)+'was an invalid path = "'+o+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},e.validateRootPathString=function(t,n,o,r){o&&(o=o.replace(/^\/*\.info(\/|$)/,"/")),e.validatePathString(t,n,o,r)},e.validateWritablePath=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},e.validateUrl=function(t,n,o){var r=o.path.toString();if("string"!=typeof o.repoInfo.host||0===o.repoInfo.host.length||!e.isValidKey(o.repoInfo.namespace)||0!==r.length&&!e.isValidRootPathString(r))throw new Error(a.errorPrefix(t,n,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},e.validateCredential=function(t,e,n,o){if((!o||void 0!==n)&&"string"!=typeof n)throw new Error(a.errorPrefix(t,e,o)+"must be a valid credential (a string).")},e.validateBoolean=function(t,e,n,o){if((!o||void 0!==n)&&"boolean"!=typeof n)throw new Error(a.errorPrefix(t,e,o)+"must be a boolean.")},e.validateString=function(t,e,n,o){if((!o||void 0!==n)&&"string"!=typeof n)throw new Error(a.errorPrefix(t,e,o)+"must be a valid string.")},e.validateObject=function(t,e,n,o){if(!(o&&void 0===n||n&&"object"==typeof n&&null!==n))throw new Error(a.errorPrefix(t,e,o)+"must be a valid object.")},e.validateObjectContainsKey=function(t,e,n,o,i,s){if(!n||"object"!=typeof n||!r.contains(n,o)){if(i)return;throw new Error(a.errorPrefix(t,e,i)+'must contain the key "'+o+'"')}if(s){var c=r.safeGet(n,o);if("number"===s&&"number"!=typeof c||"string"===s&&"string"!=typeof c||"boolean"===s&&"boolean"!=typeof c||"function"===s&&"function"!=typeof c||"object"===s&&"object"!=typeof c&&c)throw i?new Error(a.errorPrefix(t,e,i)+'contains invalid value for key "'+o+'" (must be of type "'+s+'")'):new Error(a.errorPrefix(t,e,i)+'must contain the key "'+o+'" with type "'+s+'"')}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3);!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(e.OperationType||(e.OperationType={}));var r=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,o.assert(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}();e.OperationSource=r},function(t,e,n){"use strict";function o(t){return new Promise(t)}function r(t){return Promise.resolve(t)}function i(t){return Promise.reject(t)}e.a=o,e.c=r,e.b=i},function(t,e,n){"use strict";(function(t){function o(t,e){var n=document.body.getBoundingClientRect(),o=360*t/n.width,r=-180*e/n.height+90;return new d.Vector2(o,r)}function r(t,e){var n=document.body.getBoundingClientRect(),o=t/360*n.width,r=(e/-180+.5)*n.height;return new d.Vector2(o,r)}function i(e,n,o){var r=Math.sqrt(e*e+n*n+o*o),i=180*Math.atan2(o,e)/Math.PI,a=180*Math.acos(n/r)/Math.PI;return new t.Vector3(r,a,i)}function a(e,n,o){var r=e*Math.sin(n*Math.PI/180)*Math.cos(o*Math.PI/180),i=e*Math.sin(n*Math.PI/180)*Math.sin(o*Math.PI/180),a=e*Math.cos(n*Math.PI/180);return new t.Vector3(r,a,i)}function s(t,e,n){var o=Math.sqrt(t*t+e*e+n*n);return{rho:o,theta:Math.atan2(n,t),phi:Math.acos(e/o)}}function c(t,e,n){var o=t*Math.cos(e)*Math.sin(n),r=t*Math.sin(e)*Math.sin(n),i=t*Math.cos(n);return new p.Vector3(o,i,r)}function u(t,e,n){return Math.max(e,Math.min(n,t))}function l(t,e,n){var o=n||300,r=u(t,0,360),i=u(-e,-90,90);return c(o,r/180*Math.PI,(i+90)/180*Math.PI)}Object.defineProperty(e,"__esModule",{value:!0});var p=n(24),d=n(75);e.normalizeAbsolutePosition=o,e.denormalizePosition=r,e.car2pol=i,e.pol2car=a,e.coordinateToSpherical=s,e.sphericalToCoordinate=c,e.clamp=u,e.getCoordinatePosition=l}).call(e,n(24))},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(134),s=n(14),c=function(){function t(){this.isReadOnly=!1,this.soundtrack=new a.MediaFile,this.soundtrackVolume=s.DEFAULT_VOLUME,this.initValues()}return t.prototype.initValues=function(){this.projectName=s.DEFAULT_PROJECT_NAME,this.projectDescription=s.DEFAULT_PROJECT_DESCRIPTION,this.projectTags="",this.rooms=new Set,this.homeRoomId=""},t.prototype.addRoom=function(t){this.rooms.add(t)},t.prototype.getRoomById=function(t){return Array.from(this.rooms).find(function(e){return e.getId()===t})},t.prototype.removeRoomById=function(t){this.rooms.delete(this.getRoomById(t))},t.prototype.getRooms=function(){return this.rooms},t.prototype.clearRooms=function(){this.rooms=new Set},t.prototype.getProjectName=function(){return this.projectName},t.prototype.setProjectName=function(t){this.projectName=t},t.prototype.getProjectDescription=function(){return this.projectDescription},t.prototype.setProjectDescription=function(t){this.projectDescription=t},t.prototype.getHomeRoomId=function(){return this.homeRoomId?this.homeRoomId:Array.from(this.getRooms())[0].getId()},t.prototype.setHomeRoomId=function(t){this.homeRoomId=t},t.prototype.getProjectIsEmpty=function(){return 1===this.rooms.size&&!Array.from(this.rooms)[0].hasBackgroundImage()},t.prototype.getProjectTags=function(){return this.projectTags},t.prototype.setProjectTags=function(t){this.projectTags=t},t.prototype.getIsReadOnly=function(){return this.isReadOnly},t.prototype.setIsReadOnly=function(t){this.isReadOnly=t},t.prototype.getSoundtrack=function(){return this.soundtrack},t.prototype.setSoundtrack=function(t,e,n){void 0===t||null===t?this.soundtrack.setFileName(""):(this.soundtrack.setFileName(t),this.soundtrack.setBinaryFileData(n),this.setSoundtrackVolume(e))},t.prototype.setSoundtrackVolume=function(t){this.soundtrackVolume=void 0===t||null===t?s.DEFAULT_VOLUME:t},t.prototype.removeSoundtrack=function(){this.soundtrack=new a.MediaFile},t.prototype.getSoundtrackVolume=function(){return this.soundtrackVolume},t=o([i.Injectable(),r("design:paramtypes",[])],t)}();e.RoomManager=c},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(222),s=n(0),c=n(14),u=n(183),l=function(){function t(t,e){this.http=t,this.authenticationService=e}return t.prototype.logIn=function(t,e){var n=c.BASE_URL+"/get_auth_token/",o={username:t,password:e};return this.http.post(n,o,{withCredentials:!0}).map(function(t){return t.json()}).map(function(t){return t.token})},t.prototype.logOut=function(){var t=c.BASE_URL+"/logout/";return this.http.delete(t,{withCredentials:!0})},t.prototype.getUser=function(){var t=c.BASE_URL+"/user/";return this.http.get(t,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.createUser=function(t,e,n,o,r){var i=c.BASE_URL+"/users/",a={password:o,first_name:t,last_name:e,username:n,email:r};return this.http.post(i,a,{withCredentials:!0}).map(function(t){return t.json()})},t.prototype.createProject=function(t,e,n,o,r){var i=c.BASE_URL+"/users/"+t+"/projects/",a=new FormData;return a.append("name",e),a.append("tags",n),a.append("project_file",o),a.append("project_thumbnail",r),this.http.post(i,a,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.getProjects=function(t){var e=c.BASE_URL+"/users/"+t+"/projects/";return console.log("getProjects"),this.http.get(e,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.getProjectData=function(t,e){var n=c.BASE_URL+"/users/"+t+"/projects/"+e+"/";return this.http.get(n,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.getProjectUrl=function(t,e){var n=c.BASE_URL+"/users/"+t+"/projects/"+e+"/sign_url/";return this.http.get(n,this.getRequestOptions()).map(function(t){return t.json().signed_url})},t.prototype.getProject=function(t){return this.http.get(t,{responseType:a.ResponseContentType.ArrayBuffer}).map(function(t){return t.arrayBuffer()})},t.prototype.updateProject=function(t,e,n,o,r,i){var a=c.BASE_URL+"/users/"+t+"/projects/"+e+"/",s=new FormData;return s.append("id",e),s.append("name",n),s.append("tags",o),s.append("project_file",r),s.append("project_thumbnail",i),this.http.put(a,s,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.updateSharableStatus=function(t,e,n){var o=c.BASE_URL+"/users/"+t+"/projects/"+e+"/is_public/",r={is_public:n};return this.http.put(o,r,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.deleteProject=function(t,e){var n=c.BASE_URL+"/users/"+t+"/projects/"+e+"/";return this.http.delete(n,this.getRequestOptions())},t.prototype.searchPublicProjects=function(t){var e=encodeURIComponent(t),n=c.BASE_URL+"/search/?tags="+e;return this.http.get(n,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.getAllProjectsInGroup=function(t){var e=c.BASE_URL+"/admin_groups/"+t+"/";return this.http.get(e,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.setProjectInGroup=function(t,e,n,o){var r=c.BASE_URL+"/user_groups/"+t+"/",i={projectId:e,isIn:n,projectType:o};return this.http.put(r,i,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.getGroup=function(t){var e=c.BASE_URL+"/user_groups/"+t+"/";return this.http.get(e,this.getRequestOptions()).map(function(t){return t.json()})},t.prototype.getRequestOptions=function(){var t=new a.Headers({Authorization:"Token "+this.authenticationService.getToken()});return new a.RequestOptions({withCredentials:!0,headers:t})},t.prototype.uploadVideo=function(t){return s.Observable.fromPromise(Promise.resolve())},t=o([i.Injectable(),r("design:paramtypes",[a.Http,u.AuthenticationService])],t)}();e.ApiService=l},,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,n,o,r){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=o,this.prevName=r}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,o){return new t(t.CHILD_CHANGED,n,e,o)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}();e.Change=o},function(t,e,n){"use strict";function o(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function r(t,e){for(var n in t)o(t,n)&&e(n,t[n])}function i(t){if(null==t)return{};var e={};return r(t,function(t,n){e[t]=n}),e}e.b=r,e.a=i},function(t,e,n){"use strict";function o(){return(Math.random()*Math.pow(2,31)>>>0)+""}function r(){for(var t=o();i.has(t);)t=o();return i.add(t),t}Object.defineProperty(e,"__esModule",{value:!0});var i=new Set;e.generateUniqueId=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(268),r=n(267),i=n(266),a=n(269),s=n(510),c=n(270),u=n(264),l={audio:o.Audio,door:a.Door,image:r.Image,room:s.Room,text:i.Text,link:c.Link,narrator:u.Narrator},p=function(){function t(){}return t.getTypeString=function(t){return Object.keys(l).find(function(e){return t instanceof l[e]})},t}();e.RoomPropertyTypeService=p},,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(172),a=n(45),s=n(9),c=n(3),u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return r},set:function(t){r=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return s.nameCompare(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw c.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return a.NamedNode.MIN},e.prototype.maxPost=function(){return new a.NamedNode(s.MAX_NAME,r)},e.prototype.makePost=function(t,e){return c.assert("string"==typeof t,"KeyIndex indexValue must always be a string."),new a.NamedNode(t,r)},e.prototype.toString=function(){return".key"},e}(i.Index);e.KeyIndex=u,e.KEY_INDEX=new u},function(t,e,n){"use strict";function o(t,e){if(void 0===e&&(e=null),null===t)return r.ChildrenNode.EMPTY_NODE;if("object"==typeof t&&".priority"in t&&(e=t[".priority"]),c.assert(null===e||"string"==typeof e||"number"==typeof e||"object"==typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"==typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!=typeof t||".sv"in t){var n=t;return new i.LeafNode(n,o(e))}if(t instanceof Array||!h){var f=r.ChildrenNode.EMPTY_NODE,m=t;return s.forEach(m,function(t,e){if(s.contains(m,t)&&"."!==t.substring(0,1)){var n=o(e);!n.isLeafNode()&&n.isEmpty()||(f=f.updateImmediateChild(t,n))}}),f.updatePriority(o(e))}var g=[],v=!1,y=t;if(s.forEach(y,function(t,e){if("string"!=typeof t||"."!==t.substring(0,1)){var n=o(y[t]);n.isEmpty()||(v=v||!n.getPriority().isEmpty(),g.push(new a.NamedNode(t,n)))}}),0==g.length)return r.ChildrenNode.EMPTY_NODE;var _=u.buildChildSet(g,l.NAME_ONLY_COMPARATOR,function(t){return t.name},l.NAME_COMPARATOR);if(v){var b=u.buildChildSet(g,d.PRIORITY_INDEX.getCompare());return new r.ChildrenNode(_,o(e),new p.IndexMap({".priority":b},{".priority":d.PRIORITY_INDEX}))}return new r.ChildrenNode(_,o(e),p.IndexMap.Default)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(36),i=n(173),a=n(45),s=n(3),c=n(3),u=n(482),l=n(483),p=n(481),d=n(33),h=!0;e.nodeFromJSON=o,d.setNodeFromJSON(o)},function(t,e,n){"use strict";function o(t){switch(t){case d.RAW:case d.BASE64:case d.BASE64URL:case d.DATA_URL:return;default:throw"Expected one of the event types: ["+d.RAW+", "+d.BASE64+", "+d.BASE64URL+", "+d.DATA_URL+"]."}}function r(t,e){switch(t){case d.RAW:return new h(i(e));case d.BASE64:case d.BASE64URL:return new h(s(t,e));case d.DATA_URL:return new h(c(e),u(e))}throw p.s()}function i(t){for(var e=[],n=0;n<t.length;n++){var o=t.charCodeAt(n);if(o<=127)e.push(o);else if(o<=2047)e.push(192|o>>6,128|63&o);else if(55296==(64512&o)){var r=n<t.length-1&&56320==(64512&t.charCodeAt(n+1));if(r){var i=o,a=t.charCodeAt(++n);o=65536|(1023&i)<<10|1023&a,e.push(240|o>>18,128|o>>12&63,128|o>>6&63,128|63&o)}else e.push(239,191,189)}else 56320==(64512&o)?e.push(239,191,189):e.push(224|o>>12,128|o>>6&63,128|63&o)}return new Uint8Array(e)}function a(t){var e;try{e=decodeURIComponent(t)}catch(t){throw p.i(d.DATA_URL,"Malformed data URL.")}return i(e)}function s(t,e){switch(t){case d.BASE64:var n=-1!==e.indexOf("-"),o=-1!==e.indexOf("_");if(n||o){var r=n?"-":"_";throw p.i(t,"Invalid character '"+r+"' found: is it base64url encoded?")}break;case d.BASE64URL:var i=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(i||a){var r=i?"+":"/";throw p.i(t,"Invalid character '"+r+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(e)}catch(e){throw p.i(t,"Invalid character found")}for(var c=new Uint8Array(s.length),u=0;u<s.length;u++)c[u]=s.charCodeAt(u);return c}function c(t){var e=new f(t);return e.base64?s(d.BASE64,e.rest):a(e.rest)}function u(t){return new f(t).contentType}function l(t,e){return!!(t.length>=e.length)&&t.substring(t.length-e.length)===e}n.d(e,"a",function(){return d}),e.c=o,e.b=r;var p=n(66),d={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},h=function(){function t(t,e){this.data=t,this.contentType=e||null}return t}(),f=function(){function t(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw p.i(d.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=l(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)}return t}()},function(t,e,n){"use strict";function o(t){switch(t){case i.RUNNING:case i.PAUSING:case i.CANCELING:return a.RUNNING;case i.PAUSED:return a.PAUSED;case i.SUCCESS:return a.SUCCESS;case i.CANCELED:return a.CANCELED;case i.ERROR:default:return a.ERROR}}n.d(e,"b",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"c",function(){return a}),e.d=o;var r={STATE_CHANGED:"state_changed"},i={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},a={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){}return t.prototype.getFileName=function(){return void 0===this.fileName||null===this.fileName?"":this.fileName},t.prototype.setFileName=function(t){this.fileName=t},t.prototype.getBinaryFileData=function(){return this.binaryFileData},t.prototype.setBinaryFileData=function(t){this.binaryFileData=t},t.prototype.hasAsset=function(){return!!this.binaryFileData},t}();e.MediaFile=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(75),r=n(108),i=function(){function t(){this.id=r.generateUniqueId(),this.location=o.Vector2.build(),this.timestamp=Date.now(),this.isPossibleCombinedHotspot=!1}return t.prototype.getId=function(){return this.id},t.prototype.setId=function(t){return this.id=t,this},t.prototype.getName=function(){return this.name},t.prototype.setName=function(t){return this.name=t,this},t.prototype.getLocation=function(){return this.location},t.prototype.setLocation=function(t){return this.location=t,this},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(t){return this.timestamp=t,this},t.prototype.getPossibleCombinedHotspot=function(){return this.isPossibleCombinedHotspot},t.prototype.setPossibleCombinedHotspot=function(t){this.isPossibleCombinedHotspot=t},t.prototype.toJson=function(){return{uuid:this.id,name:this.name,vect:this.location.toString(),time:this.timestamp}},t}();e.BaseElement=i},function(t,e,n){"use strict";(function(t){var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(271),a=function(){function e(){this.textureMap=new Map,this.audioBufferMap=new Map}return e.prototype.loadTextures=function(e){var n=this,o=e.filter(function(t){return!n.textureMap.has(t.id)||n.textureMap.get(t.id).fileName!==t.fileName}).map(function(e){return new Promise(function(n,o){try{(new t.TextureLoader).load(e.filePath,function(t){return n(new s(e.id,e.fileName,t))})}catch(t){o(t)}})});return Promise.all(o).then(function(t){return t.forEach(function(t){n.textureMap.set(t.id,t)})})},e.prototype.loadAudioBuffers=function(t){var e=this,n=i.getAudioContext(),o=t.filter(function(t){return!e.audioBufferMap.has(t.id)||e.audioBufferMap.get(t.id).fileName!==t.fileName}).map(function(t){for(var e=atob(t.filePath.split(",")[1]),n=new ArrayBuffer(e.length),o=new Uint8Array(n),r=0;r<e.length;r++)o[r]=e.charCodeAt(r);return{meta:t,arrayBuffer:n}}).map(function(t){try{return n.decodeAudioData(t.arrayBuffer).then(function(n){var o=new c(t.meta.id,t.meta.fileName,n);return e.audioBufferMap.set(t.meta.id,o),null})}catch(o){if("Not enough arguments"===o.message)return new Promise(function(o,r){try{n.decodeAudioData(t.arrayBuffer,function(n){var r=new c(t.meta.id,t.meta.fileName,n);e.audioBufferMap.set(t.meta.id,r),o()})}catch(t){r(t)}})}});return Promise.all(o)},e.prototype.getTextureById=function(t){return this.textureMap.has(t)?this.textureMap.get(t).texture:null},e.prototype.getAudioBufferById=function(t){return this.audioBufferMap.has(t)?this.audioBufferMap.get(t).audioBuffer:null},e.prototype.clearAssets=function(){this.textureMap.clear(),this.audioBufferMap.clear()},e=o([r.Injectable()],e)}();e.AssetManager=a;var s=function(){function t(t,e,n){this.id=t,this.fileName=e,this.texture=n}return t}(),c=function(){function t(t,e,n){this.id=t,this.fileName=e,this.audioBuffer=n}return t}()}).call(e,n(24))},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(61),s=n(181),c=n(53),u=n(12),l=function(){function t(t,e,n){this.sceneInteractor=t,this.fileLoaderUtil=e,this.propertyBuilder=n}return t.prototype.build=function(t){var e=Object.keys(t).map(function(e){return t[e]}).sort(function(t,e){return t.lastModified-e.lastModified});return this.processBackgroundFileList(e)},t.prototype.processBackgroundFileList=function(t){var e=this,n=t.filter(function(t){return a.mimeTypeMap.image.indexOf(t.type)>-1}).map(function(t){return e.fileLoaderUtil.getBinaryFileData(t).then(function(t){return c.resizeImage(t,"backgroundImage")})});return Promise.all(n).then(function(n){return n.map(function(n,o){var r=e.sceneInteractor.getActiveRoomId(),i=e.sceneInteractor.getRoomById(r);i.hasBackgroundImage()&&(r=e.sceneInteractor.addRoom(),i=e.sceneInteractor.getRoomById(r));var a=t[o].name;return i.setFileData(a,n.backgroundImage),i.setThumbnail(a,n.thumbnail),i})}).then(function(t){return t.forEach(function(t,e){})})},t=o([i.Injectable(),r("design:paramtypes",[u.SceneInteractor,a.FileLoaderUtil,s.PropertyBuilder])],t)}();e.SlideshowBuilder=l},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(12),s=n(109),c=n(6),u=function(){function t(t,e){this.sceneInteractor=t,this.eventBus=e}return t.prototype.removeProperty=function(t){var e=s.RoomPropertyTypeService.getTypeString(t);this.removePropertyStrategy(e,t)},t.prototype.removePropertyStrategy=function(t,e){var n=this,o=this.sceneInteractor.getActiveRoomId();({text:function(){var t=e;n.sceneInteractor.removeText(o,t),n.onDeselect()},audio:function(){var t=e;n.sceneInteractor.removeAudio(o,t),n.onDeselect()},image:function(){var t=e;n.sceneInteractor.removeImage(o,t),n.onDeselect()},door:function(){var t=e;n.sceneInteractor.removeDoor(o,t),n.onDeselect()},room:function(){var t=e.getId();n.sceneInteractor.removeRoom(t);var o=n.sceneInteractor.getActiveRoomId();n.eventBus.onSelectRoom(o,!1)},link:function(){var t=e;n.sceneInteractor.removeLink(o,t),n.onDeselect()}})[t]()},t.prototype.onDeselect=function(){this.eventBus.onSelectProperty(null,!1),this.eventBus.onHotspotVisibility(!1)},t=o([i.Injectable(),r("design:paramtypes",[a.SceneInteractor,c.EventBus])],t)}();e.PropertyRemovalService=u},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(185),s=n(94);n(247);var c=function(){function t(t,e){this.userService=t,this.apiService=e}return t.prototype.isAdmin=function(){return!!this.userService.getAdminGroups().length},t.prototype.getAdminGroups=function(){return this.userService.getAdminGroups()},t.prototype.getAllProjectsInGroup=function(t){return this.apiService.getAllProjectsInGroup(t)},t.prototype.setProjectInGroup=function(t,e,n,o){return this.apiService.setProjectInGroup(t,e,n,o)},t=o([i.Injectable(),r("design:paramtypes",[a.UserService,s.ApiService])],t)}();e.AdminInteractor=c},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1113),r=n(1114),i=function(t){try{if("undefined"!=typeof window&&void 0!==window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new o.DOMStorageWrapper(e)}}catch(t){}return new r.MemoryStorage};e.PersistentStorage=i("localStorage"),e.SessionStorage=i("sessionStorage")},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PROTOCOL_VERSION="5",e.VERSION_PARAM="v",e.TRANSPORT_SESSION_PARAM="s",e.REFERER_PARAM="r",e.FORGE_REF="f",e.FORGE_DOMAIN="firebaseio.com",e.LAST_SESSION_PARAM="ls",e.WEBSOCKET="websocket",e.LONG_POLLING="long_polling"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(45),r=n(9),i=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new o.NamedNode(r.MIN_NAME,t),i=new o.NamedNode(r.MIN_NAME,e);return 0!==this.compare(n,i)},t.prototype.minPost=function(){return o.NamedNode.MIN},t}();e.Index=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(3),i=n(9),a=n(479),s=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,r.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),a.validatePriorityNode(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return o},set:function(t){o=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var o=e.getFront();return null===o?n:n.isEmpty()&&".priority"!==o?this:(r.assert(".priority"!==o||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(o,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+a.priorityHashText(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?i.doubleToIEEE754String(this.value_):this.value_,this.lazyHash_=i.sha1(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(r.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,o=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),a=t.VALUE_TYPE_ORDER.indexOf(o);return r.assert(i>=0,"Unknown leaf type: "+n),r.assert(a>=0,"Unknown leaf type: "+o),i===a?"object"===o?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:a-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();e.LeafNode=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,n,o,r){void 0===r&&(r=null),this.isReverse_=o,this.resultGenerator_=r,this.nodeStack_=[];for(var i=1;!t.isEmpty();)if(t=t,i=e?n(t.key,e):1,o&&(i*=-1),i<0)t=this.isReverse_?t.left:t.right;else{if(0===i){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}();e.SortedMapIterator=o;var r=function(){function t(e,n,o,r,i){this.key=e,this.value=n,this.color=null!=o?o:t.RED,this.left=null!=r?r:a.EMPTY_NODE,this.right=null!=i?i:a.EMPTY_NODE}return t.prototype.copy=function(e,n,o,r,i){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=o?o:this.color,null!=r?r:this.left,null!=i?i:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var o,r;return r=this,o=n(t,r.key),r=o<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===o?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return a.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()},t.prototype.remove=function(t,e){var n,o;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return a.EMPTY_NODE;o=n.right.min_(),n=n.copy(o.key,o.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}();e.LLRBNode=r;var i=function(){function t(){}return t.prototype.copy=function(t,e,n,o,r){return this},t.prototype.insert=function(t,e,n){return new r(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}();e.LLRBEmptyNode=i;var a=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,r.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,r.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,o=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return o?o.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(o=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new o(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new o(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new o(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new o(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new i,t}();e.SortedMap=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(486),r=n(131),i=n(22),a=n(487),s=n(1120),c=n(1131),u=n(3),l=n(9),p=n(3),d=n(1132),h=n(257),f=n(1134),m=n(492),g=n(1135),v=n(493),y=n(1140),_=n(475),b=function(){function t(t,e,n){var o=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new g.EventQueue,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new a.SparseSnapshotTree,this.persistentConnection_=null;var r=new d.AuthTokenProvider(n);if(this.stats_=h.StatsManager.getCollection(t),e||l.beingCrawled())this.server_=new y.ReadonlyRestClient(this.repoInfo_,this.onDataUpdate_.bind(this),r),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var i=n.options.databaseAuthVariableOverride;if(void 0!==i&&null!==i){if("object"!=typeof i)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{u.stringify(i)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new v.PersistentConnection(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),r,i),this.server_=this.persistentConnection_}r.addTokenChangeListener(function(t){o.server_.refreshAuthToken(t)}),this.statsReporter_=h.StatsManager.getOrCreateReporter(t,function(){return new f.StatsReporter(o.stats_,o.server_)}),this.transactions_init_(),this.infoData_=new c.SnapshotHolder,this.infoSyncTree_=new s.SyncTree({startListening:function(t,e,n,r){var i=[],a=o.infoData_.getNode(t.path);return a.isEmpty()||(i=o.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){r("ok")},0)),i},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new s.SyncTree({startListening:function(t,e,n,r){return o.server_.listen(t,n,e,function(e,n){var i=r(e,n);o.eventQueue_.raiseEventsForChangedPath(t.path,i)}),[]},stopListening:function(t,e){o.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new i.Path(".info/serverTimeOffset")),e=t.val()||0;return(new Date).getTime()+e},t.prototype.generateServerValues=function(){return o.generateWithValues({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,o){this.dataUpdateCount++;var a=new i.Path(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var s=[];if(o)if(n){var c=p.map(e,function(t){return r.nodeFromJSON(t)});s=this.serverSyncTree_.applyTaggedQueryMerge(a,c,o)}else{var u=r.nodeFromJSON(e);s=this.serverSyncTree_.applyTaggedQueryOverwrite(a,u,o)}else if(n){var l=p.map(e,function(t){return r.nodeFromJSON(t)});s=this.serverSyncTree_.applyServerMerge(a,l)}else{var d=r.nodeFromJSON(e);s=this.serverSyncTree_.applyServerOverwrite(a,d)}var h=a;s.length>0&&(h=this.rerunTransactions_(a)),this.eventQueue_.raiseEventsForChangedPath(h,s)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;l.each(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new i.Path("/.info/"+t),o=r.nodeFromJSON(e);this.infoData_.updateSnapshot(n,o);var a=this.infoSyncTree_.applyServerOverwrite(n,o);this.eventQueue_.raiseEventsForChangedPath(n,a)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,i){var a=this;this.log_("set",{path:t.toString(),value:e,priority:n});var s=this.generateServerValues(),c=r.nodeFromJSON(e,n),u=o.resolveDeferredValueSnapshot(c,s),p=this.getNextWriteId_(),d=this.serverSyncTree_.applyUserOverwrite(t,u,p,!0);this.eventQueue_.queueEvents(d),this.server_.put(t.toString(),c.val(!0),function(e,n){var o="ok"===e;o||l.warn("set at "+t+" failed: "+e);var r=a.serverSyncTree_.ackUserWrite(p,!o);a.eventQueue_.raiseEventsForChangedPath(t,r),a.callOnCompleteCallback(i,e,n)});var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var i=this;this.log_("update",{path:t.toString(),value:e});var a=!0,s=this.generateServerValues(),c={};if(p.forEach(e,function(t,e){a=!1;var n=r.nodeFromJSON(e);c[t]=o.resolveDeferredValueSnapshot(n,s)}),a)l.log("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var u=this.getNextWriteId_(),d=this.serverSyncTree_.applyUserMerge(t,c,u);this.eventQueue_.queueEvents(d),this.server_.merge(t.toString(),e,function(e,o){var r="ok"===e;r||l.warn("update at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(u,!r),s=a.length>0?i.rerunTransactions_(t):t;i.eventQueue_.raiseEventsForChangedPath(s,a),i.callOnCompleteCallback(n,e,o)}),p.forEach(e,function(e){var n=i.abortTransactions_(t.child(e));i.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=o.resolveDeferredValueTree(this.onDisconnect_,e),r=[];n.forEachTree(i.Path.Empty,function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var o=t.abortTransactions_(e);t.rerunTransactions_(o)}),this.onDisconnect_=new a.SparseSnapshotTree,this.eventQueue_.raiseEventsForChangedPath(i.Path.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(o,r){"ok"===o&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,o,r)})},t.prototype.onDisconnectSet=function(t,e,n){var o=this,i=r.nodeFromJSON(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),function(e,r){"ok"===e&&o.onDisconnect_.remember(t,i),o.callOnCompleteCallback(n,e,r)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,o){var i=this,a=r.nodeFromJSON(e,n);this.server_.onDisconnectPut(t.toString(),a.val(!0),function(e,n){"ok"===e&&i.onDisconnect_.remember(t,a),i.callOnCompleteCallback(o,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var o=this;if(p.isEmpty(e))return l.log("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(i,a){"ok"===i&&p.forEach(e,function(e,n){var i=r.nodeFromJSON(n);o.onDisconnect_.remember(t.child(e),i)}),o.callOnCompleteCallback(n,i,a)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!=typeof console){var e;t?(this.statsListener_||(this.statsListener_=new m.StatsListener(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);p.forEach(e,function(t,e){for(var o=t.length;o<n+2;o++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),l.log.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&l.exceptionGuard(function(){if("ok"==e)t(null);else{var o=(e||"error").toUpperCase(),r=o;n&&(r+=": "+n);var i=new Error(r);i.code=o,t(i)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new _.Database(this))},enumerable:!0,configurable:!0}),t}();e.Repo=b},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}();e.CacheNode=o},function(t,e,n){"use strict";var o={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key"},r=(i={},i[o.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",i[o.AVAILABLE_IN_SW]="This method is available in a service worker context.",i[o.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",i[o.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",i[o.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",i[o.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",i[o.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",i[o.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",i[o.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",i[o.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",i[o.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",i[o.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",i[o.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",i[o.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",i[o.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",i[o.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",i[o.USE_SW_BEFORE_GET_TOKEN]="You must call useServiceWorker() before calling getToken() to ensure your service worker is used.",i[o.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",i[o.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",i[o.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",i[o.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",i[o.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",i[o.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",i[o.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",i[o.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",i[o.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",i[o.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",i[o.BAD_SCOPE]="The service worker scope must be a string with at least one character.",i[o.BAD_VAPID_KEY]="The public VAPID key must be a string with at least one character.",i[o.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",i[o.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",i[o.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",i[o.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",i);e.a={codes:o,map:r};var i},function(t,e,n){"use strict";n.d(e,"f",function(){return o}),n.d(e,"g",function(){return r}),n.d(e,"a",function(){return i}),n.d(e,"b",function(){return a}),n.d(e,"c",function(){return s}),n.d(e,"d",function(){return c}),n.d(e,"e",function(){return u}),n.d(e,"h",function(){return l});var o="https://firebasestorage.googleapis.com",r="https://firebasestorage.googleapis.com",i="/v0",a="/v0",s="storageBucket",c=12e4,u=6e4,l=-9007199254740991},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(66),r=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw o.h(e)},t.makeFromUrl=function(e){function n(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}function r(t){t.path_=decodeURIComponent(t.path)}for(var i=null,a=new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),s={bucket:1,path:3},c=new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),u={bucket:1,path:3},l=[{regex:a,indices:s,postModify:n},{regex:c,indices:u,postModify:r}],p=0;p<l.length;p++){var d=l[p],h=d.regex.exec(e);if(h){var f=h[d.indices.bucket],m=h[d.indices.path];m||(m=""),i=new t(f,m),d.postModify(i);break}}if(null==i)throw o.k(e);return i},t}()},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(12),c=n(182),u=n(54),l=function(){function t(t,e,n,o){this.sceneInteractor=t,this.storageInteractor=e,this.projectInteractor=n,this.eventBus=o}return t.prototype.loadFile=function(t){var e=this;return this.eventBus.onStartLoading(),this.storageInteractor.deserializeProject(t).subscribe(function(t){e.sceneInteractor.setActiveRoomId(null),e.projectInteractor.setProjectId(null),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading()},function(t){var n="The zip file does not seem to be a properly formatted story file. \n Error received: "+t;e.eventBus.onModalMessage("File Upload Error",n),e.eventBus.onStopLoading()})},t=o([i.Injectable(),r("design:paramtypes",[s.SceneInteractor,c.StorageInteractor,u.ProjectInteractor,a.EventBus])],t)}();e.ZipFileReader=l},function(t,e,n){"use strict";function o(t){var e=/[<]([\de\-\.]+),([\de\-\.]+)[>]/,n=t.match(e),o=(n[0],n[1]),r=n[2],i=parseFloat(o),a=parseFloat(r);return new h.Vector2(i,a)}var r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(510),s=n(266),c=n(267),u=n(268),l=n(269),p=n(270),d=n(264),h=n(75),f=n(53),m=n(265),g=n(14),v=function(){function t(){}return t.prototype.setBaseProperties=function(t,e){var n=e.setId(t.uuid).setName(t.name).setTimestamp(t.time);if(t.vect){var r=o(t.vect);n.setLocation(r)}return n},t.prototype.text=function(t,e){var n=new s.Text;return n.setName(t),n.body=e,n},t.prototype.textFromJson=function(t){var e=this.setBaseProperties(t,new s.Text);return e.body=t.file,e},t.prototype.link=function(t,e){var n=new p.Link;return n.setName(t),n.body=e,n},t.prototype.linkFromJson=function(t){var e=this.setBaseProperties(t,new p.Link);return e.body=t.file,e},t.prototype.audio=function(t){var e=new u.Audio;return e.setName(t),e.setFileData(g.DEFAULT_FILE_NAME,g.DEFAULT_VOLUME,null),e},t.prototype.audioFromJson=function(t,e){var n=this.setBaseProperties(t,new u.Audio),o=decodeURIComponent(t.file),r=t.volume;return n.setFileData(o,r,e),n},t.prototype.image=function(t){var e=new c.Image;return e.setName(t),e.setFileData(g.DEFAULT_FILE_NAME,null),e},t.prototype.imageFromJson=function(t,e){var n=this.setBaseProperties(t,new c.Image),o=decodeURIComponent(t.file);return n.setFileData(o,e),n},t.prototype.door=function(t,e){var n=new l.Door;return n.setRoomId(t),n.setName(e),n},t.prototype.doorFromJson=function(t){var e=this.setBaseProperties(t,new l.Door);return e.setRoomId(t.file),e.setNameIsCustom(t.nameIsCustom||!1),e.setAutoTime(void 0!==t.autoTime?t.autoTime:0),e},t.prototype.roomFromJson=function(t,e,n,r){var i=this.setBaseProperties(t,new a.Room),s=decodeURIComponent(t.image),c=e||g.DEFAULT_IMAGE_PATH;if(i.setFileData(s,c),n?i.setThumbnail(g.BACKGROUND_THUMBNAIL,n):!n&&e&&f.resizeImage(e,"projectThumbnail").then(function(t){i.setThumbnail(g.BACKGROUND_THUMBNAIL,t)}).catch(function(t){return console.log("generate thumbnail error",t)}),r&&i.setBackgroundAudio(t.ambient,t.bgVolume,r),t.front){var u=o(t.front);i.setLocation(u)}return t.video&&i.setBackgroundVideo("",t.video),i.setReverb(t.reverb||m.reverbList[0]),i},t.prototype.room=function(t){var e=new a.Room;return e.setName(t),e.setFileData(g.DEFAULT_FILE_NAME,g.DEFAULT_IMAGE_PATH),e.setThumbnail(g.DEFAULT_FILE_NAME,g.DEFAULT_IMAGE_PATH),e},t.prototype.narratorFromJson=function(t,e,n){var o=new d.Narrator;if(e){var r=decodeURIComponent(t.intro),i=t.volume;o.setIntroAudio(r,i,e)}if(n){var r=decodeURIComponent(t.reprise);o.setReturnAudio(r,n)}return o},t=r([i.Injectable()],t)}();e.PropertyBuilder=v},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(272),s=n(273),c=n(136),u=function(){function t(t,e,n){this.deserializationService=t,this.serializationService=e,this.assetManager=n}return t.prototype.serializeProject=function(){return this.serializationService.zipStoryFile()},t.prototype.deserializeProject=function(t){var e=this;return this.deserializationService.unzipStoryFile(t).do(function(t){return e.assetManager.clearAssets()})},t=o([i.Injectable(),r("design:paramtypes",[a.DeserializationService,s.SerializationService,c.AssetManager])],t)}();e.StorageInteractor=u},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){}return t.prototype.getToken=function(){return!this.token&&sessionStorage&&(this.token=sessionStorage.getItem("TOKEN_STORAGE")),this.token},t.prototype.setToken=function(t){sessionStorage&&sessionStorage.setItem("TOKEN_STORAGE",t),this.token=t},t.prototype.getAuthenticationMethod=function(){return this.authMethod},t.prototype.setAuthenticationMethod=function(t){this.authMethod=t},t.prototype.isLoggedIn=function(){return!!this.getToken()},t.prototype.logOut=function(){sessionStorage&&sessionStorage.removeItem("TOKEN_STORAGE"),this.token=void 0,this.authMethod=void 0},t=o([i.Injectable(),r("design:paramtypes",[])],t)}();e.AuthenticationService=a},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(263),u=n(12),l=n(54),p=n(37),d=n(38),h=n(14),f=function(){function t(t,e,n,o,r,i){this.userInteractor=t,this.eventBus=e,this.projectInteractor=n,this.metaDataInteractor=o,this.sceneInteractor=r,this.router=i}return t.prototype.openDecodedProject=function(t){var e=this;this.eventBus.onStartLoading(),this.projectInteractor.openPublicProject(t).subscribe(function(t){e.sceneInteractor.setActiveRoomId(null),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading(),e.metaDataInteractor.setIsReadOnly(!0),e.router.navigate(["editor",{outlets:{view:"preview"}}])},function(t){e.eventBus.onStopLoading(),e.eventBus.onModalMessage(h.ERROR_OPENING_PROJECT,h.SERVER_ERROR)})},t.prototype.openProject=function(t){var e=c.decodeParam(t);if("ERROR"===e.message)return void this.eventBus.onModalMessage(h.ERROR_OPENING_PROJECT,h.FORMAT_ERROR);this.openDecodedProject(e.data)},t=o([i.Injectable(),r("design:paramtypes",[d.UserInteractor,s.EventBus,l.ProjectInteractor,p.MetaDataInteractor,u.SceneInteractor,a.Router])],t)}();e.ShareableLoader=f},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){}return t.prototype.getUser=function(){if(!this.user&&sessionStorage){var t=sessionStorage.getItem("USER_STORAGE");this.user=JSON.parse(t)}return this.user},t.prototype.setUser=function(t){sessionStorage&&sessionStorage.setItem("USER_STORAGE",JSON.stringify(t)),this.user=t},t.prototype.clearUser=function(){sessionStorage&&sessionStorage.removeItem("USER_STORAGE"),this.user=void 0},t.prototype.getUserId=function(){var t=this.getUser();return t&&t.id+""},t.prototype.getUserName=function(){var t=this.getUser();return t&&t.username},t.prototype.getUserGroups=function(){var t=this.getUser();return t&&t.groups?[].concat(t.groups,t.admin_groups):[]},t.prototype.getAdminGroups=function(){var t=this.getUser();return t&&t.groups?t.admin_groups:[]},t=o([i.Injectable(),r("design:paramtypes",[])],t)}();e.UserService=a},function(t,e,n){"use strict";function o(t,e){var n=t.getX()-e.getX(),o=t.getY()-e.getY();return Math.sqrt(Math.pow(n,2)+Math.pow(o,2))}var r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),s=n(6),c=n(12),u=n(75),l=function(){function t(t,e,n){var o=this;this.sceneInteractor=t,this.ngZone=e,this.eventBus=n,this.activeNeighborId="",this.eventBus.getObservable(s.EventType.SELECT_PROPERTY).subscribe(function(t){o.activeNeighborId=""},function(t){return console.log("CombinedHotspotUtil.init",t)})}return t.prototype.setRoomPropertyList=function(t){this.roomIconList=t},t.prototype.onIconMove=function(t,e,n){var r=this,i=this.activeNeighborId,a=this.sceneInteractor.getActiveRoomId(),s=this.roomIconList.map(function(t){var r=t.getScreenPosition();return{distance:o(new u.Vector2(e,n),r),roomIcon:t}}).sort(function(t,e){return t.distance-e.distance})[0];s&&s.distance<80?this.activeNeighborId=s.roomIcon.roomProperty.getId():this.activeNeighborId="",this.activeNeighborId!==i&&this.ngZone.run(function(){r.sceneInteractor.getRoomProperties(a).forEach(function(t){var e=t.getId()===r.activeNeighborId;t.setPossibleCombinedHotspot(e)})})},t.prototype.getActiveNeighborId=function(){return this.activeNeighborId},t=r([a.Injectable(),i("design:paramtypes",[c.SceneInteractor,a.NgZone,s.EventBus])],t)}();e.CombinedHotspotUtil=l},function(t,e,n){"use strict";function o(t){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia?window.navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(e){return r(t,e)}):new Promise(function(e,n){navigator.getUserMedia({audio:!0,video:!1},function(n){return e(r(t,n))},function(t){return n(SyntaxError)})})}function r(t,e){var n=t.createGain(),o=t.createMediaStreamSource(e),r=t.createAnalyser(),i=t.createGain();return r.fftSize=2048,i.gain.value=0,o.connect(n),n.connect(r),n.connect(i),i.connect(t.destination),{audioStream:e,micNode:n,analyserNode:r}}function i(){return!!navigator.mediaDevices&&!!navigator.mediaDevices.getUserMedia&&!!navigator.getUserMedia}var a=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),u=n(61),l=n(271),p=n(380),d=function(){function t(t){this.fileLoaderUtil=t}return t.prototype.startRecording=function(){var t=this;return o(l.getAudioContext()).then(function(e){t.audioNodes=e,t.frequencyDataArray=new Uint8Array(e.analyserNode.frequencyBinCount),t.recorder=new p(e.micNode),t.recorder.record()})},t.prototype.stopRecording=function(){var t=this;return new Promise(function(e,n){try{t.recorder.stop(),t.audioNodes.audioStream.getAudioTracks().forEach(function(t){return t.stop()}),t.recorder.exportWAV(function(n){e(t.fileLoaderUtil.getBinaryFileData(n))})}catch(t){n(t)}})},t.prototype.getFrequencyData=function(){return this.audioNodes.analyserNode.getByteFrequencyData(this.frequencyDataArray),this.frequencyDataArray},t=a([c.Injectable(),s("design:paramtypes",[u.FileLoaderUtil])],t)}();e.AudioRecorderService=d,e.browserCanRecordAudio=i},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(52),a=n(100),s=n(1302),c=n(1305),u=n(1308),l=n(1311),p=n(1314),d=n(1317),h=n(1320),f=n(6),m=n(184),g=function(){function t(){}return t=o([r.NgModule({declarations:[s.Checkbox,c.TextInput,u.TextInputMaterial,l.Modal,p.LoadingModal,d.MessageModal,h.ShareableModal],imports:[i.BrowserModule,a.FormsModule],exports:[s.Checkbox,c.TextInput,u.TextInputMaterial,l.Modal,p.LoadingModal,d.MessageModal,h.ShareableModal],providers:[f.EventBus,m.ShareableLoader]})],t)}();e.CommonModule=g},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(1324),a=n(12),s=n(37),c=n(275),u=n(182),l=n(38),p=n(54),d=n(76),h=n(274),f=n(280),m=n(139),g=n(527),v=n(276),y=function(){function t(){}return t=o([r.NgModule({declarations:[],imports:[i.DataModule],providers:[a.SceneInteractor,s.MetaDataInteractor,c.CameraInteractor,u.StorageInteractor,l.UserInteractor,p.ProjectInteractor,d.AssetInteractor,h.VideoInteractor,f.SearchInteractor,m.AdminInteractor,g.GroupInteractor,v.ChatInteractor]})],t)}();e.CoreModule=y},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CONSTANTS={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(1115),i=n(1116),a=n(9),s=n(1117),c=n(478),u=n(175),l=n(22),p=n(1141),d=n(89),h=n(3),f=n(3),m=n(490),g=function(t){function e(e,n){if(!(e instanceof u.Repo))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,p.QueryParams.DEFAULT,!1)||this}return o(e,t),e.prototype.getKey=function(){return h.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return h.validateArgCount("Reference.child",1,1,arguments.length),"number"==typeof t?t=String(t):t instanceof l.Path||(null===this.path.getFront()?d.validateRootPathString("Reference.child",1,t,!1):d.validatePathString("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){h.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){h.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){h.validateArgCount("Reference.set",1,2,arguments.length),d.validateWritablePath("Reference.set",this.path),d.validateFirebaseDataArg("Reference.set",1,t,this.path,!1),h.validateCallback("Reference.set",2,e,!0);var n=new f.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(h.validateArgCount("Reference.update",1,2,arguments.length),d.validateWritablePath("Reference.update",this.path),Array.isArray(t)){for(var n={},o=0;o<t.length;++o)n[""+o]=t[o];t=n,a.warn("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}d.validateFirebaseMergeDataArg("Reference.update",1,t,this.path,!1),h.validateCallback("Reference.update",2,e,!0);var r=new f.Deferred;return this.repo.update(this.path,t,r.wrapCallback(e)),r.promise},e.prototype.setWithPriority=function(t,e,n){if(h.validateArgCount("Reference.setWithPriority",2,3,arguments.length),d.validateWritablePath("Reference.setWithPriority",this.path),d.validateFirebaseDataArg("Reference.setWithPriority",1,t,this.path,!1),d.validatePriority("Reference.setWithPriority",2,e,!1),h.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var o=new f.Deferred;return this.repo.setWithPriority(this.path,t,e,o.wrapCallback(n)),o.promise},e.prototype.remove=function(t){return h.validateArgCount("Reference.remove",0,1,arguments.length),d.validateWritablePath("Reference.remove",this.path),h.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(h.validateArgCount("Reference.transaction",1,3,arguments.length),d.validateWritablePath("Reference.transaction",this.path),h.validateCallback("Reference.transaction",1,t,!1),h.validateCallback("Reference.transaction",2,e,!0),d.validateBoolean("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var o=new f.Deferred;"function"==typeof e&&o.promise.catch(function(){});var r=function(t,n,r){t?o.reject(t):o.resolve(new i.TransactionResult(n,r)),"function"==typeof e&&e(t,n,r)};return this.repo.startTransaction(this.path,t,r,n),o.promise},e.prototype.setPriority=function(t,e){h.validateArgCount("Reference.setPriority",1,2,arguments.length),d.validateWritablePath("Reference.setPriority",this.path),d.validatePriority("Reference.setPriority",1,t,!1),h.validateCallback("Reference.setPriority",2,e,!0);var n=new f.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){h.validateArgCount("Reference.push",0,2,arguments.length),d.validateWritablePath("Reference.push",this.path),d.validateFirebaseDataArg("Reference.push",1,t,this.path,!0),h.validateCallback("Reference.push",2,e,!0);var n,o=this.repo.serverTime(),r=s.nextPushId(o),i=this.child(r),a=this.child(r);return n=null!=t?i.set(t,e).then(function(){return a}):Promise.resolve(a),i.then=n.then.bind(n),i.catch=n.then.bind(n,void 0),"function"==typeof e&&n.catch(function(){}),i},e.prototype.onDisconnect=function(){return d.validateWritablePath("Reference.onDisconnect",this.path),new r.OnDisconnect(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(c.Query);e.Reference=g,c.Query.__referenceConstructor=g,m.SyncPoint.__referenceConstructor=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(174),i=n(22),a=n(9),s=n(3),c=function(){return o||(o=new r.SortedMap(a.stringCompare)),o},u=function(){function t(t,e){void 0===e&&(e=c()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return s.forEach(e,function(t,e){n=n.set(new i.Path(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:i.Path.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),o=this.children.get(n);if(null!==o){var r=o.findRootMostMatchingPathAndValue(t.popFront(),e);if(null!=r){return{path:new i.Path(n).child(r.path),value:r.value}}return null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),o=this.children.get(n);return null!==o?o.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var o=e.getFront(),r=this.children.get(o)||t.Empty,i=r.set(e.popFront(),n),a=this.children.insert(o,i);return new t(this.value,a)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),o=this.children.get(n);if(o){var r=o.remove(e.popFront()),i=void 0;return i=r.isEmpty()?this.children.remove(n):this.children.insert(n,r),null===this.value&&i.isEmpty()?t.Empty:new t(this.value,i)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var o=e.getFront(),r=this.children.get(o)||t.Empty,i=r.setTree(e.popFront(),n),a=void 0;return a=i.isEmpty()?this.children.remove(o):this.children.insert(o,i),new t(this.value,a)},t.prototype.fold=function(t){return this.fold_(i.Path.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(o,r){n[o]=r.fold_(t.child(o),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,i.Path.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var o=!!this.value&&n(e,this.value);if(o)return o;if(t.isEmpty())return null;var r=t.getFront(),i=this.children.get(r);return i?i.findOnPath_(t.popFront(),e.child(r),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,i.Path.Empty,e)},t.prototype.foreachOnPath_=function(e,n,o){if(e.isEmpty())return this;this.value&&o(n,this.value);var r=e.getFront(),i=this.children.get(r);return i?i.foreachOnPath_(e.popFront(),n.child(r),o):t.Empty},t.prototype.foreach=function(t){this.foreach_(i.Path.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,o){o.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}();e.ImmutableTree=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(106),i=n(36),a=n(33),s=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,i,a,s){o.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var c=t.getImmediateChild(e);return c.getChild(i).equals(n.getChild(i))&&c.isEmpty()==n.isEmpty()?t:(null!=s&&(n.isEmpty()?t.hasChild(e)?s.trackChildChange(r.Change.childRemovedChange(e,c)):o.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):c.isEmpty()?s.trackChildChange(r.Change.childAddedChange(e,n)):s.trackChildChange(r.Change.childChangedChange(e,n,c))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(a.PRIORITY_INDEX,function(t,o){e.hasChild(t)||n.trackChildChange(r.Change.childRemovedChange(t,o))}),e.isLeafNode()||e.forEachChild(a.PRIORITY_INDEX,function(e,o){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(o)||n.trackChildChange(r.Change.childChangedChange(e,o,i))}else n.trackChildChange(r.Change.childAddedChange(e,o))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?i.ChildrenNode.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}();e.IndexedFilter=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1133),r=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new o.StatsCollection),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}();e.StatsManager=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(175),i=n(9),a=n(476),s=n(89);n(1143);var c,u=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return c||(c=new t),c},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options.databaseURL;void 0===n&&i.fatal("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.intializeApp().");var o=a.parseRepoInfo(n),r=o.repoInfo;return s.validateUrl("Invalid Firebase Database URL",1,o),o.path.isEmpty()||i.fatal("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(r,t).database},t.prototype.deleteRepo=function(t){var e=o.safeGet(this.repos_,t.app.name);e&&o.safeGet(e,t.repoInfo_.toURLString())===t||i.fatal("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=o.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var a=o.safeGet(n,t.toURLString());return a&&i.fatal("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),a=new r.Repo(t,this.useRestClient_,e),n[t.toURLString()]=a,a},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}();e.RepoManager=u},function(t,e,n){"use strict";function o(t,e,n){for(var o=e.length,r=e.length,i=0;i<e.length;i++)if(e[i].optional){o=i;break}if(!(o<=n.length&&n.length<=r))throw p.g(o,r,t,n.length);for(var i=0;i<n.length;i++)try{e[i].validator(n[i])}catch(e){throw e instanceof Error?p.f(i,t,e.message):p.f(i,t,e)}}function r(t,e){return function(n){t(n),e(n)}}function i(t,e){function n(t){if(!h.j(t))throw"Expected string."}var o;return o=t?r(n,t):n,new f(o,e)}function a(){function t(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||h.e()&&t instanceof Blob))throw"Expected Blob or File."}return new f(t)}function s(t){return new f(d.c,t)}function c(){function t(t){if(!(h.h(t)&&t>=0))throw"Expected a number 0 or greater."}return new f(t)}function u(t,e){function n(e){if(!(null===e||h.a(e)&&e instanceof Object))throw"Expected an Object.";void 0!==t&&null!==t&&t(e)}return new f(n,e)}function l(t){function e(t){if(null!==t&&!h.b(t))throw"Expected a Function."}return new f(e,t)}e.g=o,e.e=i,e.f=a,e.b=s,e.c=c,e.a=u,e.d=l;var p=n(66),d=n(260),h=n(46),f=function(){function t(t,e){var n=this;this.validator=function(e){n.optional&&!h.c(e)||t(e)},this.optional=!!e}return t}()},function(t,e,n){"use strict";function o(t,e){return e}function r(t){return!f.j(t)||t.length<2?t:(t=t,h.b(t))}function i(){function t(t,e){return r(e)}function e(t,e){return f.a(e)?+e:e}function n(t,e){if(!(f.j(e)&&e.length>0))return[];var n=encodeURIComponent;return e.split(",").map(function(e){var o=t.bucket,r=t.fullPath,i="/b/"+n(o)+"/o/"+n(r);return m.a(i)+m.c({alt:"media",token:e})})}if(v)return v;var o=[];o.push(new g("bucket")),o.push(new g("generation")),o.push(new g("metageneration")),o.push(new g("name","fullPath",!0));var i=new g("name");i.xform=t,o.push(i);var a=new g("size");return a.xform=e,o.push(a),o.push(new g("timeCreated")),o.push(new g("updated")),o.push(new g("md5Hash",null,!0)),o.push(new g("cacheControl",null,!0)),o.push(new g("contentDisposition",null,!0)),o.push(new g("contentEncoding",null,!0)),o.push(new g("contentLanguage",null,!0)),o.push(new g("contentType",null,!0)),o.push(new g("metadata","customMetadata",!0)),o.push(new g("downloadTokens","downloadURLs",!1,n)),v=o}function a(t,e){function n(){var n=t.bucket,o=t.fullPath,r=new d.a(n,o);return e.makeStorageReference(r)}Object.defineProperty(t,"ref",{get:n})}function s(t,e,n){var o={};o.type="file";for(var r=n.length,i=0;i<r;i++){var s=n[i];o[s.local]=s.xform(o,e[s.server])}return a(o,t),o}function c(t,e,n){var o=p.a(e);return null===o?null:s(t,o,n)}function u(t,e){for(var n={},o=e.length,r=0;r<o;r++){var i=e[r];i.writable&&(n[i.server]=t[i.local])}return JSON.stringify(n)}function l(t){if(!t||!f.i(t))throw"Expected Metadata object.";for(var e in t){var n=t[e];if("customMetadata"===e){if(!f.i(n))throw"Expected object for 'customMetadata' mapping."}else if(f.g(n))throw"Mapping for '"+e+"' cannot be an object."}}e.b=i,e.a=c,e.d=u,e.c=l;var p=n(1158),d=n(179),h=n(506),f=n(46),m=n(261),g=function(){function t(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||o}return t}(),v=null},function(t,e,n){"use strict";function o(t){return s.f+s.a+t}function r(t){return s.g+s.a+t}function i(t){return s.f+s.b+t}function a(t){var e=encodeURIComponent,n="?";return c.b(t,function(t,o){var r=e(t)+"="+e(o);n=n+r+"&"}),n=n.slice(0,-1)}e.b=o,e.a=r,e.d=i,e.c=a;var s=n(178),c=n(107)},function(t,e,n){"use strict";function o(t,e){return-1!==t.indexOf(e)}function r(t){return Array.prototype.slice.call(t)}function i(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}e.b=o,e.a=r,e.c=i},function(t,e,n){"use strict";function o(t){var e=btoa(t);return encodeURIComponent(e)}function r(t){try{var e=decodeURIComponent(t);return{message:"OK",data:atob(e)}}catch(t){return{message:"ERROR",data:t}}}function i(t){var e=location.protocol+"//"+location.host,n=location.pathname,r=(location.hash.indexOf("?")<0?location.hash.length:location.hash.indexOf("?"),"#/editor/(view:flat)"),i=a+"="+o(t);return console.log("pathName:",n),console.log("hash:",r),""+e+n+r+"?"+i}Object.defineProperty(e,"__esModule",{value:!0});var a="sharedproject";e.SHARED_KEY=a,e.decodeParam=r,e.getShareableLink=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(134),r=n(14),i=function(){function t(){this.introAudio=new o.MediaFile,this.returnAudio=new o.MediaFile,this.volume=r.DEFAULT_VOLUME}return t.prototype.getIntroAudio=function(){return this.introAudio},t.prototype.setIntroAudio=function(t,e,n){this.introAudio.setFileName(t),this.introAudio.setBinaryFileData(n),this.setVolume(e)},t.prototype.getReturnAudio=function(){return this.returnAudio},t.prototype.setReturnAudio=function(t,e){this.returnAudio.setFileName(t),this.returnAudio.setBinaryFileData(e)},t.prototype.removeIntroAudio=function(){this.introAudio=new o.MediaFile},t.prototype.setVolume=function(t){this.volume=void 0===t||null===t?r.DEFAULT_VOLUME:t},t.prototype.getVolume=function(){return this.volume},t.prototype.toJson=function(){return{intro:this.introAudio.getFileName()?encodeURIComponent(this.introAudio.getFileName()):"",reprise:this.returnAudio.getFileName()?encodeURIComponent(this.returnAudio.getFileName()):"",volume:this.getVolume()}},t}();e.Narrator=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=["Off","Generic","PaddedCell","Room","Bathroom","Livingroom","Stoneroom","Auditorium","Concerthall","Cave","Arena","Hangar","CarpetedHallway","Hallway","StoneCorridor","Alley","Forest","City","Mountains","Quarry","Plain","ParkingLot","SewerPipe","Underwater","Drugged","Dizzy","Psychotic"];e.reverbList=o},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(135),i=function(t){function e(){return t.call(this)||this}return o(e,t),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},set:function(t){this._body=t},enumerable:!0,configurable:!0}),e.prototype.toJson=function(){return Object.assign(t.prototype.toJson.call(this),{file:this._body})},e}(r.BaseElement);e.Text=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(135),i=n(134),a=function(t){function e(){var e=t.call(this)||this;return e.mediaFile=new i.MediaFile,e}return o(e,t),e.prototype.getFileName=function(){return this.mediaFile.getFileName()},e.prototype.setFileName=function(t){this.mediaFile.setFileName(t)},e.prototype.getBinaryFileData=function(){return this.mediaFile.getBinaryFileData()},e.prototype.setBinaryFileData=function(t){return this.mediaFile.setBinaryFileData(t)},e.prototype.setFileData=function(t,e){this.setFileName(t),this.setBinaryFileData(e)},e.prototype.toJson=function(){return Object.assign(t.prototype.toJson.call(this),{file:encodeURIComponent(this.mediaFile.getFileName()),size:"<2,1>"})},e}(r.BaseElement);e.Image=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(135),i=n(134),a=n(14),s=function(t){function e(){var e=t.call(this)||this;return e.mediaFile=new i.MediaFile,e.volume=a.DEFAULT_VOLUME,e}return o(e,t),e.prototype.getFileName=function(){return this.mediaFile.getFileName()},e.prototype.setFileName=function(t){this.mediaFile.setFileName(t)},e.prototype.getBinaryFileData=function(){return this.mediaFile.getBinaryFileData()},e.prototype.setBinaryFileData=function(t){return this.mediaFile.setBinaryFileData(t)},e.prototype.setFileData=function(t,e,n){this.setFileName(t),this.setVolume(e),this.setBinaryFileData(n)},e.prototype.setVolume=function(t){this.volume=void 0===t||null===t?a.DEFAULT_VOLUME:t},e.prototype.getVolume=function(){return this.volume},e.prototype.toJson=function(){return Object.assign(t.prototype.toJson.call(this),{file:encodeURIComponent(this.mediaFile.getFileName()),volume:this.getVolume()})},e}(r.BaseElement);e.Audio=s},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(135),i=n(14),a=function(t){function e(){var e=t.call(this)||this;return e.roomId="",e.nameIsCustom=!1,e.autoTime=0,e}return o(e,t),e.prototype.setRoomId=function(t){this.roomId=t},e.prototype.getRoomId=function(){return this.roomId},e.prototype.reset=function(){this.roomId="",this.nameIsCustom=!1,t.prototype.setName.call(this,i.DEFAULT_DOOR_NAME)},e.prototype.setCustomName=function(e){t.prototype.setName.call(this,e),this.nameIsCustom=!0},e.prototype.setNameIsCustom=function(t){this.nameIsCustom=t},e.prototype.hasCustomName=function(){return this.nameIsCustom},e.prototype.setAutoTime=function(t){this.autoTime=t},e.prototype.getAutoTime=function(){return this.autoTime},e.prototype.toJson=function(){return Object.assign(t.prototype.toJson.call(this),{file:this.roomId,nameIsCustom:this.nameIsCustom,autoTime:this.autoTime})},e}(r.BaseElement);e.Door=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(135),i=function(t){function e(){return t.call(this)||this}return o(e,t),Object.defineProperty(e.prototype,"body",{get:function(){return this._body},set:function(t){this._body=t},enumerable:!0,configurable:!0}),e.prototype.toJson=function(){return Object.assign(t.prototype.toJson.call(this),{file:this._body})},e}(r.BaseElement);e.Link=i},function(t,e,n){"use strict";function o(){return r}Object.defineProperty(e,"__esModule",{value:!0});var r=new AudioContext;e.getAudioContext=o},function(t,e,n){"use strict";function o(t,e){return console.log("loading media file",t),t.async(g.UINT8ARRAY).then(function(e){console.log("---fileData",t);var n=a(t.name);return new Blob([e],{type:n})}).then(function(n){return console.log("---blob",t),e(n)}).then(function(e){return console.log("success",t.name),{name:t.name,fileData:e}}).catch(function(e){return console.log("error",t.name,e)})}function r(t,e,n){return u(this,void 0,void 0,function(){var r,i,a,s;return l(this,function(c){switch(c.label){case 0:console.log("load media files",t),r=Object.keys(t).filter(function(t){return t!==e}).map(function(e){return t[e]}).filter(function(t){return!t.dir}),console.log("files to load",r),i=[],a=0,c.label=1;case 1:return a<r.length?(s=r[a],[4,o(s,n).then(function(t){return i.push(t)})]):[3,4];case 2:c.sent(),c.label=3;case 3:return a++,[3,1];case 4:return[2,i]}})})}function i(t){var e=this;console.log("jsZipData",t);var n=t.files,o=Object.keys(n).filter(function(t){return t.indexOf(g.STORY_FILE)>-1})[0]||g.STORY_FILE,i=o.substring(0,o.indexOf(g.STORY_FILE)),a=n[o];return console.log("storyFile",a),r(n,o,this.fileLoaderUtil.getBinaryFileData.bind(this.fileLoaderUtil)).then(function(t){return e.deserializeRooms(a,t,i)})}function a(t){var e=t.substring(t.lastIndexOf("."),t.length);return{".mp3":g.MIME_TYPE_MP3,".wav":g.MIME_TYPE_WAV,".aac":g.MIME_TYPE_AAC,".m4a":g.MIME_TYPE_XM4A,".png":g.MIME_TYPE_PNG,".jpg":g.MIME_TYPE_JPG,".jpeg":g.MIME_TYPE_JPEG}[e]||g.MIME_TYPE_PNG}var s=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},c=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)},u=this&&this.__awaiter||function(t,e,n,o){return new(n||(n=Promise))(function(r,i){function a(t){try{c(o.next(t))}catch(t){i(t)}}function s(t){try{c(o.throw(t))}catch(t){i(t)}}function c(t){t.done?r(t.value):new n(function(e){e(t.value)}).then(a,s)}c((o=o.apply(t,e||[])).next())})},l=this&&this.__generator||function(t,e){function n(t){return function(e){return o([t,e])}}function o(n){if(r)throw new TypeError("Generator is already executing.");for(;c;)try{if(r=1,i&&(a=i[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(i,n[1])).done)return a;switch(i=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return c.label++,{value:n[1],done:!1};case 5:c.label++,i=n[1],n=[0];continue;case 7:n=c.ops.pop(),c.trys.pop();continue;default:if(a=c.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){c=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){c.label=n[1];break}if(6===n[0]&&c.label<a[1]){c.label=a[1],a=n;break}if(a&&c.label<a[2]){c.label=a[2],c.ops.push(n);break}a[2]&&c.ops.pop(),c.trys.pop();continue}n=e.call(t,c)}catch(t){n=[6,t],i=0}finally{r=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var r,i,a,s,c={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s};Object.defineProperty(e,"__esModule",{value:!0});var p=n(2),d=n(0),h=n(93),f=n(181),m=n(61);n(381);var g=n(14),v=n(234),y=n(232),_=function(){function t(t,e,n){this.roomManager=t,this.propertyBuilder=e,this.fileLoaderUtil=n,this.zip=new v}return t.prototype.deserializeRooms=function(t,e,n){var o=this;return t.async("string").then(function(t){var r;try{var i=/!\w+\n/g,a=t.replace(/\r\n/g,"\n"),s=a.replace(i,"\n");r=y.load(s)}catch(t){return void console.error(t)}if(o.roomManager.clearRooms(),o.roomManager.setProjectName(r.name),o.roomManager.setProjectTags(r.tags||""),o.roomManager.setProjectDescription(r.description),r.homeRoomId&&o.roomManager.setHomeRoomId(r.homeRoomId),r.soundtrack){var c=e.find(function(t){return t.name===r.soundtrack}),u=c?c.fileData:null;o.roomManager.setSoundtrack(r.soundtrack,r.soundtrackVolume,u)}else o.roomManager.removeSoundtrack();r.rooms.map(function(t){var r=t.uuid;console.log("buildRoom",""+n+r);var i=""+n+r+"/"+t.image,a=e.find(function(t){return t.name===i}),s=a?a.fileData:null,c=""+n+r+"/"+g.BACKGROUND_THUMBNAIL,u=e.find(function(t){return t.name===c}),l=u?u.fileData:null,p=""+n+r+"/"+t.ambient,d=e.find(function(t){return t.name===p}),h=d?d.fileData:null,f=t.narrator?""+n+r+"/"+t.narrator.intro:"",m=e.find(function(t){return t.name===f}),v=m?m.fileData:null,y=t.narrator?""+n+r+"/"+t.narrator.reprise:"",_=e.find(function(t){return t.name===y}),b=_?_.fileData:null,w=o.propertyBuilder.roomFromJson(t,s,l,h),I=t.doors||[],E=t.autoDoors||[],R=I.concat(E);t.texts=t.texts||[],t.clips=t.clips||[],t.images=t.images||[],t.texts.map(function(t){return o.propertyBuilder.textFromJson(t)}).forEach(function(t){return w.addText(t)}),t.clips.map(function(t){var i=""+n+r+"/"+t.file,a=e.find(function(t){return t.name===i}),s=a?a.fileData:null;return o.propertyBuilder.audioFromJson(t,s)}).forEach(function(t){return w.addAudio(t)}),t.images.map(function(t){var i=""+n+r+"/"+t.file,a=e.find(function(t){return t.name===i}),s=a?a.fileData:null;return o.propertyBuilder.imageFromJson(t,s)}).forEach(function(t){return w.addImage(t)}),R.map(function(t){return o.propertyBuilder.doorFromJson(t)}).forEach(function(t){return w.addDoor(t)});var x=o.propertyBuilder.narratorFromJson(t.narrator,v,b);w.setNarrator(x),o.roomManager.addRoom(w)})})},t.prototype.unzipStoryFile=function(t){return d.Observable.fromPromise(this.zip.loadAsync(t).then(i.bind(this)))},t=s([p.Injectable(),c("design:paramtypes",[h.RoomManager,f.PropertyBuilder,m.FileLoaderUtil])],t)}();e.DeserializationService=_},function(t,e,n){"use strict";function o(t){var e=t.changingThisBreaksApplicationSecurity?t.changingThisBreaksApplicationSecurity:t;return e.substring(e.indexOf(",")+1)}var r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),s=n(0),c=n(14),u=n(93),l=n(53),p=n(234),d=n(232),h=function(){function t(t){this.roomManager=t}return t.prototype.buildProjectJson=function(){var t=Array.from(this.roomManager.getRooms()).map(function(t){return t.toJson()});return{name:this.roomManager.getProjectName(),tags:this.roomManager.getProjectTags(),soundtrack:this.roomManager.getSoundtrack().getFileName(),soundtrackVolume:this.roomManager.getSoundtrackVolume(),description:this.roomManager.getProjectDescription(),homeRoomId:this.roomManager.getHomeRoomId(),rooms:t}},t.prototype.buildAssetDirectories=function(t){return Array.from(this.roomManager.getRooms()).forEach(function(e){var n=e.getId(),r=e.getFileName()!==c.DEFAULT_FILE_NAME,i=Array.from(e.getImages()).filter(function(t){return t.getBinaryFileData()}).map(function(t){return{name:encodeURIComponent(t.getFileName()),binaryData:o(t.getBinaryFileData())}}),a=Array.from(e.getAudio()).filter(function(t){return t.getBinaryFileData()}).map(function(t){return{name:encodeURIComponent(t.getFileName()),binaryData:o(t.getBinaryFileData())}});i.concat(a).forEach(function(e){t.folder(n).file(e.name,e.binaryData,{base64:!0})});var s=e.getNarrator().getIntroAudio(),u=e.getNarrator().getReturnAudio();if(s.hasAsset()){var l=encodeURIComponent(s.getFileName()),p=o(s.getBinaryFileData());t.folder(n).file(l,p,{base64:!0})}if(u.hasAsset()){var l=encodeURIComponent(u.getFileName()),p=o(u.getBinaryFileData());t.folder(n).file(l,p,{base64:!0})}if(r){var d=encodeURIComponent(e.getFileName()),h=o(e.getBinaryFileData());t.folder(n).file(d,h,{base64:!0})}if(e.getThumbnailImage()){var d=encodeURIComponent(e.getFileName()),f=o(e.getThumbnailImage());t.folder(n).file(c.BACKGROUND_THUMBNAIL,f,{base64:!0})}if(e.getBackgroundAudio().hasAsset()){var l=encodeURIComponent(e.getBackgroundAudio().getFileName()),m=o(e.getBackgroundAudio().getBinaryFileData());t.folder(n).file(l,m,{base64:!0})}}),t},t.prototype.buildZipStoryFile=function(){var t=this.buildProjectJson(),e=d.dump(t),n=new Blob([e],{type:c.MIME_TYPE_UTF8}),o=this.buildAssetDirectories(new p);return o.file(c.STORY_FILE,n),o},t.prototype.getHomeRoomImage=function(){var t=this.roomManager.getHomeRoomId(),e=this.roomManager.getRoomById(t);if(e.getThumbnailImage())return Promise.resolve(o(e.getThumbnailImage()));var n=this.roomManager.getRoomById(t).getBinaryFileData();return l.resizeImage(n,"projectThumbnail").then(function(t){return o(t)})},t.prototype.getProjectSoundtrack=function(){var t=this;return new Promise(function(e,n){t.roomManager.getSoundtrack().hasAsset()?e(t.roomManager.getSoundtrack()):n("no Soundtrack")})},t.prototype.zipStoryFile=function(){var t=this.buildZipStoryFile(),e=Promise.all([this.getHomeRoomImage().then(function(e){return t.file("thumbnail.jpg",e,{base64:!0})}),this.getProjectSoundtrack().then(function(e){return t.file(e.getFileName(),o(e.getBinaryFileData()),{base64:!0})}).catch(function(t){return console.log(t)})]).then(function(e){return t.generateAsync({type:"blob"})});return s.Observable.fromPromise(e)},t=r([a.Injectable(),i("design:paramtypes",[u.RoomManager])],t)}();e.SerializationService=h},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(94),s=function(){function t(t){this.apiService=t}return t.prototype.uploadVideo=function(t){return this.apiService.uploadVideo(t)},t=o([i.Injectable(),r("design:paramtypes",[a.ApiService])],t)}();e.VideoInteractor=s},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(515),s=function(){function t(t){this.cameraService=t}return t.prototype.getCameraDirection=function(){return this.cameraService.getCameraDirection()},t.prototype.setCameraDirection=function(t,e,n){this.cameraService.setCameraDirection(t,e,n)},t=o([i.Injectable(),r("design:paramtypes",[a.CameraService])],t)}();e.CameraInteractor=s},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(519),s=n(185),c=function(){function t(t,e){this.chatService=t,this.userService=e}return t.prototype.createRoom=function(t,e,n){return this.chatService.createRoom(t,e,n)},t.prototype.getRooms=function(){return this.chatService.getRooms()},t.prototype.joinRoom=function(t){var e=this.userService.getUserId(),n=this.userService.getUserName();return this.chatService.joinRoom(t,e,n)},t.prototype.observeRoom=function(t){return this.chatService.observeRoom(t)},t.prototype.setLookAt=function(t,e,n,o){var r=this.userService.getUserId();return this.chatService.setLookAt(t,r,e,n,o)},t=o([i.Injectable(),r("design:paramtypes",[a.ChatService,s.UserService])],t)}();e.ChatInteractor=c},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(76),s=n(271),c=function(){function t(t){this.assetInteractor=t;var e=s.getAudioContext();this.gainNode=e.createGain(),this.gainNode.gain.value=2,this.gainNode.connect(e.destination)}return t.prototype.playSoundtrack=function(t){var e=this.getAudioSource(t);e&&(e.loop=!0,e.start(0),this.soundtrack=e)},t.prototype.playBgAudio=function(t){this.stopPlaying(this.background);var e=this.getAudioSource(t);e&&(e.start(0),this.background=e)},t.prototype.playHotspotAudio=function(t){this.stopPlaying(this.hotspot);var e=this.getAudioSource(t);e&&(e.start(0),this.hotspot=e)},t.prototype.stopPlaying=function(t){t&&t.stop()},t.prototype.stopAll=function(){this.stopPlaying(this.soundtrack),this.stopPlaying(this.background),this.stopPlaying(this.hotspot)},t.prototype.attemptStopSample=function(t){if(t)return void 0===t.playbackState?void t.stop():1===t.playbackState||2===t.playbackState?void t.stop():void 0},t.prototype.getAudioSource=function(t){var e=this.assetInteractor.getAudioBufferById(t);if(!e)return void console.log("audioPlayService.playSample error","audio buffer not found for audio ID: "+t);var n=s.getAudioContext().createBufferSource();return n.buffer=e,n.connect(this.gainNode),n},t=o([i.Injectable(),r("design:paramtypes",[a.AssetInteractor])],t)}();e.AudioPlayService=c},function(t,e,n){"use strict";(function(t){var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(76),s=n(92),c=n(14),u=n(279),l=function(){function e(e){this.assetInteractor=e,this.reticleRaycast=new t.Raycaster,this.reitlceRay=new t.Vector2}return e.prototype.exists=function(){
//!! cast the existence of this.menu as a boolean
return!!this.menu},e.prototype.load=function(e,n,o,r){this.goToBackRoom=o,this.goToHomeRoom=r,this.hButState=0,this.bButState=0,this.menu=new t.Group;var i=s.pol2car(c.THREE_CONST.CAMERA_NAVPANEL,c.THREE_CONST.NAVPANEL_THETA,c.THREE_CONST.NAVPANEL_PHI);this.menu.position.set(i.x,i.y,i.z),this.menu.name="menu";var a=new t.PlaneGeometry(c.THREE_CONST.NAVPANEL_W,c.THREE_CONST.NAVPANEL_H),u=new t.MeshBasicMaterial({opacity:c.THREE_CONST.NAVPANEL_OPACITY,transparent:!0,side:t.FrontSide}),l=new t.Mesh(a,u);l.position.set(i.x,i.y,i.z),this.panelMesh=l;var p=new t.PlaneGeometry(c.THREE_CONST.HOME_BACK_DIM,c.THREE_CONST.HOME_BACK_DIM),d=this.assetInteractor.getTextureById("back"),h=new t.MeshBasicMaterial({map:d,transparent:!0,side:t.DoubleSide}),f=new t.Mesh(p,h);f.position.set(i.x-40,i.y-30,i.z-100),f.name="backButtonIcon",f.frustumCulled=!1,this.backButtonMesh=f;var m=new t.PlaneGeometry(c.THREE_CONST.HOME_BACK_DIM,c.THREE_CONST.HOME_BACK_DIM),g=(this.assetInteractor.getTextureById("back"),new t.MeshBasicMaterial({map:d,transparent:!0,side:t.FrontSide})),v=new t.Mesh(m,g);v.position.set(i.x-40,i.y-30,i.z-98),v.name="backButton",v.material.opacity=0,this.backButtonMeshG=v;var y=new t.PlaneGeometry(c.THREE_CONST.HOME_BACK_DIM,c.THREE_CONST.HOME_BACK_DIM),_=this.assetInteractor.getTextureById("home"),b=new t.MeshBasicMaterial({map:_,transparent:!0,side:t.FrontSide}),w=new t.Mesh(y,b);w.position.set(i.x+40,i.y-30,i.z-100),w.name="homeButtonIcon",this.homeButtonMesh=w;var I=new t.PlaneGeometry(c.THREE_CONST.HOME_BACK_DIM,c.THREE_CONST.HOME_BACK_DIM),E=(this.assetInteractor.getTextureById("home"),new t.MeshBasicMaterial({map:_,transparent:!0,side:t.FrontSide})),R=new t.Mesh(I,E);R.position.set(i.x+40,i.y-30,i.z-98),R.name="homeButton",R.material.opacity=0,this.homeButtonMeshG=R,this.menu.add(w),this.menu.add(R),this.menu.add(f),this.menu.add(v),this.menu.add(l),this.menu.lookAt(n),e.add(this.menu),this.menu.updateMatrixWorld(!0),this.backButtonMesh.getWorldPosition(),this.backButtonMeshG.getWorldPosition(),this.homeButtonMesh.getWorldPosition(),this.homeButtonMeshG.getWorldPosition(),this.panelMesh.getWorldPosition()},e.prototype.update=function(t,e){var n=this;this.reticleRaycast.setFromCamera(this.reitlceRay,e);var o=this.reticleRaycast.intersectObjects(this.menu.children);o.length<=1?(this.bButState=0,this.hButState=0,this.resetTweens()):o.forEach(function(t){switch(t.object.name){case"backButton":0==n.bButState&&(n.bButState=1,n.triggerBackRoom());break;case"homeButton":0==n.hButState&&(n.hButState=1,n.triggerHomeRoom())}})},e.prototype.triggerBackRoom=function(){var t=this;this.tweenBackActivate=new u.Tween(this.backButtonMesh.scale).to({x:.001,y:.001,z:.001},c.THREE_CONST.HOTSPOT_DOOR_DELAY).easing(u.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){u.remove(t.tweenBackActivate),t.goToBackRoom()}).start()},e.prototype.triggerHomeRoom=function(){var t=this;this.tweenHomeActivate=new u.Tween(this.homeButtonMesh.scale).to({x:.001,y:.001,z:.001},c.THREE_CONST.HOTSPOT_DOOR_DELAY).easing(u.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){u.remove(t.tweenHomeActivate),t.goToHomeRoom()}).start()},e.prototype.resetTweens=function(){this.tweenBackActivate&&this.tweenBackActivate.stop(),this.backButtonMesh.scale.set(1,1,1),this.tweenHomeActivate&&this.tweenHomeActivate.stop(),this.homeButtonMesh.scale.set(1,1,1)},e.prototype.getMeshList=function(){return[this.backButtonMesh,this.homeButtonMesh]},e.prototype.getBackButton=function(){return this.backButtonMesh},e.prototype.getHomeButton=function(){return this.homeButtonMesh},e.prototype.destroy=function(){this.menu=null},e=o([i.Injectable(),r("design:paramtypes",[a.AssetInteractor])],e)}();e.MenuManager=l}).call(e,n(24))},function(t,e,n){(function(n){var o,r,i=function(){this._tweens={},this._tweensAddedDuringUpdate={}};i.prototype={getAll:function(){return Object.keys(this._tweens).map(function(t){return this._tweens[t]}.bind(this))},removeAll:function(){this._tweens={}},add:function(t){this._tweens[t.getId()]=t,this._tweensAddedDuringUpdate[t.getId()]=t},remove:function(t){delete this._tweens[t.getId()],delete this._tweensAddedDuringUpdate[t.getId()]},update:function(t,e){var n=Object.keys(this._tweens);if(0===n.length)return!1;for(t=void 0!==t?t:a.now();n.length>0;){this._tweensAddedDuringUpdate={};for(var o=0;o<n.length;o++){var r=this._tweens[n[o]];r&&!1===r.update(t)&&(r._isPlaying=!1,e||delete this._tweens[n[o]])}n=Object.keys(this._tweensAddedDuringUpdate)}return!0}};var a=new i;a.Group=i,a._nextId=0,a.nextId=function(){return a._nextId++},"undefined"==typeof window&&void 0!==n?a.now=function(){var t=n.hrtime();return 1e3*t[0]+t[1]/1e6}:"undefined"!=typeof window&&void 0!==window.performance&&void 0!==window.performance.now?a.now=window.performance.now.bind(window.performance):void 0!==Date.now?a.now=Date.now:a.now=function(){return(new Date).getTime()},a.Tween=function(t,e){this._object=t,this._valuesStart={},this._valuesEnd={},this._valuesStartRepeat={},this._duration=1e3,this._repeat=0,this._repeatDelayTime=void 0,this._yoyo=!1,this._isPlaying=!1,this._reversed=!1,this._delayTime=0,this._startTime=null,this._easingFunction=a.Easing.Linear.None,this._interpolationFunction=a.Interpolation.Linear,this._chainedTweens=[],this._onStartCallback=null,this._onStartCallbackFired=!1,this._onUpdateCallback=null,this._onCompleteCallback=null,this._onStopCallback=null,this._group=e||a,this._id=a.nextId()},a.Tween.prototype={getId:function(){return this._id},isPlaying:function(){return this._isPlaying},to:function(t,e){return this._valuesEnd=t,void 0!==e&&(this._duration=e),this},start:function(t){this._group.add(this),this._isPlaying=!0,this._onStartCallbackFired=!1,this._startTime=void 0!==t?"string"==typeof t?a.now()+parseFloat(t):t:a.now(),this._startTime+=this._delayTime;for(var e in this._valuesEnd){if(this._valuesEnd[e]instanceof Array){if(0===this._valuesEnd[e].length)continue;this._valuesEnd[e]=[this._object[e]].concat(this._valuesEnd[e])}void 0!==this._object[e]&&(this._valuesStart[e]=this._object[e],this._valuesStart[e]instanceof Array==!1&&(this._valuesStart[e]*=1),this._valuesStartRepeat[e]=this._valuesStart[e]||0)}return this},stop:function(){return this._isPlaying?(this._group.remove(this),this._isPlaying=!1,null!==this._onStopCallback&&this._onStopCallback(this._object),this.stopChainedTweens(),this):this},end:function(){return this.update(this._startTime+this._duration),this},stopChainedTweens:function(){for(var t=0,e=this._chainedTweens.length;t<e;t++)this._chainedTweens[t].stop()},delay:function(t){return this._delayTime=t,this},repeat:function(t){return this._repeat=t,this},repeatDelay:function(t){return this._repeatDelayTime=t,this},yoyo:function(t){return this._yoyo=t,this},easing:function(t){return this._easingFunction=t,this},interpolation:function(t){return this._interpolationFunction=t,this},chain:function(){return this._chainedTweens=arguments,this},onStart:function(t){return this._onStartCallback=t,this},onUpdate:function(t){return this._onUpdateCallback=t,this},onComplete:function(t){return this._onCompleteCallback=t,this},onStop:function(t){return this._onStopCallback=t,this},update:function(t){var e,n,o;if(t<this._startTime)return!0;!1===this._onStartCallbackFired&&(null!==this._onStartCallback&&this._onStartCallback(this._object),this._onStartCallbackFired=!0),n=(t-this._startTime)/this._duration,n=n>1?1:n,o=this._easingFunction(n);for(e in this._valuesEnd)if(void 0!==this._valuesStart[e]){var r=this._valuesStart[e]||0,i=this._valuesEnd[e];i instanceof Array?this._object[e]=this._interpolationFunction(i,o):("string"==typeof i&&(i="+"===i.charAt(0)||"-"===i.charAt(0)?r+parseFloat(i):parseFloat(i)),"number"==typeof i&&(this._object[e]=r+(i-r)*o))}if(null!==this._onUpdateCallback&&this._onUpdateCallback(this._object),1===n){if(this._repeat>0){isFinite(this._repeat)&&this._repeat--;for(e in this._valuesStartRepeat){if("string"==typeof this._valuesEnd[e]&&(this._valuesStartRepeat[e]=this._valuesStartRepeat[e]+parseFloat(this._valuesEnd[e])),this._yoyo){var a=this._valuesStartRepeat[e];this._valuesStartRepeat[e]=this._valuesEnd[e],this._valuesEnd[e]=a}this._valuesStart[e]=this._valuesStartRepeat[e]}return this._yoyo&&(this._reversed=!this._reversed),void 0!==this._repeatDelayTime?this._startTime=t+this._repeatDelayTime:this._startTime=t+this._delayTime,!0}null!==this._onCompleteCallback&&this._onCompleteCallback(this._object);for(var s=0,c=this._chainedTweens.length;s<c;s++)this._chainedTweens[s].start(this._startTime+this._duration);return!1}return!0}},a.Easing={Linear:{None:function(t){return t}},Quadratic:{In:function(t){return t*t},Out:function(t){return t*(2-t)},InOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)}},Cubic:{In:function(t){return t*t*t},Out:function(t){return--t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)}},Quartic:{In:function(t){return t*t*t*t},Out:function(t){return 1- --t*t*t*t},InOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)}},Quintic:{In:function(t){return t*t*t*t*t},Out:function(t){return--t*t*t*t*t+1},InOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)}},Sinusoidal:{In:function(t){return 1-Math.cos(t*Math.PI/2)},Out:function(t){return Math.sin(t*Math.PI/2)},InOut:function(t){return.5*(1-Math.cos(Math.PI*t))}},Exponential:{In:function(t){return 0===t?0:Math.pow(1024,t-1)},Out:function(t){return 1===t?1:1-Math.pow(2,-10*t)},InOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))}},Circular:{In:function(t){return 1-Math.sqrt(1-t*t)},Out:function(t){return Math.sqrt(1- --t*t)},InOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)}},Elastic:{In:function(t){return 0===t?0:1===t?1:-Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)},Out:function(t){return 0===t?0:1===t?1:Math.pow(2,-10*t)*Math.sin(5*(t-.1)*Math.PI)+1},InOut:function(t){return 0===t?0:1===t?1:(t*=2,t<1?-.5*Math.pow(2,10*(t-1))*Math.sin(5*(t-1.1)*Math.PI):.5*Math.pow(2,-10*(t-1))*Math.sin(5*(t-1.1)*Math.PI)+1)}},Back:{In:function(t){var e=1.70158;return t*t*((e+1)*t-e)},Out:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},InOut:function(t){var e=2.5949095;return(t*=2)<1?t*t*((e+1)*t-e)*.5:.5*((t-=2)*t*((e+1)*t+e)+2)}},Bounce:{In:function(t){return 1-a.Easing.Bounce.Out(1-t)},Out:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},InOut:function(t){return t<.5?.5*a.Easing.Bounce.In(2*t):.5*a.Easing.Bounce.Out(2*t-1)+.5}}},a.Interpolation={Linear:function(t,e){var n=t.length-1,o=n*e,r=Math.floor(o),i=a.Interpolation.Utils.Linear;return e<0?i(t[0],t[1],o):e>1?i(t[n],t[n-1],n-o):i(t[r],t[r+1>n?n:r+1],o-r)},Bezier:function(t,e){for(var n=0,o=t.length-1,r=Math.pow,i=a.Interpolation.Utils.Bernstein,s=0;s<=o;s++)n+=r(1-e,o-s)*r(e,s)*t[s]*i(o,s);return n},CatmullRom:function(t,e){var n=t.length-1,o=n*e,r=Math.floor(o),i=a.Interpolation.Utils.CatmullRom;return t[0]===t[n]?(e<0&&(r=Math.floor(o=n*(1+e))),i(t[(r-1+n)%n],t[r],t[(r+1)%n],t[(r+2)%n],o-r)):e<0?t[0]-(i(t[0],t[0],t[1],t[1],-o)-t[0]):e>1?t[n]-(i(t[n],t[n],t[n-1],t[n-1],o-n)-t[n]):i(t[r?r-1:0],t[r],t[n<r+1?n:r+1],t[n<r+2?n:r+2],o-r)},Utils:{Linear:function(t,e,n){return(e-t)*n+t},Bernstein:function(t,e){var n=a.Interpolation.Utils.Factorial;return n(t)/n(e)/n(t-e)},Factorial:function(){var t=[1];return function(e){var n=1;if(t[e])return t[e];for(var o=e;o>1;o--)n*=o;return t[e]=n,n}}(),CatmullRom:function(t,e,n,o,r){var i=.5*(n-t),a=.5*(o-e),s=r*r;return(2*e-2*n+i+a)*(r*s)+(-3*e+3*n-2*i-a)*s+i*r+e}}},function(n){o=[],void 0!==(r=function(){return a}.apply(e,o))&&(t.exports=r)}()}).call(e,n(124))},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(94),s=function(){function t(t){this.apiService=t}return t.prototype.searchPublicProjects=function(t){return this.apiService.searchPublicProjects(t)},t=o([i.Injectable(),r("design:paramtypes",[a.ApiService])],t)}();e.SearchInteractor=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){n(1094),t.exports=n(74).default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(253);e.assert=function(t,n){if(!t)throw e.assertionError(n)},e.assertionError=function(t){return new Error("Firebase Database ("+o.CONSTANTS.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(t){for(var e=[],n=0,o=0;o<t.length;o++){for(var r=t.charCodeAt(o);r>255;)e[n++]=255&r,r>>=8;e[n++]=r}return e},r=function(t){if(t.length<8192)return String.fromCharCode.apply(null,t);for(var e="",n=0;n<t.length;n+=8192){var o=t.slice(n,n+8192);e+=String.fromCharCode.apply(null,o)}return e};e.base64={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"==typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,o=[],r=0;r<t.length;r+=3){var i=t[r],a=r+1<t.length,s=a?t[r+1]:0,c=r+2<t.length,u=c?t[r+2]:0,l=i>>2,p=(3&i)<<4|s>>4,d=(15&s)<<2|u>>6,h=63&u;c||(h=64,a||(d=64)),o.push(n[l],n[p],n[d],n[h])}return o.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(o(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):r(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,o=[],r=0;r<t.length;){var i=n[t.charAt(r++)],a=r<t.length,s=a?n[t.charAt(r)]:0;++r;var c=r<t.length,u=c?n[t.charAt(r)]:64;++r;var l=r<t.length,p=l?n[t.charAt(r)]:64;if(++r,null==i||null==s||null==u||null==p)throw Error();var d=i<<2|s>>4;if(o.push(d),64!=u){var h=s<<4&240|u>>2;if(o.push(h),64!=p){var f=u<<6&192|p;o.push(f)}}}return o},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},e.base64Encode=function(t){var n=o(t);return e.base64.encodeByteArray(n,!0)},e.base64Decode=function(t){try{return e.base64.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null}},function(t,e,n){"use strict";function o(t){return JSON.parse(t)}function r(t){return JSON.stringify(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.jsonEval=o,e.stringify=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.contains=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.safeGet=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},e.forEach=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},e.extend=function(t,n){return e.forEach(n,function(e,n){t[e]=n}),t},e.clone=function(t){return e.extend({},t)},e.isNonNullObject=function(t){return"object"==typeof t&&null!==t},e.isEmpty=function(t){for(var e in t)return!1;return!0},e.getCount=function(t){var e=0;for(var n in t)e++;return e},e.map=function(t,e,n){var o={};for(var r in t)o[r]=e.call(n,t[r],r,t);return o},e.findKey=function(t,e,n){for(var o in t)if(e.call(n,t[o],o,t))return o},e.findValue=function(t,n,o){var r=e.findKey(t,n,o);return r&&t[r]},e.getAnyKey=function(t){for(var e in t)return e},e.getValues=function(t){var e=[],n=0;for(var o in t)e[n++]=t[o];return e},e.every=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0}},function(t,e,n){n(1111)},function(t,e,n){t.exports=n(1112)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=n(476),i=n(22),a=n(254),s=n(175),c=n(258),u=n(3),l=n(89),p=function(){function t(t){this.repo_=t,t instanceof s.Repo||o.fatal("Don't call new Database() directly - please use firebase.database()."),this.root_=new a.Reference(t,i.Path.Empty),this.INTERNAL=new d(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),u.validateArgCount("database.ref",0,1,arguments.length),void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),u.validateArgCount(e,1,1,arguments.length);var n=r.parseRepoInfo(t);l.validateUrl(e,1,n);var i=n.repoInfo;return i.host!==this.repo_.repoInfo_.host&&o.fatal(e+": Host name does not match the current database: (found "+i.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&o.fatal("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){u.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){u.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}();e.Database=p;var d=function(){function t(t){this.database=t}return t.prototype.delete=function(){return this.database.checkDeleted_("delete"),c.RepoManager.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,Promise.resolve()},t}();e.DatabaseInternals=d},function(t,e,n){"use strict";function o(t){for(var e="",n=t.split("/"),o=0;o<n.length;o++)if(n[o].length>0){var r=n[o];try{r=decodeURIComponent(r.replace(/\+/g," "))}catch(t){}e+="/"+r}return e}Object.defineProperty(e,"__esModule",{value:!0});var r=n(22),i=n(477),a=n(9);e.parseRepoInfo=function(t){var n=e.parseURL(t),o=n.subdomain;"firebase"===n.domain&&a.fatal(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),o&&"undefined"!=o||a.fatal("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||a.warnIfPageIsSecure();var s="ws"===n.scheme||"wss"===n.scheme;return{repoInfo:new i.RepoInfo(n.host,n.secure,o,s),path:new r.Path(n.pathString)}},e.parseURL=function(t){var e="",n="",r="",i="",a=!0,s="https",c=443;if("string"==typeof t){var u=t.indexOf("//");u>=0&&(s=t.substring(0,u-1),t=t.substring(u+2));var l=t.indexOf("/");-1===l&&(l=t.length),e=t.substring(0,l),i=o(t.substring(l));var p=e.split(".");3===p.length?(n=p[1],r=p[0].toLowerCase()):2===p.length&&(n=p[0]),u=e.indexOf(":"),u>=0&&(a="https"===s||"wss"===s,c=parseInt(e.substring(u+1),10))}return{host:e,port:c,domain:n,subdomain:r,secure:a,scheme:s,pathString:i}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(3),i=n(170),a=n(171),s=function(){function t(t,e,n,o,r){void 0===r&&(r=""),this.secure=e,this.namespace=n,this.webSocketOnly=o,this.persistenceKey=r,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=i.PersistentStorage.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&i.PersistentStorage.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){o.assert("string"==typeof t,"typeof type must == string"),o.assert("object"==typeof e,"typeof params must == object");var n;if(t===a.WEBSOCKET)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==a.LONG_POLLING)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var i=[];return r.forEach(e,function(t,e){i.push(t+"="+e)}),n+i.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}();e.RepoInfo=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(3),i=n(130),a=n(33),s=n(480),c=n(484),u=n(9),l=n(22),p=n(89),d=n(3),h=n(1118),f=n(3),m=function(){function t(t,e,n,o){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=o}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return r.assert(o,"Reference.ts has not been loaded"),o},set:function(t){o=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===i.KEY_INDEX){var o="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",l="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=u.MIN_NAME)throw new Error(o);if("string"!=typeof e)throw new Error(l)}if(t.hasEnd()){if(t.getIndexEndName()!=u.MAX_NAME)throw new Error(o);if("string"!=typeof n)throw new Error(l)}}else if(t.getIndex()===a.PRIORITY_INDEX){if(null!=e&&!p.isValidPriority(e)||null!=n&&!p.isValidPriority(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(r.assert(t.getIndex()instanceof c.PathIndex||t.getIndex()===s.VALUE_INDEX,"unknown index type."),null!=e&&"object"==typeof e||null!=n&&"object"==typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return d.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,o,r){d.validateArgCount("Query.on",2,4,arguments.length),p.validateEventType("Query.on",1,e,!1),d.validateCallback("Query.on",2,n,!1);var i=t.getCancelAndContextArgs_("Query.on",o,r);if("value"===e)this.onValueEvent(n,i.cancel,i.context);else{var a={};a[e]=n,this.onChildEvent(a,i.cancel,i.context)}return n},t.prototype.onValueEvent=function(t,e,n){var o=new h.ValueEventRegistration(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,o)},t.prototype.onChildEvent=function(t,e,n){var o=new h.ChildEventRegistration(t,e,n);this.repo.addEventCallbackForQuery(this,o)},t.prototype.off=function(t,e,n){d.validateArgCount("Query.off",0,3,arguments.length),p.validateEventType("Query.off",1,t,!0),d.validateCallback("Query.off",2,e,!0),d.validateContextObject("Query.off",3,n,!0);var o=null,r=null;if("value"===t){var i=e||null;o=new h.ValueEventRegistration(i,null,n||null)}else t&&(e&&(r={},r[t]=e),o=new h.ChildEventRegistration(r,null,n||null));this.repo.removeEventCallbackForQuery(this,o)},t.prototype.once=function(e,n,o,r){var i=this;d.validateArgCount("Query.once",1,4,arguments.length),p.validateEventType("Query.once",1,e,!1),d.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",o,r),s=!0,c=new f.Deferred;c.promise.catch(function(){});var u=function(t){s&&(s=!1,i.off(e,u),n&&n.bind(a.context)(t),c.resolve(t))};return this.on(e,u,function(t){i.off(e,u),a.cancel&&a.cancel.bind(a.context)(t),c.reject(t)}),c.promise},t.prototype.limitToFirst=function(e){if(d.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(d.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!=typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(d.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');p.validatePathString("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new l.Path(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var o=new c.PathIndex(n),r=this.queryParams_.orderBy(o);return t.validateQueryEndpoints_(r),new t(this.repo,this.path,r,!0)},t.prototype.orderByKey=function(){d.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(i.KEY_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){d.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(a.PRIORITY_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){d.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(s.VALUE_INDEX);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),d.validateArgCount("Query.startAt",0,2,arguments.length),p.validateFirebaseDataArg("Query.startAt",1,e,this.path,!0),p.validateKey("Query.startAt",2,n,!0);var o=this.queryParams_.startAt(e,n);if(t.validateLimit_(o),t.validateQueryEndpoints_(o),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,o,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),d.validateArgCount("Query.endAt",0,2,arguments.length),p.validateFirebaseDataArg("Query.endAt",1,e,this.path,!0),p.validateKey("Query.endAt",2,n,!0);var o=this.queryParams_.endAt(e,n);if(t.validateLimit_(o),t.validateQueryEndpoints_(o),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,o,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(d.validateArgCount("Query.equalTo",1,2,arguments.length),p.validateFirebaseDataArg("Query.equalTo",1,t,this.path,!1),p.validateKey("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return d.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return d.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=u.ObjectToUniqueKey(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(d.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var n=this.repo===e.repo,o=this.path.equals(e.path),r=this.queryIdentifier()===e.queryIdentifier();return n&&o&&r},t.getCancelAndContextArgs_=function(t,e,n){var o={cancel:null,context:null};if(e&&n)o.cancel=e,d.validateCallback(t,3,o.cancel,!0),o.context=n,d.validateContextObject(t,4,o.context,!0);else if(e)if("object"==typeof e&&null!==e)o.context=e;else{if("function"!=typeof e)throw new Error(d.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");o.cancel=e}return o},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}();e.Query=m},function(t,e,n){"use strict";function o(t){r=t}Object.defineProperty(e,"__esModule",{value:!0});var r,i=n(3),a=n(9),s=n(3);e.setMaxNode=o,e.priorityHashText=function(t){return"number"==typeof t?"number:"+a.doubleToIEEE754String(t):"string:"+t},e.validatePriorityNode=function(t){if(t.isLeafNode()){var e=t.val();i.assert("string"==typeof e||"number"==typeof e||"object"==typeof e&&s.contains(e,".sv"),"Priority must be a string or number.")}else i.assert(t===r||t.isEmpty(),"priority of unexpected type.");i.assert(t===r||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(172),i=n(45),a=n(9),s=n(131),c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?a.nameCompare(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return i.NamedNode.MIN},e.prototype.maxPost=function(){return i.NamedNode.MAX},e.prototype.makePost=function(t,e){var n=s.nodeFromJSON(t);return new i.NamedNode(e,n)},e.prototype.toString=function(){return".value"},e}(r.Index);e.ValueIndex=c,e.VALUE_INDEX=new c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(3),i=n(482),a=n(3),s=n(45),c=n(33),u=n(130),l={},p=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return r.assert(l&&c.PRIORITY_INDEX,"ChildrenNode.ts has not been loaded"),o=o||new t({".priority":l},{".priority":c.PRIORITY_INDEX})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=a.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===l?null:e},t.prototype.hasIndex=function(t){return a.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){r.assert(e!==u.KEY_INDEX,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var o=[],c=!1,p=n.getIterator(s.NamedNode.Wrap),d=p.getNext();d;)c=c||e.isDefinedOn(d.node),o.push(d),d=p.getNext();var h;h=c?i.buildChildSet(o,e.getCompare()):l;var f=e.toString(),m=a.clone(this.indexSet_);m[f]=e;var g=a.clone(this.indexes_);return g[f]=h,new t(g,m)},t.prototype.addToIndexes=function(e,n){var o=this;return new t(a.map(this.indexes_,function(t,c){var u=a.safeGet(o.indexSet_,c);if(r.assert(u,"Missing index implementation for "+c),t===l){if(u.isDefinedOn(e.node)){for(var p=[],d=n.getIterator(s.NamedNode.Wrap),h=d.getNext();h;)h.name!=e.name&&p.push(h),h=d.getNext();return p.push(e),i.buildChildSet(p,u.getCompare())}return l}var f=n.get(e.name),m=t;return f&&(m=m.remove(new s.NamedNode(e.name,f))),m.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(a.map(this.indexes_,function(t){if(t===l)return t;var o=n.get(e.name);return o?t.remove(new s.NamedNode(e.name,o)):t}),this.indexSet_)},t}();e.IndexMap=p},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(174),r=n(174),i=Math.log(2),a=function(){function t(t){this.count=function(t){return parseInt(Math.log(t)/i,10)}(t+1),this.current_=this.count-1;var e=function(t){return parseInt(Array(t+1).join("1"),2)}(this.count);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}();e.buildChildSet=function(t,e,n,i){t.sort(e);var s=function(e,r){var i,a,c=r-e;if(0==c)return null;if(1==c)return i=t[e],a=n?n(i):i,new o.LLRBNode(a,i.node,o.LLRBNode.BLACK,null,null);var u=parseInt(c/2,10)+e,l=s(e,u),p=s(u+1,r);return i=t[u],a=n?n(i):i,new o.LLRBNode(a,i.node,o.LLRBNode.BLACK,l,p)},c=new a(t.length),u=function(e){for(var r=null,i=null,a=t.length,c=function(e,r){var i=a-e,c=a;a-=e;var l=s(i+1,c),p=t[i],d=n?n(p):p;u(new o.LLRBNode(d,p.node,r,null,l))},u=function(t){r?(r.left=t,r=t):(i=t,r=t)},l=0;l<e.count;++l){var p=e.nextBitIsOne(),d=Math.pow(2,e.count-(l+1));p?c(d,o.LLRBNode.BLACK):(c(d,o.LLRBNode.BLACK),c(d,o.LLRBNode.RED))}return i}(c);return new r.SortedMap(i||e,u)}},function(t,e,n){"use strict";function o(t,e){return i.nameCompare(t.name,e.name)}function r(t,e){return i.nameCompare(t,e)}Object.defineProperty(e,"__esModule",{value:!0});var i=n(9);e.NAME_ONLY_COMPARATOR=o,e.NAME_COMPARATOR=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(9),a=n(172),s=n(36),c=n(45),u=n(131),l=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,r.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return o(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),o=this.extractChild(e.node),r=n.compareTo(o);return 0===r?i.nameCompare(t.name,e.name):r},e.prototype.makePost=function(t,e){var n=u.nodeFromJSON(t),o=s.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,n);return new c.NamedNode(e,o)},e.prototype.maxPost=function(){var t=s.ChildrenNode.EMPTY_NODE.updateChild(this.indexPath_,s.MAX_NODE);return new c.NamedNode(i.MAX_NAME,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(a.Index);e.PathIndex=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(89),i=n(22),a=n(33),s=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return o.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return o.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return o.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return o.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){o.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),r.validatePathString("DataSnapshot.child",1,e,!1);var n=new i.Path(e),s=this.ref_.child(n);return new t(this.node_.getChild(n),s,a.PRIORITY_INDEX)},t.prototype.hasChild=function(t){o.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),r.validatePathString("DataSnapshot.hasChild",1,t,!1);var e=new i.Path(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return o.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;return o.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),o.validateCallback("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(o,r){return e(new t(r,n.ref_.child(o),a.PRIORITY_INDEX))})},t.prototype.hasChildren=function(){return o.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return o.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return o.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}();e.DataSnapshot=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(22),i=n(487),a=n(173),s=n(131),c=n(33);e.generateWithValues=function(t){return t=t||{},t.timestamp=t.timestamp||(new Date).getTime(),t},e.resolveDeferredValue=function(t,e){return t&&"object"==typeof t?(o.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},e.resolveDeferredValueTree=function(t,n){var o=new i.SparseSnapshotTree;return t.forEachTree(new r.Path(""),function(t,r){o.remember(t,e.resolveDeferredValueSnapshot(r,n))}),o},e.resolveDeferredValueSnapshot=function(t,n){var o,r=t.getPriority().val(),i=e.resolveDeferredValue(r,n);if(t.isLeafNode()){var u=t,l=e.resolveDeferredValue(u.getValue(),n);return l!==u.getValue()||i!==u.getPriority().val()?new a.LeafNode(l,s.nodeFromJSON(i)):t}var p=t;return o=p,i!==p.getPriority().val()&&(o=o.updatePriority(new a.LeafNode(i))),p.forEachChild(c.PRIORITY_INDEX,function(t,r){var i=e.resolveDeferredValueSnapshot(r,n);i!==r&&(o=o.updateImmediateChild(t,i))}),o}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(22),r=n(33),i=n(488),a=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();if(t=t.popFront(),this.children_.contains(e)){return this.children_.get(e).find(t)}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new i.CountedSet);var o=e.getFront();this.children_.contains(o)||this.children_.add(o,new t);var r=this.children_.get(o);e=e.popFront(),r.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(r.PRIORITY_INDEX,function(t,e){n.remember(new o.Path(t),e)}),this.forget(t)}if(null!==this.children_){var i=t.getFront();if(t=t.popFront(),this.children_.contains(i)){this.children_.get(i).forget(t)&&this.children_.remove(i)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild(function(n,r){var i=new o.Path(t.toString()+"/"+n);r.forEachTree(i,e)})},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each(function(e,n){t(e,n)})},t}();e.SparseSnapshotTree=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return o.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return o.isEmpty(this.set)},t.prototype.count=function(){return o.getCount(this.set)},t.prototype.each=function(t){o.forEach(this.set,function(e,n){return t(e,n)})},t.prototype.keys=function(){var t=[];return o.forEach(this.set,function(e){t.push(e)}),t},t}();e.CountedSet=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(90),r=n(22),i=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=o.OperationType.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,r.Path.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}();e.Overwrite=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(176),i=n(36),a=n(3),s=n(3),c=n(491),u=n(1124),l=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return a.assert(o,"Reference.ts has not been loaded"),o},set:function(t){a.assert(!o,"__referenceConstructor has already been defined"),o=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return s.isEmpty(this.views_)},t.prototype.applyOperation=function(t,e,n){var o=t.source.queryId;if(null!==o){var r=s.safeGet(this.views_,o);return a.assert(null!=r,"SyncTree gave us an op for an invalid query."),r.applyOperation(t,e,n)}var i=[];return s.forEach(this.views_,function(o,r){i=i.concat(r.applyOperation(t,e,n))}),i},t.prototype.addEventRegistration=function(t,e,n,o,a){var l=t.queryIdentifier(),p=s.safeGet(this.views_,l);if(!p){var d=n.calcCompleteEventCache(a?o:null),h=!1;d?h=!0:o instanceof i.ChildrenNode?(d=n.calcCompleteEventChildren(o),h=!1):(d=i.ChildrenNode.EMPTY_NODE,h=!1);var f=new c.ViewCache(new r.CacheNode(d,h,!1),new r.CacheNode(o,a,!1));p=new u.View(t,f),this.views_[l]=p}return p.addEventRegistration(e),p.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,o){var r=e.queryIdentifier(),i=[],a=[],c=this.hasCompleteView();if("default"===r){var u=this;s.forEach(this.views_,function(t,e){a=a.concat(e.removeEventRegistration(n,o)),e.isEmpty()&&(delete u.views_[t],e.getQuery().getQueryParams().loadsAllData()||i.push(e.getQuery()))})}else{var l=s.safeGet(this.views_,r);l&&(a=a.concat(l.removeEventRegistration(n,o)),l.isEmpty()&&(delete this.views_[r],l.getQuery().getQueryParams().loadsAllData()||i.push(l.getQuery())))}return c&&!this.hasCompleteView()&&i.push(new t.__referenceConstructor(e.repo,e.path)),{removed:i,events:a}},t.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map(function(e){return t.views_[e]}).filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},t.prototype.getCompleteServerCache=function(t){var e=null;return s.forEach(this.views_,function(n,o){e=e||o.getCompleteServerCache(t)}),e},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return s.safeGet(this.views_,e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){return s.findValue(this.views_,function(t){return t.getQuery().getQueryParams().loadsAllData()})||null},t}();e.SyncPoint=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(36),r=n(176),i=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,o){return new t(new r.CacheNode(e,n,o),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,o){return new t(this.eventCache_,new r.CacheNode(e,n,o))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new r.CacheNode(o.ChildrenNode.EMPTY_NODE,!1,!1),new r.CacheNode(o.ChildrenNode.EMPTY_NODE,!1,!1)),t}();e.ViewCache=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=o.clone(t);return this.last_&&o.forEach(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}();e.StatsListener=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(74),i=n(3),a=n(3),s=n(3),c=n(9),u=n(22),l=n(1136),p=n(1137),d=n(3),h=n(495),f=n(3),m=n(3),g=n(498),v=1e3,y=3e5,_=function(t){function e(n,o,r,i,a,s){var u=t.call(this)||this;if(u.repoInfo_=n,u.onDataUpdate_=o,u.onConnectStatus_=r,u.onServerInfoUpdate_=i,u.authTokenProvider_=a,u.authOverride_=s,u.id=e.nextPersistentConnectionId_++,u.log_=c.logWrapper("p:"+u.id+":"),u.interruptReasons_={},u.listens_={},u.outstandingPuts_=[],u.outstandingPutCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=v,u.maxReconnectDelay_=y,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,s&&!m.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),l.VisibilityMonitor.getInstance().on("visible",u.onVisible_,u),-1===n.host.indexOf("fblocal")&&p.OnlineMonitor.getInstance().on("online",u.onOnline_,u),u}return o(e,t),e.prototype.sendRequest=function(t,e,n){var o=++this.requestNumber_,r={r:o,a:t,b:e};this.log_(a.stringify(r)),s.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(r),n&&(this.requestCBHash_[o]=n)},e.prototype.listen=function(t,e,n,o){var r=t.queryIdentifier(),i=t.path.toString();this.log_("Listen called for "+i+" "+r),this.listens_[i]=this.listens_[i]||{},s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),s.assert(!this.listens_[i][r],"listen() called twice for same path/queryId.");var a={onComplete:o,hashFn:e,query:t,tag:n};this.listens_[i][r]=a,this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,o=t.query,r=o.path.toString(),i=o.queryIdentifier();this.log_("Listen on "+r+" for "+i);var a={p:r};t.tag&&(a.q=o.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,c=a.s;e.warnOnListenWarnings_(s,o),(n.listens_[r]&&n.listens_[r][i])===t&&(n.log_("listen response",a),"ok"!==c&&n.removeListen_(r,i),t.onComplete&&t.onComplete(c,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"==typeof t&&i.contains(t,"w")){var n=i.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var o='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',r=e.path.toString();c.warn("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+o+" at "+r+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||d.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=d.isValidFormat(e)?"auth":"gauth",o={cred:e};null===this.authOverride_?o.noauth=!0:"object"==typeof this.authOverride_&&(o.authvar=this.authOverride_),this.sendRequest(n,o,function(n){var o=n.s,r=n.d||"error";t.authToken_===e&&("ok"===o?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(o,r))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),o=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+o),s.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,o)&&this.connected_&&this.sendUnlisten_(n,o,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,o){this.log_("Unlisten on "+t+" for "+e);var r={p:t};o&&(r.q=n,r.t=o),this.sendRequest("n",r)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,o){var r={p:e,d:n};this.log_("onDisconnect "+t,r),this.sendRequest(t,r,function(t){o&&setTimeout(function(){o(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,o){this.putInternal("p",t,e,n,o)},e.prototype.merge=function(t,e,n,o){this.putInternal("m",t,e,n,o)},e.prototype.putInternal=function(t,e,n,o,r){var i={p:e,d:n};void 0!==r&&(i.h=r),this.outstandingPuts_.push({action:t,request:i,onComplete:o}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,o=this.outstandingPuts_[t].request,r=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,o,function(o){e.log_(n+" response",o),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),r&&r(o.s,o.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+a.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):c.error("Unrecognized action received from server: "+a.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;s.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=v,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=v,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var t=(new Date).getTime()-this.lastConnectionEstablishedTime_;t>3e4&&(this.reconnectDelay_=v),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),r=this.id+":"+e.nextConnectionId_++,i=this,a=this.lastSessionId,u=!1,l=null,p=function(){l?l.close():(u=!0,o())},d=function(t){s.assert(l,"sendRequest call when we're not connected not allowed."),l.sendRequest(t)};this.realtime_={close:p,sendRequest:d};var m=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(m).then(function(e){u?c.log("getToken() completed but was canceled"):(c.log("getToken() completed. Creating connection."),i.authToken_=e&&e.accessToken,l=new h.Connection(r,i.repoInfo_,t,n,o,function(t){c.warn(t+" ("+i.repoInfo_.toString()+")"),i.interrupt("server_kill")},a))}).then(null,function(t){i.log_("Failed to get token: "+t),u||(f.CONSTANTS.NODE_ADMIN&&c.warn(t),p())})}},e.prototype.interrupt=function(t){c.log("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){c.log("Resuming connection for reason: "+t),delete this.interruptReasons_[t],i.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=v,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return c.ObjectToUniqueKey(t)}).join("$"):"default";var o=this.removeListen_(t,n);o&&o.onComplete&&o.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,o=new u.Path(t).toString();return void 0!==this.listens_[o]?(n=this.listens_[o][e],delete this.listens_[o][e],0===i.getCount(this.listens_[o])&&delete this.listens_[o]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){c.log("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||++this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&"undefined"!=typeof console&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),i.forEach(this.listens_,function(e,n){i.forEach(n,function(e,n){t.sendListen_(n)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";f.CONSTANTS.NODE_ADMIN?e="admin_node":f.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+r.default.SDK_VERSION.replace(/\./g,"-")]=1,m.isMobileCordova()?t["framework.cordova"]=1:m.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=p.OnlineMonitor.getInstance().currentlyOnline();return i.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(g.ServerActions);e.PersistentConnection=_},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t){this.allowedEvents_=t,this.listeners_={},o.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var o=this.listeners_[t].slice(),r=0;r<o.length;r++)o[r].callback.apply(o[r].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var o=this.getInitialEvent(t);o&&e.apply(n,o)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var o=this.listeners_[t]||[],r=0;r<o.length;r++)if(o[r].callback===e&&(!n||n===o[r].context))return void o.splice(r,1)},t.prototype.validateEventType_=function(t){o.assert(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}();e.EventEmitter=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=n(170),i=n(171),a=n(1138),s=function(){function t(t,e,n,r,i,s,c){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=s,this.lastSessionId=c,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=o.logWrapper("c:"+this.id+":"),this.transportManager_=new a.TransportManager(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=o.setTimeoutNonBlocking(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=o.requireKey("t",t),n=o.requireKey("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=o.requireKey("t",t),n=o.requireKey("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||--this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy())},t.prototype.onControl_=function(t){var e=o.requireKey("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?o.error("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):o.error("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),i.PROTOCOL_VERSION!==n&&o.warn("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),o.setTimeoutNonBlocking(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):o.setTimeoutNonBlocking(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(r.PersistentStorage.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}();e.Connection=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=n(488),i=n(257),a=n(1139),s=n(171),c=n(3),u=n(3);e.FIREBASE_LONGPOLL_START_PARAM="start",e.FIREBASE_LONGPOLL_CLOSE_COMMAND="close",e.FIREBASE_LONGPOLL_COMMAND_CB_NAME="pLPCommand",e.FIREBASE_LONGPOLL_DATA_CB_NAME="pRTLPCB",e.FIREBASE_LONGPOLL_ID_PARAM="id",e.FIREBASE_LONGPOLL_PW_PARAM="pw",e.FIREBASE_LONGPOLL_SERIAL_PARAM="ser",e.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM="cb",e.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM="seg",e.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET="ts",e.FIREBASE_LONGPOLL_DATA_PARAM="d",e.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM="disconn",e.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM="dframe";var l=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=o.logWrapper(t),this.stats_=i.StatsManager.getCollection(e),this.urlFn=function(t){return e.connectionURL(s.LONG_POLLING,t)}}return t.prototype.open=function(t,n){var r=this;this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new a.PacketReceiver(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(3e4)),o.executeWhenDOMReady(function(){if(!r.isClosed_){r.scriptTagHolder=new p(function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var o=t[0],i=t[1],a=t[2];t[3],t[4];if(r.incrementIncomingBytes_(t),r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,o==e.FIREBASE_LONGPOLL_START_PARAM)r.id=i,r.password=a;else{if(o!==e.FIREBASE_LONGPOLL_CLOSE_COMMAND)throw new Error("Unrecognized command received: "+o);i?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(i,function(){r.onClosed_()})):r.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=t[0],o=t[1];r.incrementIncomingBytes_(t),r.myPacketOrderer.handleResponse(n,o)},function(){r.onClosed_()},r.urlFn);var t={};t[e.FIREBASE_LONGPOLL_START_PARAM]="t",t[e.FIREBASE_LONGPOLL_SERIAL_PARAM]=Math.floor(1e8*Math.random()),r.scriptTagHolder.uniqueCallbackIdentifier&&(t[e.FIREBASE_LONGPOLL_CALLBACK_ID_PARAM]=r.scriptTagHolder.uniqueCallbackIdentifier),t[s.VERSION_PARAM]=s.PROTOCOL_VERSION,r.transportSessionId&&(t[s.TRANSPORT_SESSION_PARAM]=r.transportSessionId),r.lastSessionId&&(t[s.LAST_SESSION_PARAM]=r.lastSessionId),!u.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(s.FORGE_DOMAIN)&&(t[s.REFERER_PARAM]=s.FORGE_REF);var n=r.urlFn(t);r.log_("Connecting via long-poll to "+n),r.scriptTagHolder.addTag(n,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!=typeof document&&null!=document.createElement&&!o.isChromeExtensionContentScript()&&!o.isWindowsStoreApp()&&!u.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=c.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=c.base64Encode(e),r=o.splitStringBySize(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,n){if(!u.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var o={};o[e.FIREBASE_LONGPOLL_DISCONN_FRAME_REQUEST_PARAM]="t",o[e.FIREBASE_LONGPOLL_ID_PARAM]=t,o[e.FIREBASE_LONGPOLL_PW_PARAM]=n,this.myDisconnFrame.src=this.urlFn(o),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=c.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}();e.BrowserPollConnection=l;var p=function(){function t(n,i,a,s){if(this.onDisconnect=a,this.urlFn=s,this.outstandingRequests=new r.CountedSet,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,u.isNodeSdk())this.commandCB=n,this.onMessageCB=i;else{this.uniqueCallbackIdentifier=o.LUIDGenerator(),window[e.FIREBASE_LONGPOLL_COMMAND_CB_NAME+this.uniqueCallbackIdentifier]=n,window[e.FIREBASE_LONGPOLL_DATA_CB_NAME+this.uniqueCallbackIdentifier]=i,this.myIFrame=t.createIFrame_();var c="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){c='<script>document.domain="'+document.domain+'";<\/script>'}var l="<html><body>"+c+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(t){o.log("frame writing exception"),t.stack&&o.log(t.stack),o.log(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||o.log("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var n=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==n.myIFrame&&(document.body.removeChild(n.myIFrame),n.myIFrame=null)},Math.floor(0))),u.isNodeSdk()&&this.myID){var o={};o[e.FIREBASE_LONGPOLL_DISCONN_FRAME_PARAM]="t",o[e.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,o[e.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW;var r=this.urlFn(o);t.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t[e.FIREBASE_LONGPOLL_ID_PARAM]=this.myID,t[e.FIREBASE_LONGPOLL_PW_PARAM]=this.myPW,t[e.FIREBASE_LONGPOLL_SERIAL_PARAM]=this.currentSerial;for(var n=this.urlFn(t),o="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+o.length<=1870))break;var i=this.pendingSegs.shift();o=o+"&"+e.FIREBASE_LONGPOLL_SEGMENT_NUM_PARAM+r+"="+i.seg+"&"+e.FIREBASE_LONGPOLL_SEGMENTS_IN_PACKET+r+"="+i.ts+"&"+e.FIREBASE_LONGPOLL_DATA_PARAM+r+"="+i.d,r++}return n+=o,this.addLongPollTag_(n,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var o=function(){n.outstandingRequests.remove(e),n.newRequest_()},r=setTimeout(o,Math.floor(25e3)),i=function(){clearTimeout(r),o()};this.addTag(t,i)},t.prototype.addTag=function(t,e){var n=this;u.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){o.log("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}},Math.floor(1))},t}();e.FirebaseIFrameScriptHolder=p},function(t,e,n){"use strict";(function(t){function o(t){h=t}Object.defineProperty(e,"__esModule",{value:!0});var r=n(74),i=n(3),a=n(9),s=n(257),c=n(171),u=n(3),l=n(170),p=n(3),d=n(3),h=null;"undefined"!=typeof MozWebSocket?h=MozWebSocket:"undefined"!=typeof WebSocket&&(h=WebSocket),e.setWebSocketImpl=o;var f=function(){function e(t,n,o,r){this.connId=t,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=a.logWrapper(this.connId),this.stats_=s.StatsManager.getCollection(n),this.connURL=e.connectionURL_(n,o,r)}return e.connectionURL_=function(t,e,n){var o={};return o[c.VERSION_PARAM]=c.PROTOCOL_VERSION,!d.isNodeSdk()&&"undefined"!=typeof location&&location.href&&-1!==location.href.indexOf(c.FORGE_DOMAIN)&&(o[c.REFERER_PARAM]=c.FORGE_REF),e&&(o[c.TRANSPORT_SESSION_PARAM]=e),n&&(o[c.LAST_SESSION_PARAM]=n),t.connectionURL(c.WEBSOCKET,o)},e.prototype.open=function(e,n){var o=this;this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,l.PersistentStorage.set("previous_websocket_failure",!0);try{if(d.isNodeSdk()){var i=u.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",a={headers:{"User-Agent":"Firebase/"+c.PROTOCOL_VERSION+"/"+r.default.SDK_VERSION+"/"+t.platform+"/"+i}},s=t.env,p=0==this.connURL.indexOf("wss://")?s.HTTPS_PROXY||s.https_proxy:s.HTTP_PROXY||s.http_proxy;p&&(a.proxy={origin:p}),this.mySock=new h(this.connURL,[],a)}else this.mySock=new h(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var f=t.message||t.data;return f&&this.log_(f),void this.onClosed_()}this.mySock.onopen=function(){o.log_("Websocket connected."),o.everConnected_=!0},this.mySock.onclose=function(){o.log_("Websocket connection was disconnected."),o.mySock=null,o.onClosed_()},this.mySock.onmessage=function(t){o.handleIncomingFrame(t)},this.mySock.onerror=function(t){o.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&o.log_(e),o.onClosed_()}},e.prototype.start=function(){},e.forceDisallow=function(){e.forceDisallow_=!0},e.isAvailable=function(){var t=!1;if("undefined"!=typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,o=navigator.userAgent.match(n);o&&o.length>1&&parseFloat(o[1])<4.4&&(t=!0)}return!t&&null!==h&&!e.forceDisallow_},e.previouslyFailed=function(){return l.PersistentStorage.isInMemoryStorage||!0===l.PersistentStorage.get("previous_websocket_failure")},e.prototype.markConnectionHealthy=function(){l.PersistentStorage.remove("previous_websocket_failure")},e.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=p.jsonEval(e);this.onMessage(n)}},e.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},e.prototype.extractFrameCount_=function(t){if(i.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},e.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},e.prototype.send=function(t){this.resetKeepAlive();var e=p.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=a.splitStringBySize(e,16384);n.length>1&&this.sendString_(String(n.length));for(var o=0;o<n.length;o++)this.sendString_(n[o])},e.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},e.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},e.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},e.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},e.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},e.responsesRequiredToBeHealthy=2,e.healthyTimeout=3e4,e}();e.WebSocketConnection=f}).call(e,n(124))},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){}return t.prototype.put=function(t,e,n,o){},t.prototype.merge=function(t,e,n,o){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}();e.ServerActions=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(256),r=n(33),i=n(45),a=n(36),s=function(){function t(e){this.indexedFilter_=new o.IndexedFilter(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,o,r,s){return this.matches(new i.NamedNode(e,n))||(n=a.ChildrenNode.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,o,r,s)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=a.ChildrenNode.EMPTY_NODE);var o=e.withIndex(this.index_);o=o.updatePriority(a.ChildrenNode.EMPTY_NODE);var s=this;return e.forEachChild(r.PRIORITY_INDEX,function(t,e){s.matches(new i.NamedNode(t,e))||(o=o.updateImmediateChild(t,a.ChildrenNode.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,o,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}();e.RangedFilter=s},function(t,e,n){"use strict";var o=n(3),r=(n.n(o),n(177)),i=n(1150),a=n(502),s="messagingSenderId",c=function(){function t(t){var e=this;if(this.errorFactory_=new o.ErrorFactory("messaging","Messaging",r.a.map),!t.options[s]||"string"!=typeof t.options[s])throw this.errorFactory_.create(r.a.codes.BAD_SENDER_ID);this.messagingSenderId_=t.options[s],this.tokenManager_=new i.a,this.app=t,this.INTERNAL={},this.INTERNAL.delete=function(){return e.delete}}return t.prototype.getToken=function(){var t=this,e=this.getNotificationPermission_();return e!==a.a.granted?e===a.a.denied?Promise.reject(this.errorFactory_.create(r.a.codes.NOTIFICATIONS_BLOCKED)):Promise.resolve(null):this.getSWRegistration_().then(function(e){return t.tokenManager_.getSavedToken(t.messagingSenderId_,e).then(function(n){return n||t.tokenManager_.createToken(t.messagingSenderId_,e)})})},t.prototype.deleteToken=function(t){var e=this;return this.tokenManager_.deleteToken(t).then(function(){return e.getSWRegistration_().then(function(t){if(t)return t.pushManager.getSubscription()}).then(function(t){if(t)return t.unsubscribe()})})},t.prototype.getSWRegistration_=function(){throw this.errorFactory_.create(r.a.codes.SHOULD_BE_INHERITED)},t.prototype.requestPermission=function(){throw this.errorFactory_.create(r.a.codes.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw this.errorFactory_.create(r.a.codes.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw this.errorFactory_.create(r.a.codes.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw this.errorFactory_.create(r.a.codes.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw this.errorFactory_.create(r.a.codes.AVAILABLE_IN_SW)},t.prototype.delete=function(){return this.tokenManager_.closeDatabase()},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenManager=function(){return this.tokenManager_},t}();e.a=c},function(t,e,n){"use strict";var o=[4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110],r={userVisibleOnly:!0,applicationServerKey:new Uint8Array(o)};e.a={ENDPOINT:"https://fcm.googleapis.com",APPLICATION_SERVER_KEY:o,SUBSCRIPTION_OPTIONS:r}},function(t,e,n){"use strict";e.a={granted:"granted",default:"default",denied:"denied"}},function(t,e,n){"use strict";var o={TYPE_OF_MSG:"firebase-messaging-msg-type",DATA:"firebase-messaging-msg-data"},r={PUSH_MSG_RECEIVED:"push-msg-received",NOTIFICATION_CLICKED:"notification-clicked"},i=function(t,e){return n={},n[o.TYPE_OF_MSG]=t,n[o.DATA]=e,n;var n};e.a={PARAMS:o,TYPES_OF_MSG:r,createNewMsg:i}},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o;!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(o=o||(o={}))},function(t,e,n){"use strict";n.d(e,"a",function(){return f});var o=n(259),r=n(507),i=n(66),a=n(179),s=n(260),c=n(107),u=n(506),l=n(508),p=n(132),d=n(46),h=n(1161),f=function(){function t(t,e){this.authWrapper=t,e instanceof a.a?this.location=e:this.location=a.a.makeFromUrl(e)}return t.prototype.toString=function(){return o.g("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return s.b()},t.prototype.child=function(t){o.g("child",[o.e()],arguments);var e=u.a(this.location.path,t),n=new a.a(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=u.c(this.location.path);if(null===t)return null;var e=new a.a(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new a.a(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return u.b(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),o.g("put",[o.f(),o.b(!0)],arguments),this.throwIfRoot_("put"),new h.a(this,this.authWrapper,this.location,this.mappings(),new r.a(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=p.a.RAW),o.g("putString",[o.e(),o.e(p.c,!0),o.b(!0)],arguments),this.throwIfRoot_("putString");var i=p.b(e,t),a=c.a(n);return!d.a(a.contentType)&&d.a(i.contentType)&&(a.contentType=i.contentType),new h.a(this,this.authWrapper,this.location,this.mappings(),new r.a(i.data,!0),a)},t.prototype.delete=function(){o.g("delete",[],arguments),this.throwIfRoot_("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=l.d(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){o.g("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=l.e(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){o.g("updateMetadata",[o.b()],arguments),this.throwIfRoot_("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var o=l.i(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(o,n).getPromise()})},t.prototype.getDownloadURL=function(){return o.g("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.getMetadata().then(function(t){var e=t.downloadURLs[0];if(d.a(e))return e;throw i.l()})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw i.j(t)},t}()},function(t,e,n){"use strict";function o(t){if(0==t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}function r(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}function i(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}e.c=o,e.a=r,e.b=i},function(t,e,n){"use strict";n.d(e,"a",function(){return a});var o=n(1159),r=n(132),i=n(46),a=function(){function t(t,e){var n=0,o="";i.d(t)?(this.data_=t,n=t.size,o=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=o}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(i.d(this.data_)){var r=this.data_,a=o.b(r,e,n);return null===a?null:new t(a)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(i.e()){var a=e.map(function(e){return e instanceof t?e.data_:e});return new t(o.a.apply(null,a))}var s=e.map(function(t){return i.j(t)?r.b(r.a.RAW,t).data:t.data_}),c=0;s.forEach(function(t){c+=t.byteLength});var u=new Uint8Array(c),l=0;return s.forEach(function(t){for(var e=0;e<t.length;e++)u[l++]=t[e]}),new t(u,!0)},t.prototype.uploadData=function(){return this.data_},t}()},function(t,e,n){"use strict";function o(t){if(!t)throw _.s()}function r(t,e){function n(n,r){var i=b.a(t,r,e);return o(null!==i),i}return n}function i(t){function e(e,n){var o;return o=401===e.getStatus()?_.q():402===e.getStatus()?_.n(t.bucket):403===e.getStatus()?_.r(t.path):n,o.setServerResponseProp(n.serverResponseProp()),o}return e}function a(t){function e(e,o){var r=n(e,o);return 404===e.getStatus()&&(r=_.m(t.path)),r.setServerResponseProp(o.serverResponseProp()),r}var n=i(t);return e}function s(t,e,n){var o=e.fullServerUrl(),i=R.b(o),s=t.maxOperationRetryTime(),c=new I.a(i,"GET",r(t,n),s);return c.errorHandler=a(e),c}function c(t,e,n,o){var i=e.fullServerUrl(),s=R.b(i),c=b.d(n,o),u={"Content-Type":"application/json; charset=utf-8"},l=t.maxOperationRetryTime(),p=new I.a(s,"PATCH",r(t,o),l);return p.headers=u,p.body=c,p.errorHandler=a(e),p}function u(t,e){function n(t,e){}var o=e.fullServerUrl(),r=R.b(o),i=t.maxOperationRetryTime(),s=new I.a(r,"DELETE",n,i);return s.successCodes=[200,204],s.errorHandler=a(e),s}function l(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function p(t,e,n){var o=w.a(n);return o.fullPath=t.path,o.size=e.size(),o.contentType||(o.contentType=l(null,e)),o}function d(t,e,n,o,a){var s=e.bucketOnlyServerUrl(),c={"X-Goog-Upload-Protocol":"multipart"},u=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();c["Content-Type"]="multipart/related; boundary="+u;var l=p(e,o,a),d=b.d(l,n),h="--"+u+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+d+"\r\n--"+u+"\r\nContent-Type: "+l.contentType+"\r\n\r\n",f="\r\n--"+u+"--",m=y.a.getBlob(h,o,f);if(null===m)throw _.d();var g={name:l.fullPath},v=R.d(s),w=t.maxUploadRetryTime(),E=new I.a(v,"POST",r(t,n),w);return E.urlParams=g,E.headers=c,E.body=m.uploadData(),E.errorHandler=i(e),E}function h(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){o(!1)}var r=e||["active"];return o(v.b(r,n)),n}function f(t,e,n,r,a){function s(t,e){h(t);var n;try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){o(!1)}return o(E.j(n)),n}var c=e.bucketOnlyServerUrl(),u=p(e,r,a),l={name:u.fullPath},d=R.d(c),f={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":u.contentType,"Content-Type":"application/json; charset=utf-8"},m=b.d(u,n),g=t.maxUploadRetryTime(),v=new I.a(d,"POST",s,g);return v.urlParams=l,v.headers=f,v.body=m,v.errorHandler=i(e),v}function m(t,e,n,r){function a(t,e){var n,i=h(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){o(!1)}var a=parseInt(n,10);return o(!isNaN(a)),new x(a,r.size(),"final"===i)}var s={"X-Goog-Upload-Command":"query"},c=t.maxUploadRetryTime(),u=new I.a(n,"POST",a,c);return u.headers=s,u.errorHandler=i(e),u}function g(t,e,n,o,a,s,c,u){function l(t,n){var i,a=h(t,["active","final"]),c=p.current+f,u=o.size();return i="final"===a?r(e,s)(t,n):null,new x(c,u,"final"===a,i)}var p=new x(0,0);if(c?(p.current=c.current,p.total=c.total):(p.current=0,p.total=o.size()),o.size()!==p.total)throw _.p();var d=p.total-p.current,f=d;a>0&&(f=Math.min(f,a));var m=p.current,g=m+f,v=f===d?"upload, finalize":"upload",y={"X-Goog-Upload-Command":v,"X-Goog-Upload-Offset":p.current},b=o.slice(m,g);if(null===b)throw _.d();var w=e.maxUploadRetryTime(),E=new I.a(n,"POST",l,w);return E.headers=y,E.body=b.uploadData(),E.progressCallback=u||null,E.errorHandler=i(t),E}e.e=s,e.i=c,e.d=u,e.g=d,n.d(e,"a",function(){return x}),e.c=f,e.f=m,n.d(e,"h",function(){return S}),e.b=g;var v=n(262),y=n(507),_=n(66),b=n(260),w=n(107),I=n(1160),E=n(46),R=n(261),x=function(){function t(t,e,n,o){this.current=t,this.total=e,this.finalized=!!n,this.metadata=o||null}return t}(),S=262144},function(t,e){t.exports="PROD"},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(75),r=n(134),i=n(264),a=n(108),s=n(14),c=n(265),u=function(){function t(){this.id=a.generateUniqueId(),this.name="Default Room Name",this.timestamp=Date.now(),this.location=new o.Vector2(180,80),this.reverb=c.reverbList[0],this.backgroundImage=new r.MediaFile,this.backgroundAudio=new r.MediaFile,this.bgAudioVolume=s.DEFAULT_VOLUME,this.thumbnail=new r.MediaFile,this.audioSet=new Set,this.imageSet=new Set,this.textSet=new Set,this.doorSet=new Set,this.linkSet=new Set,this.narrator=new i.Narrator,this.backgroundVideo=new r.MediaFile,this.backgroundIsVideo=!1}return t.prototype.getId=function(){return this.id},t.prototype.setId=function(t){return this.id=t,this},t.prototype.getName=function(){return this.name},t.prototype.setName=function(t){return this.name=t,this},t.prototype.getAudio=function(){return this.audioSet},t.prototype.addAudio=function(t){this.audioSet.add(t)},t.prototype.removeAudio=function(t){this.audioSet.delete(t)},t.prototype.getImages=function(){return this.imageSet},t.prototype.addImage=function(t){this.imageSet.add(t)},t.prototype.removeImage=function(t){this.imageSet.delete(t)},t.prototype.getText=function(){return this.textSet},t.prototype.addText=function(t){this.textSet.add(t)},t.prototype.removeText=function(t){this.textSet.delete(t)},t.prototype.addDoor=function(t){this.doorSet.add(t)},t.prototype.removeDoor=function(t){this.doorSet.delete(t)},t.prototype.getDoors=function(){return this.doorSet},t.prototype.getLink=function(){return this.linkSet},t.prototype.addLink=function(t){this.linkSet.add(t)},t.prototype.removeLink=function(t){this.linkSet.delete(t)},t.prototype.getTimestamp=function(){return this.timestamp},t.prototype.setTimestamp=function(t){return this.timestamp=t,this},t.prototype.getFileName=function(){return this.backgroundImage.getFileName()},t.prototype.getBackgroundAudioFileName=function(){return this.backgroundAudio.getFileName()},t.prototype.getNarrationIntroFileName=function(){return this.getNarrator().getIntroAudio().getFileName()},t.prototype.getBinaryFileData=function(){return this.backgroundImage.getBinaryFileData()},t.prototype.getBackgroundAudioBinaryFileData=function(){return this.backgroundAudio.getBinaryFileData()},t.prototype.setFileData=function(t,e){this.backgroundImage.setFileName(t),this.backgroundImage.setBinaryFileData(e)},t.prototype.hasBackgroundImage=function(){return this.backgroundImage.getFileName()!==s.DEFAULT_FILE_NAME||this.backgroundIsVideo},t.prototype.setThumbnail=function(t,e){this.thumbnail.setFileName(t),this.thumbnail.setBinaryFileData(e)},t.prototype.getThumbnailImage=function(){return this.thumbnail.getBinaryFileData()},t.prototype.getThumbnailName=function(){return this.thumbnail.getFileName()},t.prototype.getNarrator=function(){return this.narrator},t.prototype.setNarrator=function(t){this.narrator=t},t.prototype.getNarrationIntroBinaryFileData=function(){return this.getNarrator().getIntroAudio().getBinaryFileData()},t.prototype.getLocation=function(){return this.location},t.prototype.setLocation=function(t){return this.location=t,this},t.prototype.getReverb=function(){return this.reverb},t.prototype.setReverb=function(t){this.reverb=t},t.prototype.setBackgroundAudio=function(t,e,n){this.backgroundAudio.setFileName(t),this.backgroundAudio.setBinaryFileData(n),this.setBackgroundAudioVolume(e)},t.prototype.removeBackgroundAudio=function(){this.backgroundAudio=new r.MediaFile},t.prototype.getBackgroundAudio=function(){return this.backgroundAudio},t.prototype.setBackgroundAudioVolume=function(t){this.bgAudioVolume=t},t.prototype.getBackgroundAudioVolume=function(){return this.bgAudioVolume},t.prototype.setBackgroundVideo=function(t,e){this.backgroundVideo.setFileName(t),this.backgroundVideo.setBinaryFileData(e),this.backgroundIsVideo=!0},t.prototype.getBackgroundVideo=function(){return this.backgroundVideo.getBinaryFileData()},t.prototype.getBackgroundIsVideo=function(){return this.backgroundIsVideo},t.prototype.getPossibleCombinedHotspot=function(){return!1},t.prototype.setPossibleCombinedHotspot=function(t){},t.prototype.toJson=function(){var t={uuid:this.id,name:this.name,time:this.timestamp,file:this.id,image:encodeURIComponent(this.backgroundImage.getFileName()),reverb:this.reverb,front:this.location.toString(),ambient:this.backgroundAudio.getFileName()?encodeURIComponent(this.backgroundAudio.getFileName()):"",bgVolume:this.bgAudioVolume,texts:Array.from(this.getText()).map(function(t){return t.toJson()}),clips:Array.from(this.getAudio()).map(function(t){return t.toJson()}),images:Array.from(this.getImages()).map(function(t){return t.toJson()}),doors:Array.from(this.getDoors()).filter(function(t){return t.getAutoTime()<=0}).map(function(t){return t.toJson()}),autoDoors:Array.from(this.getDoors()).filter(function(t){return t.getAutoTime()>0}).map(function(t){return t.toJson()}),narrator:this.narrator.toJson()};return this.backgroundIsVideo&&(t.video=this.backgroundVideo.getBinaryFileData()),t},t}();e.Room=u},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){}return t.prototype.getProjectId=function(){return this.projectId},t.prototype.setProjectId=function(t){this.projectId=t},t.prototype.isWorkingOnSavedProject=function(){return!!this.projectId},t=o([i.Injectable(),r("design:paramtypes",[])],t)}();e.ProjectService=a},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(0),s=function(){function t(){}return t.prototype.facebookLogin=function(){var t=window.FB,e=new Promise(function(e,n){t.login(function(t){console.log("on facebook log in",t),"connected"===t.status?e(t):n(t.error)})});return a.Observable.fromPromise(e)},t.prototype.googleLogin=function(){var t=window.gapi;return a.Observable.fromPromise(t.auth2.getAuthInstance().signIn())},t.prototype.facebookLogout=function(){window.FB.api("/me/permissions","delete",function(t){console.log("facebook logout",t)})},t.prototype.googleLogout=function(){window.gapi.auth2.getAuthInstance().signOut().then(function(){console.log("User signed out.")})},t=o([i.Injectable(),r("design:paramtypes",[])],t)}();e.SocialAuthenticationService=s},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){var t=this;this.screenWidth=window.innerWidth,window.addEventListener("resize",function(e){return t.screenWidth=window.innerWidth})}return t.prototype.isMobile=function(){return this.screenWidth<768},t=o([i.Injectable(),r("design:paramtypes",[])],t)}();e.ResponsiveUtil=a},function(t,e,n){(function(t){t.SvrControls=function(e,n,o){function r(t){m.theta-=t}function i(t){m.phi-=t}function a(e){e.preventDefault(),w=!1,I=new t.Vector2,y.set(e.clientX,e.clientY),l.domElement.addEventListener("mousemove",s,!1),l.domElement.addEventListener("mouseup",c,!1),l.dispatchEvent(d)}function s(t){t.preventDefault(),_.set(t.clientX,t.clientY),b.subVectors(_,y);var e=l.domElement===document?l.domElement.body:l.domElement;r(2*Math.PI*b.x/e.clientWidth*l.rotateSpeed),i(2*Math.PI*b.y/e.clientHeight*l.rotateSpeed),y.copy(_),void 0!==t.movementX&&void 0!==t.movementY&&(I.x=t.movementX,I.y=t.movementY),l.update()}function c(t){w=!0,l.domElement.removeEventListener("mousemove",s,!1),l.domElement.removeEventListener("mouseup",c,!1),l.dispatchEvent(h)}function u(t){t.preventDefault()}this.object=e,this.domElement=void 0!==n?n:document,this.target=new t.Vector3(o.x||0,o.y||0,o.z||0),this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.rotateSpeed=-.3,this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.getPolarAngle=function(){return f.phi},this.getAzimuthalAngle=function(){return f.theta},this.hasMomentum=function(){return w},this.reset=function(){l.target.copy(l.target0),l.object.position.copy(l.position0),l.object.updateProjectionMatrix(),l.dispatchEvent(p),l.update()},this.lookAt=function(t){l.target.copy(t),l.object.lookAt(l.target),l.object.updateProjectionMatrix(),l.dispatchEvent(p),l.update()},this.update=function(){var n=new t.Vector3,o=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),r=o.clone().inverse();new t.Vector3,new t.Quaternion;return function(){var t=l.object.position;return n.copy(t).sub(l.target),n.applyQuaternion(o),f.setFromVector3(n),w&&(Math.abs(I.x)<x&&Math.abs(I.y)<x?w=!1:(I.x*=E,I.y*=E,m.theta+=R*I.x,m.phi+=R*I.y)),f.theta+=m.theta,f.phi+=m.phi,f.theta=Math.max(l.minAzimuthAngle,Math.min(l.maxAzimuthAngle,f.theta)),f.phi=Math.max(l.minPolarAngle,Math.min(l.maxPolarAngle,f.phi)),f.makeSafe(),f.radius*=g,f.radius=Math.max(l.minDistance,Math.min(l.maxDistance,f.radius)),l.target.add(v),n.setFromSpherical(f),n.applyQuaternion(r),t.copy(l.target).add(n),l.object.lookAt(l.target),m.set(0,0,0),!1}}(),this.dispose=function(){l.domElement.removeEventListener("contextmenu",u,!1),l.domElement.removeEventListener("mousedown",a,!1),l.domElement.removeEventListener("mousemove",s,!1),l.domElement.removeEventListener("mouseup",c,!1)};var l=this,p={type:"change"},d={type:"start"},h={type:"end"},f=new t.Spherical,m=new t.Spherical,g=1,v=new t.Vector3,y=new t.Vector2,_=new t.Vector2,b=new t.Vector2,w=!1,I=new t.Vector2,E=.9,R=.005,x=.25;l.domElement.addEventListener("contextmenu",u,!1),l.domElement.addEventListener("mousedown",a,!1),this.update()},t.SvrControls.prototype=Object.create(t.EventDispatcher.prototype),t.SvrControls.prototype.constructor=t.SvrControls}).call(e,n(24))},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=function(){function t(){this.direction={x:0,y:0,z:0}}return t.prototype.getCameraDirection=function(){return this.direction},t.prototype.setCameraDirection=function(t,e,n){this.direction.x=t,this.direction.y=e,this.direction.z=n},t=o([r.Injectable()],t)}();e.CameraService=i},function(t,e,n){"use strict";(function(t){function o(){var e=new t.SphereGeometry(a,s,s),n=window.innerWidth/window.innerHeight,o=new t.Mesh(e),r=new t.PerspectiveCamera(i.THREE_CONST.FOV_NORM,n,1,2*a),c=new t.PerspectiveCamera(i.THREE_CONST.FOV_NORM,n,1,2*a),u=new t.Scene;return o.scale.set(-1,1,1),o.name="sphereMesh",r.aspect=n,r.position.x=0,r.position.y=0,r.position.z=1e-4,c.aspect=n,c.position.x=0,c.position.y=0,c.position.z=1e-4,u.add(r),u.add(c),u.add(o),{sphereMesh:o,camera:r,vrCamera:c,scene:u}}function r(t,e){return new Promise(function(n,o){try{var r=window.devicePixelRatio||1,i=window.innerWidth/r,a=window.innerHeight/r,s=i/a;e.setPixelRatio(r),e.setSize(i,a,!1),t.aspect=s,t.updateProjectionMatrix(),setTimeout(function(){return n()})}catch(t){o(t)}})}Object.defineProperty(e,"__esModule",{value:!0});var i=n(14),a=i.THREE_CONST.SPHERE_RADIUS,s=i.THREE_CONST.SPHERE_SLICES;i.THREE_CONST.RADIAL_DISTANCE;e.buildScene=o,e.onResize=r}).call(e,n(24))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(){this.editSpaceHasRendered=!1}return e.prototype.init=function(t){var e=this;this.videoElement=document.createElement("video"),this.videoElement.src=t,this.videoElement.setAttribute("crossorigin","anonymous"),this.videoElement.load(),this.videoElement.loop=!0;var n=this.videoElement.play();return n?n.then(function(t){return e.initTexture()}).catch(function(t){return console.log("auto playback error",t)}):(this.initTexture(),Promise.resolve(this.texture))},e.prototype.initTexture=function(){var e=document.createElement("canvas");return e.width=this.videoElement.videoWidth,e.height=this.videoElement.videoHeight,this.g2d=e.getContext("2d"),this.texture=new t.Texture(e),this.texture.minFilter=t.LinearFilter,this.texture.magFilter=t.LinearFilter,this.texture},e.prototype.getTexture=function(){return this.texture},e.prototype.attemptRender=function(){return this.videoElement.readyState===this.videoElement.HAVE_ENOUGH_DATA&&(this.g2d.drawImage(this.videoElement,0,0),this.texture.needsUpdate=!0,!0)},e.prototype.attemptEditSpaceRender=function(){this.editSpaceHasRendered||(this.editSpaceHasRendered=this.attemptRender(),this.videoElement.pause())},e.prototype.play=function(){this.videoElement.play()},e.prototype.destroy=function(){this.videoElement.pause(),this.videoElement=null,this.texture=null,this.g2d=null},e}();e.Video3D=n}).call(e,n(24))},function(t,e,n){"use strict";(function(t){var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(54),s=n(12),c=n(276),u=n(6),l=function(){function e(e,n,o,r){this.eventBus=e,this.projectInteractor=n,this.chatInteractor=o,this.sceneInteractor=r,this.chatRoomId="",this.lastLookAtTime=performance.now(),this.testMultiViewPosition=new Map,this.lastCameraPosition=new t.Vector3(0,0,0)}return e.prototype.initBeachBalls=function(e,n){var o=this,r=new t.SphereGeometry(5,32,32);n.wrapS=t.RepeatWrapping,n.wrapT=t.RepeatWrapping,n.offset.set(0,0),n.repeat.set(2,1);var i=new t.MeshBasicMaterial({map:n,side:t.FrontSide}),a=new t.Mesh(r,i);new Array(2).fill(null).map(function(t,e){return e+1}).forEach(function(t){var n=a.clone();n.position.set(10,10,10),n.visible=!0,o.testMultiViewPosition.set(t,n),e.add(n)})},e.prototype.update=function(e){var n=e.getWorldDirection();if(!n.equals(this.lastCameraPosition)){this.lastCameraPosition=n;var o=new t.Vector3(0,0,-100),r=e.localToWorld(o);this.setLookAt(r.x,r.y,r.z)}},e.prototype.updateUser=function(t,e){var n=t.lookingAt.x&&t.lookingAt.y&&t.lookingAt.z;this.testMultiViewPosition.has(e)&&n&&this.testMultiViewPosition.get(e).position.set(t.lookingAt.x,t.lookingAt.y,t.lookingAt.z)},e.prototype.openSharedValue=function(t){var e=t.split("-"),n=e[0],o=e[1];return void 0===n||void 0===o?void console.log("error","userId",n,"projectId",o):(console.log("open project for",n,o),console.log("join chat room:",t),this.chatRoomId=t,this.joinMultiView(),this.openProject(n,o))},e.prototype.setLookAt=function(t,e,n){performance.now()-this.lastLookAtTime>100&&(this.chatInteractor.setLookAt(this.chatRoomId,t,e,n),this.lastLookAtTime=performance.now())},e.prototype.observeRoom=function(){var t="/chatrooms/"+this.chatRoomId+"/";return this.chatInteractor.observeRoom(t)},e.prototype.openProject=function(t,e){var n=this;return new Promise(function(o,r){n.eventBus.onStartLoading(),n.projectInteractor.openProject(t,e).subscribe(function(t){n.sceneInteractor.setActiveRoomId(null),n.eventBus.onSelectRoom(null,!1),o()},function(t){return r(t)},function(){return n.eventBus.onStopLoading()})})},e.prototype.joinMultiView=function(){this.chatInteractor.joinRoom(this.chatRoomId).subscribe(function(t){return console.log("joined Room",t)},function(t){return console.log("error",t)})},e=o([i.Injectable(),r("design:paramtypes",[u.EventBus,a.ProjectInteractor,c.ChatInteractor,s.SceneInteractor])],e)}();e.MultiViewService=l}).call(e,n(24))},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(0),s=n(468);n(473),n(474);var c=n(183),u=function(){function t(t){this.authenticationService=t}return t.prototype.createRoom=function(t,e,n){var o={name:t,creatorId:n,users:{id:{name:e}},project:{userId:"",projectId:""}},r=s.database().ref().child("/chatrooms/").push().key,i=s.database().ref("/chatrooms/"+r).update(o);return a.Observable.fromPromise(i)},t.prototype.getRooms=function(){return a.Observable.create(function(t){s.database().ref("/chatrooms/").on("value",function(e){t.next(e.val())})})},t.prototype.joinRoom=function(t,e,n){var o="/chatrooms/"+t+"/",r=""+o+e,i={name:n},c=s.database().ref(r).update(i);return a.Observable.fromPromise(c)},t.prototype.observeRoom=function(t){return console.log("roomAddress",t),a.Observable.create(function(e){s.database().ref(t).on("value",function(t){e.next(t.val())})})},t.prototype.setLookAt=function(t,e,n,o,r){var i="/chatrooms/"+t+"/"+e+"/lookingAt",c={x:n,y:o,z:r},u=s.database().ref(i).update(c);return a.Observable.fromPromise(u)},t=o([i.Injectable(),r("design:paramtypes",[c.AuthenticationService])],t)}();e.ChatService=u},function(t,e,n){"use strict";(function(t){function n(e){e.traverse(function(e){e instanceof t.Mesh&&(o(e),e.material=null,e.geometry=null,e.material instanceof t.MeshBasicMaterial&&e.material.map instanceof t.Texture&&(e.material.map=null),e=null)}),e.children.forEach(function(t){return e.remove(t)})}function o(e){e&&(e.material&&e.material.dispose(),e.geometry&&e.geometry.dispose(),e.material&&e.material instanceof t.MeshBasicMaterial&&e.material.map instanceof t.Texture&&e.material.map.dispose())}Object.defineProperty(e,"__esModule",{value:!0}),e.clearScene=n,e.cleanMeshMemory=o}).call(e,n(24))},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(37),s=n(12),c=n(76),u=n(277),l=function(){function t(t,e,n,o){this.metaDataInteractor=t,this.sceneInteractor=e,this.assetInteractor=n,this.audioPlayService=o,this.roomBgAudioMap=new Map,this.roomNarrationMap=new Map}return t.prototype.loadBuffers=function(){var t=this,e=[],n=this.metaDataInteractor.getSoundtrack();if(n.getBinaryFileData()){var o=n.getBinaryFileData().changingThisBreaksApplicationSecurity?n.getBinaryFileData().changingThisBreaksApplicationSecurity:n.getBinaryFileData();e.push(new c.AssetModel("soundtrack",n.getFileName(),o))}var r=this.sceneInteractor.getRoomIds().map(function(e){return t.sceneInteractor.getRoomById(e)}).filter(function(e){return e.getBackgroundAudioBinaryFileData()?(t.roomBgAudioMap.set(e.getId(),!0),!0):(t.roomBgAudioMap.set(e.getId(),!1),!1)}).map(function(t){var e=t.getBackgroundAudioBinaryFileData();return e.changingThisBreaksApplicationSecurity&&(e=e.changingThisBreaksApplicationSecurity),new c.AssetModel(t.getId()+"b",t.getBackgroundAudioFileName(),e)}),i=this.sceneInteractor.getRoomIds().map(function(e){return t.sceneInteractor.getRoomById(e)}).filter(function(e){return e.getNarrationIntroBinaryFileData()?(t.roomNarrationMap.set(e.getId(),!0),!0):(t.roomNarrationMap.set(e.getId(),!1),!1)}).map(function(t){var e=t.getNarrationIntroBinaryFileData();return e.changingThisBreaksApplicationSecurity&&(e=e.changingThisBreaksApplicationSecurity),new c.AssetModel(t.getId()+"n",t.getNarrationIntroFileName(),e)}),a=this.sceneInteractor.getRoomIds().map(function(e){return t.sceneInteractor.getRoomById(e)}).reduce(function(t,e){var n=Array.from(e.getAudio()).filter(function(t){return t.getBinaryFileData()}).map(function(t){var e=t.getBinaryFileData().changingThisBreaksApplicationSecurity?t.getBinaryFileData().changingThisBreaksApplicationSecurity:t.getBinaryFileData();return new c.AssetModel(t.getId(),t.getFileName(),e)});return t.concat(n)},[]),s=e.concat(r).concat(i).concat(a);return this.assetInteractor.loadAudioBuffers(s)},t.prototype.stopAllAudio=function(){this.audioPlayService.stopAll()},t.prototype.playSoundtrack=function(){this.metaDataInteractor.getSoundtrack().getBinaryFileData()&&this.audioPlayService.playSoundtrack("soundtrack")},t.prototype.playBackgroundAudio=function(){if(this.roomBgAudioMap.get(this.sceneInteractor.getActiveRoomId())){var t=this.sceneInteractor.getActiveRoomId()+"b";this.audioPlayService.playBgAudio(t)}},t.prototype.playNarration=function(){if(this.roomNarrationMap.get(this.sceneInteractor.getActiveRoomId())){var t=this.sceneInteractor.getActiveRoomId()+"n";this.audioPlayService.playHotspotAudio(t)}},t=o([i.Injectable(),r("design:paramtypes",[a.MetaDataInteractor,s.SceneInteractor,c.AssetInteractor,u.AudioPlayService])],t)}();e.AudioManager=l},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(12),s=n(76),c=n(14),u=[new s.AssetModel("door","door",c.ICON_PATH+"door_filled.png"),new s.AssetModel("image","image",c.ICON_PATH+"image_filled.png"),new s.AssetModel("text","text",c.ICON_PATH+"text_filled.png"),new s.AssetModel("audio","audio",c.ICON_PATH+"audio_filled.png"),new s.AssetModel("link","link",c.ICON_PATH+"link_filled.png"),new s.AssetModel("back","back",c.ICON_PATH+"back_filled.png"),new s.AssetModel("home","home",c.ICON_PATH+"home_filled.png"),new s.AssetModel("colorBall","colorBall",c.IMAGE_PATH+"color_ball.jpg"),new s.AssetModel("imageMask","imageMask",c.IMAGE_PATH+"image-mask_1920.jpg")],l=function(){function t(t,e){this.sceneInteractor=t,this.assetInteractor=e}return t.prototype.load=function(){var t=this,e=this.sceneInteractor.getRoomIds().map(function(e){return t.sceneInteractor.getRoomById(e)}).filter(function(t){return t.hasBackgroundImage()}).map(function(t){var e=t.getBinaryFileData();return e.changingThisBreaksApplicationSecurity&&(e=e.changingThisBreaksApplicationSecurity),new s.AssetModel(t.getId(),t.getFileName(),e)}),n=this.sceneInteractor.getRoomIds().map(function(e){return t.sceneInteractor.getRoomById(e)}).reduce(function(t,e){var n=Array.from(e.getImages()).filter(function(t){return t.getBinaryFileData()}).map(function(t){var e=t.getBinaryFileData().changingThisBreaksApplicationSecurity?t.getBinaryFileData().changingThisBreaksApplicationSecurity:t.getBinaryFileData();return new s.AssetModel(t.getId(),t.getFileName(),e)});return t.concat(n)},[]),o=e.concat(n).concat(u);return this.assetInteractor.loadTextures(o)},t=o([i.Injectable(),r("design:paramtypes",[a.SceneInteractor,s.AssetInteractor])],t)}();e.TextureLoader=l},function(t,e,n){"use strict";(function(t){function o(){var e=new t.CircleGeometry(_.THREE_CONST.HOTSPOT_DIM,_.THREE_CONST.DASHCIRCLE_SEG),n=new t.LineDashedMaterial({color:16777215,dashSize:2,gapSize:2,linewidth:1});return e.vertices.shift(),e.computeLineDistances(),new t.Line(e,n)}var r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),s=n(12),c=n(76),u=n(109),l=n(277),p=n(93),d=n(278),h=n(1213),f=n(53),m=n(92),g=n(6),v=n(520),y=n(92),_=n(14),b=n(524),w=n(279),I=function(){function t(t,e,n,o,r,i,a,s){this.id=t,this.hotpostProperty=e,this.yamlId=e.getId(),this.type=u.RoomPropertyTypeService.getTypeString(e),this.graphicIcon=n,this.previewIcon=o,this.audioPlayService=r,this.goToRoom=i,this.activeState=0,this.activeStateLast=-1,this.graphicIcon.visible=!0,this.previewIcon.visible=!0,this.myWobble=Math.random()/1e3,this.label=a,this.rotation=s}return t.prototype.update=function(t){var e=this.graphicIcon.getWorldPosition();if(this.distanceToReticle=e.distanceTo(t),this.distanceToReticle>_.THREE_CONST.HOTSPOT_NEAR?this.activeState=0:this.distanceToReticle<_.THREE_CONST.HOTSPOT_NEAR&&this.distanceToReticle>_.THREE_CONST.HOTSPOT_ACTIVE?this.activeState=1:this.distanceToReticle<_.THREE_CONST.HOTSPOT_ACTIVE&&(this.activeState=2),this.activeState!==this.activeStateLast){switch(this.activeState){case 0:switch(this.activeStateLast){case 1:this.resetTweens(),this.graphic2preview();break;case 2:this.resetTweens(),this.graphic2preview(),this.deactivate()}break;case 1:switch(this.activeStateLast){case 0:this.resetTweens(),this.preview2graphic();break;case 2:this.resetTweens(),this.deactivate(),this.preview2graphic()}break;case 2:this.activate()}this.activeStateLast=this.activeState}if(0==this.activeState)if("door"==this.type){var n=.5+.5*Math.sin(performance.now()*(_.THREE_CONST.HOTSPOT_MOD_FREQ+this.myWobble));this.previewIcon.scale.set(n,n,1)}else{var n=Math.sin(performance.now()*(_.THREE_CONST.HOTSPOT_MOD_FREQ+this.myWobble))*_.THREE_CONST.HOTSPOT_MOD_MAG;this.previewIcon.scale.set(this.previewIcon.scale.x+n,this.previewIcon.scale.y+n,1)}},t.prototype.resetTweens=function(){this.tweenIconActivate&&this.tweenIconActivate.stop(),this.tweenIconDeactiveate&&this.tweenIconDeactiveate.stop(),this.tweenAudioActivate&&this.tweenAudioActivate.stop(),this.tweenDoorActivate&&this.tweenDoorActivate.stop(),this.tweenPlaneActivate&&this.tweenPlaneActivate.stop(),this.tweenPreviewIconIn&&this.tweenPreviewIconIn.stop(),this.tweenPreviewIconOut&&this.tweenPreviewIconOut.stop(),this.tweenGraphicIconin&&this.tweenGraphicIconin.stop(),this.tweenGraphicIconOut&&this.tweenGraphicIconOut.stop(),this.graphicIcon.scale.set(1,1,1)},t.prototype.activate=function(){var t=this;switch(this.type){case"image":case"text":case"link":this.plane.visible=!0,this.tweenPlaneActivate=new w.Tween(this.plane.scale).to({x:_.THREE_CONST.TWEEN_PLANE_SCALE,y:_.THREE_CONST.TWEEN_PLANE_SCALE,z:1},_.THREE_CONST.TWEEN_PLANE_IN).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){w.remove(t.tweenPlaneActivate)}).start(),this.tweenIconActivate=new w.Tween(this.graphicIcon.material).to({opacity:0},_.THREE_CONST.TWEEN_ICON_OUT).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){w.remove(t.tweenIconActivate),t.graphicIcon.visible=!1,t.label.visible=!1}).start();break;case"audio":this.tweenAudioActivate=new w.Tween(this.graphicIcon.scale).to({x:.001,y:.001,z:.001},_.THREE_CONST.HOTSPOT_AUDIO_DELAY).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){w.remove(t.tweenAudioActivate),t.graphicIcon.visible=!1,t.graphicIcon.scale.set(1,1,1),t.audioPlayService.playHotspotAudio(t.yamlId)}).start();break;case"door":var e=this.hotpostProperty.getRoomId();this.tweenDoorActivate=new w.Tween(this.graphicIcon.scale).to({x:.001,y:.001,z:.001},_.THREE_CONST.HOTSPOT_DOOR_DELAY).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){w.remove(t.tweenDoorActivate),t.graphicIcon.visible=!1,t.label.visible=!1,t.graphicIcon.scale.set(1,1,1),t.goToRoom(e,t.graphicIcon.position)}).start()}},t.prototype.deactivate=function(){var t=this;switch(this.type){case"image":case"text":case"link":this.tweenPlaneDeactivate=new w.Tween(this.plane.scale).to({x:.001,y:.001,z:1},_.THREE_CONST.TWEEN_PLANE_OUT).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){t.plane.visible=!1,w.remove(t.tweenPlaneActivate)}).start(),this.graphicIcon.visible=!0,this.tweenIconDeactiveate=new w.Tween(this.graphicIcon.material).to({opacity:1},_.THREE_CONST.TWEEN_ICON_IN).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){w.remove(t.tweenIconDeactiveate)}).start()}},t.prototype.graphic2preview=function(){var t=this;this.tweenPreviewIconOut&&this.tweenPreviewIconOut.stop(),this.tweenGraphicIconin&&this.tweenGraphicIconin.stop(),this.label.visible=!1,this.previewIcon.visible=!0,this.tweenPreviewIconIn=new w.Tween(this.previewIcon.scale).to({x:1,y:1,z:1},_.THREE_CONST.TWEEN_ICON_IN).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){w.remove(t.tweenPreviewIconIn)}).start(),this.tweenGraphicIconOut=new w.Tween(this.graphicIcon.material).to({opacity:0},_.THREE_CONST.TWEEN_ICON_OUT).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){t.graphicIcon.visible=!1,w.remove(t.tweenGraphicIconOut)}).start()},t.prototype.preview2graphic=function(){var t=this;this.tweenPreviewIconIn&&this.tweenPreviewIconIn.stop(),this.tweenGraphicIconOut&&this.tweenGraphicIconOut.stop(),this.tweenPreviewIconOut=new w.Tween(this.previewIcon.scale).to({x:.001,y:.001,z:.001},_.THREE_CONST.TWEEN_ICON_OUT).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){t.previewIcon.visible=!1,w.remove(t.tweenPreviewIconOut)}).start(),this.graphicIcon.visible=!0,this.tweenGraphicIconin=new w.Tween(this.graphicIcon.material).to({opacity:1},_.THREE_CONST.TWEEN_ICON_IN).easing(w.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){t.label.visible=!0,w.remove(t.tweenGraphicIconin)}).start()},t}(),E=function(){function e(t,e,n,o,r,i){this.sceneInteractor=t,this.assetInteractor=e,this.audioPlayService=n,this.roomManager=o,this.menuManager=r,this.eventBus=i,this.hotspotMap=new Map,this.doorTimerTheta=0,this.tempOutgoingRoomId="",this.lastRoomId="",this.activeHotspotId=""}return e.prototype.load=function(e,n,r){var i=this;this.onRoomChange=r,this.dashCircleLine=o(),this.cleanMaps(e);var a=this.sceneInteractor.getActiveRoomId();this.sceneInteractor.getRoomProperties(a).forEach(function(o){var a=o.getLocation(),s=m.getCoordinatePosition(a.getX(),a.getY()),c=(o.getName(),u.RoomPropertyTypeService.getTypeString(o)),l=new t.PlaneGeometry(_.THREE_CONST.HOTSPOT_DIM,_.THREE_CONST.HOTSPOT_DIM),p=i.assetInteractor.getTextureById(c),d=new t.MeshBasicMaterial({map:p,transparent:!0,side:t.FrontSide}),h=new t.Mesh(l,d),f=y.car2pol(s.x,s.y,s.z),g=y.pol2car(_.THREE_CONST.CAMERA_HOTSPOT,f.y,f.z);h.position.set(g.x,g.y,g.z),h.lookAt(n.position),h.material.opacity=0,e.add(h);var v=h.position,w=i.dashCircleLine.clone(),E=new t.Group;E.add(w),E.position.set(s.x,s.y,s.z),E.lookAt(n.position),E.visible=!0,e.add(E);var R={font:b.default.getBaseFont(),size:_.THREE_CONST.FONT_HOTSPOT_SIZE,height:_.THREE_CONST.FONT_HOTSPOT_HEIGHT,curveSegments:12,bevelEnabled:!1,bevelThickness:4,bevelSize:8,bevelSegments:5},x=new t.MeshBasicMaterial({color:16777215}),S=new t.TextGeometry(o.getName(),R);S.computeBoundingBox(),S.computeVertexNormals(),S.center();var P=new t.Mesh(S,x);P.position.set(s.x,s.y-40,s.z),P.lookAt(n.position),P.visible=!1,e.add(P);var T=new I(h.uuid,o,h,E,i.audioPlayService,r,P,v);if(i.hotspotMap.set(h.uuid,T),"image"===c){var O=o,C=i.buildExpandedImagePlane(O,n);e.add(C),i.hotspotMap.get(h.uuid).plane=C}else if("text"===c){var A=o,N=i.buildExpandedTextPlane(A,n);e.add(N),i.hotspotMap.get(h.uuid).plane=N}else if("link"===c){var k=o,M=i.buildExpandedLinkPlane(k,n);e.add(M),i.hotspotMap.get(h.uuid).plane=M}})},e.prototype.buildExpandedImagePlane=function(e,n){var o=this.assetInteractor.getTextureById(e.getId());if(o){var r=e.getLocation(),i=m.getCoordinatePosition(r.getX(),r.getY(),250),a=f.fitToMax(o.image.width,o.image.height,140),s=new t.PlaneGeometry(a.getX(),a.getY()),c=new t.MeshBasicMaterial({map:o,transparent:!0,side:t.FrontSide,alphaMap:this.assetInteractor.getTextureById("imageMask")}),u=new t.Mesh(s,c);return u.position.set(i.x,i.y,i.z),u.lookAt(n.position),u.material.opacity=1,u.scale.set(.001,.001,.001),u}return new t.Mesh},e.prototype.buildExpandedTextPlane=function(e,n){var o=e.getLocation(),r=m.getCoordinatePosition(o.getX(),o.getY(),250),i=h.buildMaterialFromText(e.body),a=f.fitToMax(i.width,i.height,140),s=new t.PlaneGeometry(a.getX(),a.getY()),c=new t.Mesh(s,i.material);return c.position.set(r.x,r.y,r.z),c.lookAt(n.position),c.material.opacity=1,c.scale.set(.001,.001,.001),c},e.prototype.buildExpandedLinkPlane=function(e,n){var o=e.getLocation(),r=m.getCoordinatePosition(o.getX(),o.getY(),250),i=h.buildMaterialFromText(e.body),a=f.fitToMax(i.width,i.height,140),s=new t.PlaneGeometry(a.getX(),a.getY()),c=new t.Mesh(s,i.material);return c.position.set(r.x,r.y,r.z),c.lookAt(n.position),c.material.opacity=1,c.scale.set(.001,.001,.001),c},e.prototype.cleanMaps=function(t){this.hotspotMap.forEach(function(e){v.cleanMeshMemory(e.graphicIcon),v.cleanMeshMemory(e.plane),t.remove(e.graphicIcon),t.remove(e.previewIcon),t.remove(e.plane)}),this.hotspotMap=new Map},e.prototype.getMeshList=function(){return Array.from(this.hotspotMap.values()).map(function(t){return t.graphicIcon})},e.prototype.getHotspot=function(t){return this.hotspotMap.get(t)},e.prototype.update=function(t,e){var n=t.getWorldPosition();this.hotspotMap.forEach(function(t,e){t.update(n)})},e=r([a.Injectable(),i("design:paramtypes",[s.SceneInteractor,c.AssetInteractor,l.AudioPlayService,p.RoomManager,d.MenuManager,g.EventBus])],e)}();e.HotspotManager=E}).call(e,n(24))},function(t,e,n){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function e(){}return e.prototype.load=function(){var e=this;return new Promise(function(n,o){(new t.FontLoader).load("assets/fonts/Nunito_Regular.json",function(t){e.font=t,n(t)},function(t){},function(t){return o(t)})})},e.prototype.getBaseFont=function(){return this.font},e}(),o=new n;e.default=o}).call(e,n(24))},function(t,e,n){"use strict";(function(t){var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(14),s=function(){function e(){this.reticleRaycaster=new t.Raycaster}return e.prototype.init=function(e,n){this.camera=e,this.vrCamera=n;var o=new t.RingGeometry(a.THREE_CONST.RETICLE_INNER,a.THREE_CONST.RETICLE_OUTER,a.THREE_CONST.RETICLE_SEGS),r=new t.MeshBasicMaterial({color:16777215,opacity:.5,transparent:!0,side:t.FrontSide}),i=new t.Mesh(o,r),s=new t.CircleGeometry(a.THREE_CONST.RETICLE_BACK_RADIUS,a.THREE_CONST.RETICLE_SEGS),c=new t.MeshBasicMaterial({color:0,opacity:.5,transparent:!0,side:t.FrontSide}),u=new t.Mesh(s,c),l=new t.Group;l.add(i),l.add(u),l.position.set(0,0,-1*a.THREE_CONST.CAMERA_RETICLE),this.touchReticle=l.clone(),this.vrReticle=l.clone(),this.vrReticle.visible=!1,this.camera.add(this.touchReticle),this.vrCamera.add(this.vrReticle)},e.prototype.showVrReticle=function(t){this.vrReticle.visible=t,this.touchReticle.visible=!t},e.prototype.getActiveReticle=function(t){return t?this.vrReticle:this.touchReticle},e.prototype.getRaycaster=function(){return this.reticleRaycaster},e.prototype.update=function(e){var n=e?this.vrCamera:this.camera,o=e?this.vrReticle:this.touchReticle;this.position=o.getWorldPosition(),this.reticleRaycaster.setFromCamera(new t.Vector2,n)},e=o([i.Injectable(),r("design:paramtypes",[])],e)}();e.Reticle=s}).call(e,n(24))},function(t,e,n){var o,r=r||function(t){"use strict";if(!(void 0===t||"undefined"!=typeof navigator&&/MSIE [1-9]\./.test(navigator.userAgent))){var e=t.document,n=function(){return t.URL||t.webkitURL||t},o=e.createElementNS("http://www.w3.org/1999/xhtml","a"),r="download"in o,i=function(t){var e=new MouseEvent("click");t.dispatchEvent(e)},a=/constructor/i.test(t.HTMLElement)||t.safari,s=/CriOS\/[\d]+/.test(navigator.userAgent),c=function(e){(t.setImmediate||t.setTimeout)(function(){throw e},0)},u=function(t){var e=function(){"string"==typeof t?n().revokeObjectURL(t):t.remove()};setTimeout(e,4e4)},l=function(t,e,n){e=[].concat(e);for(var o=e.length;o--;){var r=t["on"+e[o]];if("function"==typeof r)try{r.call(t,n||t)}catch(t){c(t)}}},p=function(t){return/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob([String.fromCharCode(65279),t],{type:t.type}):t},d=function(e,c,d){d||(e=p(e));var h,f=this,m=e.type,g="application/octet-stream"===m,v=function(){l(f,"writestart progress write writeend".split(" "))};if(f.readyState=f.INIT,r)return h=n().createObjectURL(e),void setTimeout(function(){o.href=h,o.download=c,i(o),v(),u(h),f.readyState=f.DONE});!function(){if((s||g&&a)&&t.FileReader){var o=new FileReader;return o.onloadend=function(){var e=s?o.result:o.result.replace(/^data:[^;]*;/,"data:attachment/file;");t.open(e,"_blank")||(t.location.href=e),e=void 0,f.readyState=f.DONE,v()},o.readAsDataURL(e),void(f.readyState=f.INIT)}if(h||(h=n().createObjectURL(e)),g)t.location.href=h;else{t.open(h,"_blank")||(t.location.href=h)}f.readyState=f.DONE,v(),u(h)}()},h=d.prototype,f=function(t,e,n){return new d(t,e||t.name||"download",n)};return"undefined"!=typeof navigator&&navigator.msSaveOrOpenBlob?function(t,e,n){return e=e||t.name||"download",n||(t=p(t)),navigator.msSaveOrOpenBlob(t,e)}:(h.abort=function(){},h.readyState=h.INIT=0,h.WRITING=1,h.DONE=2,h.error=h.onwritestart=h.onprogress=h.onwrite=h.onabort=h.onerror=h.onwriteend=null,f)}}("undefined"!=typeof self&&self||"undefined"!=typeof window&&window||this.content);void 0!==t&&t.exports?t.exports.saveAs=r:null!==n(1232)&&null!==n(1233)&&void 0!==(o=function(){return r}.call(e,n,e,t))&&(t.exports=o)},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(94),s=function(){function t(t){this.apiService=t}return t.prototype.getGroup=function(t){return this.apiService.getGroup(t)},t=o([i.Injectable(),r("design:paramtypes",[a.ApiService])],t)}();e.GroupInteractor=s},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(336),r=n(2),i=n(1093),a=n(1171);"PROD"===n(509)&&r.enableProdMode();var s={apiKey:"AIzaSyC5Q5Ie9To_fE2Yk8jOq1BCjIlV-9SEqQM",authDomain:"social-vr-161302.firebaseapp.com",databaseURL:"https://social-vr-161302.firebaseio.com",projectId:"social-vr-161302",storageBucket:"social-vr-161302.appspot.com",messagingSenderId:"613942124685"};i.initializeApp(s),o.platformBrowserDynamic().bootstrapModule(a.UiModule).catch(function(t){return console.error(t)})},function(t,e,n){var o=n(468);n(473),n(474),n(1147),n(1154),t.exports=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(1095),r=(n.n(o),n(1097)),i=(n.n(r),n(1098));n.n(i)},function(t,e,n){(function(t){var e=function(){if(void 0!==t)return t;if("undefined"!=typeof window)return window;if("undefined"!=typeof self)return self;throw new Error("unable to locate global object")}();"undefined"==typeof Promise&&(e.Promise=Promise=n(1096))}).call(e,n(47))},function(t,e){!function(e){function n(){}function o(t,e){return function(){t.apply(e,arguments)}}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],l(t,this)}function i(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,r._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?a:s)(e.promise,t._value);var o;try{o=n(t._value)}catch(t){return void s(e.promise,t)}a(e.promise,o)})}function a(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof r)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void l(o(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){s(t,e)}}function s(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn(function(){t._handled||r._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)i(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function l(t,e){var n=!1;try{t(function(t){n||(n=!0,a(e,t))},function(t){n||(n=!0,s(e,t))})}catch(t){if(n)return;n=!0,s(e,t)}}var p=setTimeout;r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,e){var o=new this.constructor(n);return i(this,new u(t,e,o)),o},r.all=function(t){var e=Array.prototype.slice.call(t);return new r(function(t,n){function o(i,a){try{if(a&&("object"==typeof a||"function"==typeof a)){var s=a.then;if("function"==typeof s)return void s.call(a,function(t){o(i,t)},n)}e[i]=a,0==--r&&t(e)}catch(t){n(t)}}if(0===e.length)return t([]);for(var r=e.length,i=0;i<e.length;i++)o(i,e[i])})},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r(function(e){e(t)})},r.reject=function(t){return new r(function(e,n){n(t)})},r.race=function(t){return new r(function(e,n){for(var o=0,r=t.length;o<r;o++)t[o].then(e,n)})},r._immediateFn="function"==typeof setImmediate&&function(t){setImmediate(t)}||function(t){p(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},void 0!==t&&t.exports?t.exports=r:e.Promise||(e.Promise=r)}(this)},function(t,e){Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var o=arguments[1],r=0;r<n;){var i=e[r];if(t.call(o,i,r,e))return i;r++}}})},function(t,e){Array.prototype.findIndex||Object.defineProperty(Array.prototype,"findIndex",{value:function(t){if(null==this)throw new TypeError('"this" is null or not defined');var e=Object(this),n=e.length>>>0;if("function"!=typeof t)throw new TypeError("predicate must be a function");for(var o=arguments[1],r=0;r<n;){var i=e[r];if(t.call(o,i,r,e))return r;r++}return-1}})},function(t,e,n){"use strict";function o(){function t(t){d(f[t],"delete"),delete f[t]}function e(t){return t=t||s,a(f,t)||r("no-app",{name:t}),f[t]}function n(t,e){void 0===e?e=s:"string"==typeof e&&""!==e||r("bad-app-name",{name:e+""}),a(f,e)&&r("duplicate-app",{name:e});var n=new u(t,e,v);return f[e]=n,d(n,"create"),n}function c(){return Object.keys(f).map(function(t){return f[t]})}function l(t,n,o,a,s){m[t]&&r("duplicate-service",{name:t}),m[t]=n,a&&(g[t]=a,c().forEach(function(t){a("create",t)}));var l=function(n){return void 0===n&&(n=e()),"function"!=typeof n[t]&&r("invalid-app-argument",{name:t}),n[t]()};return void 0!==o&&Object(i.deepExtend)(l,o),v[t]=l,u.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,s?e:[])},l}function p(t){Object(i.deepExtend)(v,t)}function d(t,e){Object.keys(m).forEach(function(n){var o=h(t,n);null!==o&&g[o]&&g[o](e,t)})}function h(t,e){if("serverAuth"===e)return null;var n=e;t.options;return n}var f={},m={},g={},v={__esModule:!0,initializeApp:n,app:e,apps:null,Promise:Promise,SDK_VERSION:"4.5.2",INTERNAL:{registerService:l,createFirebaseNamespace:o,extendNamespace:p,createSubscribe:i.createSubscribe,ErrorFactory:i.ErrorFactory,removeApp:t,factories:m,useAsService:h,Promise:Promise,deepExtend:i.deepExtend}};return Object(i.patchProperty)(v,"default",v),Object.defineProperty(v,"apps",{get:c}),Object(i.patchProperty)(e,"App",u),v}function r(t,e){throw p.create(t,e)}e.a=o;var i=n(3),a=(n.n(i),function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}),s="[DEFAULT]",c=[],u=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e,this.options_=Object(i.deepCopy)(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){c.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){c=c.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(o){e.push(t.services_[n][o])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=s),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==s?e:void 0,o=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=o}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;Object(i.deepExtend)(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(c.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),c=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&r("app-deleted",{name:this.name_})},t}();u.prototype.name&&u.prototype.options||u.prototype.delete||console.log("dc");var l={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},p=new i.ErrorFactory("app","Firebase",l)},function(t,e,n){"use strict";function o(t){return r(void 0,t)}function r(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var o in e)e.hasOwnProperty(o)&&(t[o]=r(t[o],e[o]));return t}function i(t,e,n){t[e]=n}Object.defineProperty(e,"__esModule",{value:!0}),e.deepCopy=o,e.deepExtend=r,e.patchProperty=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,o){n?e.reject(n):e.resolve(o),"function"==typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,o))}},t}();e.Deferred=o},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(253);e.getUA=function(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:""},e.isMobileCordova=function(){return"undefined"!=typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(e.getUA())},e.isReactNative=function(){return"object"==typeof navigator&&"ReactNative"===navigator.product},e.isNodeSdk=function(){return!0===o.CONSTANTS.NODE_CLIENT||!0===o.CONSTANTS.NODE_ADMIN}},function(t,e,n){"use strict";function o(t){var e=i;return i=t,e}Object.defineProperty(e,"__esModule",{value:!0});var r="FirebaseError",i=Error.captureStackTrace;e.patchCapture=o;var a=function(){function t(t,e){this.code=t,this.message=e;if(i)i(this,s.prototype.create);else{var n=Error.apply(this,arguments);this.name=r,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}return t}();e.FirebaseError=a,a.prototype=Object.create(Error.prototype),a.prototype.constructor=a,a.prototype.name=r;var s=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,o=this.errors[t],r=this.service+"/"+t;n=void 0===o?"Error":o.replace(this.pattern,function(t,n){var o=e[n];return void 0!==o?o.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+r+").";var i=new a(r,n);for(var s in e)e.hasOwnProperty(s)&&"_"!==s.slice(-1)&&(i[s]=e[s]);return i},t}();e.ErrorFactory=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(470),r=n(471);e.decode=function(t){var e={},n={},i={},a="";try{var s=t.split(".");e=r.jsonEval(o.base64Decode(s[0])||""),n=r.jsonEval(o.base64Decode(s[1])||""),a=s[2],i=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:i,signature:a}},e.isValidTimestamp=function(t){var n,o,r=e.decode(t).claims,i=Math.floor((new Date).getTime()/1e3);return"object"==typeof r&&(r.hasOwnProperty("nbf")?n=r.nbf:r.hasOwnProperty("iat")&&(n=r.iat),o=r.hasOwnProperty("exp")?r.exp:n+86400),i&&n&&o&&i>=n&&i<=o},e.issuedAtTime=function(t){var n=e.decode(t).claims;return"object"==typeof n&&n.hasOwnProperty("iat")?n.iat:null},e.isValidFormat=function(t){var n=e.decode(t),o=n.claims;return!!n.signature&&!!o&&"object"==typeof o&&o.hasOwnProperty("iat")},e.isAdmin=function(t){var n=e.decode(t).claims;return"object"==typeof n&&!0===n.admin}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(472);e.querystring=function(t){var e=[];return o.forEach(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},e.querystringDecode=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e}},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(1107),i=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return o(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"==typeof t)for(var o=0;o<16;o++)n[o]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(var o=0;o<16;o++)n[o]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(var o=16;o<80;o++){var r=n[o-3]^n[o-8]^n[o-14]^n[o-16];n[o]=4294967295&(r<<1|r>>>31)}for(var i,a,s=this.chain_[0],c=this.chain_[1],u=this.chain_[2],l=this.chain_[3],p=this.chain_[4],o=0;o<80;o++){o<40?o<20?(i=l^c&(u^l),a=1518500249):(i=c^u^l,a=1859775393):o<60?(i=c&u|l&(c|u),a=2400959708):(i=c^u^l,a=3395469782);var r=(s<<5|s>>>27)+i+p+a+n[o]&4294967295;p=l,l=u,u=4294967295&(c<<30|c>>>2),c=s,s=r}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+c&4294967295,this.chain_[2]=this.chain_[2]+u&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+p&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,o=0,r=this.buf_,i=this.inbuf_;o<e;){if(0==i)for(;o<=n;)this.compress_(t,o),o+=this.blockSize;if("string"==typeof t){for(;o<e;)if(r[i]=t.charCodeAt(o),++i,++o,i==this.blockSize){this.compress_(r),i=0;break}}else for(;o<e;)if(r[i]=t[o],++i,++o,i==this.blockSize){this.compress_(r),i=0;break}}this.inbuf_=i,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);for(var o=0,n=0;n<5;n++)for(var r=24;r>=0;r-=8)t[o]=this.chain_[n]>>r&255,++o;return t},e}(r.Hash);e.Sha1=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=function(){function t(){this.blockSize=-1}return t}();e.Hash=o},function(t,e,n){"use strict";function o(t,e){var n=new s(t,e);return n.subscribe.bind(n)}function r(t,e){return function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}}function i(t,e){if("object"!=typeof t||null===t)return!1;for(var n=0,o=e;n<o.length;n++){var r=o[n];if(r in t&&"function"==typeof t[r])return!0}return!1}function a(){}Object.defineProperty(e,"__esModule",{value:!0}),e.createSubscribe=o;var s=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var o,r=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");o=i(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===o.next&&(o.next=a),void 0===o.error&&(o.error=a),void 0===o.complete&&(o.complete=a);var s=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{r.finalError?o.error(r.finalError):o.complete()}catch(t){}}),this.observers.push(o),s},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!=typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}();e.async=r},function(t,e,n){"use strict";function o(t,e,n){var o="";switch(e){case 1:o=n?"first":"First";break;case 2:o=n?"second":"Second";break;case 3:o=n?"third":"Third";break;case 4:o=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var r=t+" failed: ";return r+=o+" argument "}function r(t,e,n,r){if((!r||n)&&"string"!=typeof n)throw new Error(o(t,e,r)+"must be a valid firebase namespace.")}function i(t,e,n,r){if((!r||n)&&"function"!=typeof n)throw new Error(o(t,e,r)+"must be a valid function.")}function a(t,e,n,r){if((!r||n)&&("object"!=typeof n||null===n))throw new Error(o(t,e,r)+"must be a valid context object.")}Object.defineProperty(e,"__esModule",{value:!0}),e.validateArgCount=function(t,e,n,o){var r;if(o<e?r="at least "+e:o>n&&(r=0===n?"none":"no more than "+n),r){var i=t+" failed: Was called with "+o+(1===o?" argument.":" arguments.")+" Expects "+r+".";throw new Error(i)}},e.errorPrefix=o,e.validateNamespace=r,e.validateCallback=i,e.validateContextObject=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(469);e.stringToByteArray=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var a=i-55296;r++,o.assert(r<t.length,"Surrogate pair missing trail surrogate.");i=65536+(a<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},e.stringLength=function(t){for(var e=0,n=0;n<t.length;n++){var o=t.charCodeAt(n);o<128?e++:o<2048?e+=2:o>=55296&&o<=56319?(e+=4,n++):e+=3}return e}},function(t,e,n){(function(t){var e=n(74).default;(function(){(function(){var t,n=n||{},o=this,r=function(t){return void 0!==t},i=function(t){return"string"==typeof t},a=function(t){return"boolean"==typeof t},s=function(){},c=function(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&void 0!==t.splice&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||void 0!==t.call&&void 0!==t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&void 0===t.call)return"object";return e},u=function(t){return null===t},l=function(t){return"array"==c(t)},p=function(t){var e=c(t);return"array"==e||"object"==e&&"number"==typeof t.length},d=function(t){return"function"==c(t)},h=function(t){var e=typeof t;return"object"==e&&null!=t||"function"==e},f=function(t,e,n){return t.call.apply(t.bind,arguments)},m=function(t,e,n){if(!t)throw Error();if(2<arguments.length){var o=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,o),t.apply(e,n)}}return function(){return t.apply(e,arguments)}},g=function(t,e,n){return g=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?f:m,g.apply(null,arguments)},v=function(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}},y=Date.now||function(){return+new Date},_=function(t,e){function n(){}n.prototype=e.prototype,t.Uc=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Og=function(t,n,o){for(var r=Array(arguments.length-2),i=2;i<arguments.length;i++)r[i-2]=arguments[i];return e.prototype[n].apply(t,r)}},b=function(t){if(Error.captureStackTrace)Error.captureStackTrace(this,b);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))};_(b,Error),b.prototype.name="CustomError";var w=function(t,e){for(var n=t.split("%s"),o="",r=Array.prototype.slice.call(arguments,1);r.length&&1<n.length;)o+=n.shift()+r.shift();return o+n.join("%s")},I=String.prototype.trim?function(t){return t.trim()}:function(t){return t.replace(/^[\s\xa0]+|[\s\xa0]+$/g,"")},E=function(t){return C.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(R,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(x,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(S,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(P,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(T,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(O,"&#0;")),t):t},R=/&/g,x=/</g,S=/>/g,P=/"/g,T=/'/g,O=/\x00/g,C=/[\x00&<>"']/,A=function(t,e){return-1!=t.indexOf(e)},N=function(t,e){return t<e?-1:t>e?1:0},k=function(t,e){e.unshift(t),b.call(this,w.apply(null,e)),e.shift()};_(k,b),k.prototype.name="AssertionError";var M=function(t,e,n,o){var r="Assertion failed";if(n){r+=": "+n;var i=o}else t&&(r+=": "+t,i=e);throw new k(""+r,i||[])},D=function(t,e,n){return t||M("",null,e,Array.prototype.slice.call(arguments,2)),t},j=function(t,e){throw new k("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))},L=function(t,e,n){return"number"==typeof t||M("Expected number but got %s: %s.",[c(t),t],e,Array.prototype.slice.call(arguments,2)),t},F=function(t,e,n){i(t)||M("Expected string but got %s: %s.",[c(t),t],e,Array.prototype.slice.call(arguments,2))},B=function(t,e,n){d(t)||M("Expected function but got %s: %s.",[c(t),t],e,Array.prototype.slice.call(arguments,2))},U=function(){this.Tc="",this.kf=H};U.prototype.qb=!0,U.prototype.ob=function(){return this.Tc},U.prototype.toString=function(){return"Const{"+this.Tc+"}"};var V=function(t){return t instanceof U&&t.constructor===U&&t.kf===H?t.Tc:(j("expected object of type Const, got '"+t+"'"),"type_error:Const")},H={},W=function(t){var e=new U;return e.Tc=t,e};W("");var z=function(){this.Lc="",this.lf=Q};z.prototype.qb=!0,z.prototype.ob=function(){return this.Lc},z.prototype.toString=function(){return"TrustedResourceUrl{"+this.Lc+"}"};var G,q=function(t){return t instanceof z&&t.constructor===z&&t.lf===Q?t.Lc:(j("expected object of type TrustedResourceUrl, got '"+t+"' of type "+c(t)),"type_error:TrustedResourceUrl")},Y=function(t,e){var n=V(t);if(!X.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(K,function(t,o){if(!Object.prototype.hasOwnProperty.call(e,o))throw Error('Found marker, "'+o+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[o],t instanceof U?V(t):encodeURIComponent(String(t))}),$(t)},K=/%{(\w+)}/g,X=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank(#|$)/i,Q={},$=function(t){var e=new z;return e.Lc=t,e},J=Array.prototype.indexOf?function(t,e,n){return D(null!=t.length),Array.prototype.indexOf.call(t,e,n)}:function(t,e,n){if(n=null==n?0:0>n?Math.max(0,t.length+n):n,i(t))return i(e)&&1==e.length?t.indexOf(e,n):-1;for(;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},Z=Array.prototype.forEach?function(t,e,n){D(null!=t.length),Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var o=t.length,r=i(t)?t.split(""):t,a=0;a<o;a++)a in r&&e.call(n,r[a],a,t)},tt=function(t,e){for(var n=i(t)?t.split(""):t,o=t.length-1;0<=o;--o)o in n&&e.call(void 0,n[o],o,t)},et=Array.prototype.map?function(t,e,n){return D(null!=t.length),Array.prototype.map.call(t,e,n)}:function(t,e,n){for(var o=t.length,r=Array(o),a=i(t)?t.split(""):t,s=0;s<o;s++)s in a&&(r[s]=e.call(n,a[s],s,t));return r},nt=Array.prototype.some?function(t,e,n){return D(null!=t.length),Array.prototype.some.call(t,e,n)}:function(t,e,n){for(var o=t.length,r=i(t)?t.split(""):t,a=0;a<o;a++)if(a in r&&e.call(n,r[a],a,t))return!0;return!1},ot=function(t){t:{for(var e=$o,n=t.length,o=i(t)?t.split(""):t,r=0;r<n;r++)if(r in o&&e.call(void 0,o[r],r,t)){e=r;break t}e=-1}return 0>e?null:i(t)?t.charAt(e):t[e]},rt=function(t,e){return 0<=J(t,e)},it=function(t,e){e=J(t,e);var n;return(n=0<=e)&&at(t,e),n},at=function(t,e){return D(null!=t.length),1==Array.prototype.splice.call(t,e,1).length},st=function(t,e){var n=0;tt(t,function(o,r){e.call(void 0,o,r,t)&&at(t,r)&&n++})},ct=function(t){return Array.prototype.concat.apply([],arguments)},ut=function(t){var e=t.length;if(0<e){for(var n=Array(e),o=0;o<e;o++)n[o]=t[o];return n}return[]},lt=function(t){return et(t,function(t){return t=t.toString(16),1<t.length?t:"0"+t}).join("")};t:{var pt=o.navigator;if(pt){var dt=pt.userAgent;if(dt){G=dt;break t}}G=""}var ht=function(t){return A(G,t)},ft=function(t,e){for(var n in t)e.call(void 0,t[n],n,t)},mt=function(t,e){for(var n in t)if(e.call(void 0,t[n],n,t))return!0;return!1},gt=function(t){var e,n=[],o=0;for(e in t)n[o++]=t[e];return n},vt=function(t){var e,n=[],o=0;for(e in t)n[o++]=e;return n},yt=function(t){for(var e in t)return!1;return!0},_t=function(t,e){for(var n in t)if(!(n in e)||t[n]!==e[n])return!1;for(n in e)if(!(n in t))return!1;return!0},bt=function(t){var e,n={};for(e in t)n[e]=t[e];return n},wt="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),It=function(t,e){for(var n,o,r=1;r<arguments.length;r++){o=arguments[r];for(n in o)t[n]=o[n];for(var i=0;i<wt.length;i++)n=wt[i],Object.prototype.hasOwnProperty.call(o,n)&&(t[n]=o[n])}},Et=function(t){return Et[" "](t),t};Et[" "]=s;var Rt,xt=function(t,e){var n=Ft;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)},St=ht("Opera"),Pt=ht("Trident")||ht("MSIE"),Tt=ht("Edge"),Ot=Tt||Pt,Ct=ht("Gecko")&&!(A(G.toLowerCase(),"webkit")&&!ht("Edge"))&&!(ht("Trident")||ht("MSIE"))&&!ht("Edge"),At=A(G.toLowerCase(),"webkit")&&!ht("Edge"),Nt=function(){var t=o.document;return t?t.documentMode:void 0};t:{var kt="",Mt=function(){var t=G;return Ct?/rv:([^\);]+)(\)|;)/.exec(t):Tt?/Edge\/([\d\.]+)/.exec(t):Pt?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):At?/WebKit\/(\S+)/.exec(t):St?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Mt&&(kt=Mt?Mt[1]:""),Pt){var Dt=Nt();if(null!=Dt&&Dt>parseFloat(kt)){Rt=String(Dt);break t}}Rt=kt}var jt,Lt=Rt,Ft={},Bt=function(t){return xt(t,function(){for(var e=0,n=I(String(Lt)).split("."),o=I(String(t)).split("."),r=Math.max(n.length,o.length),i=0;0==e&&i<r;i++){var a=n[i]||"",s=o[i]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=N(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||N(0==a[2].length,0==s[2].length)||N(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})},Ut=o.document;jt=Ut&&Pt?Nt()||("CSS1Compat"==Ut.compatMode?parseInt(Lt,10):5):void 0;var Vt,Ht=null,Wt=null,zt=function(t){var e="";return Gt(t,function(t){e+=String.fromCharCode(t)}),e},Gt=function(t,e){function n(e){for(;o<t.length;){var n=t.charAt(o++),r=Wt[n];if(null!=r)return r;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}qt();for(var o=0;;){var r=n(-1),i=n(0),a=n(64),s=n(64);if(64===s&&-1===r)break;e(r<<2|i>>4),64!=a&&(e(i<<4&240|a>>2),64!=s&&e(a<<6&192|s))}},qt=function(){if(!Ht){Ht={},Wt={};for(var t=0;65>t;t++)Ht[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),Wt[Ht[t]]=t,62<=t&&(Wt["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}},Yt=function(){this.Da=-1},Kt=function(t,e){this.Da=-1,this.Da=64,this.qc=o.Uint8Array?new Uint8Array(this.Da):Array(this.Da),this.Xc=this.rb=0,this.l=[],this.bg=t,this.Fe=e,this.Cg=o.Int32Array?new Int32Array(64):Array(64),r(Vt)||(Vt=o.Int32Array?new Int32Array(Zt):Zt),this.reset()};_(Kt,Yt);for(var Xt=[],Qt=0;63>Qt;Qt++)Xt[Qt]=0;var $t=ct(128,Xt);Kt.prototype.reset=function(){this.Xc=this.rb=0,this.l=o.Int32Array?new Int32Array(this.Fe):ut(this.Fe)};var Jt=function(t){var e=t.qc;D(e.length==t.Da);for(var n=t.Cg,o=0,r=0;r<e.length;)n[o++]=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],r=4*o;for(e=16;64>e;e++){r=0|n[e-15],o=0|n[e-2];var i=(0|n[e-16])+((r>>>7|r<<25)^(r>>>18|r<<14)^r>>>3)|0,a=(0|n[e-7])+((o>>>17|o<<15)^(o>>>19|o<<13)^o>>>10)|0;n[e]=i+a|0}o=0|t.l[0],r=0|t.l[1];var s=0|t.l[2],c=0|t.l[3],u=0|t.l[4],l=0|t.l[5],p=0|t.l[6];for(i=0|t.l[7],e=0;64>e;e++){var d=((o>>>2|o<<30)^(o>>>13|o<<19)^(o>>>22|o<<10))+(o&r^o&s^r&s)|0;a=u&l^~u&p,i=i+((u>>>6|u<<26)^(u>>>11|u<<21)^(u>>>25|u<<7))|0,a=a+(0|Vt[e])|0,a=i+(a+(0|n[e])|0)|0,i=p,p=l,l=u,u=c+a|0,c=s,s=r,r=o,o=a+d|0}t.l[0]=t.l[0]+o|0,t.l[1]=t.l[1]+r|0,t.l[2]=t.l[2]+s|0,t.l[3]=t.l[3]+c|0,t.l[4]=t.l[4]+u|0,t.l[5]=t.l[5]+l|0,t.l[6]=t.l[6]+p|0,t.l[7]=t.l[7]+i|0};Kt.prototype.update=function(t,e){r(e)||(e=t.length);var n=0,o=this.rb;if(i(t))for(;n<e;)this.qc[o++]=t.charCodeAt(n++),o==this.Da&&(Jt(this),o=0);else{if(!p(t))throw Error("message must be string or array");for(;n<e;){var a=t[n++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");this.qc[o++]=a,o==this.Da&&(Jt(this),o=0)}}this.rb=o,this.Xc+=e},Kt.prototype.digest=function(){var t=[],e=8*this.Xc;56>this.rb?this.update($t,56-this.rb):this.update($t,this.Da-(this.rb-56));for(var n=63;56<=n;n--)this.qc[n]=255&e,e/=256;for(Jt(this),n=e=0;n<this.bg;n++)for(var o=24;0<=o;o-=8)t[e++]=this.l[n]>>o&255;return t};var Zt=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],te=function(){Kt.call(this,8,ee)};_(te,Kt);var ee=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],ne=Object.freeze||function(t){return t},oe=function(){this.Ma=this.Ma,this.Ic=this.Ic};oe.prototype.Ma=!1,oe.prototype.isDisposed=function(){return this.Ma},oe.prototype.lb=function(){if(this.Ic)for(;this.Ic.length;)this.Ic.shift()()};var re=!Pt||9<=Number(jt),ie=Pt&&!Bt("9");!At||Bt("528"),Ct&&Bt("1.9b")||Pt&&Bt("8")||St&&Bt("9.5")||At&&Bt("528"),Ct&&!Bt("8")||Pt&&Bt("9");var ae=function(){if(!o.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return o.addEventListener("test",s,e),o.removeEventListener("test",s,e),t}(),se=function(t,e){this.type=t,this.currentTarget=this.target=e,this.defaultPrevented=this.Wa=!1,this.Ue=!0};se.prototype.stopPropagation=function(){this.Wa=!0},se.prototype.preventDefault=function(){this.defaultPrevented=!0,this.Ue=!1};var ce=function(t,e){se.call(this,t?t.type:""),this.relatedTarget=this.currentTarget=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=this.offsetY=this.offsetX=0,this.key="",this.charCode=this.keyCode=0,this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.R=null,t&&this.init(t,e)};_(ce,se);var ue=ne({2:"touch",3:"pen",4:"mouse"});ce.prototype.init=function(t,e){var n=this.type=t.type,o=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.currentTarget=e,e=t.relatedTarget){if(Ct){t:{try{Et(e.nodeName);var r=!0;break t}catch(t){}r=!1}r||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===o?(this.offsetX=At||void 0!==t.offsetX?t.offsetX:t.layerX,this.offsetY=At||void 0!==t.offsetY?t.offsetY:t.layerY,this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==o.clientX?o.clientX:o.pageX,this.clientY=void 0!==o.clientY?o.clientY:o.pageY,this.screenX=o.screenX||0,this.screenY=o.screenY||0),this.button=t.button,this.keyCode=t.keyCode||0,this.key=t.key||"",this.charCode=t.charCode||("keypress"==n?t.keyCode:0),this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=i(t.pointerType)?t.pointerType:ue[t.pointerType]||"",this.state=t.state,this.R=t,t.defaultPrevented&&this.preventDefault()},ce.prototype.stopPropagation=function(){ce.Uc.stopPropagation.call(this),this.R.stopPropagation?this.R.stopPropagation():this.R.cancelBubble=!0},ce.prototype.preventDefault=function(){ce.Uc.preventDefault.call(this);var t=this.R;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,ie)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},ce.prototype.Hf=function(){return this.R};var le="closure_listenable_"+(1e6*Math.random()|0),pe=0,de=function(t,e,n,o,r){this.listener=t,this.Mc=null,this.src=e,this.type=n,this.capture=!!o,this.vc=r,this.key=++pe,this.Bb=this.pc=!1},he=function(t){t.Bb=!0,t.listener=null,t.Mc=null,t.src=null,t.vc=null},fe=function(t){this.src=t,this.I={},this.jc=0};fe.prototype.add=function(t,e,n,o,r){var i=t.toString();(t=this.I[i])||(t=this.I[i]=[],this.jc++);var a=ge(t,e,o,r);return-1<a?(e=t[a],n||(e.pc=!1)):(e=new de(e,this.src,i,!!o,r),e.pc=n,t.push(e)),e},fe.prototype.remove=function(t,e,n,o){if(!((t=t.toString())in this.I))return!1;var r=this.I[t];return-1<(e=ge(r,e,n,o))&&(he(r[e]),at(r,e),0==r.length&&(delete this.I[t],this.jc--),!0)};var me=function(t,e){var n=e.type;n in t.I&&it(t.I[n],e)&&(he(e),0==t.I[n].length&&(delete t.I[n],t.jc--))};fe.prototype.td=function(t,e,n,o){t=this.I[t.toString()];var r=-1;return t&&(r=ge(t,e,n,o)),-1<r?t[r]:null},fe.prototype.hasListener=function(t,e){var n=r(t),o=n?t.toString():"",i=r(e);return mt(this.I,function(t){for(var r=0;r<t.length;++r)if(!(n&&t[r].type!=o||i&&t[r].capture!=e))return!0;return!1})};var ge=function(t,e,n,o){for(var r=0;r<t.length;++r){var i=t[r];if(!i.Bb&&i.listener==e&&i.capture==!!n&&i.vc==o)return r}return-1},ve="closure_lm_"+(1e6*Math.random()|0),ye={},_e=0,be=function(t,e,n,o,r){if(o&&o.once)Ee(t,e,n,o,r);else if(l(e))for(var i=0;i<e.length;i++)be(t,e[i],n,o,r);else n=Ne(n),t&&t[le]?t.listen(e,n,h(o)?!!o.capture:!!o,r):we(t,e,n,!1,o,r)},we=function(t,e,n,o,r,i){if(!e)throw Error("Invalid event type");var a=h(r)?!!r.capture:!!r,s=Ce(t);if(s||(t[ve]=s=new fe(t)),n=s.add(e,n,o,a,i),!n.Mc){if(o=Ie(),n.Mc=o,o.src=t,o.listener=n,t.addEventListener)ae||(r=a),void 0===r&&(r=!1),t.addEventListener(e.toString(),o,r);else{if(!t.attachEvent)throw Error("addEventListener and attachEvent are unavailable.");t.attachEvent(Se(e.toString()),o)}_e++}},Ie=function(){var t=Oe,e=re?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e},Ee=function(t,e,n,o,r){if(l(e))for(var i=0;i<e.length;i++)Ee(t,e[i],n,o,r);else n=Ne(n),t&&t[le]?Oo(t,e,n,h(o)?!!o.capture:!!o,r):we(t,e,n,!0,o,r)},Re=function(t,e,n,o,r){if(l(e))for(var i=0;i<e.length;i++)Re(t,e[i],n,o,r);else o=h(o)?!!o.capture:!!o,n=Ne(n),t&&t[le]?t.ga.remove(String(e),n,o,r):t&&(t=Ce(t))&&(e=t.td(e,n,o,r))&&xe(e)},xe=function(t){if("number"!=typeof t&&t&&!t.Bb){var e=t.src;if(e&&e[le])me(e.ga,t);else{var n=t.type,o=t.Mc;e.removeEventListener?e.removeEventListener(n,o,t.capture):e.detachEvent&&e.detachEvent(Se(n),o),_e--,(n=Ce(e))?(me(n,t),0==n.jc&&(n.src=null,e[ve]=null)):he(t)}}},Se=function(t){return t in ye?ye[t]:ye[t]="on"+t},Pe=function(t,e,n,o){var r=!0;if((t=Ce(t))&&(e=t.I[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var i=e[t];i&&i.capture==n&&!i.Bb&&(i=Te(i,o),r=r&&!1!==i)}return r},Te=function(t,e){var n=t.listener,o=t.vc||t.src;return t.pc&&xe(t),n.call(o,e)},Oe=function(t,e){if(t.Bb)return!0;if(!re){if(!e)t:{e=["window","event"];for(var n=o,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new ce(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.currentTarget;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;!e.Wa&&0<=i;i--){e.currentTarget=r[i];var a=Pe(r[i],t,!0,e);n=n&&a}for(i=0;!e.Wa&&i<r.length;i++)e.currentTarget=r[i],a=Pe(r[i],t,!1,e),n=n&&a}return n}return Te(t,new ce(e,this))},Ce=function(t){return t=t[ve],t instanceof fe?t:null},Ae="__closure_events_fn_"+(1e9*Math.random()>>>0),Ne=function(t){return D(t,"Listener can not be null."),d(t)?t:(D(t.handleEvent,"An object listener must have handleEvent method."),t[Ae]||(t[Ae]=function(e){return t.handleEvent(e)}),t[Ae])},ke=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/,Me=function(){this.xa="",this.jf=Fe};Me.prototype.qb=!0,Me.prototype.ob=function(){return this.xa},Me.prototype.toString=function(){return"SafeUrl{"+this.xa+"}"};var De=function(t){return t instanceof Me&&t.constructor===Me&&t.jf===Fe?t.xa:(j("expected object of type SafeUrl, got '"+t+"' of type "+c(t)),"type_error:SafeUrl")},je=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,Le=function(t){return t instanceof Me?t:(t=t.qb?t.ob():String(t),je.test(t)||(t="about:invalid#zClosurez"),Be(t))},Fe={},Be=function(t){var e=new Me;return e.xa=t,e};Be("about:blank");var Ue=function(t){var e=[];return He(new Ve,t,e),e.join("")},Ve=function(){this.Nc=void 0},He=function(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(l(e)){var o=e;e=o.length,n.push("[");for(var r="",i=0;i<e;i++)n.push(r),r=o[i],He(t,t.Nc?t.Nc.call(o,String(i),r):r,n),r=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){n.push("{"),i="";for(o in e)Object.prototype.hasOwnProperty.call(e,o)&&"function"!=typeof(r=e[o])&&(n.push(i),Ge(o,n),n.push(":"),He(t,t.Nc?t.Nc.call(e,o,r):r,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":Ge(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}},We={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},ze=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g,Ge=function(t,e){e.push('"',t.replace(ze,function(t){var e=We[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),We[t]=e),e}),'"')},qe=function(){};qe.prototype.je=null;var Ye,Ke=function(t){return t.je||(t.je=t.Cd())},Xe=function(){};_(Xe,qe),Xe.prototype.rc=function(){var t=Qe(this);return t?new ActiveXObject(t):new XMLHttpRequest},Xe.prototype.Cd=function(){var t={};return Qe(this)&&(t[0]=!0,t[1]=!0),t};var Qe=function(t){if(!t.Ee&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var o=e[n];try{return new ActiveXObject(o),t.Ee=o}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.Ee};Ye=new Xe;var $e=function(){};_($e,qe),$e.prototype.rc=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Je;throw Error("Unsupported browser")},$e.prototype.Cd=function(){return{}};var Je=function(){this.oa=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText=this.responseXML=null,this.oa.onload=g(this.Lf,this),this.oa.onerror=g(this.ze,this),this.oa.onprogress=g(this.Mf,this),this.oa.ontimeout=g(this.Nf,this)};t=Je.prototype,t.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.oa.open(t,e)},t.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.oa.send(t)}else this.oa.send()},t.abort=function(){this.oa.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.oa.contentType:""},t.Lf=function(){this.status=200,this.responseText=this.oa.responseText,Ze(this,4)},t.ze=function(){this.status=500,this.responseText="",Ze(this,4)},t.Nf=function(){this.ze()},t.Mf=function(){this.status=200,Ze(this,1)};var Ze=function(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()};Je.prototype.getAllResponseHeaders=function(){return"content-type: "+this.oa.contentType};var tn=function(t,e,n){this.Yf=n,this.wf=t,this.lg=e,this.Hc=0,this.wc=null};tn.prototype.get=function(){if(0<this.Hc){this.Hc--;var t=this.wc;this.wc=t.next,t.next=null}else t=this.wf();return t},tn.prototype.put=function(t){this.lg(t),this.Hc<this.Yf&&(this.Hc++,t.next=this.wc,this.wc=t)};var en,nn=function(t){o.setTimeout(function(){throw t},0)},on=function(){var t=o.MessageChannel;if(void 0===t&&"undefined"!=typeof window&&window.postMessage&&window.addEventListener&&!ht("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),o="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=g(function(t){"*"!=o&&t.origin!=o||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,o)}}}),void 0!==t&&!ht("Trident")&&!ht("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(r(n.next)){n=n.next;var t=n.me;n.me=null,t()}},function(t){i.next={me:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!=typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){o.setTimeout(t,0)}},rn=function(){this.bd=this.hb=null},an=new tn(function(){return new sn},function(t){t.reset()},100);rn.prototype.add=function(t,e){var n=an.get();n.set(t,e),this.bd?this.bd.next=n:(D(!this.hb),this.hb=n),this.bd=n},rn.prototype.remove=function(){var t=null;return this.hb&&(t=this.hb,this.hb=this.hb.next,this.hb||(this.bd=null),t.next=null),t};var sn=function(){this.next=this.scope=this.rd=null};sn.prototype.set=function(t,e){this.rd=t,this.scope=e,this.next=null},sn.prototype.reset=function(){this.next=this.scope=this.rd=null};var cn,un=function(t,e){cn||ln(),pn||(cn(),pn=!0),dn.add(t,e)},ln=function(){if(-1!=String(o.Promise).indexOf("[native code]")){var t=o.Promise.resolve(void 0);cn=function(){t.then(hn)}}else cn=function(){var t=hn;!d(o.setImmediate)||o.Window&&o.Window.prototype&&!ht("Edge")&&o.Window.prototype.setImmediate==o.setImmediate?(en||(en=on()),en(t)):o.setImmediate(t)}},pn=!1,dn=new rn,hn=function(){for(var t;t=dn.remove();){try{t.rd.call(t.scope)}catch(t){nn(t)}an.put(t)}pn=!1},fn=function(t,e){var n=(n=t&&t.ownerDocument)&&(n.defaultView||n.parentWindow)||o;void 0!==n[e]&&void 0!==n.Location&&void 0!==n.Element&&(n=t&&(t instanceof n[e]||!(t instanceof n.Location||t instanceof n.Element)),t=h(t)?t.constructor.displayName||t.constructor.name||Object.prototype.toString.call(t):void 0===t?"undefined":null===t?"null":typeof t,D(n,"Argument is not a %s (or a non-Element, non-Location mock); got: %s",e,t))},mn=!Pt||9<=Number(jt);!Ct&&!Pt||Pt&&9<=Number(jt)||Ct&&Bt("1.9.1"),Pt&&Bt("9");var gn=function(){this.xa="",this.hf=yn};gn.prototype.qb=!0,gn.prototype.ob=function(){return this.xa},gn.prototype.toString=function(){return"SafeHtml{"+this.xa+"}"};var vn=function(t){return t instanceof gn&&t.constructor===gn&&t.hf===yn?t.xa:(j("expected object of type SafeHtml, got '"+t+"' of type "+c(t)),"type_error:SafeHtml")},yn={};gn.prototype.Tf=function(t){return this.xa=t,this};var _n=function(t,e){fn(t,"HTMLScriptElement"),t.src=q(e)},bn=function(t){var e=document;return i(t)?e.getElementById(t):t},wn=function(t,e){ft(e,function(e,n){e&&e.qb&&(e=e.ob()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:In.hasOwnProperty(n)?t.setAttribute(In[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})},In={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},En=function(t,e,n){var o=arguments,r=document,a=String(o[0]),s=o[1];if(!mn&&s&&(s.name||s.type)){if(a=["<",a],s.name&&a.push(' name="',E(s.name),'"'),s.type){a.push(' type="',E(s.type),'"');var c={};It(c,s),delete c.type,s=c}a.push(">"),a=a.join("")}return a=r.createElement(a),s&&(i(s)?a.className=s:l(s)?a.className=s.join(" "):wn(a,s)),2<o.length&&Rn(r,a,o),a},Rn=function(t,e,n){function o(n){n&&e.appendChild(i(n)?t.createTextNode(n):n)}for(var r=2;r<n.length;r++){var a=n[r];!p(a)||h(a)&&0<a.nodeType?o(a):Z(xn(a)?ut(a):a,o)}},xn=function(t){if(t&&"number"==typeof t.length){if(h(t))return"function"==typeof t.item||"string"==typeof t.item;if(d(t))return"function"==typeof t.item}return!1},Sn=function(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0},Pn=function(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}},Tn=function(t,e){if(this.aa=0,this.za=void 0,this.kb=this.ua=this.w=null,this.uc=this.pd=!1,t!=s)try{var n=this;t.call(e,function(t){Vn(n,2,t)},function(t){if(!(t instanceof Qn))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}Vn(n,3,t)})}catch(t){Vn(this,3,t)}},On=function(){this.next=this.context=this.tb=this.Ua=this.child=null,this.Hb=!1};On.prototype.reset=function(){this.context=this.tb=this.Ua=this.child=null,this.Hb=!1};var Cn=new tn(function(){return new On},function(t){t.reset()},100),An=function(t,e,n){var o=Cn.get();return o.Ua=t,o.tb=e,o.context=n,o},Nn=function(t){if(t instanceof Tn)return t;var e=new Tn(s);return Vn(e,2,t),e},kn=function(t){return new Tn(function(e,n){n(t)})},Mn=function(t,e,n){Hn(t,e,n,null)||un(v(e,t))},Dn=function(t){return new Tn(function(e,n){var o=t.length,r=[];if(o)for(var i,a=function(t,n){o--,r[t]=n,0==o&&e(r)},s=function(t){n(t)},c=0;c<t.length;c++)i=t[c],Mn(i,v(a,c),s);else e(r)})},jn=function(t){return new Tn(function(e){var n=t.length,o=[];if(n)for(var r,i=function(t,r,i){n--,o[t]=r?{Gf:!0,value:i}:{Gf:!1,reason:i},0==n&&e(o)},a=0;a<t.length;a++)r=t[a],Mn(r,v(i,a,!0),v(i,a,!1));else e(o)})};Tn.prototype.then=function(t,e,n){return null!=t&&B(t,"opt_onFulfilled should be a function."),null!=e&&B(e,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),Un(this,d(t)?t:null,d(e)?e:null,n)},Sn(Tn);var Ln=function(t,e){return e=An(e,e,void 0),e.Hb=!0,Bn(t,e),t};Tn.prototype.g=function(t,e){return Un(this,null,t,e)},Tn.prototype.cancel=function(t){0==this.aa&&un(function(){var e=new Qn(t);Fn(this,e)},this)};var Fn=function(t,e){if(0==t.aa)if(t.w){var n=t.w;if(n.ua){for(var o=0,r=null,i=null,a=n.ua;a&&(a.Hb||(o++,a.child==t&&(r=a),!(r&&1<o)));a=a.next)r||(i=a);r&&(0==n.aa&&1==o?Fn(n,e):(i?(o=i,D(n.ua),D(null!=o),o.next==n.kb&&(n.kb=o),o.next=o.next.next):Gn(n),qn(n,r,3,e)))}t.w=null}else Vn(t,3,e)},Bn=function(t,e){t.ua||2!=t.aa&&3!=t.aa||zn(t),D(null!=e.Ua),t.kb?t.kb.next=e:t.ua=e,t.kb=e},Un=function(t,e,n,o){var i=An(null,null,null);return i.child=new Tn(function(t,a){i.Ua=e?function(n){try{var r=e.call(o,n);t(r)}catch(t){a(t)}}:t,i.tb=n?function(e){try{var i=n.call(o,e);!r(i)&&e instanceof Qn?a(e):t(i)}catch(t){a(t)}}:a}),i.child.w=t,Bn(t,i),i.child};Tn.prototype.zg=function(t){D(1==this.aa),this.aa=0,Vn(this,2,t)},Tn.prototype.Ag=function(t){D(1==this.aa),this.aa=0,Vn(this,3,t)};var Vn=function(t,e,n){0==t.aa&&(t===n&&(e=3,n=new TypeError("Promise cannot resolve to itself")),t.aa=1,Hn(n,t.zg,t.Ag,t)||(t.za=n,t.aa=e,t.w=null,zn(t),3!=e||n instanceof Qn||Kn(t,n)))},Hn=function(t,e,n,o){if(t instanceof Tn)return null!=e&&B(e,"opt_onFulfilled should be a function."),null!=n&&B(n,"opt_onRejected should be a function. Did you pass opt_context as the second argument instead of the third?"),Bn(t,An(e||s,n||null,o)),!0;if(Pn(t))return t.then(e,n,o),!0;if(h(t))try{var r=t.then;if(d(r))return Wn(t,r,e,n,o),!0}catch(t){return n.call(o,t),!0}return!1},Wn=function(t,e,n,o,r){var i=!1,a=function(t){i||(i=!0,n.call(r,t))},s=function(t){i||(i=!0,o.call(r,t))};try{e.call(t,a,s)}catch(t){s(t)}},zn=function(t){t.pd||(t.pd=!0,un(t.Bf,t))},Gn=function(t){var e=null;return t.ua&&(e=t.ua,t.ua=e.next,e.next=null),t.ua||(t.kb=null),null!=e&&D(null!=e.Ua),e};Tn.prototype.Bf=function(){for(var t;t=Gn(this);)qn(this,t,this.aa,this.za);this.pd=!1};var qn=function(t,e,n,o){if(3==n&&e.tb&&!e.Hb)for(;t&&t.uc;t=t.w)t.uc=!1;if(e.child)e.child.w=null,Yn(e,n,o);else try{e.Hb?e.Ua.call(e.context):Yn(e,n,o)}catch(t){Xn.call(null,t)}Cn.put(e)},Yn=function(t,e,n){2==e?t.Ua.call(t.context,n):t.tb&&t.tb.call(t.context,n)},Kn=function(t,e){t.uc=!0,un(function(){t.uc&&Xn.call(null,e)})},Xn=nn,Qn=function(t){b.call(this,t)};_(Qn,b),Qn.prototype.name="cancel";var $n=function(t,e){this.Qc=[],this.Ne=t,this.re=e||null,this.Pb=this.nb=!1,this.za=void 0,this.be=this.he=this.fd=!1,this.Yc=0,this.w=null,this.gd=0};$n.prototype.cancel=function(t){if(this.nb)this.za instanceof $n&&this.za.cancel();else{if(this.w){var e=this.w;delete this.w,t?e.cancel(t):0>=--e.gd&&e.cancel()}this.Ne?this.Ne.call(this.re,this):this.be=!0,this.nb||to(this,new so)}},$n.prototype.oe=function(t,e){this.fd=!1,Jn(this,t,e)};var Jn=function(t,e,n){t.nb=!0,t.za=n,t.Pb=!e,io(t)},Zn=function(t){if(t.nb){if(!t.be)throw new ao;t.be=!1}};$n.prototype.callback=function(t){Zn(this),eo(t),Jn(this,!0,t)};var to=function(t,e){Zn(t),eo(e),Jn(t,!1,e)},eo=function(t){D(!(t instanceof $n),"An execution sequence may not be initiated with a blocking Deferred.")},no=function(t,e){oo(t,null,e,void 0)},oo=function(t,e,n,o){D(!t.he,"Blocking Deferreds can not be re-used"),t.Qc.push([e,n,o]),t.nb&&io(t)};$n.prototype.then=function(t,e,n){var o,r,i=new Tn(function(t,e){o=t,r=e});return oo(this,o,function(t){t instanceof so?i.cancel():r(t)}),i.then(t,e,n)},Sn($n);var ro=function(t){return nt(t.Qc,function(t){return d(t[1])})},io=function(t){if(t.Yc&&t.nb&&ro(t)){var e=t.Yc,n=uo[e];n&&(o.clearTimeout(n.Qb),delete uo[e]),t.Yc=0}t.w&&(t.w.gd--,delete t.w),e=t.za;for(var i=n=!1;t.Qc.length&&!t.fd;){var a=t.Qc.shift(),s=a[0],c=a[1];if(a=a[2],s=t.Pb?c:s)try{var u=s.call(a||t.re,e);r(u)&&(t.Pb=t.Pb&&(u==e||u instanceof Error),t.za=e=u),(Pn(e)||"function"==typeof o.Promise&&e instanceof o.Promise)&&(i=!0,t.fd=!0)}catch(o){e=o,t.Pb=!0,ro(t)||(n=!0)}}t.za=e,i&&(u=g(t.oe,t,!0),i=g(t.oe,t,!1),e instanceof $n?(oo(e,u,i),e.he=!0):e.then(u,i)),n&&(e=new co(e),uo[e.Qb]=e,t.Yc=e.Qb)},ao=function(){b.call(this)};_(ao,b),ao.prototype.message="Deferred has already fired",ao.prototype.name="AlreadyCalledError";var so=function(){b.call(this)};_(so,b),so.prototype.message="Deferred was canceled",so.prototype.name="CanceledError";var co=function(t){this.Qb=o.setTimeout(g(this.yg,this),0),this.ba=t};co.prototype.yg=function(){throw D(uo[this.Qb],"Cannot throw an error that is not scheduled."),delete uo[this.Qb],this.ba};var uo={},lo=function(t){var e={},n=e.document||document,o=q(t),r=document.createElement("SCRIPT"),i={We:r,ic:void 0},a=new $n(ho,i),s=null,c=null!=e.timeout?e.timeout:5e3;return 0<c&&(s=window.setTimeout(function(){fo(r,!0),to(a,new mo(1,"Timeout reached for loading script "+o))},c),i.ic=s),r.onload=r.onreadystatechange=function(){r.readyState&&"loaded"!=r.readyState&&"complete"!=r.readyState||(fo(r,e.Pg||!1,s),a.callback(null))},r.onerror=function(){fo(r,!0,s),to(a,new mo(0,"Error while loading script "+o))},i=e.attributes||{},It(i,{type:"text/javascript",charset:"UTF-8"}),wn(r,i),_n(r,t),po(n).appendChild(r),a},po=function(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement},ho=function(){if(this&&this.We){var t=this.We;t&&"SCRIPT"==t.tagName&&fo(t,!0,this.ic)}},fo=function(t,e,n){null!=n&&o.clearTimeout(n),t.onload=s,t.onerror=s,t.onreadystatechange=s,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)},mo=function(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),b.call(this,n),this.code=t};_(mo,b);var go=function(t,e,n,o,r){this.reset(t,e,n,o,r)};go.prototype.te=null;var vo=0;go.prototype.reset=function(t,e,n,o,r){"number"==typeof r||vo++,o||y(),this.Vb=t,delete this.te},go.prototype.Xe=function(t){this.Vb=t};var yo=function(t){this.Le=t,this.Ae=this.kd=this.Vb=this.w=null},_o=function(t,e){this.name=t,this.value=e};_o.prototype.toString=function(){return this.name};var bo=new _o("SEVERE",1e3),wo=new _o("INFO",800),Io=new _o("CONFIG",700),Eo=new _o("FINE",500);yo.prototype.getName=function(){return this.Le},yo.prototype.getParent=function(){return this.w},yo.prototype.Xe=function(t){this.Vb=t};var Ro=function(t){return t.Vb?t.Vb:t.w?Ro(t.w):(j("Root logger has no level set."),null)};yo.prototype.log=function(t,e,n){if(t.value>=Ro(this).value)for(d(e)&&(e=e()),t=new go(t,String(e),this.Le),n&&(t.te=n),n=this;n;){var o=n,r=t;if(o.Ae)for(var i=0;e=o.Ae[i];i++)e(r);n=n.getParent()}},yo.prototype.info=function(t,e){this.log(wo,t,e)},yo.prototype.config=function(t,e){this.log(Io,t,e)};var xo={},So=null,Po=function(t){So||(So=new yo(""),xo[""]=So,So.Xe(Io));var e;if(!(e=xo[t])){e=new yo(t);var n=t.lastIndexOf("."),o=t.substr(n+1);n=Po(t.substr(0,n)),n.kd||(n.kd={}),n.kd[o]=e,e.w=n,xo[t]=e}return e},To=function(){oe.call(this),this.ga=new fe(this),this.nf=this,this.Kd=null};_(To,oe),To.prototype[le]=!0,t=To.prototype,t.addEventListener=function(t,e,n,o){be(this,t,e,n,o)},t.removeEventListener=function(t,e,n,o){Re(this,t,e,n,o)},t.dispatchEvent=function(t){Ao(this);var e=this.Kd;if(e)for(var n=[],o=1;e;e=e.Kd)n.push(e),D(1e3>++o,"infinite loop");if(e=this.nf,o=t.type||t,i(t))t=new se(t,e);else if(t instanceof se)t.target=t.target||e;else{var r=t;t=new se(o,e),It(t,r)}if(r=!0,n)for(var a=n.length-1;!t.Wa&&0<=a;a--){var s=t.currentTarget=n[a];r=Co(s,o,!0,t)&&r}if(t.Wa||(s=t.currentTarget=e,r=Co(s,o,!0,t)&&r,t.Wa||(r=Co(s,o,!1,t)&&r)),n)for(a=0;!t.Wa&&a<n.length;a++)s=t.currentTarget=n[a],r=Co(s,o,!1,t)&&r;return r},t.lb=function(){if(To.Uc.lb.call(this),this.ga){var t,e=this.ga,n=0;for(t in e.I){for(var o=e.I[t],r=0;r<o.length;r++)++n,he(o[r]);delete e.I[t],e.jc--}}this.Kd=null},t.listen=function(t,e,n,o){return Ao(this),this.ga.add(String(t),e,!1,n,o)};var Oo=function(t,e,n,o,r){t.ga.add(String(e),n,!0,o,r)},Co=function(t,e,n,o){if(!(e=t.ga.I[String(e)]))return!0;e=e.concat();for(var r=!0,i=0;i<e.length;++i){var a=e[i];if(a&&!a.Bb&&a.capture==n){var s=a.listener,c=a.vc||a.src;a.pc&&me(t.ga,a),r=!1!==s.call(c,o)&&r}}return r&&0!=o.Ue};To.prototype.td=function(t,e,n,o){return this.ga.td(String(t),e,n,o)},To.prototype.hasListener=function(t,e){return this.ga.hasListener(r(t)?String(t):void 0,e)};var Ao=function(t){D(t.ga,"Event target is not initialized. Did you call the superclass (goog.events.EventTarget) constructor?")},No="StopIteration"in o?o.StopIteration:{message:"StopIteration",stack:""},ko=function(){};ko.prototype.next=function(){throw No},ko.prototype.mf=function(){return this};var Mo=function(t,e){t&&t.log(Eo,e,void 0)},Do=function(t,e){this.ja={},this.C=[],this.gb=this.u=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var o=0;o<n;o+=2)this.set(arguments[o],arguments[o+1])}else t&&this.addAll(t)};t=Do.prototype,t.ha=function(){jo(this);for(var t=[],e=0;e<this.C.length;e++)t.push(this.ja[this.C[e]]);return t},t.va=function(){return jo(this),this.C.concat()},t.Jb=function(t){return Lo(this.ja,t)},t.clear=function(){this.ja={},this.gb=this.u=this.C.length=0},t.remove=function(t){return!!Lo(this.ja,t)&&(delete this.ja[t],this.u--,this.gb++,this.C.length>2*this.u&&jo(this),!0)};var jo=function(t){if(t.u!=t.C.length){for(var e=0,n=0;e<t.C.length;){var o=t.C[e];Lo(t.ja,o)&&(t.C[n++]=o),e++}t.C.length=n}if(t.u!=t.C.length){var r={};for(n=e=0;e<t.C.length;)o=t.C[e],Lo(r,o)||(t.C[n++]=o,r[o]=1),e++;t.C.length=n}};t=Do.prototype,t.get=function(t,e){return Lo(this.ja,t)?this.ja[t]:e},t.set=function(t,e){Lo(this.ja,t)||(this.u++,this.C.push(t),this.gb++),this.ja[t]=e},t.addAll=function(t){if(t instanceof Do){var e=t.va();t=t.ha()}else e=vt(t),t=gt(t);for(var n=0;n<e.length;n++)this.set(e[n],t[n])},t.forEach=function(t,e){for(var n=this.va(),o=0;o<n.length;o++){var r=n[o],i=this.get(r);t.call(e,i,r,this)}},t.clone=function(){return new Do(this)},t.mf=function(t){jo(this);var e=0,n=this.gb,o=this,r=new ko;return r.next=function(){if(n!=o.gb)throw Error("The map has changed since the iterator was created");if(e>=o.C.length)throw No;var r=o.C[e++];return t?r:o.ja[r]},r};var Lo=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},Fo=function(t){if(t.ha&&"function"==typeof t.ha)return t.ha();if(i(t))return t.split("");if(p(t)){for(var e=[],n=t.length,o=0;o<n;o++)e.push(t[o]);return e}return gt(t)},Bo=function(t){if(t.va&&"function"==typeof t.va)return t.va();if(!t.ha||"function"!=typeof t.ha){if(p(t)||i(t)){var e=[];t=t.length;for(var n=0;n<t;n++)e.push(n);return e}return vt(t)}},Uo=function(t,e,n){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,n);else if(p(t)||i(t))Z(t,e,n);else for(var o=Bo(t),r=Fo(t),a=r.length,s=0;s<a;s++)e.call(n,r[s],o&&o[s],t)},Vo=function(t,e,n){if(d(t))n&&(t=g(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=g(t.handleEvent,t)}return 2147483647<Number(e)?-1:o.setTimeout(t,e||0)},Ho=function(t){var e=null;return new Tn(function(n,o){-1==(e=Vo(function(){n(void 0)},t))&&o(Error("Failed to schedule timer."))}).g(function(t){throw o.clearTimeout(e),t})},Wo=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/,zo=function(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var o=t[n].indexOf("="),r=null;if(0<=o){var i=t[n].substring(0,o);r=t[n].substring(o+1)}else i=t[n];e(i,r?decodeURIComponent(r.replace(/\+/g," ")):"")}}},Go=function(t){To.call(this),this.headers=new Do,this.dd=t||null,this.Ca=!1,this.cd=this.b=null,this.Ub=this.Ke=this.Ec="",this.Qa=this.zd=this.zc=this.od=!1,this.Db=0,this.Vc=null,this.Oc="",this.Zc=this.hg=this.gf=!1};_(Go,To);var qo=Go.prototype,Yo=Po("goog.net.XhrIo");qo.T=Yo;var Ko=/^https?$/i,Xo=["POST","PUT"];Go.prototype.send=function(t,e,n,r){if(this.b)throw Error("[goog.net.XhrIo] Object is active with another request="+this.Ec+"; newUri="+t);e=e?e.toUpperCase():"GET",this.Ec=t,this.Ub="",this.Ke=e,this.od=!1,this.Ca=!0,this.b=this.dd?this.dd.rc():Ye.rc(),this.cd=Ke(this.dd?this.dd:Ye),this.b.onreadystatechange=g(this.Re,this),this.hg&&"onprogress"in this.b&&(this.b.onprogress=g(function(t){this.Qe(t,!0)},this),this.b.upload&&(this.b.upload.onprogress=g(this.Qe,this)));try{Mo(this.T,ar(this,"Opening Xhr")),this.zd=!0,this.b.open(e,String(t),!0),this.zd=!1}catch(t){return Mo(this.T,ar(this,"Error opening Xhr: "+t.message)),void this.ba(5,t)}t=n||"";var i=this.headers.clone();r&&Uo(r,function(t,e){i.set(e,t)}),r=ot(i.va()),n=o.FormData&&t instanceof o.FormData,!rt(Xo,e)||r||n||i.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),i.forEach(function(t,e){this.b.setRequestHeader(e,t)},this),this.Oc&&(this.b.responseType=this.Oc),"withCredentials"in this.b&&this.b.withCredentials!==this.gf&&(this.b.withCredentials=this.gf);try{nr(this),0<this.Db&&(this.Zc=Qo(this.b),Mo(this.T,ar(this,"Will abort after "+this.Db+"ms if incomplete, xhr2 "+this.Zc)),this.Zc?(this.b.timeout=this.Db,this.b.ontimeout=g(this.ic,this)):this.Vc=Vo(this.ic,this.Db,this)),Mo(this.T,ar(this,"Sending request")),this.zc=!0,this.b.send(t),this.zc=!1}catch(t){Mo(this.T,ar(this,"Send error: "+t.message)),this.ba(5,t)}};var Qo=function(t){return Pt&&Bt(9)&&"number"==typeof t.timeout&&r(t.ontimeout)},$o=function(t){return"content-type"==t.toLowerCase()};Go.prototype.ic=function(){void 0!==n&&this.b&&(this.Ub="Timed out after "+this.Db+"ms, aborting",Mo(this.T,ar(this,this.Ub)),this.dispatchEvent("timeout"),this.abort(8))},Go.prototype.ba=function(t,e){this.Ca=!1,this.b&&(this.Qa=!0,this.b.abort(),this.Qa=!1),this.Ub=e,Jo(this),er(this)};var Jo=function(t){t.od||(t.od=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))};Go.prototype.abort=function(){this.b&&this.Ca&&(Mo(this.T,ar(this,"Aborting")),this.Ca=!1,this.Qa=!0,this.b.abort(),this.Qa=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),er(this))},Go.prototype.lb=function(){this.b&&(this.Ca&&(this.Ca=!1,this.Qa=!0,this.b.abort(),this.Qa=!1),er(this,!0)),Go.Uc.lb.call(this)},Go.prototype.Re=function(){this.isDisposed()||(this.zd||this.zc||this.Qa?Zo(this):this.dg())},Go.prototype.dg=function(){Zo(this)};var Zo=function(t){if(t.Ca&&void 0!==n)if(t.cd[1]&&4==or(t)&&2==rr(t))Mo(t.T,ar(t,"Local request error detected and ignored"));else if(t.zc&&4==or(t))Vo(t.Re,0,t);else if(t.dispatchEvent("readystatechange"),4==or(t)){Mo(t.T,ar(t,"Request complete")),t.Ca=!1;try{var e=rr(t);t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var r=!0;break t;default:r=!1}var i;if(!(i=r)){var a;if(a=0===e){var s=String(t.Ec).match(Wo)[1]||null;if(!s&&o.self&&o.self.location){var c=o.self.location.protocol;s=c.substr(0,c.length-1)}a=!Ko.test(s?s.toLowerCase():"")}i=a}if(i)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var u=2<or(t)?t.b.statusText:""}catch(e){Mo(t.T,"Can not get status: "+e.message),u=""}t.Ub=u+" ["+rr(t)+"]",Jo(t)}}finally{er(t)}}};Go.prototype.Qe=function(t,e){D("progress"===t.type,"goog.net.EventType.PROGRESS is of the same type as raw XHR progress."),this.dispatchEvent(tr(t,"progress")),this.dispatchEvent(tr(t,e?"downloadprogress":"uploadprogress"))};var tr=function(t,e){return{type:e,lengthComputable:t.lengthComputable,loaded:t.loaded,total:t.total}},er=function(t,e){if(t.b){nr(t);var n=t.b,o=t.cd[0]?s:null;t.b=null,t.cd=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=o}catch(e){(t=t.T)&&t.log(bo,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}},nr=function(t){t.b&&t.Zc&&(t.b.ontimeout=null),t.Vc&&(o.clearTimeout(t.Vc),t.Vc=null)},or=function(t){return t.b?t.b.readyState:0},rr=function(t){try{return 2<or(t)?t.b.status:-1}catch(t){return-1}},ir=function(t){try{return t.b?t.b.responseText:""}catch(e){return Mo(t.T,"Can not get responseText: "+e.message),""}};Go.prototype.getResponse=function(){try{if(!this.b)return null;if("response"in this.b)return this.b.response;switch(this.Oc){case"":case"text":return this.b.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.b)return this.b.mozResponseArrayBuffer}var t=this.T;return t&&t.log(bo,"Response type "+this.Oc+" is not supported on this browser",void 0),null}catch(t){return Mo(this.T,"Can not get response: "+t.message),null}},Go.prototype.getResponseHeader=function(t){if(this.b&&4==or(this))return t=this.b.getResponseHeader(t),null===t?void 0:t},Go.prototype.getAllResponseHeaders=function(){return this.b&&4==or(this)?this.b.getAllResponseHeaders():""};var ar=function(t,e){return e+" ["+t.Ke+" "+t.Ec+" "+rr(t)+"]"},sr=function(t,e){if(this.pa=this.eb=this.qa="",this.vb=null,this.Pa=this.Ga="",this.da=this.Xf=!1,t instanceof sr){this.da=r(e)?e:t.da,cr(this,t.qa);var n=t.eb;mr(this),this.eb=n,ur(this,t.pa),lr(this,t.vb),pr(this,t.Ga),dr(this,t.ea.clone()),t=t.Pa,mr(this),this.Pa=t}else t&&(n=String(t).match(Wo))?(this.da=!!e,cr(this,n[1]||"",!0),t=n[2]||"",mr(this),this.eb=yr(t),ur(this,n[3]||"",!0),lr(this,n[4]),pr(this,n[5]||"",!0),dr(this,n[6]||"",!0),t=n[7]||"",mr(this),this.Pa=yr(t)):(this.da=!!e,this.ea=new Sr(null,0,this.da))};sr.prototype.toString=function(){var t=[],e=this.qa;e&&t.push(_r(e,wr,!0),":");var n=this.pa;return(n||"file"==e)&&(t.push("//"),(e=this.eb)&&t.push(_r(e,wr,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.vb)&&t.push(":",String(n))),(n=this.Ga)&&(this.pa&&"/"!=n.charAt(0)&&t.push("/"),t.push(_r(n,"/"==n.charAt(0)?Er:Ir,!0))),(n=this.ea.toString())&&t.push("?",n),(n=this.Pa)&&t.push("#",_r(n,xr)),t.join("")},sr.prototype.resolve=function(t){var e=this.clone(),n=!!t.qa;if(n?cr(e,t.qa):n=!!t.eb,n){var o=t.eb;mr(e),e.eb=o}else n=!!t.pa;if(n?ur(e,t.pa):n=null!=t.vb,o=t.Ga,n)lr(e,t.vb);else if(n=!!t.Ga){if("/"!=o.charAt(0))if(this.pa&&!this.Ga)o="/"+o;else{var r=e.Ga.lastIndexOf("/");-1!=r&&(o=e.Ga.substr(0,r+1)+o)}if(".."==(r=o)||"."==r)o="";else if(A(r,"./")||A(r,"/.")){o=0==r.lastIndexOf("/",0),r=r.split("/");for(var i=[],a=0;a<r.length;){var s=r[a++];"."==s?o&&a==r.length&&i.push(""):".."==s?((1<i.length||1==i.length&&""!=i[0])&&i.pop(),o&&a==r.length&&i.push("")):(i.push(s),o=!0)}o=i.join("/")}else o=r}return n?pr(e,o):n=""!==t.ea.toString(),n?dr(e,t.ea.clone()):n=!!t.Pa,n&&(t=t.Pa,mr(e),e.Pa=t),e},sr.prototype.clone=function(){return new sr(this)};var cr=function(t,e,n){mr(t),t.qa=n?yr(e,!0):e,t.qa&&(t.qa=t.qa.replace(/:$/,""))},ur=function(t,e,n){mr(t),t.pa=n?yr(e,!0):e},lr=function(t,e){if(mr(t),e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.vb=e}else t.vb=null},pr=function(t,e,n){mr(t),t.Ga=n?yr(e,!0):e},dr=function(t,e,n){mr(t),e instanceof Sr?(t.ea=e,t.ea.$d(t.da)):(n||(e=_r(e,Rr)),t.ea=new Sr(e,0,t.da))},hr=function(t,e,n){mr(t),t.ea.set(e,n)},fr=function(t,e){return t.ea.get(e)};sr.prototype.removeParameter=function(t){return mr(this),this.ea.remove(t),this};var mr=function(t){if(t.Xf)throw Error("Tried to modify a read-only Uri")};sr.prototype.$d=function(t){return this.da=t,this.ea&&this.ea.$d(t),this};var gr=function(t){return t instanceof sr?t.clone():new sr(t,void 0)},vr=function(t,e){var n=new sr(null,void 0);return cr(n,"https"),t&&ur(n,t),e&&pr(n,e),n},yr=function(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""},_r=function(t,e,n){return i(t)?(t=encodeURI(t).replace(e,br),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null},br=function(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)},wr=/[#\/\?@]/g,Ir=/[#\?:]/g,Er=/[#\?]/g,Rr=/[#\?@]/g,xr=/#/g,Sr=function(t,e,n){this.u=this.s=null,this.X=t||null,this.da=!!n},Pr=function(t){t.s||(t.s=new Do,t.u=0,t.X&&zo(t.X,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))},Tr=function(t){var e=Bo(t);if(void 0===e)throw Error("Keys are undefined");var n=new Sr(null,0,void 0);t=Fo(t);for(var o=0;o<e.length;o++){var r=e[o],i=t[o];l(i)?Or(n,r,i):n.add(r,i)}return n};t=Sr.prototype,t.add=function(t,e){Pr(this),this.X=null,t=this.ca(t);var n=this.s.get(t);return n||this.s.set(t,n=[]),n.push(e),this.u=L(this.u)+1,this},t.remove=function(t){return Pr(this),t=this.ca(t),!!this.s.Jb(t)&&(this.X=null,this.u=L(this.u)-this.s.get(t).length,this.s.remove(t))},t.clear=function(){this.s=this.X=null,this.u=0},t.Jb=function(t){return Pr(this),t=this.ca(t),this.s.Jb(t)},t.forEach=function(t,e){Pr(this),this.s.forEach(function(n,o){Z(n,function(n){t.call(e,n,o,this)},this)},this)},t.va=function(){Pr(this);for(var t=this.s.ha(),e=this.s.va(),n=[],o=0;o<e.length;o++)for(var r=t[o],i=0;i<r.length;i++)n.push(e[o]);return n},t.ha=function(t){Pr(this);var e=[];if(i(t))this.Jb(t)&&(e=ct(e,this.s.get(this.ca(t))));else{t=this.s.ha();for(var n=0;n<t.length;n++)e=ct(e,t[n])}return e},t.set=function(t,e){return Pr(this),this.X=null,t=this.ca(t),this.Jb(t)&&(this.u=L(this.u)-this.s.get(t).length),this.s.set(t,[e]),this.u=L(this.u)+1,this},t.get=function(t,e){return t=t?this.ha(t):[],0<t.length?String(t[0]):e};var Or=function(t,e,n){t.remove(e),0<n.length&&(t.X=null,t.s.set(t.ca(e),ut(n)),t.u=L(t.u)+n.length)};t=Sr.prototype,t.toString=function(){if(this.X)return this.X;if(!this.s)return"";for(var t=[],e=this.s.va(),n=0;n<e.length;n++){var o=e[n],r=encodeURIComponent(String(o));o=this.ha(o);for(var i=0;i<o.length;i++){var a=r;""!==o[i]&&(a+="="+encodeURIComponent(String(o[i]))),t.push(a)}}return this.X=t.join("&")},t.clone=function(){var t=new Sr;return t.X=this.X,this.s&&(t.s=this.s.clone(),t.u=this.u),t},t.ca=function(t){return t=String(t),this.da&&(t=t.toLowerCase()),t},t.$d=function(t){t&&!this.da&&(Pr(this),this.X=null,this.s.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(this.remove(e),Or(this,n,t))},this)),this.da=t},t.extend=function(t){for(var e=0;e<arguments.length;e++)Uo(arguments[e],function(t,e){this.add(e,t)},this)};var Cr,Ar={Kg:{qd:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",Wd:"https://securetoken.googleapis.com/v1/token",id:"p"},Lg:{qd:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",Wd:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Mg:{qd:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",Wd:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}},Nr=function(t){for(var e in Ar)if(Ar[e].id===t)return t=Ar[e],{firebaseEndpoint:t.qd,secureTokenEndpoint:t.Wd};return null};Cr=Nr("__EID__")?"__EID__":void 0;var kr=function(){var t=Jr();return Pt&&!!jt&&11==jt||/Edge\/\d+/.test(t)},Mr=function(){return o.window&&o.window.location.href||""},Dr=function(t,e){e=e||o.window;var n="about:blank";t&&(n=De(Le(t))),e.location.href=n},jr=function(t,e){var n,o=[];for(n in t)n in e?typeof t[n]!=typeof e[n]?o.push(n):l(t[n])?_t(t[n],e[n])||o.push(n):"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<jr(t[n],e[n]).length&&o.push(n):t[n]!==e[n]&&o.push(n):o.push(n);for(n in e)n in t||o.push(n);return o},Lr=function(){var t=Jr();return!((t="Chrome"!=Xr(t)?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!Pt||!jt||9<jt)},Fr=function(t){return t=(t||Jr()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))},Br=function(t){t=t||o.window;try{t.close()}catch(t){}},Ur=function(t,e,n){var o=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var r=(window.screen.availHeight-n)/2,i=(window.screen.availWidth-e)/2;e={width:e,height:n,top:0<r?r:0,left:0<i?i:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=Jr().toLowerCase(),o&&(e.target=o,A(n,"crios/")&&(e.target="_blank")),"Firefox"==Xr(Jr())&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),o=window,e=n instanceof Me?n:Le(void 0!==n.href?n.href:String(n)),n=t.target||n.target,r=[];for(a in t)switch(a){case"width":case"height":case"top":case"left":r.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:r.push(a+"="+(t[a]?1:0))}var a=r.join(",");if((ht("iPhone")&&!ht("iPod")&&!ht("iPad")||ht("iPad")||ht("iPod"))&&o.navigator&&o.navigator.standalone&&n&&"_self"!=n?(a=o.document.createElement("A"),fn(a,"HTMLAnchorElement"),e instanceof Me||e instanceof Me||(e=e.qb?e.ob():String(e),D(je.test(e))||(e="about:invalid#zClosurez"),e=Be(e)),a.href=De(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,o,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=o.open("",n,a),o=De(e),a&&(Ot&&A(o,";")&&(o="'"+o.replace(/'/g,"%27")+"'"),a.opener=null,t=W("b/12014412, meta tag with sanitized URL"),o='<META HTTP-EQUIV="refresh" content="0; url='+E(o)+'">',F(V(t),"must provide justification"),D(!/^[\s\xa0]*$/.test(V(t)),"must provide non-empty justification"),a.document.write(vn((new gn).Tf(o))),a.document.close())):(a=o.open(De(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a},Vr=function(t){return new Tn(function(e){var n=function(){Ho(2e3).then(function(){if(t&&!t.closed)return n();e()})};return n()})},Hr=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wr=function(){var t=null;return new Tn(function(e){"complete"==o.document.readyState?e():(t=function(){e()},Ee(window,"load",t))}).g(function(e){throw Re(window,"load",t),e})},zr=function(){return Gr(void 0)?Wr().then(function(){return new Tn(function(t,e){var n=o.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):kn(Error("Cordova must run in an Android or iOS file scheme."))},Gr=function(t){return t=t||Jr(),!("file:"!==oi()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))},qr=function(){var t=o.window;try{return!(!t||t==t.top)}catch(t){return!1}},Yr=function(){return e.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":e.INTERNAL.hasOwnProperty("node")?"Node":"Browser"},Kr=function(){var t=Yr();return"ReactNative"===t||"Node"===t},Xr=function(t){var e=t.toLowerCase();return A(e,"opera/")||A(e,"opr/")||A(e,"opios/")?"Opera":A(e,"iemobile")?"IEMobile":A(e,"msie")||A(e,"trident/")?"IE":A(e,"edge/")?"Edge":A(e,"firefox/")?"Firefox":A(e,"silk/")?"Silk":A(e,"blackberry")?"Blackberry":A(e,"webos")?"Webos":!A(e,"safari/")||A(e,"chrome/")||A(e,"crios/")||A(e,"android")?!A(e,"chrome/")&&!A(e,"crios/")||A(e,"edge/")?A(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":"Chrome":"Safari"},Qr={Fg:"FirebaseCore-web",Hg:"FirebaseUI-web"},$r=function(t,e){e=e||[];var n,o=[],r={};for(n in Qr)r[Qr[n]]=!0;for(n=0;n<e.length;n++)void 0!==r[e[n]]&&(delete r[e[n]],o.push(e[n]));return o.sort(),e=o,e.length||(e=["FirebaseCore-web"]),o=Yr(),("Browser"===o?Xr(Jr()):o)+"/JsCore/"+t+"/"+e.join(",")},Jr=function(){return o.navigator&&o.navigator.userAgent||""},Zr=function(t,e){t=t.split("."),e=e||o;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e},ti=function(){try{var t=o.localStorage,e=ci();if(t)return t.setItem(e,"1"),t.removeItem(e),!kr()||!!o.indexedDB}catch(t){}return!1},ei=function(){return(ni()||"chrome-extension:"===oi()||Gr())&&!Kr()&&ti()},ni=function(){return"http:"===oi()||"https:"===oi()},oi=function(){return o.location&&o.location.protocol||null},ri=function(t){return t=t||Jr(),!Fr(t)&&"Firefox"!=Xr(t)},ii=function(t){return void 0===t?null:Ue(t)},ai=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n},si=function(t){if(null!==t)return JSON.parse(t)},ci=function(t){return t||""+Math.floor(1e9*Math.random()).toString()},ui=function(t){return t=t||Jr(),"Safari"!=Xr(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)},li=function(){var t=o.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null},pi=function(){var t=o.navigator;return!t||"boolean"!=typeof t.onLine||!ni()&&"chrome-extension:"!==oi()&&void 0===t.connection||t.onLine},di=function(t,e,n,o){if(t>e)throw Error("Short delay should be less than long delay!");this.ug=t,this.ag=e,t=n||Jr(),o=o||Yr(),this.Wf=Fr(t)||"ReactNative"===o};di.prototype.get=function(){return this.Wf?this.ag:this.ug};var hi,fi=function(){var t=o.document;return!t||void 0===t.visibilityState||"visible"==t.visibilityState},mi=function(){var t=o.document,e=null;return fi()||!t?Nn():new Tn(function(n){e=function(){fi()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).g(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})},gi=function(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null},vi={};try{var yi={};Object.defineProperty(yi,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(yi,"abcd",{configurable:!0,enumerable:!0,value:2}),hi=2==yi.abcd}catch(t){hi=!1}var _i=function(t,e,n){hi?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n},bi=function(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&_i(t,n,e[n])},wi=function(t){var e={};return bi(e,t),e},Ii=function(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n},Ei=function(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var o=t[e[n]];if(void 0===o||null===o||""===o)return!1}return!0},Ri=function(t){var e=t;if("object"==typeof t&&null!=t){e="length"in t?[]:{};for(var n in t)_i(e,n,Ri(t[n]))}return e},xi="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),Si=["client_id","response_type","scope","redirect_uri","state"],Pi={Gg:{Dc:"locale",Zb:500,Yb:600,providerId:"facebook.com",Ud:Si},Ig:{Dc:null,Zb:500,Yb:620,providerId:"github.com",Ud:Si},Jg:{Dc:"hl",Zb:515,Yb:680,providerId:"google.com",Ud:Si},Ng:{Dc:"lang",Zb:485,Yb:705,providerId:"twitter.com",Ud:xi}},Ti=function(t){for(var e in Pi)if(Pi[e].providerId==t)return Pi[e];return null},Oi=function(t,e){this.code="auth/"+t,this.message=e||Ai[t]||""};_(Oi,Error),Oi.prototype.A=function(){return{code:this.code,message:this.message}},Oi.prototype.toJSON=function(){return this.A()};var Ci=function(t){var e=t&&t.code;return e?new Oi(e.substring(5),t.message):null},Ai={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"The user's credential is no longer valid. The user must sign in again.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},Ni=function(t,e,n,o,r){if(this.ma=t,this.Y=e||null,this.Eb=n||null,this.Yd=o||null,this.ba=r||null,!this.Eb&&!this.ba)throw new Oi("invalid-auth-event");if(this.Eb&&this.ba)throw new Oi("invalid-auth-event");if(this.Eb&&!this.Yd)throw new Oi("invalid-auth-event")};Ni.prototype.tc=function(){return this.Yd},Ni.prototype.getError=function(){return this.ba},Ni.prototype.A=function(){return{type:this.ma,eventId:this.Y,urlResponse:this.Eb,sessionId:this.Yd,error:this.ba&&this.ba.A()}};var ki=function(t){return t=t||{},t.type?new Ni(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&Ci(t.error)):null},Mi=function(t){var e="unauthorized-domain",n=void 0,o=gr(t);t=o.pa,o=o.qa,"chrome-extension"==o?n=w("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==o||"https"==o?n=w("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",Oi.call(this,e,n)};_(Mi,Oi);var Di=function(t){this.Zf=t.sub,y(),this.Mb=t.email||null,this.Rd=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.qf=!!t.is_anonymous||"anonymous"==this.Rd};Di.prototype.getEmail=function(){return this.Mb},Di.prototype.isAnonymous=function(){return this.qf};var ji=function(t){if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{var o=JSON.parse(zt(t));if(o.sub&&o.iss&&o.aud&&o.exp)return new Di(o)}catch(t){}return null},Li=function(t,e){return t.then(function(t){if(t.idToken){var n=ji(t.idToken);if(!n||e!=n.Zf)throw new Oi("user-mismatch");return t}throw new Oi("user-mismatch")}).g(function(t){throw t&&t.code&&"auth/user-not-found"==t.code?new Oi("user-mismatch"):t})},Fi=function(t,e){if(e.idToken||e.accessToken)e.idToken&&_i(this,"idToken",e.idToken),e.accessToken&&_i(this,"accessToken",e.accessToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new Oi("internal-error","failed to construct a credential");_i(this,"accessToken",e.oauthToken),_i(this,"secret",e.oauthTokenSecret)}_i(this,"providerId",t)};Fi.prototype.Ob=function(t){return Aa(t,Bi(this))},Fi.prototype.Fc=function(t,e){var n=Bi(this);return n.idToken=e,Na(t,n)},Fi.prototype.Gd=function(t,e){var n=Bi(this);return Li(ka(t,n),e)};var Bi=function(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,{postBody:Tr(e).toString(),requestUri:"http://localhost"}};Fi.prototype.A=function(){var t={providerId:this.providerId};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),t};var Ui=function(t,e){this.kg=e||[],bi(this,{providerId:t,isOAuthProvider:!0}),this.qe={},this.Ed=(Ti(t)||{}).Dc||null,this.nd=null};Ui.prototype.setCustomParameters=function(t){return this.qe=bt(t),this};var Vi=function(t){Ui.call(this,t,Si),this.Vd=[]};_(Vi,Ui),Vi.prototype.addScope=function(t){return rt(this.Vd,t)||this.Vd.push(t),this},Vi.prototype.ye=function(){return ut(this.Vd)},Vi.prototype.credential=function(t,e){if(!t&&!e)throw new Oi("argument-error","credential failed: must provide the ID token and/or the access token.");return new Fi(this.providerId,{idToken:t||null,accessToken:e||null})};var Hi=function(){Vi.call(this,"facebook.com")};_(Hi,Vi),_i(Hi,"PROVIDER_ID","facebook.com");var Wi=function(t){if(!t)throw new Oi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return h(t)&&(e=t.accessToken),(new Hi).credential(null,e)},zi=function(){Vi.call(this,"github.com")};_(zi,Vi),_i(zi,"PROVIDER_ID","github.com");var Gi=function(t){if(!t)throw new Oi("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return h(t)&&(e=t.accessToken),(new zi).credential(null,e)},qi=function(){Vi.call(this,"google.com"),this.addScope("profile")};_(qi,Vi),_i(qi,"PROVIDER_ID","google.com");var Yi=function(t,e){var n=t;return h(t)&&(n=t.idToken,e=t.accessToken),(new qi).credential(n,e)},Ki=function(){Ui.call(this,"twitter.com",xi)};_(Ki,Ui),_i(Ki,"PROVIDER_ID","twitter.com");var Xi=function(t,e){var n=t;if(h(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new Oi("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Fi("twitter.com",n)},Qi=function(t,e){this.Mb=t,this.Ld=e,_i(this,"providerId","password")};Qi.prototype.Ob=function(t){return is(t,es,{email:this.Mb,password:this.Ld})},Qi.prototype.Fc=function(t,e){return is(t,Xa,{idToken:e,email:this.Mb,password:this.Ld})},Qi.prototype.Gd=function(t,e){return Li(this.Ob(t),e)},Qi.prototype.A=function(){return{email:this.Mb,password:this.Ld}};var $i=function(){bi(this,{providerId:"password",isOAuthProvider:!1})};bi($i,{PROVIDER_ID:"password"});var Ji=function(t){if(!(t.verificationId&&t.$c||t.hc&&t.phoneNumber))throw new Oi("internal-error");this.U=t,_i(this,"providerId","phone")};Ji.prototype.Ob=function(t){return t.verifyPhoneNumber(Zi(this))},Ji.prototype.Fc=function(t,e){var n=Zi(this);return n.idToken=e,is(t,os,n)},Ji.prototype.Gd=function(t,e){var n=Zi(this);return n.operation="REAUTH",t=is(t,rs,n),Li(t,e)},Ji.prototype.A=function(){var t={providerId:"phone"};return this.U.verificationId&&(t.verificationId=this.U.verificationId),this.U.$c&&(t.verificationCode=this.U.$c),this.U.hc&&(t.temporaryProof=this.U.hc),this.U.phoneNumber&&(t.phoneNumber=this.U.phoneNumber),t};var Zi=function(t){return t.U.hc&&t.U.phoneNumber?{temporaryProof:t.U.hc,phoneNumber:t.U.phoneNumber}:{sessionInfo:t.U.verificationId,code:t.U.$c}},ta=function(t){try{this.tf=t||e.auth()}catch(t){throw new Oi("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}bi(this,{providerId:"phone",isOAuthProvider:!1})};ta.prototype.verifyPhoneNumber=function(t,e){var n=this.tf.f;return Nn(e.verify()).then(function(o){if(!i(o))throw new Oi("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(e.type){case"recaptcha":return is(n,Ya,{phoneNumber:t,recaptchaToken:o});default:throw new Oi("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})};var ea=function(t,e){if(!t)throw new Oi("missing-verification-id");if(!e)throw new Oi("missing-verification-code");return new Ji({verificationId:t,$c:e})};bi(ta,{PROVIDER_ID:"phone"});var na=function(t){if(t.temporaryProof&&t.phoneNumber)return new Ji({hc:t.temporaryProof,phoneNumber:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,o=t&&t.oauthTokenSecret;t=t&&t.oauthIdToken;try{switch(e){case"google.com":return Yi(t,n);case"facebook.com":return Wi(n);case"github.com":return Gi(n);case"twitter.com":return Xi(n,o);default:return new Vi(e).credential(t,n)}}catch(t){return null}},oa=function(t){if(!t.isOAuthProvider)throw new Oi("invalid-oauth-provider")},ra=function(t,e,n){Oi.call(this,t,n),t=e||{},t.email&&_i(this,"email",t.email),t.phoneNumber&&_i(this,"phoneNumber",t.phoneNumber),t.credential&&_i(this,"credential",t.credential)};_(ra,Oi),ra.prototype.A=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.A();return e&&It(t,e),t},ra.prototype.toJSON=function(){return this.A()};var ia=function(t){if(t.code){var e=t.code||"";0==e.indexOf("auth/")&&(e=e.substring(5));var n={credential:na(t)};if(t.email)n.email=t.email;else{if(!t.phoneNumber)return new Oi(e,t.message||void 0);n.phoneNumber=t.phoneNumber}return new ra(e,n,t.message)}return null},aa=function(t){this.Eg=t};_(aa,qe),aa.prototype.rc=function(){return new this.Eg},aa.prototype.Cd=function(){return{}};var sa,ca=function(t,n,r){var i="Node"==Yr();if(!(i=o.XMLHttpRequest||i&&e.INTERNAL.node&&e.INTERNAL.node.XMLHttpRequest))throw new Oi("internal-error","The XMLHttpRequest compatibility library was not found.");this.m=t,t=n||{},this.qg=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.rg=t.secureTokenTimeout||ua,this.Pc=bt(t.secureTokenHeaders||la),this.Df=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.Ef=t.firebaseTimeout||pa,this.mb=bt(t.firebaseHeaders||da),r&&(this.mb["X-Client-Version"]=r,this.Pc["X-Client-Version"]=r),this.vf=new $e,this.Dg=new aa(i)},ua=new di(3e4,6e4),la={"Content-Type":"application/x-www-form-urlencoded"},pa=new di(3e4,6e4),da={"Content-Type":"application/json"},ha=function(t,e){e?t.mb["X-Firebase-Locale"]=e:delete t.mb["X-Firebase-Locale"]},fa=function(t,e){e?(t.mb["X-Client-Version"]=e,t.Pc["X-Client-Version"]=e):(delete t.mb["X-Client-Version"],delete t.Pc["X-Client-Version"])},ma=function(t,e,n,o,r,i,a){pi()?(Lr()?t=g(t.tg,t):(sa||(sa=new Tn(function(t,e){ya(t,e)})),t=g(t.sg,t)),t(e,n,o,r,i,a)):n&&n(null)};ca.prototype.tg=function(t,e,n,o,r,i){var a="Node"==Yr(),s=Kr()?a?new Go(this.Dg):new Go:new Go(this.vf);if(i){s.Db=Math.max(0,i);var c=setTimeout(function(){s.dispatchEvent("timeout")},i)}s.listen("complete",function(){c&&clearTimeout(c);var t=null;try{t=JSON.parse(ir(this))||null}catch(e){t=null}e&&e(t)}),Oo(s,"ready",function(){c&&clearTimeout(c),this.Ma||(this.Ma=!0,this.lb())}),Oo(s,"timeout",function(){c&&clearTimeout(c),this.Ma||(this.Ma=!0,this.lb()),e&&e(null)}),s.send(t,n,o,r)};var ga=W("https://apis.google.com/js/client.js?onload=%{onload}"),va="__fcb"+Math.floor(1e6*Math.random()).toString(),ya=function(t,e){if(((window.gapi||{}).client||{}).request)t();else{o[va]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};var n=Y(ga,{onload:va});no(lo(n),function(){e(Error("CORS_UNSUPPORTED"))})}};ca.prototype.sg=function(t,e,n,o,r){var i=this;sa.then(function(){window.gapi.client.setApiKey(i.m);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:o,headers:r,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).g(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})};var _a=function(t,e){return new Tn(function(n,o){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?ma(t,t.qg+"?key="+encodeURIComponent(t.m),function(t){t?t.error?o(as(t)):t.access_token&&t.refresh_token?n(t):o(new Oi("internal-error")):o(new Oi("network-request-failed"))},"POST",Tr(e).toString(),t.Pc,t.rg.get()):o(new Oi("internal-error"))})},ba=function(t,e,n,o,r,i){var a=gr(t.Df+e);hr(a,"key",t.m),i&&hr(a,"cb",y().toString());var s="GET"==n;if(s)for(var c in o)o.hasOwnProperty(c)&&hr(a,c,o[c]);return new Tn(function(e,i){ma(t,a.toString(),function(t){t?t.error?i(as(t,r||{})):e(t):i(new Oi("network-request-failed"))},n,s?void 0:Ue(ai(o)),t.mb,t.Ef.get())})},wa=function(t){if(!ke.test(t.email))throw new Oi("invalid-email")},Ia=function(t){"email"in t&&wa(t)},Ea=function(t,e){return is(t,Fa,{identifier:e,continueUri:ni()?Mr():"http://localhost"}).then(function(t){return t.allProviders||[]})},Ra=function(t){return is(t,za,{}).then(function(t){return t.authorizedDomains||[]})},xa=function(t){if(!t.idToken)throw new Oi("internal-error")},Sa=function(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new Oi("internal-error")}else{if(!t.sessionInfo)throw new Oi("missing-verification-id");if(!t.code)throw new Oi("missing-verification-code")}};ca.prototype.signInAnonymously=function(){return is(this,Qa,{})},ca.prototype.updateEmail=function(t,e){return is(this,Ka,{idToken:t,email:e})},ca.prototype.updatePassword=function(t,e){return is(this,Xa,{idToken:t,password:e})};var Pa={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};ca.prototype.updateProfile=function(t,e){var n={idToken:t},o=[];return ft(Pa,function(t,r){var i=e[r];null===i?o.push(t):r in e&&(n[r]=i)}),o.length&&(n.deleteAttribute=o),is(this,Ka,n)},ca.prototype.sendPasswordResetEmail=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},It(t,e),is(this,Wa,t)},ca.prototype.sendEmailVerification=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},It(t,e),is(this,Ha,t)},ca.prototype.verifyPhoneNumber=function(t){return is(this,ns,t)};var Ta=function(t,e,n){return is(t,Ua,{idToken:e,deleteProvider:n})},Oa=function(t){if(!t.requestUri||!t.sessionId&&!t.postBody)throw new Oi("internal-error")},Ca=function(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=ia(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=ia(t)):"EMAIL_EXISTS"==t.errorMessage&&(t.code="email-already-in-use",e=ia(t)),e)throw e;if(!t.idToken)throw new Oi("internal-error")},Aa=function(t,e){return e.returnIdpCredential=!0,is(t,$a,e)},Na=function(t,e){return e.returnIdpCredential=!0,is(t,Za,e)},ka=function(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,is(t,Ja,e)},Ma=function(t){if(!t.oobCode)throw new Oi("invalid-action-code")};ca.prototype.confirmPasswordReset=function(t,e){return is(this,qa,{oobCode:t,newPassword:e})},ca.prototype.checkActionCode=function(t){return is(this,ja,{oobCode:t})},ca.prototype.applyActionCode=function(t){return is(this,Da,{oobCode:t})};var Da={endpoint:"setAccountInfo",F:Ma,cb:"email"},ja={endpoint:"resetPassword",F:Ma,$:function(t){if(!t.email||!t.requestType)throw new Oi("internal-error")}},La={endpoint:"signupNewUser",F:function(t){if(wa(t),!t.password)throw new Oi("weak-password")},$:xa,Aa:!0},Fa={endpoint:"createAuthUri"},Ba={endpoint:"deleteAccount",ab:["idToken"]},Ua={endpoint:"setAccountInfo",ab:["idToken","deleteProvider"],F:function(t){if(!l(t.deleteProvider))throw new Oi("internal-error")}},Va={endpoint:"getAccountInfo"},Ha={endpoint:"getOobConfirmationCode",ab:["idToken","requestType"],F:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new Oi("internal-error")},cb:"email"},Wa={endpoint:"getOobConfirmationCode",ab:["requestType"],F:function(t){if("PASSWORD_RESET"!=t.requestType)throw new Oi("internal-error");wa(t)},cb:"email"},za={ie:!0,endpoint:"getProjectConfig",De:"GET"},Ga={ie:!0,endpoint:"getRecaptchaParam",De:"GET",$:function(t){if(!t.recaptchaSiteKey)throw new Oi("internal-error")}},qa={endpoint:"resetPassword",F:Ma,cb:"email"},Ya={endpoint:"sendVerificationCode",ab:["phoneNumber","recaptchaToken"],cb:"sessionInfo"},Ka={endpoint:"setAccountInfo",ab:["idToken"],F:Ia,Aa:!0},Xa={endpoint:"setAccountInfo",ab:["idToken"],F:function(t){if(Ia(t),!t.password)throw new Oi("weak-password")},$:xa,Aa:!0},Qa={endpoint:"signupNewUser",$:xa,Aa:!0},$a={endpoint:"verifyAssertion",F:Oa,$:Ca,Aa:!0},Ja={endpoint:"verifyAssertion",F:Oa,$:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new Oi("user-not-found");if(!t.idToken)throw new Oi("internal-error")},Aa:!0},Za={endpoint:"verifyAssertion",F:function(t){if(Oa(t),!t.idToken)throw new Oi("internal-error")},$:Ca,Aa:!0},ts={endpoint:"verifyCustomToken",F:function(t){if(!t.token)throw new Oi("invalid-custom-token")},$:xa,Aa:!0},es={endpoint:"verifyPassword",F:function(t){if(wa(t),!t.password)throw new Oi("wrong-password")},$:xa,Aa:!0},ns={endpoint:"verifyPhoneNumber",F:Sa,$:xa},os={endpoint:"verifyPhoneNumber",F:function(t){if(!t.idToken)throw new Oi("internal-error");Sa(t)},$:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",ia(t);xa(t)}},rs={yf:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",F:Sa,$:xa},is=function(t,e,n){if(!Ei(n,e.ab))return kn(new Oi("internal-error"));var o,r=e.De||"POST";return Nn(n).then(e.F).then(function(){return e.Aa&&(n.returnSecureToken=!0),ba(t,e.endpoint,r,n,e.yf,e.ie||!1)}).then(function(t){return o=t}).then(e.$).then(function(){if(!e.cb)return o;if(!(e.cb in o))throw new Oi("internal-error");return o[e.cb]})},as=function(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",o={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=o[n]?new Oi(o[n]):null)return n;n=t.error&&t.error.message||"",o={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id"},It(o,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0;for(var r in o)if(0===n.indexOf(r))return new Oi(o[r],e);return!e&&t&&(e=ii(t)),new Oi("internal-error",e)},ss=function(t){this.Bg=t,this.yc=null,this.Id=cs(this)},cs=function(t){return fs().then(function(){return new Tn(function(e,n){Zr("gapi.iframes.getContext")().open({where:document.body,url:t.Bg,messageHandlersFilter:Zr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(o){t.yc=o,t.yc.restyle({setHideOnLeave:!1});var r=setTimeout(function(){n(Error("Network Error"))},ds.get()),i=function(){clearTimeout(r),e()};o.ping(i).then(i,function(){n(Error("Network Error"))})})})})};ss.prototype.sendMessage=function(t){var e=this;return this.Id.then(function(){return new Tn(function(n){e.yc.send(t.type,t,n,Zr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})};var us=function(t,e){t.Id.then(function(){t.yc.register("authEvent",e,Zr("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})},ls=W("https://apis.google.com/js/api.js?onload=%{onload}"),ps=new di(3e4,6e4),ds=new di(5e3,15e3),hs=null,fs=function(){return hs||(hs=new Tn(function(t,e){if(pi()){var n=function(){li(),Zr("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){li(),e(Error("Network Error"))},timeout:ps.get()})};if(Zr("gapi.iframes.Iframe"))t();else if(Zr("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();o[r]=function(){Zr("gapi.load")?n():e(Error("Network Error"))},r=Y(ls,{onload:r}),Nn(lo(r)).g(function(){e(Error("Network Error"))})}}else e(Error("Network Error"))}).g(function(t){throw hs=null,t}))},ms=function(t,e,n){this.B=t,this.m=e,this.o=n,this.fb=null,this.Ba=vr(this.B,"/__/auth/iframe"),hr(this.Ba,"apiKey",this.m),hr(this.Ba,"appName",this.o),this.P=null,this.M=[]};ms.prototype.ae=function(t){return this.fb=t,this},ms.prototype.Zd=function(t){return this.P=t,this},ms.prototype.toString=function(){return this.fb?hr(this.Ba,"v",this.fb):this.Ba.removeParameter("v"),this.P?hr(this.Ba,"eid",this.P):this.Ba.removeParameter("eid"),this.M.length?hr(this.Ba,"fw",this.M.join(",")):this.Ba.removeParameter("fw"),this.Ba.toString()};var gs=function(t,e,n,o,r){this.B=t,this.m=e,this.o=n,this.sf=o,this.fb=this.Y=this.Td=null,this.xb=r,this.P=null};gs.prototype.ae=function(t){return this.fb=t,this},gs.prototype.Zd=function(t){return this.P=t,this},gs.prototype.toString=function(){var t=vr(this.B,"/__/auth/handler");if(hr(t,"apiKey",this.m),hr(t,"appName",this.o),hr(t,"authType",this.sf),this.xb.isOAuthProvider){var n=this.xb;try{var o=e.app(this.o).auth().ia}catch(t){o=null}n.nd=o,hr(t,"providerId",this.xb.providerId),n=this.xb,o=ai(n.qe);for(var r in o)o[r]=o[r].toString();r=n.kg,o=bt(o);for(var i=0;i<r.length;i++){var a=r[i];a in o&&delete o[a]}n.Ed&&n.nd&&!o[n.Ed]&&(o[n.Ed]=n.nd),yt(o)||hr(t,"customParameters",ii(o))}if("function"==typeof this.xb.ye&&(n=this.xb.ye(),n.length&&hr(t,"scopes",n.join(","))),this.Td?hr(t,"redirectUrl",this.Td):t.removeParameter("redirectUrl"),this.Y?hr(t,"eventId",this.Y):t.removeParameter("eventId"),this.fb?hr(t,"v",this.fb):t.removeParameter("v"),this.mc)for(var s in this.mc)this.mc.hasOwnProperty(s)&&!fr(t,s)&&hr(t,s,this.mc[s]);return this.P?hr(t,"eid",this.P):t.removeParameter("eid"),s=vs(this.o),s.length&&hr(t,"fw",s.join(",")),t.toString()};var vs=function(t){try{return ut(e.app(t).auth().M)}catch(t){return[]}},ys=function(t,e,n,o,r){this.B=t,this.m=e,this.o=n,this.La=o||null,this.P=r||null,this.f=this.yd=this.we=null,this.ta=[],this.Ac=this.wa=null},_s=function(t){var e=Mr();return Ra(t).then(function(t){t:{var n=gr(e),o=n.qa;n=n.pa;for(var r=0;r<t.length;r++){var i=t[r],a=n,s=o;if(0==i.indexOf("chrome-extension://")?a=gr(i).pa==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Hr.test(i)?a=a==i:(i=i.split(".").join("\\."),a=new RegExp("^(.+\\."+i+"|"+i+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new Mi(Mr())})};t=ys.prototype,t.Sb=function(){if(this.Ac)return this.Ac;var t=this;return this.Ac=Wr().then(function(){if(!t.yd){var e=t.La,n=t.P,o=vs(t.o);e=new ms(t.B,t.m,t.o).ae(e).Zd(n),e.M=ut(o||[]),t.yd=e.toString()}t.xc=new ss(t.yd),Is(t)})},t.ec=function(t,e,n){var o=new Oi("popup-closed-by-user"),r=new Oi("web-storage-unsupported"),i=this,a=!1;return this.Ra().then(function(){Es(i).then(function(n){n||(t&&Br(t),e(r),a=!0)})}).g(function(){}).then(function(){if(!a)return Vr(t)}).then(function(){if(!a)return Ho(n).then(function(){e(o)})})},t.Ye=function(){var t=Jr();return!ri(t)&&!ui(t)},t.Be=function(){return!1},t.$b=function(t,e,n,o,r,i,a){if(!t)return kn(new Oi("popup-blocked"));if(a&&!ri())return this.Ra().g(function(e){Br(t),r(e)}),o(),Nn();this.wa||(this.wa=_s(bs(this)));var s=this;return this.wa.then(function(){var e=s.Ra().g(function(e){throw Br(t),r(e),e});return o(),e}).then(function(){if(oa(n),!a){var o=ws(s.B,s.m,s.o,e,n,null,i,s.La,void 0,s.P);Dr(o,t)}}).g(function(t){throw"auth/network-request-failed"==t.code&&(s.wa=null),t})};var bs=function(t){return t.f||(t.we=t.La?$r(t.La,vs(t.o)):null,t.f=new ca(t.m,Nr(t.P),t.we)),t.f};ys.prototype.ac=function(t,e,n){this.wa||(this.wa=_s(bs(this)));var o=this;return this.wa.then(function(){oa(e);var r=ws(o.B,o.m,o.o,t,e,Mr(),n,o.La,void 0,o.P);Dr(r)}).g(function(t){throw"auth/network-request-failed"==t.code&&(o.wa=null),t})},ys.prototype.Ra=function(){var t=this;return this.Sb().then(function(){return t.xc.Id}).g(function(){throw t.wa=null,new Oi("network-request-failed")})},ys.prototype.bf=function(){return!0};var ws=function(t,e,n,o,r,i,a,s,c,u){return t=new gs(t,e,n,o,r),t.Td=i,t.Y=a,i=t.ae(s),i.mc=bt(c||null),i.Zd(u).toString()},Is=function(t){if(!t.xc)throw Error("IfcHandler must be initialized!");us(t.xc,function(e){var n={};if(e&&e.authEvent){var o=!1;for(e=ki(e.authEvent),n=0;n<t.ta.length;n++)o=t.ta[n](e)||o;return n={},n.status=o?"ACK":"ERROR",Nn(n)}return n.status="ERROR",Nn(n)})},Es=function(t){var e={type:"webStorageSupport"};return t.Sb().then(function(){return t.xc.sendMessage(e)}).then(function(t){if(t&&t.length&&void 0!==t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})};ys.prototype.ib=function(t){this.ta.push(t)},ys.prototype.dc=function(t){st(this.ta,function(e){return e==t})};var Rs=function(t,e,n,r,i,a){if(_i(this,"type","recaptcha"),this.ad=this.Ib=null,this.Kb=!1,this.ne=e,this.Fa=n||{theme:"light",type:"image"},this.J=[],this.Fa.sitekey)throw new Oi("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.Bc="invisible"===this.Fa.size,!bn(e)||!this.Bc&&bn(e).hasChildNodes())throw new Oi("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.f=new ca(t,a||null,i||null),this.Jf=r||function(){return null};var s=this;this.Wc=[];var c=this.Fa.callback;this.Fa.callback=function(t){if(s.Lb(t),"function"==typeof c)c(t);else if("string"==typeof c){var e=Zr(c,o);"function"==typeof e&&e(t)}};var u=this.Fa["expired-callback"];this.Fa["expired-callback"]=function(){if(s.Lb(null),"function"==typeof u)u();else if("string"==typeof u){var t=Zr(u,o);"function"==typeof t&&t()}}};Rs.prototype.Lb=function(t){for(var e=0;e<this.Wc.length;e++)try{this.Wc[e](t)}catch(t){}};var xs=function(t,e){st(t.Wc,function(t){return t==e})};Rs.prototype.c=function(t){var e=this;return this.J.push(t),Ln(t,function(){it(e.J,t)}),t},Rs.prototype.Tb=function(){var t=this;return this.Ib?this.Ib:this.Ib=this.c(Nn().then(function(){if(ni())return Wr();throw new Oi("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return Os(As(),t.Jf())}).then(function(){return is(t.f,Ga,{})}).then(function(e){t.Fa.sitekey=e.recaptchaSiteKey}).g(function(e){throw t.Ib=null,e}))},Rs.prototype.render=function(){Ss(this);var t=this;return this.c(this.Tb().then(function(){if(null===t.ad){var e=t.ne;if(!t.Bc){var n=bn(e);e=En("DIV"),n.appendChild(e)}t.ad=grecaptcha.render(e,t.Fa)}return t.ad}))},Rs.prototype.verify=function(){Ss(this);var t=this;return this.c(this.render().then(function(e){return new Tn(function(n){var o=grecaptcha.getResponse(e);if(o)n(o);else{var r=function(e){e&&(xs(t,r),n(e))};t.Wc.push(r),t.Bc&&grecaptcha.execute(t.ad)}})}))};var Ss=function(t){if(t.Kb)throw new Oi("internal-error","RecaptchaVerifier instance has been destroyed.")};Rs.prototype.clear=function(){Ss(this),this.Kb=!0,As().ld--;for(var t=0;t<this.J.length;t++)this.J[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.Bc){t=bn(this.ne);for(var e;e=t.firstChild;)t.removeChild(e)}};var Ps=W("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),Ts=function(){this.ld=o.grecaptcha?1/0:0,this.Ce=null,this.jd="__rcb"+Math.floor(1e6*Math.random()).toString()},Os=function(t,e){return new Tn(function(n,r){if(pi())if(!o.grecaptcha||e!==t.Ce&&!t.ld){o[t.jd]=function(){if(o.grecaptcha){t.Ce=e;var i=o.grecaptcha.render;o.grecaptcha.render=function(e,n){return e=i(e,n),t.ld++,e},n()}else r(new Oi("internal-error"));delete o[t.jd]};var i=Y(Ps,{onload:t.jd,hl:e||""});Nn(lo(i)).g(function(){r(new Oi("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else n();else r(new Oi("network-request-failed"))})},Cs=null,As=function(){return Cs||(Cs=new Ts),Cs},Ns=function(t,n,o){try{this.i=o||e.app()}catch(t){throw new Oi("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.i.options||!this.i.options.apiKey)throw new Oi("invalid-api-key");o=this.i.options.apiKey;var r=this,i=null;try{i=ut(this.i.auth().M)}catch(t){}i=e.SDK_VERSION?$r(e.SDK_VERSION,i):null,Rs.call(this,o,t,n,function(){try{var t=r.i.auth().ia}catch(e){t=null}return t},i,Nr(Cr))};_(Ns,Rs);var ks=function(t){if(this.G=t||e.INTERNAL.reactNative&&e.INTERNAL.reactNative.AsyncStorage,!this.G)throw new Oi("internal-error","The React Native compatibility library was not found.")};t=ks.prototype,t.get=function(t){return Nn(this.G.getItem(t)).then(function(t){return t&&si(t)})},t.set=function(t,e){return Nn(this.G.setItem(t,ii(e)))},t.remove=function(t){return Nn(this.G.removeItem(t))},t.jb=function(){},t.$a=function(){};var Ms=function(){this.G={}};t=Ms.prototype,t.get=function(t){return Nn(this.G[t])},t.set=function(t,e){return this.G[t]=e,Nn()},t.remove=function(t){return delete this.G[t],Nn()},t.jb=function(){},t.$a=function(){};var Ds=function(){if(!js()){if("Node"==Yr())throw new Oi("internal-error","The LocalStorage compatibility library was not found.");throw new Oi("web-storage-unsupported")}this.G=o.localStorage||e.INTERNAL.node.localStorage},js=function(){var t="Node"==Yr();if(!(t=o.localStorage||t&&e.INTERNAL.node&&e.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}};t=Ds.prototype,t.get=function(t){var e=this;return Nn().then(function(){var n=e.G.getItem(t);return si(n)})},t.set=function(t,e){var n=this;return Nn().then(function(){var o=ii(e);null===o?n.remove(t):n.G.setItem(t,o)})},t.remove=function(t){var e=this;return Nn().then(function(){e.G.removeItem(t)})},t.jb=function(t){o.window&&be(o.window,"storage",t)},t.$a=function(t){o.window&&Re(o.window,"storage",t)};var Ls=function(){this.G={}};t=Ls.prototype,t.get=function(){return Nn(null)},t.set=function(){return Nn()},t.remove=function(){return Nn()},t.jb=function(){},t.$a=function(){};var Fs=function(){if(!Bs()){if("Node"==Yr())throw new Oi("internal-error","The SessionStorage compatibility library was not found.");throw new Oi("web-storage-unsupported")}this.G=o.sessionStorage||e.INTERNAL.node.sessionStorage},Bs=function(){var t="Node"==Yr();if(!(t=o.sessionStorage||t&&e.INTERNAL.node&&e.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}};t=Fs.prototype,t.get=function(t){var e=this;return Nn().then(function(){var n=e.G.getItem(t);return si(n)})},t.set=function(t,e){var n=this;return Nn().then(function(){var o=ii(e);null===o?n.remove(t):n.G.setItem(t,o)})},t.remove=function(t){var e=this;return Nn().then(function(){e.G.removeItem(t)})},t.jb=function(){},t.$a=function(){};var Us,Vs=function(t,e,n,r,i,a){if(!window.indexedDB)throw new Oi("web-storage-unsupported");this.zf=t,this.Hd=e,this.md=n,this.ff=r,this.gb=i,this.N={},this.fc=[],this.Wb=0,this.Rf=a||o.indexedDB},Hs=function(t){return new Tn(function(e,n){var o=t.Rf.open(t.zf,t.gb);o.onerror=function(t){n(Error(t.target.errorCode))},o.onupgradeneeded=function(e){e=e.target.result;try{e.createObjectStore(t.Hd,{keyPath:t.md})}catch(t){n(t)}},o.onsuccess=function(t){e(t.target.result)}})},Ws=function(t){return t.Ge||(t.Ge=Hs(t)),t.Ge},zs=function(t,e){return e.objectStore(t.Hd)},Gs=function(t,e,n){return e.transaction([t.Hd],n?"readwrite":"readonly")},qs=function(t){return new Tn(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(Error(t.target.errorCode))}})};t=Vs.prototype,t.set=function(t,e){var n,o=!1,r=this;return Ln(Ws(this).then(function(e){return n=e,e=zs(r,Gs(r,n,!0)),qs(e.get(t))}).then(function(i){var a=zs(r,Gs(r,n,!0));return i?(i.value=e,qs(a.put(i))):(r.Wb++,o=!0,i={},i[r.md]=t,i[r.ff]=e,qs(a.add(i)))}).then(function(){r.N[t]=e}),function(){o&&r.Wb--})},t.get=function(t){var e=this;return Ws(this).then(function(n){return qs(zs(e,Gs(e,n,!1)).get(t))}).then(function(t){return t&&t.value})},t.remove=function(t){var e=!1,n=this;return Ln(Ws(this).then(function(o){return e=!0,n.Wb++,qs(zs(n,Gs(n,o,!0)).delete(t))}).then(function(){delete n.N[t]}),function(){e&&n.Wb--})},t.xg=function(){var t=this;return Ws(this).then(function(e){var n=zs(t,Gs(t,e,!1));return n.getAll?qs(n.getAll()):new Tn(function(t,e){var o=[],r=n.openCursor();r.onsuccess=function(e){(e=e.target.result)?(o.push(e.value),e.continue()):t(o)},r.onerror=function(t){e(Error(t.target.errorCode))}})}).then(function(e){var n={},o=[];if(0==t.Wb){for(o=0;o<e.length;o++)n[e[o][t.md]]=e[o][t.ff];o=jr(t.N,n),t.N=n}return o})},t.jb=function(t){0==this.fc.length&&this.ce(),this.fc.push(t)},t.$a=function(t){st(this.fc,function(e){return e==t}),0==this.fc.length&&this.Sc()},t.ce=function(){var t=this;this.Sc();var e=function(){return t.Nd=Ho(800).then(g(t.xg,t)).then(function(e){0<e.length&&Z(t.fc,function(t){t(e)})}).then(e).g(function(t){"STOP_EVENT"!=t.message&&e()}),t.Nd};e()},t.Sc=function(){this.Nd&&this.Nd.cancel("STOP_EVENT")};var Ys,Ks=function(){this.se={Browser:Xs,Node:Qs,ReactNative:$s}[Yr()]},Xs={D:Ds,ee:Fs},Qs={D:Ds,ee:Fs},$s={D:ks,ee:Ls},Js=function(t){this.Bd(t)};Js.prototype.Bd=function(t){var e=t.url;if(void 0===e)throw new Oi("missing-continue-uri");if("string"!=typeof e||"string"==typeof e&&!e.length)throw new Oi("invalid-continue-uri");this.uf=e,this.ge=this.nc=null,this.He=!1;var n=t.android;if(n&&"object"==typeof n){e=n.packageName;var o=n.installApp;if(n=n.minimumVersion,"string"==typeof e&&e.length){if(this.nc=e,void 0!==o&&"boolean"!=typeof o)throw new Oi("argument-error","installApp property must be a boolean when specified.");if(this.He=!!o,void 0!==n&&("string"!=typeof n||"string"==typeof n&&!n.length))throw new Oi("argument-error","minimumVersion property must be a non empty string when specified.");this.ge=n||null}else{if(void 0!==e)throw new Oi("argument-error","packageName property must be a non empty string when specified.");if(void 0!==o||void 0!==n)throw new Oi("missing-android-pkg-name")}}else if(void 0!==n)throw new Oi("argument-error","android property must be a non null object when specified.");if(this.xd=null,(e=t.iOS)&&"object"==typeof e){if("string"==typeof(e=e.bundleId)&&e.length)this.xd=e;else if(void 0!==e)throw new Oi("argument-error","bundleId property must be a non empty string when specified.")}else if(void 0!==e)throw new Oi("argument-error","iOS property must be a non null object when specified.");if(void 0!==(t=t.handleCodeInApp)&&"boolean"!=typeof t)throw new Oi("argument-error","handleCodeInApp property must be a boolean when specified.");if((this.le=!!t)&&!this.xd&&!this.nc)throw new Oi("argument-error","handleCodeInApp property can't be true when no mobile application is provided.")};var Zs=function(t){var e={};e.continueUrl=t.uf,e.canHandleCodeInApp=t.le,(e.androidPackageName=t.nc)&&(e.androidMinimumVersion=t.ge,e.androidInstallApp=t.He),e.iOSBundleId=t.xd;for(var n in e)null===e[n]&&delete e[n];return e},tc=function(t,e){this.xf=e,_i(this,"verificationId",t)};tc.prototype.confirm=function(t){return t=ea(this.verificationId,t),this.xf(t)};var ec=function(t,e,n,o){return new ta(t).verifyPhoneNumber(e,n).then(function(t){return new tc(t,o)})},nc=function(t){var e={},n=t.email,o=t.newEmail;if(t=t.requestType,!n||!t)throw Error("Invalid provider user info!");e.fromEmail=o||null,e.email=n,_i(this,"operation",t),_i(this,"data",Ri(e))},oc=function(t,e,n,o,r,i){if(this.fg=t,this.mg=e,this.Kf=n,this.Gc=o,this.fe=r,this.ng=!!i,this.ub=null,this.Sa=this.Gc,this.fe<this.Gc)throw Error("Proactive refresh lower bound greater than upper bound!")};oc.prototype.start=function(){this.Sa=this.Gc,ic(this,!0)};var rc=function(t,e){return e?(t.Sa=t.Gc,t.Kf()):(e=t.Sa,t.Sa*=2,t.Sa>t.fe&&(t.Sa=t.fe),e)},ic=function(t,e){t.stop(),t.ub=Ho(rc(t,e)).then(function(){return t.ng?Nn():mi()}).then(function(){return t.fg()}).then(function(){ic(t,!0)}).g(function(e){t.mg(e)&&ic(t,!1)})};oc.prototype.stop=function(){this.ub&&(this.ub.cancel(),this.ub=null)};var ac=function(t){var e={};e["facebook.com"]=uc,e["google.com"]=pc,e["github.com"]=lc,e["twitter.com"]=dc;var n=t&&t.providerId;try{if(n)return e[n]?new e[n](t):new cc(t);if(void 0!==t.idToken)return new sc(t)}catch(t){}return null},sc=function(t){var e=t.providerId;if(!e&&t.idToken){var n=ji(t.idToken);n&&n.Rd&&(e=n.Rd)}if(!e)throw Error("Invalid additional user info!");t=!!t.isNewUser,_i(this,"providerId",e),_i(this,"isNewUser",t)},cc=function(t){sc.call(this,t),t=si(t.rawUserInfo||"{}"),_i(this,"profile",Ri(t||{}))};_(cc,sc);var uc=function(t){if(cc.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider id!")};_(uc,cc);var lc=function(t){if(cc.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider id!");_i(this,"username",this.profile&&this.profile.login||null)};_(lc,cc);var pc=function(t){if(cc.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider id!")};_(pc,cc);var dc=function(t){if(cc.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider id!");_i(this,"username",t.screenName||null)};_(dc,cc);var hc,fc={LOCAL:"local",NONE:"none",SESSION:"session"},mc=function(t){var e=new Oi("invalid-persistence-type"),n=new Oi("unsupported-persistence-type");t:{for(o in fc)if(fc[o]==t){var o=!0;break t}o=!1}if(!o||"string"!=typeof t)throw e;switch(Yr()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!ti()&&"none"!==t)throw n}},gc=function(t,e,n,o){this.Me=t,this.Xd=e,this.og=n,this.Ve=o,this.S={},Ys||(Ys=new Ks),t=Ys;try{if(kr()){Us||(Us=new Vs("firebaseLocalStorageDb","firebaseLocalStorage","fbase_key","value",1));var r=Us}else r=new t.se.D;this.Se=r}catch(t){this.Se=new Ms,this.Ve=!0}try{this.af=new t.se.ee}catch(t){this.af=new Ms}this.Qf=new Ms,this.de=g(this.Ze,this),this.N={}},vc=function(){return hc||(hc=new gc("firebase",":",!(ui(Jr())||!qr()),ri())),hc},yc=function(t,e){switch(e){case"session":return t.af;case"none":return t.Qf;default:return t.Se}};t=gc.prototype,t.ca=function(t,e){return this.Me+this.Xd+t.name+(e?this.Xd+e:"")},t.get=function(t,e){return yc(this,t.D).get(this.ca(t,e))},t.remove=function(t,e){return e=this.ca(t,e),"local"==t.D&&(this.N[e]=null),yc(this,t.D).remove(e)},t.set=function(t,e,n){var o=this.ca(t,n),r=this,i=yc(this,t.D);return i.set(o,e).then(function(){return i.get(o)}).then(function(e){"local"==t.D&&(r.N[o]=e)})},t.addListener=function(t,e,n){t=this.ca(t,e),void 0!==o.localStorage&&"function"==typeof o.localStorage.getItem&&(this.N[t]=o.localStorage.getItem(t)),yt(this.S)&&this.ce(),this.S[t]||(this.S[t]=[]),this.S[t].push(n)},t.removeListener=function(t,e,n){t=this.ca(t,e),this.S[t]&&(st(this.S[t],function(t){return t==n}),0==this.S[t].length&&delete this.S[t]),yt(this.S)&&this.Sc()},t.ce=function(){yc(this,"local").jb(this.de),this.Ve||kr()||_c(this)};var _c=function(t){bc(t),t.Fd=setInterval(function(){for(var e in t.S){var n=o.localStorage.getItem(e),r=t.N[e];n!=r&&(t.N[e]=n,n=new ce({type:"storage",key:e,target:window,oldValue:r,newValue:n,Md:!0}),t.Ze(n))}},1e3)},bc=function(t){t.Fd&&(clearInterval(t.Fd),t.Fd=null)};gc.prototype.Sc=function(){yc(this,"local").$a(this.de),bc(this)},gc.prototype.Ze=function(t){if(t&&t.Hf){var e=t.R.key;if(null==e)for(var n in this.S){var r=this.N[n];void 0===r&&(r=null);var i=o.localStorage.getItem(n);i!==r&&(this.N[n]=i,this.hd(n))}else if(0==e.indexOf(this.Me+this.Xd)&&this.S[e]){if(void 0!==t.R.Md?yc(this,"local").$a(this.de):bc(this),this.og)if(n=o.localStorage.getItem(e),(r=t.R.newValue)!==n)null!==r?o.localStorage.setItem(e,r):o.localStorage.removeItem(e);else if(this.N[e]===r&&void 0===t.R.Md)return;var a=this;n=function(){void 0===t.R.Md&&a.N[e]===o.localStorage.getItem(e)||(a.N[e]=o.localStorage.getItem(e),a.hd(e))},Pt&&jt&&10==jt&&o.localStorage.getItem(e)!==t.R.newValue&&t.R.newValue!==t.R.oldValue?setTimeout(n,10):n()}}else Z(t,g(this.hd,this))},gc.prototype.hd=function(t){this.S[t]&&Z(this.S[t],function(t){t()})};var wc=function(t,e){this.j=t,this.h=e||vc()},Ic={name:"authEvent",D:"local"},Ec=function(t){return t.h.get(Ic,t.j).then(function(t){return ki(t)})};wc.prototype.ib=function(t){this.h.addListener(Ic,this.j,t)},wc.prototype.dc=function(t){this.h.removeListener(Ic,this.j,t)};var Rc=function(t){this.h=t||vc()},xc={name:"sessionId",D:"session"};Rc.prototype.tc=function(t){return this.h.get(xc,t)};var Sc=function(t,e,n,o,r,i,a){this.B=t,this.m=e,this.o=n,this.La=o||null,this.P=a||null,this.$e=e+":"+n,this.pg=new Rc,this.xe=new wc(this.$e),this.Ad=null,this.ta=[],this.Vf=r||500,this.ig=i||2e3,this.Rb=this.Jc=null},Pc=function(t){return new Oi("invalid-cordova-configuration",t)};Sc.prototype.Ra=function(){return this.Tb?this.Tb:this.Tb=zr().then(function(){if("function"!=typeof Zr("universalLinks.subscribe",o))throw Pc("cordova-universal-links-plugin is not installed");if(void 0===Zr("BuildInfo.packageName",o))throw Pc("cordova-plugin-buildinfo is not installed");if("function"!=typeof Zr("cordova.plugins.browsertab.openUrl",o))throw Pc("cordova-plugin-browsertab is not installed");if("function"!=typeof Zr("cordova.InAppBrowser.open",o))throw Pc("cordova-plugin-inappbrowser is not installed")},function(){throw new Oi("cordova-not-ready")})};var Tc=function(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")},Oc=function(t){var e=new te;return e.update(t),lt(e.digest())};t=Sc.prototype,t.ec=function(t,e){return e(new Oi("operation-not-supported-in-this-environment")),Nn()},t.$b=function(){return kn(new Oi("operation-not-supported-in-this-environment"))},t.bf=function(){return!1},t.Ye=function(){return!0},t.Be=function(){return!0},t.ac=function(t,e,n){if(this.Jc)return kn(new Oi("redirect-operation-pending"));var r=this,i=o.document,a=null,s=null,c=null,u=null;return this.Jc=Ln(Nn().then(function(){return oa(e),Ac(r)}).then(function(){return Cc(r,t,e,n)}).then(function(){return new Tn(function(t,e){s=function(){var e=Zr("cordova.plugins.browsertab.close",o);return t(),"function"==typeof e&&e(),r.Rb&&"function"==typeof r.Rb.close&&(r.Rb.close(),r.Rb=null),!1},r.ib(s),c=function(){a||(a=Ho(r.ig).then(function(){e(new Oi("redirect-cancelled-by-user"))}))},u=function(){fi()&&c()},i.addEventListener("resume",c,!1),Jr().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).g(function(t){return Nc(r).then(function(){throw t})})}),function(){c&&i.removeEventListener("resume",c,!1),u&&i.removeEventListener("visibilitychange",u,!1),a&&a.cancel(),s&&r.dc(s),r.Jc=null})};var Cc=function(t,e,n,r){var i=Tc(),a=new Ni(e,r,null,i,new Oi("no-auth-event")),s=Zr("BuildInfo.packageName",o);if("string"!=typeof s)throw new Oi("invalid-cordova-configuration");var c=Zr("BuildInfo.displayName",o),u={};if(Jr().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=s;else{if(!Jr().toLowerCase().match(/android/))return kn(new Oi("operation-not-supported-in-this-environment"));u.apn=s}c&&(u.appDisplayName=c),i=Oc(i),u.sessionId=i;var l=ws(t.B,t.m,t.o,e,n,null,r,t.La,u,t.P);return t.Ra().then(function(){var e=t.$e;return t.pg.h.set(Ic,a.A(),e)}).then(function(){var e=Zr("cordova.plugins.browsertab.isAvailable",o);if("function"!=typeof e)throw new Oi("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!=typeof(n=Zr("cordova.plugins.browsertab.openUrl",o)))throw new Oi("invalid-cordova-configuration");n(l)}else{if("function"!=typeof(n=Zr("cordova.InAppBrowser.open",o)))throw new Oi("invalid-cordova-configuration");e=n;var r=Jr();r=!(!r.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!r.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.Rb=e(l,r?"_blank":"_system","location=yes")}})})};Sc.prototype.Lb=function(t){for(var e=0;e<this.ta.length;e++)try{this.ta[e](t)}catch(t){}};var Ac=function(t){return t.Ad||(t.Ad=t.Ra().then(function(){return new Tn(function(e){var n=function(o){return e(o),t.dc(n),!1};t.ib(n),kc(t)})})),t.Ad},Nc=function(t){var e=null;return Ec(t.xe).then(function(n){return e=n,n=t.xe,n.h.remove(Ic,n.j)}).then(function(){return e})},kc=function(t){var e=Zr("universalLinks.subscribe",o);if("function"!=typeof e)throw new Oi("invalid-cordova-configuration");var n=new Ni("unknown",null,null,null,new Oi("no-auth-event")),r=!1,i=Ho(t.Vf).then(function(){return Nc(t).then(function(){r||t.Lb(n)})}),a=function(e){r=!0,i&&i.cancel(),Nc(t).then(function(o){var r=n;if(o&&e&&e.url){r=null;var i=e.url,a=gr(i),s=fr(a,"link"),c=fr(gr(s),"link");a=fr(a,"deep_link_id"),i=fr(gr(a),"link")||a||c||s||i,-1!=i.indexOf("/__/auth/callback")&&(r=gr(i),r=si(fr(r,"firebaseError")||null),r=(r="object"==typeof r?Ci(r):null)?new Ni(o.ma,o.Y,null,null,r):new Ni(o.ma,o.Y,i,o.tc())),r=r||n}t.Lb(r)})},s=o.handleOpenURL;o.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(Zr("BuildInfo.packageName",o).toLowerCase()+"://")&&a({url:t}),"function"==typeof s)try{s(t)}catch(t){console.error(t)}},e(null,a)};Sc.prototype.ib=function(t){this.ta.push(t),Ac(this).g(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new Ni("unknown",null,null,null,new Oi("no-auth-event")),t(e))})},Sc.prototype.dc=function(t){st(this.ta,function(e){return e==t})};var Mc=function(t){this.j=t,this.h=vc()},Dc={name:"pendingRedirect",D:"session"},jc=function(t){return t.h.set(Dc,"pending",t.j)},Lc=function(t){return t.h.remove(Dc,t.j)},Fc=function(t){return t.h.get(Dc,t.j).then(function(t){return"pending"==t})},Bc=function(t,e,n){this.B=t,this.m=e,this.o=n,this.gc=[],this.sb=!1,this.ed=g(this.vd,this),this.Xa=new Yc(this),this.Od=new Zc(this),this.Xb=new Mc(this.m+":"+this.o),this.Ia={},this.Ia.unknown=this.Xa,this.Ia.signInViaRedirect=this.Xa,this.Ia.linkViaRedirect=this.Xa,this.Ia.reauthViaRedirect=this.Xa,this.Ia.signInViaPopup=this.Od,this.Ia.linkViaPopup=this.Od,this.Ia.reauthViaPopup=this.Od,this.Z=Uc(this.B,this.m,this.o,Cr)},Uc=function(t,n,o,r){var i=e.SDK_VERSION||null;return Gr()?new Sc(t,n,o,i,void 0,void 0,r):new ys(t,n,o,i,r)};Bc.prototype.reset=function(){this.sb=!1,this.Z.dc(this.ed),this.Z=Uc(this.B,this.m,this.o)},Bc.prototype.Sb=function(){var t=this;this.sb||(this.sb=!0,this.Z.ib(this.ed));var e=this.Z;return this.Z.Ra().g(function(n){throw t.Z==e&&t.reset(),n})};var Vc=function(t){t.Z.Ye()&&t.Sb().g(function(e){var n=new Ni("unknown",null,null,null,new Oi("operation-not-supported-in-this-environment"));zc(e)&&t.vd(n)}),t.Z.Be()||Kc(t.Xa)};Bc.prototype.subscribe=function(t){if(rt(this.gc,t)||this.gc.push(t),!this.sb){var e=this;Fc(this.Xb).then(function(t){t?Lc(e.Xb).then(function(){e.Sb().g(function(t){var n=new Ni("unknown",null,null,null,new Oi("operation-not-supported-in-this-environment"));zc(t)&&e.vd(n)})}):Vc(e)}).g(function(){Vc(e)})}},Bc.prototype.unsubscribe=function(t){st(this.gc,function(e){return e==t})},Bc.prototype.vd=function(t){if(!t)throw new Oi("invalid-auth-event");for(var e=!1,n=0;n<this.gc.length;n++){var o=this.gc[n];if(o.ke(t.ma,t.Y)){(e=this.Ia[t.ma])&&e.Te(t,o),e=!0;break}}return Kc(this.Xa),e};var Hc=new di(2e3,1e4),Wc=new di(3e4,6e4);Bc.prototype.getRedirectResult=function(){return this.Xa.getRedirectResult()},Bc.prototype.$b=function(t,e,n,o,r){var i=this;return this.Z.$b(t,e,n,function(){i.sb||(i.sb=!0,i.Z.ib(i.ed))},function(){i.reset()},o,r)};var zc=function(t){return!(!t||"auth/cordova-not-ready"!=t.code)};Bc.prototype.ac=function(t,e,n){var o,r=this;return jc(this.Xb).then(function(){return r.Z.ac(t,e,n).g(function(t){if(zc(t))throw new Oi("operation-not-supported-in-this-environment");return o=t,Lc(r.Xb).then(function(){throw o})}).then(function(){return r.Z.bf()?new Tn(function(){}):Lc(r.Xb).then(function(){return r.getRedirectResult()}).then(function(){}).g(function(){})})})},Bc.prototype.ec=function(t,e,n,o){return this.Z.ec(n,function(n){t.bb(e,null,n,o)},Hc.get())};var Gc={},qc=function(t,e,n){var o=e+":"+n;return Gc[o]||(Gc[o]=new Bc(t,e,n)),Gc[o]},Yc=function(t){this.h=t,this.Ab=null,this.cc=[],this.bc=[],this.yb=null,this.Sd=!1};Yc.prototype.reset=function(){this.Ab=null,this.yb&&(this.yb.cancel(),this.yb=null)},Yc.prototype.Te=function(t,e){if(!t)return kn(new Oi("invalid-auth-event"));this.reset(),this.Sd=!0;var n=t.ma,o=t.Y,r=t.getError()&&"auth/web-storage-unsupported"==t.getError().code,i=t.getError()&&"auth/operation-not-supported-in-this-environment"==t.getError().code;return"unknown"!=n||r||i?t=t.ba?this.Pd(t,e):e.Nb(n,o)?this.Qd(t,e):kn(new Oi("invalid-auth-event")):($c(this,!1,null,null),t=Nn()),t};var Kc=function(t){t.Sd||(t.Sd=!0,$c(t,!1,null,null))};Yc.prototype.Pd=function(t){return $c(this,!0,null,t.getError()),Nn()},Yc.prototype.Qd=function(t,e){var n=this;e=e.Nb(t.ma,t.Y);var o=t.Eb,r=t.tc(),i=!!t.ma.match(/Redirect$/);return e(o,r).then(function(t){$c(n,i,t,null)}).g(function(t){$c(n,i,null,t)})};var Xc=function(t,e){if(t.Ab=function(){return kn(e)},t.bc.length)for(var n=0;n<t.bc.length;n++)t.bc[n](e)},Qc=function(t,e){if(t.Ab=function(){return Nn(e)},t.cc.length)for(var n=0;n<t.cc.length;n++)t.cc[n](e)},$c=function(t,e,n,o){e?o?Xc(t,o):Qc(t,n):Qc(t,{user:null}),t.cc=[],t.bc=[]};Yc.prototype.getRedirectResult=function(){var t=this;return new Tn(function(e,n){t.Ab?t.Ab().then(e,n):(t.cc.push(e),t.bc.push(n),Jc(t))})};var Jc=function(t){var e=new Oi("timeout");t.yb&&t.yb.cancel(),t.yb=Ho(Wc.get()).then(function(){t.Ab||$c(t,!0,null,e)})},Zc=function(t){this.h=t};Zc.prototype.Te=function(t,e){if(!t)return kn(new Oi("invalid-auth-event"));var n=t.ma,o=t.Y;return t.ba?this.Pd(t,e):e.Nb(n,o)?this.Qd(t,e):kn(new Oi("invalid-auth-event"))},Zc.prototype.Pd=function(t,e){return e.bb(t.ma,null,t.getError(),t.Y),Nn()},Zc.prototype.Qd=function(t,e){var n=t.Y,o=t.ma,r=e.Nb(o,n),i=t.Eb;return t=t.tc(),r(i,t).then(function(t){e.bb(o,t,null,n)}).g(function(t){e.bb(o,null,t,n)})};var tu=function(t){this.f=t,this.Ja=this.fa=null,this.Na=0};tu.prototype.A=function(){return{apiKey:this.f.m,refreshToken:this.fa,accessToken:this.Ja,expirationTime:this.Na}};var eu=function(t,e){var n=e.idToken,o=e.refreshToken;e=nu(e.expiresIn),t.Ja=n,t.Na=e,t.fa=o},nu=function(t){return y()+1e3*parseInt(t,10)},ou=function(t,e){return _a(t.f,e).then(function(e){return t.Ja=e.access_token,t.Na=nu(e.expires_in),t.fa=e.refresh_token,{accessToken:t.Ja,expirationTime:t.Na,refreshToken:t.fa}}).g(function(e){throw"auth/user-token-expired"==e.code&&(t.fa=null),e})};tu.prototype.getToken=function(t){return t=!!t,this.Ja&&!this.fa?kn(new Oi("user-token-expired")):t||!this.Ja||y()>this.Na-3e4?this.fa?ou(this,{grant_type:"refresh_token",refresh_token:this.fa}):Nn(null):Nn({accessToken:this.Ja,expirationTime:this.Na,refreshToken:this.fa})};var ru=function(t,e){this.pe=t||null,this.Je=e||null,bi(this,{lastSignInTime:gi(e||null),creationTime:gi(t||null)})};ru.prototype.clone=function(){return new ru(this.pe,this.Je)},ru.prototype.A=function(){return{lastLoginAt:this.Je,createdAt:this.pe}};var iu=function(t,e,n,o,r,i){bi(this,{uid:t,displayName:o||null,photoURL:r||null,email:n||null,phoneNumber:i||null,providerId:e})},au=function(t,e){se.call(this,t);for(var n in e)this[n]=e[n]};_(au,se);var su=function(t,n,o){this.J=[],this.m=t.apiKey,this.o=t.appName,this.B=t.authDomain||null,t=e.SDK_VERSION?$r(e.SDK_VERSION):null,this.f=new ca(this.m,Nr(Cr),t),this.ra=new tu(this.f),mu(this,n.idToken),eu(this.ra,n),_i(this,"refreshToken",this.ra.fa),_u(this,o||{}),To.call(this),this.Kc=!1,this.B&&ei()&&(this.v=qc(this.B,this.m,this.o)),this.Rc=[],this.sa=null,this.wb=du(this),this.Gb=g(this.wd,this);var r=this;this.ia=null,this.Pe=function(t){r.Cb(t.languageCode)},this.Dd=null,this.M=[],this.Oe=function(t){uu(r,t.Ff)},this.sd=null};_(su,To),su.prototype.Cb=function(t){this.ia=t,ha(this.f,t)};var cu=function(t,e){t.Dd&&Re(t.Dd,"languageCodeChanged",t.Pe),(t.Dd=e)&&be(e,"languageCodeChanged",t.Pe)},uu=function(t,n){t.M=n,fa(t.f,e.SDK_VERSION?$r(e.SDK_VERSION,t.M):null)},lu=function(t,e){t.sd&&Re(t.sd,"frameworkChanged",t.Oe),(t.sd=e)&&be(e,"frameworkChanged",t.Oe)};su.prototype.wd=function(){this.wb.ub&&(this.wb.stop(),this.wb.start())};var pu=function(t){try{return e.app(t.o).auth()}catch(e){throw new Oi("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.o+"'!")}},du=function(t){return new oc(function(){return t.getIdToken(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.ra.Na-y()-3e5;return 0<e?e:0},3e4,96e4,!1)},hu=function(t){t.Kb||t.wb.ub||(t.wb.start(),Re(t,"tokenChanged",t.Gb),be(t,"tokenChanged",t.Gb))},fu=function(t){Re(t,"tokenChanged",t.Gb),t.wb.stop()},mu=function(t,e){t.Ie=e,_i(t,"_lat",e)},gu=function(t,e){st(t.Rc,function(t){return t==e})},vu=function(t){for(var e=[],n=0;n<t.Rc.length;n++)e.push(t.Rc[n](t));return jn(e).then(function(){return t})},yu=function(t){t.v&&!t.Kc&&(t.Kc=!0,t.v.subscribe(t))},_u=function(t,e){bi(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new ru(e.createdAt,e.lastLoginAt),providerData:[]})};_i(su.prototype,"providerId","firebase");var bu=function(){},wu=function(t){return Nn().then(function(){if(t.Kb)throw new Oi("app-deleted")})},Iu=function(t){return et(t.providerData,function(t){return t.providerId})},Eu=function(t,e){e&&(Ru(t,e.providerId),t.providerData.push(e))},Ru=function(t,e){st(t.providerData,function(t){return t.providerId==e})},xu=function(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&_i(t,e,n)};su.prototype.copy=function(t){var e=this;e!=t&&(bi(this,{uid:t.uid,displayName:t.displayName,photoURL:t.photoURL,email:t.email,emailVerified:t.emailVerified,phoneNumber:t.phoneNumber,isAnonymous:t.isAnonymous,providerData:[]}),t.metadata?_i(this,"metadata",t.metadata.clone()):_i(this,"metadata",new ru),Z(t.providerData,function(t){Eu(e,t)}),this.ra=t.ra,_i(this,"refreshToken",this.ra.fa))},su.prototype.reload=function(){var t=this;return this.c(wu(this).then(function(){return Su(t).then(function(){return vu(t)}).then(bu)}))};var Su=function(t){return t.getIdToken().then(function(e){var n=t.isAnonymous;return Tu(t,e).then(function(){return n||xu(t,"isAnonymous",!1),e})})};su.prototype.getIdToken=function(t){var e=this;return this.c(wu(this).then(function(){return e.ra.getToken(t)}).then(function(t){if(!t)throw new Oi("internal-error");return t.accessToken!=e.Ie&&(mu(e,t.accessToken),e.Ta()),xu(e,"refreshToken",t.refreshToken),t.accessToken}))},su.prototype.getToken=function(t){return vi["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(vi["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.")),this.getIdToken(t)};var Pu=function(t,e){e.idToken&&t.Ie!=e.idToken&&(eu(t.ra,e),t.Ta(),mu(t,e.idToken),xu(t,"refreshToken",t.ra.fa))};su.prototype.Ta=function(){this.dispatchEvent(new au("tokenChanged"))};var Tu=function(t,e){return is(t.f,Va,{idToken:e}).then(g(t.gg,t))};su.prototype.gg=function(t){if(!(t=t.users)||!t.length)throw new Oi("internal-error");t=t[0],_u(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=Ou(t),n=0;n<e.length;n++)Eu(this,e[n]);xu(this,"isAnonymous",!(this.email&&t.passwordHash||this.providerData&&this.providerData.length))};var Ou=function(t){return(t=t.providerUserInfo)&&t.length?et(t,function(t){return new iu(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]};su.prototype.reauthenticateAndRetrieveDataWithCredential=function(t){var e=this,n=null;return this.c(t.Gd(this.f,this.uid).then(function(t){return Pu(e,t),n=Au(e,t,"reauthenticate"),e.sa=null,e.reload()}).then(function(){return n}),!0)},su.prototype.reauthenticateWithCredential=function(t){return this.reauthenticateAndRetrieveDataWithCredential(t).then(function(){})};var Cu=function(t,e){return Su(t).then(function(){if(rt(Iu(t),e))return vu(t).then(function(){throw new Oi("provider-already-linked")})})};su.prototype.linkAndRetrieveDataWithCredential=function(t){var e=this,n=null;return this.c(Cu(this,t.providerId).then(function(){return e.getIdToken()}).then(function(n){return t.Fc(e.f,n)}).then(function(t){return n=Au(e,t,"link"),Nu(e,t)}).then(function(){return n}))},su.prototype.linkWithCredential=function(t){return this.linkAndRetrieveDataWithCredential(t).then(function(t){return t.user})},su.prototype.linkWithPhoneNumber=function(t,e){var n=this;return this.c(Cu(this,"phone").then(function(){return ec(pu(n),t,e,g(n.linkAndRetrieveDataWithCredential,n))}))},su.prototype.reauthenticateWithPhoneNumber=function(t,e){var n=this;return this.c(Nn().then(function(){return ec(pu(n),t,e,g(n.reauthenticateAndRetrieveDataWithCredential,n))}),!0)};var Au=function(t,e,n){var o=na(e);return e=ac(e),wi({user:t,credential:o,additionalUserInfo:e,operationType:n})},Nu=function(t,e){return Pu(t,e),t.reload().then(function(){return t})};t=su.prototype,t.updateEmail=function(t){var e=this;return this.c(this.getIdToken().then(function(n){return e.f.updateEmail(n,t)}).then(function(t){return Pu(e,t),e.reload()}))},t.updatePhoneNumber=function(t){var e=this;return this.c(this.getIdToken().then(function(n){return t.Fc(e.f,n)}).then(function(t){return Pu(e,t),e.reload()}))},t.updatePassword=function(t){var e=this;return this.c(this.getIdToken().then(function(n){return e.f.updatePassword(n,t)}).then(function(t){return Pu(e,t),e.reload()}))},t.updateProfile=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return wu(this);var e=this;return this.c(this.getIdToken().then(function(n){return e.f.updateProfile(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Pu(e,t),xu(e,"displayName",t.displayName||null),xu(e,"photoURL",t.photoUrl||null),Z(e.providerData,function(t){"password"===t.providerId&&(_i(t,"displayName",e.displayName),_i(t,"photoURL",e.photoURL))}),vu(e)}).then(bu))},t.unlink=function(t){var e=this;return this.c(Su(this).then(function(n){return rt(Iu(e),t)?Ta(e.f,n,[t]).then(function(t){var n={};return Z(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),Z(Iu(e),function(t){n[t]||Ru(e,t)}),n[ta.PROVIDER_ID]||_i(e,"phoneNumber",null),vu(e)}):vu(e).then(function(){throw new Oi("no-such-provider")})}))},t.delete=function(){var t=this;return this.c(this.getIdToken().then(function(e){return is(t.f,Ba,{idToken:e})}).then(function(){t.dispatchEvent(new au("userDeleted"))})).then(function(){for(var e=0;e<t.J.length;e++)t.J[e].cancel("app-deleted");cu(t,null),lu(t,null),t.J=[],t.Kb=!0,fu(t),_i(t,"refreshToken",null),t.v&&t.v.unsubscribe(t)})},t.ke=function(t,e){return!!("linkViaPopup"==t&&(this.la||null)==e&&this.ka||"reauthViaPopup"==t&&(this.la||null)==e&&this.ka||"linkViaRedirect"==t&&(this.Ha||null)==e||"reauthViaRedirect"==t&&(this.Ha||null)==e)},t.bb=function(t,e,n,o){"linkViaPopup"!=t&&"reauthViaPopup"!=t||o!=(this.la||null)||(n&&this.Va?this.Va(n):e&&!n&&this.ka&&this.ka(e),this.K&&(this.K.cancel(),this.K=null),delete this.ka,delete this.Va)},t.Nb=function(t,e){return"linkViaPopup"==t&&e==(this.la||null)?g(this.ue,this):"reauthViaPopup"==t&&e==(this.la||null)?g(this.ve,this):"linkViaRedirect"==t&&(this.Ha||null)==e?g(this.ue,this):"reauthViaRedirect"==t&&(this.Ha||null)==e?g(this.ve,this):null},t.sc=function(){return ci(this.uid+":::")},t.linkWithPopup=function(t){var e=this;return ku(this,"linkViaPopup",t,function(){return Cu(e,t.providerId).then(function(){return vu(e)})},!1)},t.reauthenticateWithPopup=function(t){return ku(this,"reauthViaPopup",t,function(){return Nn()},!0)};var ku=function(t,n,o,r,i){if(!ei())return kn(new Oi("operation-not-supported-in-this-environment"));if(t.sa&&!i)return kn(t.sa);var a=Ti(o.providerId),s=t.sc(),c=null;(!ri()||qr())&&t.B&&o.isOAuthProvider&&(c=ws(t.B,t.m,t.o,n,o,null,s,e.SDK_VERSION||null));var u=Ur(c,a&&a.Zb,a&&a.Yb);return r=r().then(function(){if(Du(t),!i)return t.getIdToken().then(function(){})}).then(function(){return t.v.$b(u,n,o,s,!!c)}).then(function(){return new Tn(function(e,o){t.bb(n,null,new Oi("cancelled-popup-request"),t.la||null),t.ka=e,t.Va=o,t.la=s,t.K=t.v.ec(t,n,u,s)})}).then(function(t){return u&&Br(u),t?wi(t):null}).g(function(t){throw u&&Br(u),t}),t.c(r,i)};su.prototype.linkWithRedirect=function(t){var e=this;return Mu(this,"linkViaRedirect",t,function(){return Cu(e,t.providerId)},!1)},su.prototype.reauthenticateWithRedirect=function(t){return Mu(this,"reauthViaRedirect",t,function(){return Nn()},!0)};var Mu=function(t,e,n,o,r){if(!ei())return kn(new Oi("operation-not-supported-in-this-environment"));if(t.sa&&!r)return kn(t.sa);var i=null,a=t.sc();return o=o().then(function(){if(Du(t),!r)return t.getIdToken().then(function(){})}).then(function(){return t.Ha=a,vu(t)}).then(function(e){return t.Ya&&(e=t.Ya,e=e.h.set(Uu,t.A(),e.j)),e}).then(function(){return t.v.ac(e,n,a)}).g(function(e){if(i=e,t.Ya)return Vu(t.Ya);throw i}).then(function(){if(i)throw i}),t.c(o,r)},Du=function(t){if(!t.v||!t.Kc){if(t.v&&!t.Kc)throw new Oi("internal-error");throw new Oi("auth-domain-config-required")}};su.prototype.ue=function(t,e){var n=this;this.K&&(this.K.cancel(),this.K=null);var o=null,r=this.getIdToken().then(function(o){return Na(n.f,{requestUri:t,sessionId:e,idToken:o})}).then(function(t){return o=Au(n,t,"link"),Nu(n,t)}).then(function(){return o});return this.c(r)},su.prototype.ve=function(t,e){var n=this;this.K&&(this.K.cancel(),this.K=null);var o=null,r=Nn().then(function(){return Li(ka(n.f,{requestUri:t,sessionId:e}),n.uid)}).then(function(t){return o=Au(n,t,"reauthenticate"),Pu(n,t),n.sa=null,n.reload()}).then(function(){return o});return this.c(r,!0)},su.prototype.sendEmailVerification=function(t){var e=this,n=null;return this.c(this.getIdToken().then(function(e){return n=e,void 0===t||yt(t)?{}:Zs(new Js(t))}).then(function(t){return e.f.sendEmailVerification(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},su.prototype.c=function(t,e){var n=this,o=ju(this,t,e);return this.J.push(o),Ln(o,function(){it(n.J,o)}),o};var ju=function(t,e,n){return t.sa&&!n?(e.cancel(),kn(t.sa)):e.g(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.sa||t.dispatchEvent(new au("userInvalidated")),t.sa=e),e})};su.prototype.toJSON=function(){return this.A()},su.prototype.A=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.m,appName:this.o,authDomain:this.B,stsTokenManager:this.ra.A(),redirectEventId:this.Ha||null};return this.metadata&&It(t,this.metadata.A()),Z(this.providerData,function(e){t.providerData.push(Ii(e))}),t};var Lu=function(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n.idToken=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-y())/1e3;var o=new su(e,n,t);return t.providerData&&Z(t.providerData,function(t){t&&Eu(o,wi(t))}),t.redirectEventId&&(o.Ha=t.redirectEventId),o},Fu=function(t,e,n,o){var r=new su(t,e);return n&&(r.Ya=n),o&&uu(r,o),r.reload().then(function(){return r})},Bu=function(t){this.j=t,this.h=vc()},Uu={name:"redirectUser",D:"session"},Vu=function(t){return t.h.remove(Uu,t.j)},Hu=function(t,e){return t.h.get(Uu,t.j).then(function(t){return t&&e&&(t.authDomain=e),Lu(t||{})})},Wu=function(t,e){this.j=t,this.h=e||vc(),this.O=null,this.Jd=this.Bd(),this.h.addListener(qu("local"),this.j,g(this.vg,this))};Wu.prototype.vg=function(){var t=this,e=qu("local");$u(this,function(){return Nn().then(function(){return t.O&&"local"!=t.O.D?t.h.get(e,t.j):null}).then(function(n){if(n)return zu(t,"local").then(function(){t.O=e})})})};var zu=function(t,e){var n,o=[];for(n in fc)fc[n]!==e&&o.push(t.h.remove(qu(fc[n]),t.j));return o.push(t.h.remove(Gu,t.j)),Dn(o)};Wu.prototype.Bd=function(){var t=this,e=qu("local"),n=qu("session"),o=qu("none");return this.h.get(n,this.j).then(function(r){return r?n:t.h.get(o,t.j).then(function(n){return n?o:t.h.get(e,t.j).then(function(n){return n?e:t.h.get(Gu,t.j).then(function(t){return t?qu(t):e})})})}).then(function(e){return t.O=e,zu(t,e.D)}).g(function(){t.O||(t.O=e)})};var Gu={name:"persistence",D:"session"},qu=function(t){return{name:"authUser",D:t}};Wu.prototype.setPersistence=function(t){var e=null,n=this;return mc(t),$u(this,function(){return t!=n.O.D?n.h.get(n.O,n.j).then(function(o){return e=o,zu(n,t)}).then(function(){if(n.O=qu(t),e)return n.h.set(n.O,e,n.j)}):Nn()})};var Yu=function(t){return $u(t,function(){return t.h.set(Gu,t.O.D,t.j)})},Ku=function(t,e){return $u(t,function(){return t.h.set(t.O,e.A(),t.j)})},Xu=function(t){return $u(t,function(){return t.h.remove(t.O,t.j)})},Qu=function(t,e){return $u(t,function(){return t.h.get(t.O,t.j).then(function(t){return t&&e&&(t.authDomain=e),Lu(t||{})})})},$u=function(t,e){return t.Jd=t.Jd.then(e,e),t.Jd},Ju=function(t){if(this.Ea=!1,_i(this,"app",t),!this.i().options||!this.i().options.apiKey)throw new Oi("invalid-api-key");t=e.SDK_VERSION?$r(e.SDK_VERSION):null,this.f=new ca(this.i().options&&this.i().options.apiKey,Nr(Cr),t),this.J=[],this.Ka=[],this.Fb=[],this.cg=e.INTERNAL.createSubscribe(g(this.Sf,this)),this.kc=void 0,this.eg=e.INTERNAL.createSubscribe(g(this.Uf,this)),il(this,null),t=this.i().options.apiKey;var n=this.i().name;this.na=new Wu(t+":"+n),t=this.i().options.apiKey,n=this.i().name,this.zb=new Bu(t+":"+n),this.oc=this.c(sl(this)),this.ya=this.c(cl(this)),this.Cc=!1,this.ud=g(this.wg,this),this.ef=g(this.pb,this),this.Gb=g(this.wd,this),this.cf=g(this.Of,this),this.df=g(this.Pf,this),ol(this),this.INTERNAL={},this.INTERNAL.delete=g(this.delete,this),this.INTERNAL.logFramework=g(this.$f,this),this.Oa=0,To.call(this),el(this),this.M=[]};_(Ju,To);var Zu=function(t){se.call(this,"languageCodeChanged"),this.languageCode=t};_(Zu,se);var tl=function(t){se.call(this,"frameworkChanged"),this.Ff=t};_(tl,se),Ju.prototype.setPersistence=function(t){return t=this.na.setPersistence(t),this.c(t)},Ju.prototype.Cb=function(t){this.ia===t||this.Ea||(this.ia=t,ha(this.f,this.ia),this.dispatchEvent(new Zu(this.ia)))},Ju.prototype.useDeviceLanguage=function(){var t=o.navigator;this.Cb(t?t.languages&&t.languages[0]||t.language||t.userLanguage||null:null)},Ju.prototype.$f=function(t){this.M.push(t),fa(this.f,e.SDK_VERSION?$r(e.SDK_VERSION,this.M):null),this.dispatchEvent(new tl(this.M))};var el=function(t){Object.defineProperty(t,"lc",{get:function(){return this.ia},set:function(t){this.Cb(t)},enumerable:!1}),t.ia=null};Ju.prototype.toJSON=function(){return{apiKey:this.i().options.apiKey,authDomain:this.i().options.authDomain,appName:this.i().name,currentUser:ll(this)&&ll(this).A()}};var nl=function(t){return t.Af||kn(new Oi("auth-domain-config-required"))},ol=function(t){var e=t.i().options.authDomain,n=t.i().options.apiKey;e&&ei()&&(t.Af=t.oc.then(function(){if(!t.Ea){if(t.v=qc(e,n,t.i().name),t.v.subscribe(t),ll(t)&&yu(ll(t)),t.Za){yu(t.Za);var o=t.Za;o.Cb(t.ia),cu(o,t),o=t.Za,uu(o,t.M),lu(o,t),t.Za=null}return t.v}}))};t=Ju.prototype,t.ke=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.la==e&&!!this.ka;default:return!1}},t.bb=function(t,e,n,o){"signInViaPopup"==t&&this.la==o&&(n&&this.Va?this.Va(n):e&&!n&&this.ka&&this.ka(e),this.K&&(this.K.cancel(),this.K=null),delete this.ka,delete this.Va)},t.Nb=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.la==e&&this.ka?g(this.Cf,this):null},t.Cf=function(t,e){var n=this;t={requestUri:t,sessionId:e},this.K&&(this.K.cancel(),this.K=null);var o=null,r=null,i=Aa(n.f,t).then(function(t){return o=na(t),r=ac(t),t});return t=n.oc.then(function(){return i}).then(function(t){return rl(n,t)}).then(function(){return wi({user:ll(n),credential:o,additionalUserInfo:r,operationType:"signIn"})}),this.c(t)},t.sc=function(){return ci()},t.signInWithPopup=function(t){if(!ei())return kn(new Oi("operation-not-supported-in-this-environment"));var n=this,o=Ti(t.providerId),r=this.sc(),i=null;(!ri()||qr())&&this.i().options.authDomain&&t.isOAuthProvider&&(i=ws(this.i().options.authDomain,this.i().options.apiKey,this.i().name,"signInViaPopup",t,null,r,e.SDK_VERSION||null));var a=Ur(i,o&&o.Zb,o&&o.Yb);return o=nl(this).then(function(e){return e.$b(a,"signInViaPopup",t,r,!!i)}).then(function(){return new Tn(function(t,e){n.bb("signInViaPopup",null,new Oi("cancelled-popup-request"),n.la),n.ka=t,n.Va=e,n.la=r,n.K=n.v.ec(n,"signInViaPopup",a,r)})}).then(function(t){return a&&Br(a),t?wi(t):null}).g(function(t){throw a&&Br(a),t}),this.c(o)},t.signInWithRedirect=function(t){if(!ei())return kn(new Oi("operation-not-supported-in-this-environment"));var e=this,n=nl(this).then(function(){return Yu(e.na)}).then(function(){return e.v.ac("signInViaRedirect",t)});return this.c(n)},t.getRedirectResult=function(){if(!ei())return kn(new Oi("operation-not-supported-in-this-environment"));var t=this,e=nl(this).then(function(){return t.v.getRedirectResult()}).then(function(t){return t?wi(t):null});return this.c(e)};var rl=function(t,e){var n={};return n.apiKey=t.i().options.apiKey,n.authDomain=t.i().options.authDomain,n.appName=t.i().name,t.oc.then(function(){return Fu(n,e,t.zb,ut(t.M))}).then(function(e){return ll(t)&&e.uid==ll(t).uid?(ll(t).copy(e),t.pb(e)):(il(t,e),yu(e),t.pb(e))}).then(function(){t.Ta()})},il=function(t,e){ll(t)&&(gu(ll(t),t.ef),Re(ll(t),"tokenChanged",t.Gb),Re(ll(t),"userDeleted",t.cf),Re(ll(t),"userInvalidated",t.df),fu(ll(t))),e&&(e.Rc.push(t.ef),be(e,"tokenChanged",t.Gb),be(e,"userDeleted",t.cf),be(e,"userInvalidated",t.df),0<t.Oa&&hu(e)),_i(t,"currentUser",e),e&&(e.Cb(t.ia),cu(e,t),uu(e,t.M),lu(e,t))};Ju.prototype.signOut=function(){var t=this,e=this.ya.then(function(){return ll(t)?(il(t,null),Xu(t.na).then(function(){t.Ta()})):Nn()});return this.c(e)};var al=function(t){var e=t.i().options.authDomain;return e=Hu(t.zb,e).then(function(e){return(t.Za=e)&&(e.Ya=t.zb),Vu(t.zb)}),t.c(e)},sl=function(t){var e=t.i().options.authDomain,n=al(t).then(function(){return Qu(t.na,e)}).then(function(e){return e?(e.Ya=t.zb,t.Za&&(t.Za.Ha||null)==(e.Ha||null)?e:e.reload().then(function(){return Ku(t.na,e).then(function(){return e})}).g(function(n){return"auth/network-request-failed"==n.code?e:Xu(t.na)})):null}).then(function(e){il(t,e||null)});return t.c(n)},cl=function(t){return t.oc.then(function(){return t.getRedirectResult()}).g(function(){}).then(function(){if(!t.Ea)return t.ud()}).g(function(){}).then(function(){if(!t.Ea){t.Cc=!0;var e=t.na;e.h.addListener(qu("local"),e.j,t.ud)}})};t=Ju.prototype,t.wg=function(){var t=this,e=this.i().options.authDomain;return Qu(this.na,e).then(function(e){if(!t.Ea){var n;if(n=ll(t)&&e){n=ll(t).uid;var o=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==o&&null!==o&&""!==o&&n==o}if(n)return ll(t).copy(e),ll(t).getIdToken();(ll(t)||e)&&(il(t,e),e&&(yu(e),e.Ya=t.zb),t.v&&t.v.subscribe(t),t.Ta())}})},t.pb=function(t){return Ku(this.na,t)},t.wd=function(){this.Ta(),this.pb(ll(this))},t.Of=function(){this.signOut()},t.Pf=function(){this.signOut()};var ul=function(t,e){var n=null,o=null;return t.c(e.then(function(e){return n=na(e),o=ac(e),rl(t,e)}).then(function(){return wi({user:ll(t),credential:n,additionalUserInfo:o,operationType:"signIn"})}))};t=Ju.prototype,t.Sf=function(t){var e=this;this.addAuthTokenListener(function(){t.next(ll(e))})},t.Uf=function(t){var e=this;dl(this,function(){t.next(ll(e))})},t.onIdTokenChanged=function(t,n,o){var r=this;return this.Cc&&e.Promise.resolve().then(function(){d(t)?t(ll(r)):d(t.next)&&t.next(ll(r))}),this.cg(t,n,o)},t.onAuthStateChanged=function(t,n,o){var r=this;return this.Cc&&e.Promise.resolve().then(function(){r.kc=r.getUid(),d(t)?t(ll(r)):d(t.next)&&t.next(ll(r))}),this.eg(t,n,o)},t.If=function(t){var e=this,n=this.ya.then(function(){return ll(e)?ll(e).getIdToken(t).then(function(t){return{accessToken:t}}):null});return this.c(n)},t.signInWithCustomToken=function(t){var e=this;return this.ya.then(function(){return ul(e,is(e.f,ts,{token:t}))}).then(function(t){return t=t.user,xu(t,"isAnonymous",!1),e.pb(t)}).then(function(){return ll(e)})},t.signInWithEmailAndPassword=function(t,e){var n=this;return this.ya.then(function(){return ul(n,is(n.f,es,{email:t,password:e}))}).then(function(t){return t.user})},t.createUserWithEmailAndPassword=function(t,e){var n=this;return this.ya.then(function(){return ul(n,is(n.f,La,{email:t,password:e}))}).then(function(t){return t.user})},t.signInWithCredential=function(t){return this.signInAndRetrieveDataWithCredential(t).then(function(t){return t.user})},t.signInAndRetrieveDataWithCredential=function(t){var e=this;return this.ya.then(function(){return ul(e,t.Ob(e.f))})},t.signInAnonymously=function(){var t=this;return this.ya.then(function(){var e=ll(t);return e&&e.isAnonymous?e:ul(t,t.f.signInAnonymously()).then(function(e){return e=e.user,xu(e,"isAnonymous",!0),t.pb(e)}).then(function(){return ll(t)})})},t.i=function(){return this.app};var ll=function(t){return t.currentUser};Ju.prototype.getUid=function(){return ll(this)&&ll(this).uid||null};var pl=function(t){return ll(t)&&ll(t)._lat||null};t=Ju.prototype,t.Ta=function(){if(this.Cc){for(var t=0;t<this.Ka.length;t++)this.Ka[t]&&this.Ka[t](pl(this));if(this.kc!==this.getUid()&&this.Fb.length)for(this.kc=this.getUid(),t=0;t<this.Fb.length;t++)this.Fb[t]&&this.Fb[t](pl(this))}},t.pf=function(t){this.addAuthTokenListener(t),0<++this.Oa&&ll(this)&&hu(ll(this))},t.jg=function(t){var e=this;Z(this.Ka,function(n){n==t&&e.Oa--}),0>this.Oa&&(this.Oa=0),0==this.Oa&&ll(this)&&fu(ll(this)),this.removeAuthTokenListener(t)},t.addAuthTokenListener=function(t){var e=this;this.Ka.push(t),this.c(this.ya.then(function(){e.Ea||rt(e.Ka,t)&&t(pl(e))}))},t.removeAuthTokenListener=function(t){st(this.Ka,function(e){return e==t})};var dl=function(t,e){t.Fb.push(e),t.c(t.ya.then(function(){!t.Ea&&rt(t.Fb,e)&&t.kc!==t.getUid()&&(t.kc=t.getUid(),e(pl(t)))}))};t=Ju.prototype,t.delete=function(){this.Ea=!0;for(var t=0;t<this.J.length;t++)this.J[t].cancel("app-deleted");return this.J=[],this.na&&(t=this.na,t.h.removeListener(qu("local"),t.j,this.ud)),this.v&&this.v.unsubscribe(this),e.Promise.resolve()},t.c=function(t){var e=this;return this.J.push(t),Ln(t,function(){it(e.J,t)}),t},t.fetchProvidersForEmail=function(t){return this.c(Ea(this.f,t))},t.verifyPasswordResetCode=function(t){return this.checkActionCode(t).then(function(t){return t.data.email})},t.confirmPasswordReset=function(t,e){return this.c(this.f.confirmPasswordReset(t,e).then(function(){}))},t.checkActionCode=function(t){return this.c(this.f.checkActionCode(t).then(function(t){return new nc(t)}))},t.applyActionCode=function(t){return this.c(this.f.applyActionCode(t).then(function(){}))},t.sendPasswordResetEmail=function(t,e){var n=this;return this.c(Nn().then(function(){return void 0===e||yt(e)?{}:Zs(new Js(e))}).then(function(e){return n.f.sendPasswordResetEmail(t,e)}).then(function(){}))},t.signInWithPhoneNumber=function(t,e){return this.c(ec(this,t,e,g(this.signInAndRetrieveDataWithCredential,this)))};var hl=function(t,e,n,o){t:{n=Array.prototype.slice.call(n);for(var r=0,i=!1,a=0;a<e.length;a++)if(e[a].optional)i=!0;else{if(i)throw new Oi("internal-error","Argument validator encountered a required argument after an optional argument.");r++}if(i=e.length,n.length<r||i<n.length)o="Expected "+(r==i?1==r?"1 argument":r+" arguments":r+"-"+i+" arguments")+" but got "+n.length+".";else{for(r=0;r<n.length;r++)if(i=e[r].optional&&void 0===n[r],!e[r].W(n[r])&&!i){if(e=e[r],0>r||r>=fl.length)throw new Oi("internal-error","Argument validator received an unsupported number of arguments.");n=fl[r],o=(o?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.V+".";break t}o=null}}if(o)throw new Oi("argument-error",t+" failed: "+o)},fl="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" "),ml=function(t,e){return{name:t||"",V:"a valid string",optional:!!e,W:i}},gl=function(){return{name:"opt_forceRefresh",V:"a boolean",optional:!0,W:a}},vl=function(t,e){return{name:t||"",V:"a valid object",optional:!!e,W:h}},yl=function(t,e){return{name:t||"",V:"a function",optional:!!e,W:d}},_l=function(t,e){return{name:t||"",V:"null",optional:!!e,W:u}},bl=function(){return{name:"",V:"an HTML element",optional:!1,W:function(t){return!!(t&&t instanceof Element)}}},wl=function(){return{name:"auth",V:"an instance of Firebase Auth",optional:!0,W:function(t){return!!(t&&t instanceof Ju)}}},Il=function(){return{name:"app",V:"an instance of Firebase App",optional:!0,W:function(t){return!!(t&&t instanceof e.app.App)}}},El=function(t){return{name:t?t+"Credential":"credential",V:t?"a valid "+t+" credential":"a valid credential",optional:!1,W:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.Ob||!n)}}},Rl=function(){return{name:"authProvider",V:"a valid Auth provider",optional:!1,W:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}},xl=function(){return{name:"applicationVerifier",V:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,W:function(t){return!!(t&&i(t.type)&&d(t.verify))}}},Sl=function(t,e,n,o){return{name:n||"",V:t.V+" or "+e.V,optional:!!o,W:function(n){return t.W(n)||e.W(n)}}},Pl=function(t,e){for(var n in e){var o=e[n].name;t[o]=Ol(o,t[n],e[n].a)}},Tl=function(t,e,n,o){t[e]=Ol(e,n,o)},Ol=function(t,e,n){if(!n)return e;var o=Cl(t);t=function(){var t=Array.prototype.slice.call(arguments);return hl(o,n,t),e.apply(this,t)};for(var r in e)t[r]=e[r];for(r in e.prototype)t.prototype[r]=e.prototype[r];return t},Cl=function(t){return t=t.split("."),t[t.length-1]};Pl(Ju.prototype,{applyActionCode:{name:"applyActionCode",a:[ml("code")]},checkActionCode:{name:"checkActionCode",a:[ml("code")]},confirmPasswordReset:{name:"confirmPasswordReset",a:[ml("code"),ml("newPassword")]},createUserWithEmailAndPassword:{name:"createUserWithEmailAndPassword",a:[ml("email"),ml("password")]},fetchProvidersForEmail:{name:"fetchProvidersForEmail",a:[ml("email")]},getRedirectResult:{name:"getRedirectResult",a:[]},onAuthStateChanged:{name:"onAuthStateChanged",a:[Sl(vl(),yl(),"nextOrObserver"),yl("opt_error",!0),yl("opt_completed",!0)]},onIdTokenChanged:{name:"onIdTokenChanged",a:[Sl(vl(),yl(),"nextOrObserver"),yl("opt_error",!0),yl("opt_completed",!0)]},sendPasswordResetEmail:{name:"sendPasswordResetEmail",a:[ml("email"),Sl(vl("opt_actionCodeSettings",!0),_l(null,!0),"opt_actionCodeSettings",!0)]},setPersistence:{name:"setPersistence",a:[ml("persistence")]},signInAndRetrieveDataWithCredential:{name:"signInAndRetrieveDataWithCredential",a:[El()]},signInAnonymously:{name:"signInAnonymously",a:[]},signInWithCredential:{name:"signInWithCredential",a:[El()]},signInWithCustomToken:{name:"signInWithCustomToken",a:[ml("token")]},signInWithEmailAndPassword:{name:"signInWithEmailAndPassword",a:[ml("email"),ml("password")]},signInWithPhoneNumber:{name:"signInWithPhoneNumber",a:[ml("phoneNumber"),xl()]},signInWithPopup:{name:"signInWithPopup",a:[Rl()]},signInWithRedirect:{name:"signInWithRedirect",a:[Rl()]},signOut:{name:"signOut",a:[]},toJSON:{name:"toJSON",a:[ml(null,!0)]},useDeviceLanguage:{name:"useDeviceLanguage",a:[]},verifyPasswordResetCode:{name:"verifyPasswordResetCode",a:[ml("code")]}}),function(t,e){for(var n in e){var o=e[n].name;if(o!==n){var r=e[n].rf;Object.defineProperty(t,o,{get:function(){return this[n]},set:function(t){hl(o,[r],[t],!0),this[n]=t},enumerable:!0})}}}(Ju.prototype,{lc:{name:"languageCode",rf:Sl(ml(),_l(),"languageCode")}}),Ju.Persistence=fc,Ju.Persistence.LOCAL="local",Ju.Persistence.SESSION="session",Ju.Persistence.NONE="none",Pl(su.prototype,{delete:{name:"delete",a:[]},getIdToken:{name:"getIdToken",a:[gl()]},getToken:{name:"getToken",a:[gl()]},linkAndRetrieveDataWithCredential:{name:"linkAndRetrieveDataWithCredential",a:[El()]},linkWithCredential:{name:"linkWithCredential",a:[El()]},linkWithPhoneNumber:{name:"linkWithPhoneNumber",a:[ml("phoneNumber"),xl()]},linkWithPopup:{name:"linkWithPopup",a:[Rl()]},linkWithRedirect:{name:"linkWithRedirect",a:[Rl()]},reauthenticateAndRetrieveDataWithCredential:{name:"reauthenticateAndRetrieveDataWithCredential",a:[El()]},reauthenticateWithCredential:{name:"reauthenticateWithCredential",a:[El()]},reauthenticateWithPhoneNumber:{name:"reauthenticateWithPhoneNumber",a:[ml("phoneNumber"),xl()]},reauthenticateWithPopup:{name:"reauthenticateWithPopup",a:[Rl()]},reauthenticateWithRedirect:{name:"reauthenticateWithRedirect",a:[Rl()]},reload:{name:"reload",a:[]},sendEmailVerification:{name:"sendEmailVerification",a:[Sl(vl("opt_actionCodeSettings",!0),_l(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",a:[ml(null,!0)]},unlink:{name:"unlink",a:[ml("provider")]},updateEmail:{name:"updateEmail",a:[ml("email")]},updatePassword:{name:"updatePassword",a:[ml("password")]},updatePhoneNumber:{name:"updatePhoneNumber",a:[El("phone")]},updateProfile:{name:"updateProfile",a:[vl("profile")]}}),Pl(Tn.prototype,{g:{name:"catch"},then:{name:"then"}}),Pl(tc.prototype,{confirm:{name:"confirm",a:[ml("verificationCode")]}}),Tl($i,"credential",function(t,e){return new Qi(t,e)},[ml("email"),ml("password")]),Pl(Hi.prototype,{addScope:{name:"addScope",a:[ml("scope")]},setCustomParameters:{name:"setCustomParameters",a:[vl("customOAuthParameters")]}}),Tl(Hi,"credential",Wi,[Sl(ml(),vl(),"token")]),Pl(zi.prototype,{addScope:{name:"addScope",a:[ml("scope")]},setCustomParameters:{name:"setCustomParameters",a:[vl("customOAuthParameters")]}}),Tl(zi,"credential",Gi,[Sl(ml(),vl(),"token")]),Pl(qi.prototype,{addScope:{name:"addScope",a:[ml("scope")]},setCustomParameters:{name:"setCustomParameters",a:[vl("customOAuthParameters")]}}),Tl(qi,"credential",Yi,[Sl(ml(),Sl(vl(),_l()),"idToken"),Sl(ml(),_l(),"accessToken",!0)]),Pl(Ki.prototype,{setCustomParameters:{name:"setCustomParameters",a:[vl("customOAuthParameters")]}}),Tl(Ki,"credential",Xi,[Sl(ml(),vl(),"token"),ml("secret",!0)]),Pl(Vi.prototype,{addScope:{name:"addScope",a:[ml("scope")]},credential:{name:"credential",a:[Sl(ml(),_l(),"idToken",!0),Sl(ml(),_l(),"accessToken",!0)]},setCustomParameters:{name:"setCustomParameters",a:[vl("customOAuthParameters")]}}),Tl(ta,"credential",ea,[ml("verificationId"),ml("verificationCode")]),Pl(ta.prototype,{verifyPhoneNumber:{name:"verifyPhoneNumber",a:[ml("phoneNumber"),xl()]}}),Pl(Oi.prototype,{toJSON:{name:"toJSON",a:[ml(null,!0)]}}),Pl(ra.prototype,{toJSON:{name:"toJSON",a:[ml(null,!0)]}}),Pl(Mi.prototype,{toJSON:{name:"toJSON",a:[ml(null,!0)]}}),Pl(Ns.prototype,{clear:{name:"clear",a:[]},render:{name:"render",a:[]},verify:{name:"verify",a:[]}}),function(){if(void 0===e||!e.INTERNAL||!e.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:Ju,Error:Oi};Tl(t,"EmailAuthProvider",$i,[]),Tl(t,"FacebookAuthProvider",Hi,[]),Tl(t,"GithubAuthProvider",zi,[]),Tl(t,"GoogleAuthProvider",qi,[]),Tl(t,"TwitterAuthProvider",Ki,[]),Tl(t,"OAuthProvider",Vi,[ml("providerId")]),Tl(t,"PhoneAuthProvider",ta,[wl()]),Tl(t,"RecaptchaVerifier",Ns,[Sl(ml(),bl(),"recaptchaContainer"),vl("recaptchaParameters",!0),Il()]),e.INTERNAL.registerService("auth",function(t,e){return t=new Ju(t),e({INTERNAL:{getUid:g(t.getUid,t),getToken:g(t.If,t),addAuthTokenListener:g(t.pf,t),removeAuthTokenListener:g(t.jg,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),e.INTERNAL.extendNamespace({User:su})}()}).call(this)}).call(void 0!==t?t:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})}).call(e,n(47))},function(t,e,n){"use strict";function o(e){var n=e.INTERNAL.registerService("database",function(t,e,n){return u.RepoManager.getInstance().databaseFromApp(t,n)},{Reference:s.Reference,Query:a.Query,Database:i.Database,enableLogging:c.enableLogging,INTERNAL:l,ServerValue:i.Database.ServerValue,TEST_ACCESS:p},null,!0);d.isNodeSdk()&&(t.exports=n)}Object.defineProperty(e,"__esModule",{value:!0});var r=n(74),i=n(475),a=n(478),s=n(254),c=n(9),u=n(258),l=n(1145),p=n(1146),d=n(3);e.registerDatabase=o,o(r.default)},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),o.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:o.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}();e.DOMStorageWrapper=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return o.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}();e.MemoryStorage=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(89),i=n(9),a=n(3),s=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){o.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),o.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new a.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){o.validateArgCount("OnDisconnect.remove",0,1,arguments.length),r.validateWritablePath("OnDisconnect.remove",this.path_),o.validateCallback("OnDisconnect.remove",1,t,!0);var e=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){o.validateArgCount("OnDisconnect.set",1,2,arguments.length),r.validateWritablePath("OnDisconnect.set",this.path_),r.validateFirebaseDataArg("OnDisconnect.set",1,t,this.path_,!1),o.validateCallback("OnDisconnect.set",2,e,!0);var n=new a.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){o.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),r.validateWritablePath("OnDisconnect.setWithPriority",this.path_),r.validateFirebaseDataArg("OnDisconnect.setWithPriority",1,t,this.path_,!1),r.validatePriority("OnDisconnect.setWithPriority",2,e,!1),o.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var i=new a.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,i.wrapCallback(n)),i.promise},t.prototype.update=function(t,e){if(o.validateArgCount("OnDisconnect.update",1,2,arguments.length),r.validateWritablePath("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},s=0;s<t.length;++s)n[""+s]=t[s];t=n,i.warn("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}r.validateFirebaseMergeDataArg("OnDisconnect.update",1,t,this.path_,!1),o.validateCallback("OnDisconnect.update",2,e,!0);var c=new a.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,c.wrapCallback(e)),c.promise},t}();e.OnDisconnect=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return o.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();e.TransactionResult=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3);e.nextPushId=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(r){var i=r===e;e=r;var a,s=new Array(8);for(a=7;a>=0;a--)s[a]=t.charAt(r%64),r=Math.floor(r/64);o.assert(0===r,"Cannot push at time == 0");var c=s.join("");if(i){for(a=11;a>=0&&63===n[a];a--)n[a]=0;n[a]++}else for(a=0;a<12;a++)n[a]=Math.floor(64*Math.random());for(a=0;a<12;a++)c+=t.charAt(n[a]);return o.assert(20===c.length,"nextPushId: Length should be 20."),c}}()},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(485),r=n(1119),i=n(3),a=n(3),s=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new r.DataEvent("value",this,new o.DataSnapshot(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){a.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var o=this.callback_;return function(){o.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new r.CancelEvent(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}();e.ValueEventRegistration=s;var c=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,i.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new r.CancelEvent(this,t,e):null},t.prototype.createEvent=function(t,e){a.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),i=e.getQueryParams().getIndex();return new r.DataEvent(t.type,this,new o.DataSnapshot(t.snapshotNode,n,i),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){a.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var o=this.callbacks_[t.eventType];return function(){o.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=i.getCount(e.callbacks_);if(n===i.getCount(this.callbacks_)){if(1===n){var o=i.getAnyKey(e.callbacks_),r=i.getAnyKey(this.callbacks_);return!(r!==o||e.callbacks_[o]&&this.callbacks_[r]&&e.callbacks_[o]!==this.callbacks_[r])}return i.every(this.callbacks_,function(t,n){return e.callbacks_[t]===n})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}();e.ChildEventRegistration=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=function(){function t(t,e,n,o){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=o}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+o.stringify(this.snapshot.exportVal())},t}();e.DataEvent=r;var i=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}();e.CancelEvent=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(9),i=n(1121),a=n(36),s=n(3),c=n(255),u=n(1122),l=n(1123),p=n(90),d=n(489),h=n(22),f=n(490),m=n(1129),g=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=c.ImmutableTree.Empty,this.pendingWriteTree_=new m.WriteTree,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,o){return this.pendingWriteTree_.addOverwrite(t,e,n,o),o?this.applyOperationToSyncPoints_(new d.Overwrite(p.OperationSource.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var o=c.ImmutableTree.fromObject(e);return this.applyOperationToSyncPoints_(new l.Merge(p.OperationSource.User,t,o))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var o=c.ImmutableTree.Empty;return null!=n.snap?o=o.set(h.Path.Empty,!0):s.forEach(n.children,function(t,e){o=o.set(new h.Path(t),e)}),this.applyOperationToSyncPoints_(new i.AckUserWrite(n.path,o,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new d.Overwrite(p.OperationSource.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=c.ImmutableTree.fromObject(e);return this.applyOperationToSyncPoints_(new l.Merge(p.OperationSource.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new u.ListenComplete(p.OperationSource.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,o){var r=this.queryKeyForTag_(o);if(null!=r){var i=t.parseQueryKey_(r),a=i.path,s=i.queryId,c=h.Path.relativePath(a,e),u=new d.Overwrite(p.OperationSource.forServerTaggedQuery(s),c,n);return this.applyTaggedOperation_(a,u)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,o){var r=this.queryKeyForTag_(o);if(r){var i=t.parseQueryKey_(r),a=i.path,s=i.queryId,u=h.Path.relativePath(a,e),d=c.ImmutableTree.fromObject(n),f=new l.Merge(p.OperationSource.forServerTaggedQuery(s),u,d);return this.applyTaggedOperation_(a,f)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var o=this.queryKeyForTag_(n);if(o){var r=t.parseQueryKey_(o),i=r.path,a=r.queryId,s=h.Path.relativePath(i,e),c=new u.ListenComplete(p.OperationSource.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(i,c)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,s=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=h.Path.relativePath(t,r);i=i||e.getCompleteServerCache(n),s=s||e.hasCompleteView()});var c=this.syncPointTree_.get(r);c?(s=s||c.hasCompleteView(),i=i||c.getCompleteServerCache(h.Path.Empty)):(c=new f.SyncPoint,this.syncPointTree_=this.syncPointTree_.set(r,c));var u;if(null!=i)u=!0;else{u=!1,i=a.ChildrenNode.EMPTY_NODE;this.syncPointTree_.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(h.Path.Empty);n&&(i=i.updateImmediateChild(t,n))})}var l=c.viewExistsForQuery(e);if(!l&&!e.getQueryParams().loadsAllData()){var p=t.makeQueryKey_(e);o.assert(!(p in this.queryToTagMap_),"View does not exist, but we have a tag");var d=t.getNextQueryTag_();this.queryToTagMap_[p]=d,this.tagToQueryMap_["_"+d]=p}var m=this.pendingWriteTree_.childWrites(r),g=c.addEventRegistration(e,n,m,i,u);if(!l&&!s){var v=c.viewForQuery(e);g=g.concat(this.setupListener_(e,v))}return g},t.prototype.removeEventRegistration=function(e,n,o){var r=this,i=e.path,a=this.syncPointTree_.get(i),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var c=a.removeEventRegistration(e,n,o);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(i));var u=c.removed;s=c.events;var l=-1!==u.findIndex(function(t){return t.getQueryParams().loadsAllData()}),p=this.syncPointTree_.findOnPath(i,function(t,e){return e.hasCompleteView()});if(l&&!p){var d=this.syncPointTree_.subtree(i);if(!d.isEmpty())for(var h=this.collectDistinctViewsForSubTree_(d),f=0;f<h.length;++f){var m=h[f],g=m.getQuery(),v=this.createListenerForView_(m);this.listenProvider_.startListening(t.queryForListening_(g),this.tagForQuery_(g),v.hashFn,v.onComplete)}}if(!p&&u.length>0&&!o)if(l){this.listenProvider_.stopListening(t.queryForListening_(e),null)}else u.forEach(function(e){var n=r.queryToTagMap_[t.makeQueryKey_(e)];r.listenProvider_.stopListening(t.queryForListening_(e),n)});this.removeTags_(u)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,o=this.syncPointTree_.findOnPath(t,function(e,n){var o=h.Path.relativePath(e,t),r=n.getCompleteServerCache(o);if(r)return r});return n.calcCompleteEventCache(t,o,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView()){return[e.getCompleteView()]}var o=[];return e&&(o=e.getQueryViews()),s.forEach(n,function(t,e){o=o.concat(e)}),o})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var o=e[n];if(!o.getQueryParams().loadsAllData()){var r=t.makeQueryKey_(o),i=this.queryToTagMap_[r];delete this.queryToTagMap_[r],delete this.tagToQueryMap_["_"+i]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),a=this.createListenerForView_(n),c=this.listenProvider_.startListening(t.queryForListening_(e),i,a.hashFn,a.onComplete),u=this.syncPointTree_.subtree(r);if(i)o.assert(!u.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var l=u.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var o=[];return e&&(o=o.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),s.forEach(n,function(t,e){o=o.concat(e)}),o}),p=0;p<l.length;++p){var d=l[p];this.listenProvider_.stopListening(t.queryForListening_(d),this.tagForQuery_(d))}return c},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),o=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||a.ChildrenNode.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return o?e.applyTaggedListenComplete(n.path,o):e.applyListenComplete(n.path);var i=r.errorForServerCode(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return o.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new h.Path(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return s.safeGet(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);o.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(h.Path.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,o){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,o);var r=e.get(h.Path.Empty);null==n&&null!=r&&(n=r.getCompleteServerCache(h.Path.Empty));var i=[],a=t.path.getFront(),s=t.operationForChild(a),c=e.children.get(a);if(c&&s){var u=n?n.getImmediateChild(a):null,l=o.child(a);i=i.concat(this.applyOperationHelper_(s,c,u,l))}return r&&(i=i.concat(r.applyOperation(t,o,n))),i},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,o){var r=this,i=e.get(h.Path.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(h.Path.Empty));var a=[];return e.children.inorderTraversal(function(e,i){var s=n?n.getImmediateChild(e):null,c=o.child(e),u=t.operationForChild(e);u&&(a=a.concat(r.applyOperationDescendantsHelper_(u,i,s,c)))}),i&&(a=a.concat(i.applyOperation(t,o,n))),a},t.nextQueryTag_=1,t}();e.SyncTree=g},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(22),i=n(90),a=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=i.OperationType.ACK_USER_WRITE,this.source=i.OperationSource.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return o.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new r.Path(e));return new t(r.Path.Empty,n,this.revert)}return o.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}();e.AckUserWrite=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(22),r=n(90),i=function(){function t(t,e){this.source=t,this.path=e,this.type=r.OperationType.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,o.Path.Empty):new t(this.source,this.path.popFront())},t}();e.ListenComplete=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(90),r=n(489),i=n(22),a=n(3),s=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=o.OperationType.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new i.Path(e));return n.isEmpty()?null:n.value?new r.Overwrite(this.source,i.Path.Empty,n.value):new t(this.source,i.Path.Empty,n)}return a.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}();e.Merge=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(256),r=n(1125),i=n(36),a=n(176),s=n(491),c=n(1128),u=n(3),l=n(90),p=n(106),d=n(33),h=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),u=new o.IndexedFilter(n.getIndex()),l=n.getNodeFilter();this.processor_=new r.ViewProcessor(l);var p=e.getServerCache(),d=e.getEventCache(),h=u.updateFullNode(i.ChildrenNode.EMPTY_NODE,p.getNode(),null),f=l.updateFullNode(i.ChildrenNode.EMPTY_NODE,d.getNode(),null),m=new a.CacheNode(h,p.isFullyInitialized(),u.filtersNodes()),g=new a.CacheNode(f,d.isFullyInitialized(),l.filtersNodes());this.viewCache_=new s.ViewCache(g,m),this.eventGenerator_=new c.EventGenerator(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){u.assert(null==t,"A cancel should cancel all event registrations.");var o=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var r=t.createCancelEvent(e,o);r&&n.push(r)})}if(t){for(var r=[],i=0;i<this.eventRegistrations_.length;++i){var a=this.eventRegistrations_[i];if(a.matches(t)){if(t.hasAnyCallback()){r=r.concat(this.eventRegistrations_.slice(i+1));break}}else r.push(a)}this.eventRegistrations_=r}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===l.OperationType.MERGE&&null!==t.source.queryId&&(u.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),u.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var o=this.viewCache_,r=this.processor_.applyOperation(o,t,e,n);return this.processor_.assertIndexed(r.viewCache),u.assert(r.viewCache.getServerCache().isFullyInitialized()||!o.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=r.viewCache,this.generateEventsForChanges_(r.changes,r.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];if(!e.getNode().isLeafNode()){e.getNode().forEachChild(d.PRIORITY_INDEX,function(t,e){n.push(p.Change.childAddedChange(t,e))})}return e.isFullyInitialized()&&n.push(p.Change.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var o=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,o)},t}();e.View=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(90),r=n(3),i=n(1126),a=n(106),s=n(36),c=n(130),u=n(255),l=n(22),p=n(1127),d=function(){function t(t,e){this.viewCache=t,this.changes=e}return t}();e.ProcessorResult=d;var h=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){r.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),r.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,a,s){var c,u,l=new i.ChildChangeAccumulator;if(n.type===o.OperationType.OVERWRITE){var p=n;p.source.fromUser?c=this.applyUserOverwrite_(e,p.path,p.snap,a,s,l):(r.assert(p.source.fromServer,"Unknown source."),u=p.source.tagged||e.getServerCache().isFiltered()&&!p.path.isEmpty(),c=this.applyServerOverwrite_(e,p.path,p.snap,a,s,u,l))}else if(n.type===o.OperationType.MERGE){var h=n;h.source.fromUser?c=this.applyUserMerge_(e,h.path,h.children,a,s,l):(r.assert(h.source.fromServer,"Unknown source."),u=h.source.tagged||e.getServerCache().isFiltered(),c=this.applyServerMerge_(e,h.path,h.children,a,s,u,l))}else if(n.type===o.OperationType.ACK_USER_WRITE){var f=n;c=f.revert?this.revertUserWrite_(e,f.path,a,s,l):this.ackUserWrite_(e,f.path,f.affectedTree,a,s,l)}else{if(n.type!==o.OperationType.LISTEN_COMPLETE)throw r.assertionError("Unknown operation type: "+n.type);c=this.listenComplete_(e,n.path,a,l)}var m=l.getChanges();return t.maybeAddValueEvent_(e,c,m),new d(c,m)},t.maybeAddValueEvent_=function(t,e,n){var o=e.getEventCache();if(o.isFullyInitialized()){var r=o.getNode().isLeafNode()||o.getNode().isEmpty(),i=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||r&&!o.getNode().equals(i)||!o.getNode().getPriority().equals(i.getPriority()))&&n.push(a.Change.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,o,i){var a=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var c=void 0,u=void 0;if(e.isEmpty())if(r.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var l=t.getCompleteServerSnap(),p=l instanceof s.ChildrenNode?l:s.ChildrenNode.EMPTY_NODE,d=n.calcCompleteEventChildren(p);c=this.filter_.updateFullNode(t.getEventCache().getNode(),d,i)}else{var h=n.calcCompleteEventCache(t.getCompleteServerSnap());c=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=e.getFront();if(".priority"==f){r.assert(1==e.getLength(),"Can't have a priority with additional path components");var m=a.getNode();u=t.getServerCache().getNode();var g=n.calcEventCacheAfterServerOverwrite(e,m,u);c=null!=g?this.filter_.updatePriority(m,g):a.getNode()}else{var v=e.popFront(),y=void 0;if(a.isCompleteForChild(f)){u=t.getServerCache().getNode();var _=n.calcEventCacheAfterServerOverwrite(e,a.getNode(),u);y=null!=_?a.getNode().getImmediateChild(f).updateChild(v,_):a.getNode().getImmediateChild(f)}else y=n.calcCompleteChild(f,t.getServerCache());c=null!=y?this.filter_.updateChild(a.getNode(),f,y,v,o,i):a.getNode()}}return t.updateEventSnap(c,a.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,o,r,i,a){var s,c=t.getServerCache(),u=i?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=u.updateFullNode(c.getNode(),n,null);else if(u.filtersNodes()&&!c.isFiltered()){var l=c.getNode().updateChild(e,n);s=u.updateFullNode(c.getNode(),l,null)}else{var d=e.getFront();if(!c.isCompleteForPath(e)&&e.getLength()>1)return t;var h=e.popFront(),f=c.getNode().getImmediateChild(d),m=f.updateChild(h,n);s=".priority"==d?u.updatePriority(c.getNode(),m):u.updateChild(c.getNode(),d,m,h,p.NO_COMPLETE_CHILD_SOURCE,null)}var g=t.updateServerSnap(s,c.isFullyInitialized()||e.isEmpty(),u.filtersNodes()),v=new p.WriteTreeCompleteChildSource(o,g,r);return this.generateEventCacheAfterServerEvent_(g,e,o,v,a)},t.prototype.applyUserOverwrite_=function(t,e,n,o,r,i){var a,c,u=t.getEventCache(),l=new p.WriteTreeCompleteChildSource(o,t,r);if(e.isEmpty())c=this.filter_.updateFullNode(t.getEventCache().getNode(),n,i),a=t.updateEventSnap(c,!0,this.filter_.filtersNodes());else{var d=e.getFront();if(".priority"===d)c=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(c,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(d),m=void 0;if(h.isEmpty())m=n;else{var g=l.getCompleteChild(d);m=null!=g?".priority"===h.getBack()&&g.getChild(h.parent()).isEmpty()?g:g.updateChild(h,n):s.ChildrenNode.EMPTY_NODE}if(f.equals(m))a=t;else{var v=this.filter_.updateChild(u.getNode(),d,m,h,l,i);a=t.updateEventSnap(v,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,o,r,i,a){var s=this,c=e;return o.foreach(function(o,u){var l=n.child(o);t.cacheHasChild_(e,l.getFront())&&(c=s.applyUserOverwrite_(c,l,u,r,i,a))}),o.foreach(function(o,u){var l=n.child(o);t.cacheHasChild_(e,l.getFront())||(c=s.applyUserOverwrite_(c,l,u,r,i,a))}),c},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,o,r,i,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var c,p=t;c=e.isEmpty()?n:u.ImmutableTree.Empty.setTree(e,n);var d=t.getServerCache().getNode();return c.children.inorderTraversal(function(e,n){if(d.hasChild(e)){var c=t.getServerCache().getNode().getImmediateChild(e),u=s.applyMerge_(c,n);p=s.applyServerOverwrite_(p,new l.Path(e),u,o,r,i,a)}}),c.children.inorderTraversal(function(e,n){var c=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!d.hasChild(e)&&!c){var u=t.getServerCache().getNode().getImmediateChild(e),h=s.applyMerge_(u,n);p=s.applyServerOverwrite_(p,new l.Path(e),h,o,r,i,a)}}),p},t.prototype.ackUserWrite_=function(t,e,n,o,r,i){if(null!=o.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),o,r,a,i);if(e.isEmpty()){var p=u.ImmutableTree.Empty;return s.getNode().forEachChild(c.KEY_INDEX,function(t,e){p=p.set(new l.Path(t),e)}),this.applyServerMerge_(t,e,p,o,r,a,i)}return t}var d=u.ImmutableTree.Empty;return n.foreach(function(t,n){var o=e.child(t);s.isCompleteForPath(o)&&(d=d.set(t,s.getNode().getChild(o)))}),this.applyServerMerge_(t,e,d,o,r,a,i)},t.prototype.listenComplete_=function(t,e,n,o){var r=t.getServerCache(),i=t.updateServerSnap(r.getNode(),r.isFullyInitialized()||e.isEmpty(),r.isFiltered());return this.generateEventCacheAfterServerEvent_(i,e,n,p.NO_COMPLETE_CHILD_SOURCE,o)},t.prototype.revertUserWrite_=function(t,e,n,o,i){var a;if(null!=n.shadowingWrite(e))return t;var c=new p.WriteTreeCompleteChildSource(n,t,o),u=t.getEventCache().getNode(),d=void 0;if(e.isEmpty()||".priority"===e.getFront()){var h=void 0;if(t.getServerCache().isFullyInitialized())h=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var f=t.getServerCache().getNode();r.assert(f instanceof s.ChildrenNode,"serverChildren would be complete if leaf node"),h=n.calcCompleteEventChildren(f)}h=h,d=this.filter_.updateFullNode(u,h,i)}else{var m=e.getFront(),g=n.calcCompleteChild(m,t.getServerCache());null==g&&t.getServerCache().isCompleteForChild(m)&&(g=u.getImmediateChild(m)),d=null!=g?this.filter_.updateChild(u,m,g,e.popFront(),c,i):t.getEventCache().getNode().hasChild(m)?this.filter_.updateChild(u,m,s.ChildrenNode.EMPTY_NODE,e.popFront(),c,i):u,d.isEmpty()&&t.getServerCache().isFullyInitialized()&&(a=n.calcCompleteEventCache(t.getCompleteServerSnap()),a.isLeafNode()&&(d=this.filter_.updateFullNode(d,a,i)))}return a=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(l.Path.Empty),t.updateEventSnap(d,a,this.filter_.filtersNodes())},t}();e.ViewProcessor=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(106),i=n(3),a=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;i.assert(e==r.Change.CHILD_ADDED||e==r.Change.CHILD_CHANGED||e==r.Change.CHILD_REMOVED,"Only child changes supported for tracking"),i.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var a=o.safeGet(this.changeMap_,n);if(a){var s=a.type;if(e==r.Change.CHILD_ADDED&&s==r.Change.CHILD_REMOVED)this.changeMap_[n]=r.Change.childChangedChange(n,t.snapshotNode,a.snapshotNode);else if(e==r.Change.CHILD_REMOVED&&s==r.Change.CHILD_ADDED)delete this.changeMap_[n];else if(e==r.Change.CHILD_REMOVED&&s==r.Change.CHILD_CHANGED)this.changeMap_[n]=r.Change.childRemovedChange(n,a.oldSnap);else if(e==r.Change.CHILD_CHANGED&&s==r.Change.CHILD_ADDED)this.changeMap_[n]=r.Change.childAddedChange(n,t.snapshotNode);else{if(e!=r.Change.CHILD_CHANGED||s!=r.Change.CHILD_CHANGED)throw i.assertionError("Illegal combination of changes: "+t+" occurred after "+a);this.changeMap_[n]=r.Change.childChangedChange(n,t.snapshotNode,a.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return o.getValues(this.changeMap_)},t}();e.ChildChangeAccumulator=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(176),r=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}();e.NoCompleteChildSource_=r,e.NO_COMPLETE_CHILD_SOURCE=new r;var i=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new o.CacheNode(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var o=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),r=this.writes_.calcIndexedSlice(o,e,1,n,t);return 0===r.length?null:r[0]},t}();e.WriteTreeCompleteChildSource=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(45),r=n(106),i=n(3),a=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var o=this,i=[],a=[];return t.forEach(function(t){t.type===r.Change.CHILD_CHANGED&&o.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&a.push(r.Change.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,r.Change.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,r.Change.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,r.Change.CHILD_MOVED,a,n,e),this.generateEventsForType_(i,r.Change.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,r.Change.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,o,r){var i=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=i.materializeSingleChange_(e,r);o.forEach(function(o){o.respondsTo(e.type)&&t.push(o.createEvent(n,i.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw i.assertionError("Should only compare child_ events.");var n=new o.NamedNode(t.childName,t.snapshotNode),r=new o.NamedNode(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}();e.EventGenerator=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(3),i=n(22),a=n(1130),s=n(33),c=n(36),u=function(){function t(){this.visibleWrites_=a.CompoundWrite.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new l(t,this)},t.prototype.addOverwrite=function(t,e,n,o){r.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===o&&(o=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:o}),o&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){r.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});r.assert(n>=0,"removeWrite called with nonexistent writeId.");var i=this.allWrites_[n];this.allWrites_.splice(n,1);for(var a=i.visible,s=!1,c=this.allWrites_.length-1;a&&c>=0;){var u=this.allWrites_[c];u.visible&&(c>=n&&this.recordContainsPath_(u,i.path)?a=!1:i.path.contains(u.path)&&(s=!0)),c--}if(a){if(s)return this.resetTree_(),!0;if(i.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(i.path);else{var l=i.children;o.forEach(l,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(i.path.child(t))})}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,o,r){if(o||r){var a=this.visibleWrites_.childCompoundWrite(e);if(!r&&a.isEmpty())return n;if(r||null!=n||a.hasCompleteWrite(i.Path.Empty)){var s=function(t){return(t.visible||r)&&(!o||!~o.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},u=t.layerTree_(this.allWrites_,s,e),l=n||c.ChildrenNode.EMPTY_NODE;return u.apply(l)}return null}var p=this.visibleWrites_.getCompleteNode(e);if(null!=p)return p;var d=this.visibleWrites_.childCompoundWrite(e);if(d.isEmpty())return n;if(null!=n||d.hasCompleteWrite(i.Path.Empty)){var l=n||c.ChildrenNode.EMPTY_NODE;return d.apply(l)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=c.ChildrenNode.EMPTY_NODE,o=this.visibleWrites_.getCompleteNode(t);if(o)return o.isLeafNode()||o.forEachChild(s.PRIORITY_INDEX,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var r=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(s.PRIORITY_INDEX,function(t,e){var o=r.childCompoundWrite(new i.Path(t)).apply(e);n=n.updateImmediateChild(t,o)}),r.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,o){r.assert(n||o,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var a=this.visibleWrites_.childCompoundWrite(i);return a.isEmpty()?o.getChild(e):a.apply(o.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var o=t.child(e),r=this.visibleWrites_.getCompleteNode(o);if(null!=r)return r;if(n.isCompleteForChild(e)){return this.visibleWrites_.childCompoundWrite(o).apply(n.getNode().getImmediateChild(e))}return null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,o,r,a){var s,c=this.visibleWrites_.childCompoundWrite(t),u=c.getCompleteNode(i.Path.Empty);if(null!=u)s=u;else{if(null==e)return[];s=c.apply(e)}if(s=s.withIndex(a),s.isEmpty()||s.isLeafNode())return[];for(var l=[],p=a.getCompare(),d=r?s.getReverseIteratorFrom(n,a):s.getIteratorFrom(n,a),h=d.getNext();h&&l.length<o;)0!==p(h,n)&&l.push(h),h=d.getNext();return l},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!o.findKey(t.children,function(n,o){return t.path.child(o).contains(e)})},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,i.Path.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var s=a.CompoundWrite.Empty,c=0;c<t.length;++c){var u=t[c];if(e(u)){var l=u.path,p=void 0;if(u.snap)n.contains(l)?(p=i.Path.relativePath(n,l),s=s.addWrite(p,u.snap)):l.contains(n)&&(p=i.Path.relativePath(l,n),s=s.addWrite(i.Path.Empty,u.snap.getChild(p)));else{if(!u.children)throw r.assertionError("WriteRecord should have .snap or .children");if(n.contains(l))p=i.Path.relativePath(n,l),s=s.addWrites(p,u.children);else if(l.contains(n))if(p=i.Path.relativePath(l,n),p.isEmpty())s=s.addWrites(i.Path.Empty,u.children);else{var d=o.safeGet(u.children,p.getFront());if(d){var h=d.getChild(p.popFront());s=s.addWrite(i.Path.Empty,h)}}}}}return s},t}();e.WriteTree=u;var l=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,o,r){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,o,r)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}();e.WriteTreeRef=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(255),r=n(22),i=n(3),a=n(45),s=n(33),c=n(3),u=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new o.ImmutableTree(n));var i=this.writeTree_.findRootMostValueAndPath(e);if(null!=i){var a=i.path,s=i.value,c=r.Path.relativePath(a,e);return s=s.updateChild(c,n),new t(this.writeTree_.set(a,s))}var u=new o.ImmutableTree(n);return new t(this.writeTree_.setTree(e,u))},t.prototype.addWrites=function(t,e){var n=this;return i.forEach(e,function(e,o){n=n.addWrite(t.child(e),o)}),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,o.ImmutableTree.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(r.Path.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(s.PRIORITY_INDEX,function(e,n){t.push(new a.NamedNode(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new a.NamedNode(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new o.ImmutableTree(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(r.Path.Empty,this.writeTree_,e)},t.Empty=new t(new o.ImmutableTree(null)),t.applySubtreeWrite_=function(e,n,o){if(null!=n.value)return o.updateChild(e,n.value);var r=null;return n.children.inorderTraversal(function(n,i){".priority"===n?(c.assert(null!==i.value,"Priority writes must always be leaf nodes"),r=i.value):o=t.applySubtreeWrite_(e.child(n),i,o)}),o.getChild(e).isEmpty()||null===r||(o=o.updateChild(e.child(".priority"),r)),o},t}();e.CompoundWrite=u},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(36),r=function(){function t(){this.rootNode_=o.ChildrenNode.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}();e.SnapshotHolder=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(o.log("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',o.warn(t)},t}();e.AuthTokenProvider=r},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(3),i=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),r.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return o.deepCopy(this.counters_)},t}();e.StatsCollection=i},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(9),i=n(492),a=1e4,s=3e4,c=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new i.StatsListener(t);var n=a+(s-a)*Math.random();r.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},i=!1;o.forEach(e,function(e,r){r>0&&o.contains(t.statsToReport_,e)&&(n[e]=r,i=!0)}),i&&this.server_.reportStats(n),r.setTimeoutNonBlocking(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}();e.StatsReporter=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var o=t[n],r=o.getPath();null===e||r.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new i(r)),e.add(o)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var o=this.eventLists_[n];if(o){t(o.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}}e&&(this.eventLists_=[]),this.recursionDepth_--},t}();e.EventQueue=r;var i=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();o.logger&&o.log("event: "+e.toString()),o.exceptionGuard(n)}}},t.prototype.getPath=function(){return this.path_},t}();e.EventList=i},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(494),i=n(3),a=function(t){function e(){var e,n,o=t.call(this,["visible"])||this;return"undefined"!=typeof document&&void 0!==document.addEventListener&&(void 0!==document.hidden?(n="visibilitychange",e="hidden"):void 0!==document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):void 0!==document.msHidden?(n="msvisibilitychange",e="msHidden"):void 0!==document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),o.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==o.visible_&&(o.visible_=t,o.trigger("visible",t))},!1),o}return o(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return i.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(r.EventEmitter);e.VisibilityMonitor=a},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(494),a=n(3),s=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"==typeof window||void 0===window.addEventListener||a.isMobileCordova()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return o(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return r.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(i.EventEmitter);e.OnlineMonitor=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(496),r=n(497),i=n(9),a=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[o.BrowserPollConnection,r.WebSocketConnection]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=r.WebSocketConnection&&r.WebSocketConnection.isAvailable(),o=n&&!r.WebSocketConnection.previouslyFailed();if(e.webSocketOnly&&(n||i.warn("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),o=!0),o)this.transports_=[r.WebSocketConnection];else{var a=this.transports_=[];i.each(t.ALL_TRANSPORTS,function(t,e){e&&e.isAvailable()&&a.push(e)})}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}();e.TransportManager=a},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(9),r=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=this;this.pendingResponses[this.currentResponseNum];){if("break"===function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=0;e<t.length;++e)!function(e){t[e]&&o.exceptionGuard(function(){n.onMessage_(t[e])})}(e);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}())break}},t}();e.PacketReceiver=r},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}();Object.defineProperty(e,"__esModule",{value:!0});var r=n(3),i=n(9),a=n(3),s=n(3),c=n(3),u=n(498),l=function(t){function e(e,n,o){var r=t.call(this)||this;return r.repoInfo_=e,r.onDataUpdate_=n,r.authTokenProvider_=o,r.log_=i.logWrapper("p:rest:"),r.listens_={},r}return o(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(r.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,o,r){var i=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var c=e.getListenId_(t,o),u={};this.listens_[c]=u;var l=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",l,function(t,e){var n=e;if(404===t&&(n=null,t=null),null===t&&i.onDataUpdate_(a,n,!1,o),s.safeGet(i.listens_,c)===u){var l;l=t?401==t?"permission_denied":"rest_error:"+t:"ok",r(l,null)}})},e.prototype.unlisten=function(t,n){var o=e.getListenId_(t,n);delete this.listens_[o]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var o=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(r){var s=r&&r.accessToken;s&&(e.auth=s);var u=(o.repoInfo_.secure?"https://":"http://")+o.repoInfo_.host+t+"?"+c.querystring(e);o.log_("Sending REST request for "+u);var l=new XMLHttpRequest;l.onreadystatechange=function(){if(n&&4===l.readyState){o.log_("REST Response for "+u+" received. status:",l.status,"response:",l.responseText);var t=null;if(l.status>=200&&l.status<300){try{t=a.jsonEval(l.responseText)}catch(t){i.warn("Failed to parse JSON response for "+u+": "+l.responseText)}n(null,t)}else 401!==l.status&&404!==l.status&&i.warn("Got unsuccessful REST response for "+u+" Status: "+l.status),n(l.status);n=null}},l.open("GET",u,!0),l.send()})},e}(u.ServerActions);e.ReadonlyRestClient=l},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(9),i=n(130),a=n(33),s=n(480),c=n(484),u=n(256),l=n(1142),p=n(499),d=n(3),h=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=a.PRIORITY_INDEX}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return o.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return o.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:r.MIN_NAME},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return o.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return o.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:r.MAX_NAME},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return o.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var o=this.viewFrom_;""===o&&(o=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=o}return this.index_!==a.PRIORITY_INDEX&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==a.PRIORITY_INDEX},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new u.IndexedFilter(this.getIndex()):this.hasLimit()?new l.LimitedFilter(this):new p.RangedFilter(this)},t.prototype.toRestQueryStringParameters=function(){var e=t.REST_QUERY_CONSTANTS_,n={};if(this.isDefault())return n;var r;return this.index_===a.PRIORITY_INDEX?r=e.PRIORITY_INDEX:this.index_===s.VALUE_INDEX?r=e.VALUE_INDEX:this.index_===i.KEY_INDEX?r=e.KEY_INDEX:(o.assert(this.index_ instanceof c.PathIndex,"Unrecognized index type!"),r=this.index_.toString()),n[e.ORDER_BY]=d.stringify(r),this.startSet_&&(n[e.START_AT]=d.stringify(this.indexStartValue_),this.startNameSet_&&(n[e.START_AT]+=","+d.stringify(this.indexStartName_))),this.endSet_&&(n[e.END_AT]=d.stringify(this.indexEndValue_),this.endNameSet_&&(n[e.END_AT]+=","+d.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[e.LIMIT_TO_FIRST]=this.limit_:n[e.LIMIT_TO_LAST]=this.limit_),n},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}();e.QueryParams=h},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(499),r=n(36),i=n(45),a=n(3),s=n(106),c=function(){function t(t){this.rangedFilter_=new o.RangedFilter(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,o,a,s){return this.rangedFilter_.matches(new i.NamedNode(e,n))||(n=r.ChildrenNode.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,o,a,s):this.fullLimitUpdateChild_(t,e,n,a,s)},t.prototype.updateFullNode=function(t,e,n){var o;if(e.isLeafNode()||e.isEmpty())o=r.ChildrenNode.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){o=r.ChildrenNode.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var a=0;i.hasNext()&&a<this.limit_;){var s=i.getNext(),c=void 0;if(!(c=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),s)<=0:this.index_.compare(s,this.rangedFilter_.getEndPost())<=0))break;o=o.updateImmediateChild(s.name,s.node),a++}}else{o=e.withIndex(this.index_),o=o.updatePriority(r.ChildrenNode.EMPTY_NODE);var u=void 0,l=void 0,p=void 0,i=void 0;if(this.reverse_){i=o.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),l=this.rangedFilter_.getStartPost();var d=this.index_.getCompare();p=function(t,e){return d(e,t)}}else i=o.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),l=this.rangedFilter_.getEndPost(),p=this.index_.getCompare();for(var a=0,h=!1;i.hasNext();){var s=i.getNext();!h&&p(u,s)<=0&&(h=!0);var c=h&&a<this.limit_&&p(s,l)<=0;c?a++:o=o.updateImmediateChild(s.name,r.ChildrenNode.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,o,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,o,c){var u;if(this.reverse_){var l=this.index_.getCompare();u=function(t,e){return l(e,t)}}else u=this.index_.getCompare();var p=t;a.assert(p.numChildren()==this.limit_,"");var d=new i.NamedNode(e,n),h=this.reverse_?p.getFirstChild(this.index_):p.getLastChild(this.index_),f=this.rangedFilter_.matches(d);if(p.hasChild(e)){for(var m=p.getImmediateChild(e),g=o.getChildAfterChild(this.index_,h,this.reverse_);null!=g&&(g.name==e||p.hasChild(g.name));)g=o.getChildAfterChild(this.index_,g,this.reverse_);var v=null==g?1:u(g,d);if(f&&!n.isEmpty()&&v>=0)return null!=c&&c.trackChildChange(s.Change.childChangedChange(e,n,m)),p.updateImmediateChild(e,n);null!=c&&c.trackChildChange(s.Change.childRemovedChange(e,m));var y=p.updateImmediateChild(e,r.ChildrenNode.EMPTY_NODE);return null!=g&&this.rangedFilter_.matches(g)?(null!=c&&c.trackChildChange(s.Change.childAddedChange(g.name,g.node)),y.updateImmediateChild(g.name,g.node)):y}return n.isEmpty()?t:f&&u(h,d)>=0?(null!=c&&(c.trackChildChange(s.Change.childRemovedChange(h.name,h.node)),c.trackChildChange(s.Change.childAddedChange(e,n))),p.updateImmediateChild(e,n).updateImmediateChild(h.name,r.ChildrenNode.EMPTY_NODE)):t},t}();e.LimitedFilter=c},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o,r=n(3),i=n(254),a=n(485),s=n(22),c=n(1144),u=n(33),l=n(9),p=n(486),d=n(89),h=n(3),f=n(131),m=n(36),g=n(175);!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(o=e.TransactionStatus||(e.TransactionStatus={})),g.Repo.MAX_TRANSACTION_RETRIES_=25,g.Repo.prototype.transactions_init_=function(){this.transactionQueueTree_=new c.Tree},g.Repo.prototype.startTransaction=function(t,e,n,s){this.log_("transaction on "+t);var c=function(){},g=new i.Reference(this,t);g.on("value",c);var v=function(){g.off("value",c)},y={path:t,update:e,onComplete:n,status:null,order:l.LUIDGenerator(),applyLocally:s,retryCount:0,unwatcher:v,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},_=this.getLatestState_(t);y.currentInputSnapshot=_;var b=y.update(_.val());if(void 0===b){if(y.unwatcher(),y.currentOutputSnapshotRaw=null,y.currentOutputSnapshotResolved=null,y.onComplete){var w=new a.DataSnapshot(y.currentInputSnapshot,new i.Reference(this,y.path),u.PRIORITY_INDEX);y.onComplete(null,!1,w)}}else{d.validateFirebaseData("transaction failed: Data returned ",b,y.path),y.status=o.RUN;var I=this.transactionQueueTree_.subTree(t),E=I.getValue()||[];E.push(y),I.setValue(E);var R=void 0;if("object"==typeof b&&null!==b&&h.contains(b,".priority"))R=h.safeGet(b,".priority"),r.assert(d.isValidPriority(R),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{R=(this.serverSyncTree_.calcCompleteEventCache(t)||m.ChildrenNode.EMPTY_NODE).getPriority().val()}R=R;var x=this.generateServerValues(),S=f.nodeFromJSON(b,R),P=p.resolveDeferredValueSnapshot(S,x);y.currentOutputSnapshotRaw=S,y.currentOutputSnapshotResolved=P,y.currentWriteId=this.getNextWriteId_();var T=this.serverSyncTree_.applyUserOverwrite(t,P,y.currentWriteId,y.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,T),this.sendReadyTransactions_()}},g.Repo.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||m.ChildrenNode.EMPTY_NODE},g.Repo.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);r.assert(n.length>0,"Sending zero length transaction queue");n.every(function(t){return t.status===o.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},g.Repo.prototype.sendTransactionQueue_=function(t,e){for(var n=this,c=e.map(function(t){return t.currentWriteId}),p=this.getLatestState_(t,c),d=p,h=p.hash(),f=0;f<e.length;f++){var m=e[f];r.assert(m.status===o.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),m.status=o.SENT,m.retryCount++;var g=s.Path.relativePath(t,m.path);d=d.updateChild(g,m.currentOutputSnapshotRaw)}var v=d.val(!0),y=t;this.server_.put(y.toString(),v,function(r){n.log_("transaction put response",{path:y.toString(),status:r});var s=[];if("ok"===r){for(var c=[],p=0;p<e.length;p++){if(e[p].status=o.COMPLETED,s=s.concat(n.serverSyncTree_.ackUserWrite(e[p].currentWriteId)),e[p].onComplete){var d=e[p].currentOutputSnapshotResolved,h=new i.Reference(n,e[p].path),f=new a.DataSnapshot(d,h,u.PRIORITY_INDEX);c.push(e[p].onComplete.bind(null,null,!0,f))}e[p].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,s);for(var p=0;p<c.length;p++)l.exceptionGuard(c[p])}else{if("datastale"===r)for(var p=0;p<e.length;p++)e[p].status===o.SENT_NEEDS_ABORT?e[p].status=o.NEEDS_ABORT:e[p].status=o.RUN;else{l.warn("transaction at "+y.toString()+" failed: "+r);for(var p=0;p<e.length;p++)e[p].status=o.NEEDS_ABORT,e[p].abortReason=r}n.rerunTransactions_(t)}},h)},g.Repo.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),o=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(o,n),n},g.Repo.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],c=[],m=t.filter(function(t){return t.status===o.RUN}),v=m.map(function(t){return t.currentWriteId}),y=0;y<t.length;y++){var _=t[y],b=s.Path.relativePath(e,_.path),w=!1,I=void 0;if(r.assert(null!==b,"rerunTransactionsUnderNode_: relativePath should not be null."),_.status===o.NEEDS_ABORT)w=!0,I=_.abortReason,c=c.concat(this.serverSyncTree_.ackUserWrite(_.currentWriteId,!0));else if(_.status===o.RUN)if(_.retryCount>=g.Repo.MAX_TRANSACTION_RETRIES_)w=!0,I="maxretry",c=c.concat(this.serverSyncTree_.ackUserWrite(_.currentWriteId,!0));else{var E=this.getLatestState_(_.path,v);_.currentInputSnapshot=E;var R=t[y].update(E.val());if(void 0!==R){d.validateFirebaseData("transaction failed: Data returned ",R,_.path);var x=f.nodeFromJSON(R),S="object"==typeof R&&null!=R&&h.contains(R,".priority");S||(x=x.updatePriority(E.getPriority()));var P=_.currentWriteId,T=this.generateServerValues(),O=p.resolveDeferredValueSnapshot(x,T);_.currentOutputSnapshotRaw=x,_.currentOutputSnapshotResolved=O,_.currentWriteId=this.getNextWriteId_(),v.splice(v.indexOf(P),1),c=c.concat(this.serverSyncTree_.applyUserOverwrite(_.path,O,_.currentWriteId,_.applyLocally)),c=c.concat(this.serverSyncTree_.ackUserWrite(P,!0))}else w=!0,I="nodata",c=c.concat(this.serverSyncTree_.ackUserWrite(_.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,c),c=[],w&&(t[y].status=o.COMPLETED,function(t){setTimeout(t,Math.floor(0))}(t[y].unwatcher),t[y].onComplete))if("nodata"===I){var C=new i.Reference(this,t[y].path),A=t[y].currentInputSnapshot,N=new a.DataSnapshot(A,C,u.PRIORITY_INDEX);n.push(t[y].onComplete.bind(null,null,!1,N))}else n.push(t[y].onComplete.bind(null,new Error(I),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var y=0;y<n.length;y++)l.exceptionGuard(n[y]);this.sendReadyTransactions_()}},g.Repo.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},g.Repo.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},g.Repo.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,o=t.getValue();if(null!==o)for(var r=0;r<o.length;r++)e.push(o[r]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},g.Repo.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==o.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},g.Repo.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),o=this.transactionQueueTree_.subTree(t);return o.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(o),o.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},g.Repo.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],i=[],a=-1,s=0;s<e.length;s++)if(e[s].status===o.SENT_NEEDS_ABORT);else if(e[s].status===o.SENT)r.assert(a===s-1,"All SENT items should be at beginning of queue."),a=s,e[s].status=o.SENT_NEEDS_ABORT,e[s].abortReason="set";else if(r.assert(e[s].status===o.RUN,"Unexpected transaction status in abort"),e[s].unwatcher(),i=i.concat(this.serverSyncTree_.ackUserWrite(e[s].currentWriteId,!0)),e[s].onComplete){n.push(e[s].onComplete.bind(null,new Error("set"),!1,null))}-1===a?t.setValue(null):e.length=a+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),i);for(var s=0;s<n.length;s++)l.exceptionGuard(n[s])}}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(3),r=n(22),i=n(3),a=function(){function t(){this.children={},this.childCount=0,this.value=null}return t}();e.TreeNode=a;var s=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new a),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,o=e instanceof r.Path?e:new r.Path(e),s=this;null!==(n=o.getFront());){s=new t(n,s,i.safeGet(s.node_.children,n)||new a),o=o.popFront()}return s},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){o.assert(void 0!==t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;i.forEach(this.node_.children,function(o,r){e(new t(o,n,r))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new r.Path(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),o=i.contains(this.node_.children,t);n&&o?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||o||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();e.Tree=s},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(497),r=n(496);e.forceLongPolling=function(){o.WebSocketConnection.forceDisallow(),r.BrowserPollConnection.forceAllow()},e.forceWebSockets=function(){r.BrowserPollConnection.forceDisallow()},e.isWebSocketsAvailable=function(){return o.WebSocketConnection.isAvailable()},e.setSecurityDebugCallback=function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},e.stats=function(t,e){t.repo.stats(e)},e.statsIncrementCounter=function(t,e){t.repo.statsIncrementCounter(e)},e.dataUpdateCount=function(t){return t.repo.dataUpdateCount},e.interceptServerData=function(t,e){return t.repo.interceptServerData_(e)}},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n(477),r=n(493),i=n(258),a=n(495);e.DataConnection=r.PersistentConnection,r.PersistentConnection.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},r.PersistentConnection.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)},e.RealTimeConnection=a.Connection,e.hijackHash=function(t){var e=r.PersistentConnection.prototype.put;return r.PersistentConnection.prototype.put=function(n,o,r,i){void 0!==i&&(i=t()),e.call(this,n,o,r,i)},function(){r.PersistentConnection.prototype.put=e}},e.ConnectionTarget=o.RepoInfo,e.queryIdentifier=function(t){return t.queryIdentifier()},e.listens=function(t){return t.repo.persistentConnection_.listens_},e.forceRestClient=function(t){i.RepoManager.getInstance().forceRestClient(t)}},function(t,e,n){n(1148)},function(t,e,n){"use strict";function o(t){var e=function(t){return self&&"ServiceWorkerGlobalScope"in self?new i.a(t):new r.a(t)},n={Messaging:r.a};t.INTERNAL.registerService("messaging",e,n)}Object.defineProperty(e,"__esModule",{value:!0}),e.registerMessaging=o;var r=n(1149),i=n(1153);o(n(74).default)},function(t,e,n){"use strict";var o=n(500),r=n(177),i=n(503),a=n(1152),s=n(502),c=n(3),u=(n.n(c),this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}()),l=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse_,n.manifestCheckPromise_,n.messageObserver_=null,n.onMessage_=Object(c.createSubscribe)(function(t){n.messageObserver_=t}),n.tokenRefreshObserver_=null,n.onTokenRefresh_=Object(c.createSubscribe)(function(t){n.tokenRefreshObserver_=t}),n.setupSWMessageListener_(),n}return u(e,t),e.prototype.getToken=function(){var e=this;return this.isSupported_()?this.manifestCheck_().then(function(){return t.prototype.getToken.call(e)}):Promise.reject(this.errorFactory_.create(r.a.codes.UNSUPPORTED_BROWSER))},e.prototype.manifestCheck_=function(){var t=this;if(this.manifestCheckPromise_)return this.manifestCheckPromise_;var e=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise_=e?fetch(e.href).then(function(t){return t.json()}).catch(function(){return Promise.resolve()}).then(function(e){if(e&&e.gcm_sender_id&&"103953800507"!==e.gcm_sender_id)throw t.errorFactory_.create(r.a.codes.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.manifestCheckPromise_},e.prototype.requestPermission=function(){var t=this;return Notification.permission===s.a.granted?Promise.resolve():new Promise(function(e,n){var o=function(o){return o===s.a.granted?e():n(o===s.a.denied?t.errorFactory_.create(r.a.codes.PERMISSION_BLOCKED):t.errorFactory_.create(r.a.codes.PERMISSION_DEFAULT))},i=Notification.requestPermission(function(t){i||o(t)});i&&i.then(o)})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw this.errorFactory_.create(r.a.codes.SW_REGISTRATION_EXPECTED);if(void 0!==this.registrationToUse_)throw this.errorFactory_.create(r.a.codes.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse_=t},e.prototype.onMessage=function(t,e,n){return this.onMessage_(t,e,n)},e.prototype.onTokenRefresh=function(t,e,n){return this.onTokenRefresh_(t,e,n)},e.prototype.waitForRegistrationToActivate_=function(t){var e=this,n=t.installing||t.waiting||t.active;return new Promise(function(o,i){if(!n)return void i(e.errorFactory_.create(r.a.codes.NO_SW_IN_REG));if("activated"===n.state)return void o(t);if("redundant"===n.state)return void i(e.errorFactory_.create(r.a.codes.SW_REG_REDUNDANT));var a=function(){if("activated"===n.state)o(t);else{if("redundant"!==n.state)return;i(e.errorFactory_.create(r.a.codes.SW_REG_REDUNDANT))}n.removeEventListener("statechange",a)};n.addEventListener("statechange",a)})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse_?this.waitForRegistrationToActivate_(this.registrationToUse_):(this.registrationToUse_=null,navigator.serviceWorker.register(a.a.path,{scope:a.a.scope}).catch(function(e){throw t.errorFactory_.create(r.a.codes.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:e.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return t.registrationToUse_=e,e.update(),e})}))},e.prototype.setupSWMessageListener_=function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[i.a.PARAMS.TYPE_OF_MSG]){var n=e.data;switch(n[i.a.PARAMS.TYPE_OF_MSG]){case i.a.TYPES_OF_MSG.PUSH_MSG_RECEIVED:case i.a.TYPES_OF_MSG.NOTIFICATION_CLICKED:var o=n[i.a.PARAMS.DATA];t.messageObserver_.next(o)}}},!1)},e.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},e}(o.a);e.a=l},function(t,e,n){"use strict";var o=n(3),r=(n.n(o),n(177)),i=n(1151),a=n(501),s="fcm_token_object_Store",c=function(){function t(){this.errorFactory_=new o.ErrorFactory("messaging","Messaging",r.a.map),this.openDbPromise_=null}return t.prototype.openDatabase_=function(){return this.openDbPromise_?this.openDbPromise_:(this.openDbPromise_=new Promise(function(e,n){var o=indexedDB.open(t.DB_NAME,1);o.onerror=function(t){n(t.target.error)},o.onsuccess=function(t){e(t.target.result)},o.onupgradeneeded=function(t){var e=t.target.result,n=e.createObjectStore(s,{keyPath:"swScope"});n.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),n.createIndex("fcmToken","fcmToken",{unique:!0})}}),this.openDbPromise_)},t.prototype.closeDatabase=function(){var t=this;return this.openDbPromise_?this.openDbPromise_.then(function(e){e.close(),t.openDbPromise_=null}):Promise.resolve()},t.prototype.getTokenDetailsFromToken=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,o){var r=e.transaction([s]),i=r.objectStore(s),a=i.index("fcmToken"),c=a.get(t);c.onerror=function(t){o(t.target.error)},c.onsuccess=function(t){n(t.target.result)}})})},t.prototype.getTokenDetailsFromSWScope_=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,o){var r=e.transaction([s]),i=r.objectStore(s),a=i.get(t);a.onerror=function(t){o(t.target.error)},a.onsuccess=function(t){n(t.target.result)}})})},t.prototype.getAllTokenDetailsForSenderId_=function(t){return this.openDatabase_().then(function(e){return new Promise(function(n,o){var r=e.transaction([s]),i=r.objectStore(s),a=[],c=i.openCursor();c.onerror=function(t){o(t.target.error)},c.onsuccess=function(e){var o=e.target.result;o?(o.value.fcmSenderId===t&&a.push(o.value),o.continue()):n(a)}})})},t.prototype.subscribeToFCM=function(t,e,n){var o=this,s=Object(i.a)(e.getKey("p256dh")),c=Object(i.a)(e.getKey("auth")),u="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+s+"&encryption_auth="+c;n&&(u+="&pushSet="+n);var l=new Headers;l.append("Content-Type","application/x-www-form-urlencoded");var p={method:"POST",headers:l,body:u};return fetch(a.a.ENDPOINT+"/fcm/connect/subscribe",p).then(function(t){return t.json()}).then(function(t){var e=t;if(e.error){var n=e.error.message;throw o.errorFactory_.create(r.a.codes.TOKEN_SUBSCRIBE_FAILED,{message:n})}if(!e.token)throw o.errorFactory_.create(r.a.codes.TOKEN_SUBSCRIBE_NO_TOKEN);if(!e.pushSet)throw o.errorFactory_.create(r.a.codes.TOKEN_SUBSCRIBE_NO_PUSH_SET);return{token:e.token,pushSet:e.pushSet}})},t.prototype.isSameSubscription_=function(t,e){return t.endpoint===e.endpoint&&Object(i.a)(t.getKey("auth"))===e.auth&&Object(i.a)(t.getKey("p256dh"))===e.p256dh},t.prototype.saveTokenDetails_=function(t,e,n,o,r){var a={swScope:e.scope,endpoint:n.endpoint,auth:Object(i.a)(n.getKey("auth")),p256dh:Object(i.a)(n.getKey("p256dh")),fcmToken:o,fcmPushSet:r,fcmSenderId:t};return this.openDatabase_().then(function(t){return new Promise(function(e,n){var o=t.transaction([s],"readwrite"),r=o.objectStore(s),i=r.put(a);i.onerror=function(t){n(t.target.error)},i.onsuccess=function(t){e()}})})},t.prototype.getSavedToken=function(t,e){var n=this;return e instanceof ServiceWorkerRegistration?"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(r.a.codes.BAD_SENDER_ID)):this.getAllTokenDetailsForSenderId_(t).then(function(n){if(0!==n.length){var o=n.findIndex(function(n){return e.scope===n.swScope&&t===n.fcmSenderId});if(-1!==o)return n[o]}}).then(function(t){if(t)return e.pushManager.getSubscription().catch(function(t){throw n.errorFactory_.create(r.a.codes.GET_SUBSCRIPTION_FAILED)}).then(function(e){if(e&&n.isSameSubscription_(e,t))return t.fcmToken})}):Promise.reject(this.errorFactory_.create(r.a.codes.SW_REGISTRATION_EXPECTED))},t.prototype.createToken=function(t,e){var n=this;if("string"!=typeof t||0===t.length)return Promise.reject(this.errorFactory_.create(r.a.codes.BAD_SENDER_ID));if(!(e instanceof ServiceWorkerRegistration))return Promise.reject(this.errorFactory_.create(r.a.codes.SW_REGISTRATION_EXPECTED));var o,i;return e.pushManager.getSubscription().then(function(t){return t||e.pushManager.subscribe(a.a.SUBSCRIPTION_OPTIONS)}).then(function(e){return o=e,n.subscribeToFCM(t,o)}).then(function(r){return i=r,n.saveTokenDetails_(t,e,o,i.token,i.pushSet)}).then(function(){return i.token})},t.prototype.deleteToken=function(t){var e=this;return"string"!=typeof t||0===t.length?Promise.reject(this.errorFactory_.create(r.a.codes.INVALID_DELETE_TOKEN)):this.getTokenDetailsFromToken(t).then(function(t){if(!t)throw e.errorFactory_.create(r.a.codes.DELETE_TOKEN_NOT_FOUND);return e.openDatabase_().then(function(n){return new Promise(function(o,i){var a=n.transaction([s],"readwrite"),c=a.objectStore(s),u=c.delete(t.swScope);u.onerror=function(t){i(t.target.error)},u.onsuccess=function(n){if(0===n.target.result)return void i(e.errorFactory_.create(r.a.codes.FAILED_TO_DELETE_TOKEN));o(t)}})})})},t}();e.a=c},function(t,e,n){"use strict";function o(t){var e=new Uint8Array(t);return window.btoa(String.fromCharCode.apply(null,e))}e.a=function(t){return o(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}},function(t,e,n){"use strict";e.a={path:"/firebase-messaging-sw.js",scope:"/firebase-cloud-messaging-push-scope"}},function(t,e,n){"use strict";var o=n(500),r=n(177),i=n(503),a=n(501),s=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),c=function(t){function e(e){var n=t.call(this,e)||this;return self.addEventListener("push",function(t){return n.onPush_(t)},!1),self.addEventListener("pushsubscriptionchange",function(t){return n.onSubChange_(t)},!1),self.addEventListener("notificationclick",function(t){return n.onNotificationClick_(t)},!1),n.bgMessageHandler_=null,n}return s(e,t),e.prototype.onPush_=function(t){var e,n=this;try{e=t.data.json()}catch(t){return}var o=this.hasVisibleClients_().then(function(t){if(t){if(e.notification||n.bgMessageHandler_)return n.sendMessageToWindowClients_(e)}else{var o=n.getNotificationData_(e);if(o){var r=o.title||"";return self.registration.showNotification(r,o)}if(n.bgMessageHandler_)return n.bgMessageHandler_(e)}});t.waitUntil(o)},e.prototype.onSubChange_=function(t){var e=this,n=this.getToken().then(function(t){if(!t)throw e.errorFactory_.create(r.a.codes.NO_FCM_TOKEN_FOR_RESUBSCRIBE);var n=null,o=e.getTokenManager();return o.getTokenDetailsFromToken(t).then(function(t){if(!(n=t))throw e.errorFactory_.create(r.a.codes.INVALID_SAVED_TOKEN);return self.registration.pushManager.subscribe(a.a.SUBSCRIPTION_OPTIONS)}).then(function(t){return o.subscribeToFCM(n.fcmSenderId,t,n.fcmPushSet)}).catch(function(t){return o.deleteToken(n.fcmToken).then(function(){throw e.errorFactory_.create(r.a.codes.UNABLE_TO_RESUBSCRIBE,{message:t})})})});t.waitUntil(n)},e.prototype.onNotificationClick_=function(t){var e=this;if(t.notification&&t.notification.data&&t.notification.data.FCM_MSG){t.stopImmediatePropagation(),t.notification.close();var n=t.notification.data.FCM_MSG,o=n.notification.click_action;if(o){var r=this.getWindowClient_(o).then(function(t){return t||self.clients.openWindow(o)}).then(function(t){if(t){n.notification;delete n.notification;var o=i.a.createNewMsg(i.a.TYPES_OF_MSG.NOTIFICATION_CLICKED,n);return e.attemptToMessageClient_(t,o)}});t.waitUntil(r)}}},e.prototype.getNotificationData_=function(t){if(t&&"object"==typeof t.notification){var e=Object.assign({},t.notification);return e.data=(n={},n.FCM_MSG=t,n),e;var n}},e.prototype.setBackgroundMessageHandler=function(t){if(t&&"function"!=typeof t)throw this.errorFactory_.create(r.a.codes.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler_=t},e.prototype.getWindowClient_=function(t){var e=new URL(t).href;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){for(var n=null,o=0;o<t.length;o++){if(new URL(t[o].url).href===e){n=t[o];break}}if(n)return n.focus(),n})},e.prototype.attemptToMessageClient_=function(t,e){var n=this;return new Promise(function(o,i){if(!t)return i(n.errorFactory_.create(r.a.codes.NO_WINDOW_CLIENT_TO_MSG));t.postMessage(e),o()})},e.prototype.hasVisibleClients_=function(){return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(t){return t.some(function(t){return"visible"===t.visibilityState})})},e.prototype.sendMessageToWindowClients_=function(t){var e=this;return self.clients.matchAll({type:"window",includeUncontrolled:!0}).then(function(n){var o=i.a.createNewMsg(i.a.TYPES_OF_MSG.PUSH_MSG_RECEIVED,t);return Promise.all(n.map(function(t){return e.attemptToMessageClient_(t,o)}))})},e.prototype.getSWRegistration_=function(){return Promise.resolve(self.registration)},e}(o.a);e.a=c},function(t,e,n){n(1155)},function(t,e,n){"use strict";function o(t,e,n){return new l.a(t,new c.a,n)}function r(t){var e={TaskState:s.c,TaskEvent:s.b,StringFormat:a.a,Storage:l.a,Reference:u.a};t.INTERNAL.registerService(p,o,e,void 0,!0)}Object.defineProperty(e,"__esModule",{value:!0}),e.registerStorage=r;var i=n(74),a=n(132),s=n(133),c=n(1156),u=n(505),l=n(1165),p="storage";r(i.default)},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(1157),r=function(){function t(){}return t.prototype.createXhrIo=function(){return new o.a},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return c});var o=n(66),r=n(107),i=n(91),a=n(46),s=n(504),c=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=s.a.NO_ERROR,this.sendPromise_=i.a(function(e,n){t.xhr_.addEventListener("abort",function(n){t.errorCode_=s.a.ABORT,e(t)}),t.xhr_.addEventListener("error",function(n){t.errorCode_=s.a.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,i){var s=this;if(this.sent_)throw o.e("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),a.a(i)){var c=i;r.b(c,function(t,e){s.xhr_.setRequestHeader(t,e.toString())})}return a.a(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw o.e("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw o.e("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw o.e("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){a.a(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){a.a(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}()},function(t,e,n){"use strict";function o(t){var e;try{e=JSON.parse(t)}catch(t){return null}return r.f(e)?e:null}e.a=o;var r=n(46)},function(t,e,n){"use strict";function o(){return"undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function r(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(a.e())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function i(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}e.a=r,e.b=i;var a=n(46)},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(t,e,n,o){this.url=t,this.method=e,this.handler=n,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return h});var o=n(133),r=n(1162),i=n(1163),a=n(259),s=n(262),c=n(1164),u=n(66),l=n(91),p=n(508),d=n(46),h=function(){function t(t,e,n,r,i,a){void 0===a&&(a=null);var s=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=a,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=o.a.RUNNING,this.errorHandler_=function(t){s.request_=null,s.chunkMultiplier_=1,t.codeEquals(u.a.CANCELED)?(s.needToFetchStatus_=!0,s.completeTransitions_()):(s.error_=t,s.transition_(o.a.ERROR))},this.metadataErrorHandler_=function(t){s.request_=null,t.codeEquals(u.a.CANCELED)?s.completeTransitions_():(s.error_=t,s.transition_(o.a.ERROR))},this.promise_=l.a(function(t,e){s.resolve_=t,s.reject_=e,s.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n,o){t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===o.a.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case o.a.RUNNING:t(n);break;case o.a.CANCELING:e.transition_(o.a.CANCELED);break;case o.a.PAUSING:e.transition_(o.a.PAUSED)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=p.c(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),o=t.authWrapper_.makeRequest(n,e);t.request_=o,o.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var o=p.f(t.authWrapper_,t.location_,e,t.blob_),r=t.authWrapper_.makeRequest(o,n);t.request_=r,r.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=p.h*this.chunkMultiplier_,n=new p.a(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var a;try{a=p.b(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(e){return t.error_=e,void t.transition_(o.a.ERROR)}var s=t.authWrapper_.makeRequest(a,i);t.request_=s,s.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(o.a.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){p.h*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=p.e(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(o.a.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=p.g(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(o.a.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case o.a.CANCELING:case o.a.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case o.a.RUNNING:var e=this.state_===o.a.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case o.a.PAUSED:this.state_=t,this.notifyObservers_();break;case o.a.CANCELED:this.error_=u.c(),this.state_=t,this.notifyObservers_();break;case o.a.ERROR:case o.a.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case o.a.PAUSING:this.transition_(o.a.PAUSED);break;case o.a.CANCELING:this.transition_(o.a.CANCELED);break;case o.a.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=o.d(this.state_);return new i.a(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,i){function s(e){if(t!==o.b.STATE_CHANGED)throw"Expected one of the event types: ["+o.b.STATE_CHANGED+"]."}function c(t){try{return void h(t)}catch(t){}try{f(t);if(!(d.c(t.next)||d.c(t.error)||d.c(t.complete)))throw"";return}catch(t){throw p}}function u(t){function e(e,n,o){null!==t&&a.g("on",t,arguments);var s=new r.a(e,n,i);return g.addObserver_(s),function(){g.removeObserver_(s)}}return e}function l(t){if(null===t)throw p;c(t)}void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===i&&(i=void 0);var p="Expected a function or an Object with one of `next`, `error`, `complete` properties.",h=a.d(!0).validator,f=a.a(null,!0).validator,m=[a.e(s),a.a(c,!0),a.d(!0),a.d(!0)];a.g("on",m,arguments);var g=this,v=[a.a(l),a.d(!0),a.d(!0)];return d.c(e)||d.c(n)||d.c(i)?u(null)(e,n,i):u(v)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){s.c(this.observers_,t)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),s.a(this.observers_).forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(o.d(this.state_)){case o.c.SUCCESS:Object(c.a)(this.resolve_.bind(null,this.snapshot))();break;case o.c.CANCELED:case o.c.ERROR:var e=this.reject_;Object(c.a)(e.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(o.d(this.state_)){case o.c.RUNNING:case o.c.PAUSED:null!==t.next&&Object(c.a)(t.next.bind(t,this.snapshot))();break;case o.c.SUCCESS:null!==t.complete&&Object(c.a)(t.complete.bind(t))();break;case o.c.CANCELED:case o.c.ERROR:null!==t.error&&Object(c.a)(t.error.bind(t,this.error_))();break;default:null!==t.error&&Object(c.a)(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){a.g("resume",[],arguments);var t=this.state_===o.a.PAUSED||this.state_===o.a.PAUSING;return t&&this.transition_(o.a.RUNNING),t},t.prototype.pause=function(){a.g("pause",[],arguments);var t=this.state_===o.a.RUNNING;return t&&this.transition_(o.a.PAUSING),t},t.prototype.cancel=function(){a.g("cancel",[],arguments);var t=this.state_===o.a.RUNNING||this.state_===o.a.PAUSING;return t&&this.transition_(o.a.CANCELING),t},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(46),r=function(){function t(t,e,n){if(o.b(t)||o.a(e)||o.a(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}return t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return o});var o=function(){function t(t,e,n,o,r,i){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=o,this.task=r,this.ref=i}return Object.defineProperty(t.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var t=this.metadata.downloadURLs;return null!=t&&null!=t[0]?t[0]:null}return null},enumerable:!0,configurable:!0}),t}()},function(t,e,n){"use strict";function o(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];r.c(!0).then(function(){t.apply(null,e)})}}e.a=o;var r=n(91)},function(t,e,n){"use strict";n.d(e,"a",function(){return u});var o=n(259),r=n(1166),i=n(179),a=n(91),s=n(1169),c=n(505),u=function(){function t(t,e,n){function o(t,e){return new c.a(t,e)}if(this.bucket_=null,this.authWrapper_=new r.a(t,o,s.a,this,e),this.app_=t,null!=n)this.bucket_=i.a.makeFromBucketSpec(n);else{var a=this.authWrapper_.bucket();null!=a&&(this.bucket_=new i.a(a,""))}this.internals_=new l(this)}return t.prototype.ref=function(t){function e(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}if(o.g("ref",[o.e(e,!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var n=new c.a(this.authWrapper_,this.bucket_);return null!=t?n.child(t):n},t.prototype.refFromURL=function(t){function e(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{i.a.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}}return o.g("refFromURL",[o.e(e,!1)],arguments),new c.a(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){o.g("setMaxUploadRetryTime",[o.c()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){o.g("setMaxOperationRetryTime",[o.c()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),l=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),a.c(void 0)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return l});var o=n(178),r=n(66),i=n(1167),a=n(179),s=n(91),c=n(1168),u=n(46),l=function(){function t(e,n,r,i,a){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var s=this.app_.options;u.a(s)&&(this.bucket_=t.extractBucket_(s))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=a,this.service_=i,this.maxOperationRetryTime_=o.d,this.maxUploadRetryTime_=o.e,this.requestMap_=new c.a}return t.extractBucket_=function(t){var e=t[o.c]||null;return null==e?null:a.a.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&u.a(this.app_.INTERNAL)&&u.a(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):s.c(null)},t.prototype.bucket=function(){if(this.deleted_)throw r.b();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new i.a(r.b());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return r});var o=n(91),r=function(){function t(t){this.promise_=o.b(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}()},function(t,e,n){"use strict";n.d(e,"a",function(){return i});var o=n(107),r=n(178),i=function(){function t(){this.map_={},this.id_=r.h}return t.prototype.addRequest=function(t){function e(){delete o.map_[n]}var n=this.id_;this.id_++,this.map_[n]=t;var o=this;t.getPromise().then(e,e)},t.prototype.clear=function(){o.b(this.map_,function(t,e){e&&e.cancel(!0)}),this.map_={}},t}()},function(t,e,n){"use strict";function o(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}function r(t){var e=void 0!==a.default?a.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}function i(t,e,n){var i=h.c(t.urlParams),a=t.url+i,s=l.a(t.headers);return o(s,e),r(s),new m(a,t.method,s,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}e.a=i;var a=n(74),s=n(262),c=n(1170),u=n(66),l=n(107),p=n(91),d=n(46),h=n(261),f=n(504),m=function(){function t(t,e,n,o,r,i,a,s,c,u,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=o,this.successCodes_=r.slice(),this.additionalRetryCodes_=i.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=u,this.timeout_=c,this.pool_=l;var d=this;this.promise_=p.a(function(t,e){d.resolve_=t,d.reject_=e,d.start_()})}return t.prototype.start_=function(){function t(t,e){function o(t){var e=t.loaded,o=t.lengthComputable?t.total:-1;null!==n.progressCallback_&&n.progressCallback_(e,o)}if(e)return void t(!1,new g(!1,null,!0));var r=n.pool_.createXhrIo();n.pendingXhr_=r,null!==n.progressCallback_&&r.addUploadProgressListener(o),r.send(n.url_,n.method_,n.body_,n.headers_).then(function(e){null!==n.progressCallback_&&e.removeUploadProgressListener(o),n.pendingXhr_=null,e=e;var r=e.getErrorCode()===f.a.NO_ERROR,i=e.getStatus();if(!r||n.isRetryStatusCode_(i)){var a=e.getErrorCode()===f.a.ABORT;return void t(!1,new g(!1,null,a))}var c=s.b(n.successCodes_,i);t(!0,new g(c,e))})}function e(t,e){var o=n.resolve_,r=n.reject_,i=e.xhr;if(e.wasSuccessCode)try{var a=n.callback_(i,i.getResponseText());d.c(a)?o(a):o()}catch(t){r(t)}else if(null!==i){var s=u.s();s.setServerResponseProp(i.getResponseText()),r(n.errorCallback_?n.errorCallback_(i,s):s)}else if(e.canceled){var s=n.appDelete_?u.b():u.c();r(s)}else{var s=u.o();r(s)}}var n=this;this.canceled_?e(!1,new g(!1,null,!0)):this.backoffId_=c.a(t,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&c.b(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=[408,429],o=s.b(n,t),r=s.b(this.additionalRetryCodes_,t);return e||o||r},t}(),g=function(){function t(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}return t}()},function(t,e,n){"use strict";function o(t,e,n){function o(){return 2===p}function r(){d||(d=!0,e.apply(null,arguments))}function i(e){u=setTimeout(function(){u=null,t(a,o())},e)}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!d){if(t)return void r.apply(null,arguments);if(o()||l)return void r.apply(null,arguments);c<64&&(c*=2);var a;1===p?(p=2,a=0):a=1e3*(c+Math.random()),i(a)}}function s(t){h||(h=!0,d||(null!==u?(t||(p=2),clearTimeout(u),i(0)):t||(p=1)))}var c=1,u=null,l=!1,p=0,d=!1,h=!1;return i(0),setTimeout(function(){l=!0,s(!0)},n),s}function r(t){t(!1)}e.a=o,e.b=r},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(17),a=n(114),s=n(1172),c=n(1325),u=n(1335),l=n(1345),p=n(1349),d=i.RouterModule.forRoot([{path:"**",redirectTo:"editor",pathMatch:"full"}]),h=function(){function t(){}return t=o([r.NgModule({declarations:[p.Ui],imports:[s.EditorModule,c.AdminModule,u.ExploreModule,l.ChatModule,d],providers:[{provide:a.LocationStrategy,useClass:a.HashLocationStrategy}],bootstrap:[p.Ui]})],t)}();e.UiModule=h},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(17),a=n(52),s=n(100),c=n(1173),u=n(1178),l=n(1181),p=n(1184),d=n(1187),h=n(1191),f=n(1194),m=n(1197),g=n(1200),v=n(1203),y=n(1206),_=n(1209),b=n(1212),w=n(277),I=n(518),E=n(521),R=n(522),x=n(523),S=n(278),P=n(525),T=n(1219),O=n(1222),C=n(1225),A=n(1228),N=n(1231),k=n(1236),M=n(1239),D=n(1242),j=n(1245),L=n(1248),F=n(1251),B=n(1254),U=n(1257),V=n(1260),H=n(1263),W=n(1266),z=n(1269),G=n(1272),q=n(1275),Y=n(1278),K=n(1281),X=n(1282),Q=n(1283),$=n(1284),J=n(1287),Z=n(1290),tt=n(61),et=n(138),nt=n(1293),ot=n(1296),rt=n(180),it=n(187),at=n(186),st=n(137),ct=n(1299),ut=n(513),lt=n(188),pt=n(189),dt=i.RouterModule.forChild([{path:"editor",component:c.Editor,children:[{path:"",redirectTo:"/editor/(view:flat)",pathMatch:"full"},{path:"flat",component:u.EditSpaceFlat,outlet:"view"},{path:"sphere",component:l.EditSpaceSphere,outlet:"view"},{path:"preview",component:b.PreviewSpace,outlet:"view"},{path:"profile",component:C.UserTab,outlet:"modal"},{path:"story",component:D.Story,outlet:"modal"},{path:"upload",component:L.Upload,outlet:"modal"}]}]),ht=function(){function t(){}return t=o([r.NgModule({declarations:[c.Editor,u.EditSpaceFlat,l.EditSpaceSphere,b.PreviewSpace,T.Topbar,d.RoomIcon,H.RoomEditorIcon,h.PropertyEditor,f.TextEditor,m.ImageEditor,y.AudioEditor,g.DoorEditor,V.RoomEditor,v.LinkEditor,K.DraggableIcon,Q.Droppable,$.FileLoader,J.HiddenFileLoader,Z.FileLoaderMulti,k.TreeTab,M.RowItem,C.UserTab,A.UnauthUserTab,N.AuthUserTab,U.ActionMenu,nt.CloseButton,ot.InfoButton,p.DefaultOverlay,W.EditSpaceToggle,X.OffClick,O.AboutTab,D.Story,j.ModalClose,L.Upload,B.Fab,F.HotspotMenu,_.AudioRecorder,ct.Slider,z.StoryScroll,G.StorymapItem,q.AddRoomButton,Y.Fullscreen],imports:[a.BrowserModule,pt.CoreModule,lt.CommonModule,s.FormsModule,dt],providers:[tt.FileLoaderUtil,et.PropertyRemovalService,rt.ZipFileReader,it.AudioRecorderService,at.CombinedHotspotUtil,w.AudioPlayService,st.SlideshowBuilder,ut.ResponsiveUtil,I.MultiViewService,E.AudioManager,R.TextureLoader,x.HotspotManager,S.MenuManager,P.Reticle]})],t)}();e.EditorModule=ht},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(61),c=n(6),u=n(92),l=n(263),p=n(180),d=n(12),h=n(274),f=n(53),m=n(137),g=n(184),v=n(37),y=n(1175),_=n(513),b=function(){function t(t,e,n,o,r,a,s,c,u,l,p,d){this.sceneInteractor=t,this.fileLoaderUtil=e,this.eventBus=n,this.zipFileReader=o,this.slideshowBuilder=r,this.videoInteractor=a,this.route=s,this.router=c,this.shareableLoader=u,this.metaDataInteractor=l,this.element=p,this.responsiveUtil=d,this.changeEmitter=new i.EventEmitter,this.hotspotMenuIsOpen=!1,this.hotspotEditorIsOpen=!1,this.subscriptions=new Set,this.isInFlatMode=!0,this.isInFullscreen=!1}return t.prototype.ngAfterViewInit=function(){var t=this;this.route.queryParams.map(function(t){return t[l.SHARED_KEY]}).filter(function(t){return!!t}).subscribe(function(e){setTimeout(function(){return t.shareableLoader.openProject(e)})},function(t){return console.log("error",t)}),y.addTouchListenersToElement(this.element.nativeElement),this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.onDragOver=function(t){t.stopPropagation(),t.preventDefault()},t.prototype.onDrop=function(t){if(!this.uploadIsOpen()){t.stopPropagation(),t.preventDefault();var e=t.dataTransfer.files;if(!e)return;var n=Object.keys(e).map(function(t){return e[t]});this.processDroppedFileMulti(n,t.clientX,t.clientY)}},t.prototype.subscribeToEvents=function(){var t=this,e=this.eventBus.getObservable(c.EventType.HOTSPOT_EDITOR_VISIBILITY).subscribe(function(e){return t.hotspotEditorIsOpen=e.isVisible},function(t){return console.log("error",t)});this.subscriptions.add(e)},t.prototype.isPreview=function(){return this.router.url.includes("view:preview")},t.prototype.showPreviewCheckbox=function(){return(this.roomEditorIsVisible()||this.isPreview())&&!this.isReadOnly()},t.prototype.isFlat=function(){return this.router.url.includes("view:flat")},t.prototype.hotspotMenuIsVisible=function(){return this.responsiveUtil.isMobile()?this.hasBackgroundImage()&&!this.isPreview()&&!this.hotspotEditorIsOpen:this.hasBackgroundImage()&&!this.isPreview()},t.prototype.previewVisible=function(){return!this.metaDataInteractor.getIsReadOnly()},t.prototype.isReadOnly=function(){return this.metaDataInteractor.getIsReadOnly()},t.prototype.viewToggleIsVisibleOLD=function(){return this.responsiveUtil.isMobile()?this.hasBackgroundImage()&&!this.hotspotMenuIsOpen&&!this.hotspotEditorIsOpen:this.hasBackgroundImage()},t.prototype.roomEditorIsVisible=function(){return this.responsiveUtil.isMobile()?this.hasBackgroundImage()&&!this.isPreview()&&!this.hotspotMenuIsOpen&&!this.hotspotEditorIsOpen:this.hasBackgroundImage()&&!this.isPreview()},t.prototype.onHotspotMenuChange=function(t){this.hotspotMenuIsOpen=t.isOpen},t.prototype.hasBackgroundImage=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.roomHasBackgroundImage(t)},t.prototype.processDroppedFile=function(t,e,n){var o=this,r=(t.name,this.isFlat()?u.normalizeAbsolutePosition(e,n):this.editSpaceSphere.transformScreenPositionTo3dNormal(e,n)),i=Object.keys(s.mimeTypeMap).find(function(e){return s.mimeTypeMap[e].indexOf(t.type)>-1});if(!i){return void this.eventBus.onModalMessage("Incompatible File Type","Try using an image (.jpg, .jpeg, .png), an audio file (.mp3, .wav), or a story file (.zip)")}if("video"===i)return console.log("bam, video",t),void this.getFileTypeStrategy(i)(t,null,r);this.fileLoaderUtil.getBinaryFileData(t).then(function(e){return o.getFileTypeStrategy(i)(t,e,r)}).catch(function(t){return o.eventBus.onModalMessage("Error",t)})},t.prototype.processDroppedFileMulti=function(t,e,n){var o=this,r=t.map(function(t){var r=(t.name,o.isFlat()?u.normalizeAbsolutePosition(e,n):o.editSpaceSphere.transformScreenPositionTo3dNormal(e,n)),i=Object.keys(s.mimeTypeMap).find(function(e){return s.mimeTypeMap[e].indexOf(t.type)>-1});if(!i){return Promise.reject("Try using an image (.jpg, .jpeg, .png), an audio file (.mp3, .wav), or a story file (.zip)")}return"video"===i?(console.log("bam, video",t),void o.getFileTypeStrategy(i)(t,null,r)):o.fileLoaderUtil.getBinaryFileData(t).then(function(e){return o.getFileTypeStrategy(i)(t,e,r),Promise.resolve()}).catch(function(t){return o.eventBus.onModalMessage("Error",t)})});Promise.all(r).then(function(t){}).catch(function(t){o.eventBus.onStopLoading(),o.eventBus.onModalMessage("error",t),console.log(t)})},t.prototype.getFileTypeStrategy=function(t){var e=this;return{audio:function(t,n,o){var r=e.sceneInteractor.getActiveRoomId(),i=e.sceneInteractor.addAudio(r);i.setFileName(t.name),i.setBinaryFileData(n),i.setLocation(o),e.requestRender()},image:function(t,n,o){var r=e.sceneInteractor.getActiveRoomId();if(!e.hasBackgroundImage())return e.eventBus.onStartLoading(),void f.resizeImage(n,"backgroundImage").then(function(n){var o=e.sceneInteractor.getRoomById(r);o.setFileData(t.name,n.backgroundImage),o.setThumbnail(t.name,n.thumbnail),e.requestRender(),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)});f.resizeImage(n,"hotspotImage").then(function(n){var i=e.sceneInteractor.addImage(r);i.setFileName(t.name),i.setBinaryFileData(n),i.setLocation(o),e.requestRender()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)})},zip:function(t,n,o){e.zipFileReader.loadFile(t)},video:function(t,n,o){e.videoInteractor.uploadVideo(t).subscribe(function(t){var n=e.sceneInteractor.getActiveRoomId();e.sceneInteractor.getRoomById(n).setBackgroundVideo("",t.downloadUrl),console.log("bam, success",t)},function(t){return console.log("damn",t)})}}[t]},t.prototype.requestRender=function(){var t=this;this.isFlat()||setTimeout(function(){t.editSpaceSphere.render()})},t.prototype.setEditPlaySliderIsVisible=function(){return!1},t.prototype.uploadIsOpen=function(){return this.router.url.includes("modal:upload")},t.prototype.editorIsSphere=function(){return this.router.url.includes("view:sphere")},t.prototype.editorIsFlat=function(){return this.router.url.includes("view:flat")},t.prototype.on2dViewClick=function(t){this.router.navigate(["/editor",{outlets:{view:"flat"}}]),this.isInFlatMode=!0},t.prototype.on3dViewClick=function(t){this.router.navigate(["editor",{outlets:{view:"sphere"}}]),this.isInFlatMode=!1},t.prototype.onEditPlayChange=function(t){1==t.value?this.router.navigate(["editor",{outlets:{view:"preview"}}]):(console.log("switch to edit"),this.isInFlatMode?this.router.navigate(["/editor",{outlets:{view:"flat"}}]):this.router.navigate(["/editor",{outlets:{view:"sphere"}}])),this.changeEmitter.emit({value:t.value})},o([i.ViewChild("editSpaceSphere"),r("design:type",Object)],t.prototype,"editSpaceSphere",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"changeEmitter",void 0),o([i.HostListener("dragover",["$event"]),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],t.prototype,"onDragOver",null),o([i.HostListener("drop",["$event"]),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],t.prototype,"onDrop",null),t=o([i.Component({selector:"editor",styles:[n(1176)],template:n(1177)}),r("design:paramtypes",[d.SceneInteractor,s.FileLoaderUtil,c.EventBus,p.ZipFileReader,m.SlideshowBuilder,h.VideoInteractor,a.ActivatedRoute,a.Router,g.ShareableLoader,v.MetaDataInteractor,i.ElementRef,_.ResponsiveUtil])],t)}();e.Editor=b},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});!function(t){t[t.SOCIAL_VR=0]="SOCIAL_VR",t[t.GOOGLE=1]="GOOGLE",t[t.FACEBOOK=2]="FACEBOOK"}(e.AuthenticationMethod||(e.AuthenticationMethod={}))},function(t,e,n){"use strict";function o(t){var e,n={view:window,bubbles:!0,cancelable:!0};t.addEventListener("touchstart",function(t){t.stopPropagation();var o=t.touches[0].clientX,i=t.touches[0].clientY,a=t.touches[0].screenX,s=t.touches[0].screenY;e={clientX:o,clientY:i,screenX:a,screenY:s};var c=new MouseEvent("mousedown",r({},n,e));t.target.dispatchEvent(c)}),t.addEventListener("touchmove",function(t){t.preventDefault(),t.stopPropagation();var o=t.touches[0].clientX,i=t.touches[0].clientY,a=t.touches[0].screenX,s=t.touches[0].screenY,c=a-e.screenX,u=s-e.screenY;e={clientX:o,clientY:i,screenX:a,screenY:s};var l=new MouseEvent("mousemove",r({},n,e,{movementX:c,movementY:u}));t.target.dispatchEvent(l)},{passive:!1}),t.addEventListener("touchend",function(t){t.stopPropagation();var o=new MouseEvent("mouseup",r({},n,e));t.target.dispatchEvent(o)})}var r=this&&this.__assign||Object.assign||function(t){for(var e,n=1,o=arguments.length;n<o;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t};Object.defineProperty(e,"__esModule",{value:!0}),e.addTouchListenersToElement=o},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.editor{position:relative;height:100%;width:100%;overflow:hidden}.editor__topbar{position:absolute;top:0;left:0;width:100%}.editor__toggle{position:absolute;top:calc(50% - 40px);right:0}.editor__hotspot-menu{position:absolute;bottom:0;margin-bottom:10px;left:0}.editor__editPlayToggle{position:absolute;top:0;left:50%;margin-top:10px;display:flex;flex-direction:column;align-items:center;transform:translate(-50%, 0%)}.editor__2d3d{display:flex;flex-direction:row;justify-content:space-between;margin-top:3px}.editor__2d3d{margin-left:3px;margin-right:3px}.editor__2d3d--active{color:#FF3571}.editor__editPlayToggleButton{margin-top:6px}.editor__fullscreen{position:absolute;bottom:0;right:0;margin-bottom:10px;margin-right:10px}.editor__edit-space{position:fixed;width:100%;height:100%;background-color:#eee}\n'},function(t,e){t.exports='<div class="editor">\n\n  \x3c!-- Router outlet for edit-space-flat, edit-space-sphere, and preview-space components --\x3e\n  <router-outlet name="view"></router-outlet>\n\n  <topbar\n    *ngIf="!isPreview()"\n    class="editor__topbar">\n  </topbar>\n\n  <div\n    class="editor__editPlayToggle">\n    <p\n      *ngIf="showPreviewCheckbox()"\n      class=\'topbar__row-label\'>Preview</p>\n    <checkbox\n      *ngIf="showPreviewCheckbox()"\n      [initialValue]="isPreview()"\n      (changeEmitter)="onEditPlayChange($event)"\n      class="editor__editPlayToggleButton">\n    </checkbox>\n    <div\n      *ngIf="roomEditorIsVisible()"\n      class ="editor__2d3d">\n      <div\n      (click)="on2dViewClick($event)"\n      [ngClass]="{\'editor__2d3d--active\': editorIsFlat()}"\n      class=\'topbar__row-label editor__2d3d\'>2D</div>\n      <div\n      (click)="on3dViewClick($event)"\n      [ngClass]="{\'editor__2d3d--active\': editorIsSphere()}"\n      class=\'topbar__row-label editor__2d3d\'>3D</div>\n    </div>\n  </div>\n\n  <hotspot-menu\n    *ngIf="hotspotMenuIsVisible()"\n    (onMenuChange)="onHotspotMenuChange($event)"\n    class="editor__hotspot-menu">\n  </hotspot-menu>\n\n  \x3c!--\n  <edit-space-toggle\n    *ngIf="viewToggleIsVisible()"\n    class="editor__toggle">\n  </edit-space-toggle>\n--\x3e\n\n  \x3c!-- Story Map --\x3e\n  <story-scroll\n      *ngIf="roomEditorIsVisible()"\n      class="editor__story-scroll">\n  </story-scroll>\n\n  \x3c!-- Fullscreen --\x3e\n  <fullscreen\n      *ngIf="roomEditorIsVisible()"\n      class="editor__fullscreen">\n  </fullscreen>\n\n  <modal></modal>\n  <hidden-file-loader></hidden-file-loader>\n\n</div>\n\n<router-outlet name="modal"></router-outlet>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(12),c=n(186),u=function(){function t(t,e,n){this.sceneInteractor=t,this.combinedHotspotUtil=e,this.eventBus=n,this.subscriptions=new Set}return t.prototype.ngOnInit=function(){var t=this,e=this.eventBus.getObservable(a.EventType.SELECT_PROPERTY).subscribe(function(e){var n=e.propertyId,o=t.roomIconComponentList.filter(function(t){return t.roomProperty.getId()!==n});t.combinedHotspotUtil.setRoomPropertyList(o)},function(t){return console.log("EditSpaceFlat.ngOnInit",t)}),n=this.eventBus.getObservable(a.EventType.WINDOW_RESIZE).subscribe(function(e){return t.onResize(null)},function(t){return console.log("EditSpaceFlat.onResize",t)}),o=this.eventBus.getObservable(a.EventType.SELECT_ROOM).subscribe(function(e){return t.onResize(null)},function(t){return console.log("EditSpaceFlat.onSelectRoom",t)});this.subscriptions.add(e),this.subscriptions.add(n),this.subscriptions.add(o)},t.prototype.isVideo=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomById(t).getBackgroundIsVideo()},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.onResize=function(t){this.roomIconComponentList.forEach(function(t){return t.updatePosition()})},t.prototype.getBackgroundImage=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomById(t).getBinaryFileData()},t.prototype.getBackgroundVideo=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomById(t).getBackgroundVideo()},t.prototype.getItems=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomProperties(t)},t.prototype.roomHasBackgroundImage=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.roomHasBackgroundImage(t)},o([i.ViewChildren("roomIcon"),r("design:type",Array)],t.prototype,"roomIconComponentList",void 0),t=o([i.Component({selector:"edit-space-flat",styles:[n(1179)],template:n(1180)}),r("design:paramtypes",[s.SceneInteractor,c.CombinedHotspotUtil,a.EventBus])],t)}();e.EditSpaceFlat=u},function(t,e){t.exports=".edit-space{width:100%;height:100%}.edit-space-background{width:100%;height:100%;user-select:none;-moz-user-select:none;-webkit-user-drag:none;-webkit-user-select:none;-ms-user-select:none}.edit-space-background--video{object-fit:inherit}\n"},function(t,e){t.exports='<div class="edit-space">\n\n  <img\n    *ngIf="!isVideo()"\n    [attr.src]="getBackgroundImage()"\n    (dragstart)="$event.preventDefault()"\n    class="edit-space-background">\n\n  <video\n    *ngIf="isVideo()"\n    [attr.src]="getBackgroundVideo()"\n    (dragstart)="$event.preventDefault()"\n    class="edit-space-background edit-space-background--video">\n  </video>\n\n\n  <div *ngFor="let roomProperty of getItems()">\n    <room-icon\n      #roomIcon\n      [roomProperty]="roomProperty">\n    </room-icon>\n  </div>\n\n  <default-overlay\n    *ngIf="!roomHasBackgroundImage()">\n  </default-overlay>\n\n</div>\n'},function(t,e,n){"use strict";(function(t){function o(e,n,o,r){var i=r.canvas.width,a=r.canvas.height,s=e/i*2-1,c=-n/a*2+1;return new t.Vector3(s,c,.5).unproject(o)}function r(e,n,o){var r=new t.Object3D,i=new t.Vector3,a=o.canvas.width/2,s=o.canvas.height/2;return r.position.set(e.x,e.y,e.z),r.updateMatrixWorld(!0),i.setFromMatrixPosition(r.matrixWorld),i.project(n),{x:i.x*a+a,y:-i.y*s+s}}function i(t,e,n,r){var i=o(t,e,n,r),a=v.coordinateToSpherical(i.x,i.y,i.z),s=a.theta/Math.PI*180,c=a.phi/Math.PI*180-90;return s<0&&(s+=360),s=v.clamp(s,0,360),c=v.clamp(c,-90,90),new h.Vector2(s,c)}var a=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},s=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var c=n(2),u=n(17);n(24),n(514);var l=n(6),p=n(12),d=n(275),h=n(75),f=n(186),m=n(76),g=n(37),v=n(92),y=n(516),_=n(517),b=function(){function e(t,e,n,o,r,i,a,s){this.sceneInteractor=t,this.cameraInteractor=e,this.eventBus=n,this.ngZone=o,this.combinedHotspotUtil=r,this.assetInteractor=i,this.metaDataInteractor=a,this.router=s,this.subscriptions=new Set,this.isDragging=!1}return e.prototype.ngOnInit=function(){this.metaDataInteractor.projectIsEmpty()&&this.router.navigate(["/editor",{outlets:{view:"flat"}}]),this.windowWidth=window.innerWidth,this.windowHeight=window.innerHeight},e.prototype.ngAfterViewInit=function(){this.initScene(),this.subscribeToEvents(),this.loadTextures().then(this.initRoom.bind(this)).catch(function(t){return console.log("load textures / init room error",t,console.trace())})},e.prototype.ngOnDestroy=function(){if(this.camera){var e=new t.Vector3(0,0,-1);e.applyQuaternion(this.camera.quaternion),this.cameraInteractor.setCameraDirection(e.x,e.y,e.z)}cancelAnimationFrame(this.animationRequest),this.isDragging=!1,this.subscriptions.forEach(function(t){return t.unsubscribe()}),this.video3D&&this.video3D.destroy()},e.prototype.initScene=function(){var e=this.globeCanvas.nativeElement,n=y.buildScene();this.sphereMesh=n.sphereMesh,this.camera=n.camera,this.vrCamera=n.vrCamera,this.scene=n.scene,this.renderer=new t.WebGLRenderer({canvas:e,alpha:!0,antialias:"undefined"==window.orientation}),this.svrControls=new t.SvrControls(this.camera,e,this.cameraInteractor.getCameraDirection())},e.prototype.initRoom=function(){var e=this,n=this.sceneInteractor.getActiveRoomId(),o=this.sceneInteractor.getRoomById(n);if(o.getBackgroundIsVideo())this.video3D=new _.Video3D,this.video3D.init(o.getBackgroundVideo()).then(function(n){e.sphereMesh.material=new t.MeshBasicMaterial({map:n,side:t.FrontSide}),e.onResize(null)}).catch(function(t){return console.log("EditSpaceSphere.initVideo",t)});else{var r=this.assetInteractor.getTextureById(n);this.sphereMesh.material=new t.MeshBasicMaterial({map:r,side:t.FrontSide}),this.onResize(null)}},e.prototype.loadTextures=function(){var t=this,e=this.sceneInteractor.getRoomIds().map(function(e){return t.sceneInteractor.getRoomById(e)}).filter(function(t){return t.hasBackgroundImage()&&!t.getBackgroundIsVideo()}).map(function(t){var e=t.getBinaryFileData();return e.changingThisBreaksApplicationSecurity&&(e=e.changingThisBreaksApplicationSecurity),new m.AssetModel(t.getId(),t.getFileName(),e)});return this.assetInteractor.loadTextures(e)},e.prototype.subscribeToEvents=function(){var t=this,e=this.eventBus.getObservable(l.EventType.SELECT_PROPERTY).subscribe(function(e){var n=e.propertyId,o=e.isNewProperty,r=t.roomIconComponentList.filter(function(t){return t.roomProperty.getId()!==n});o&&t.onNewPropertyAdded(n),t.combinedHotspotUtil.setRoomPropertyList(r)},function(t){return console.log("error",t)}),n=this.eventBus.getObservable(l.EventType.SELECT_ROOM).subscribe(function(e){if(e.isNewProperty)return void t.initRoom();t.loadTextures().then(t.initRoom.bind(t)).catch(function(t){return console.log("onRoomSelect",t)})},function(t){return console.log("error",t)}),o=this.eventBus.getObservable(l.EventType.MOUSE_UP).subscribe(function(e){var n=t.sceneInteractor.getActiveRoomId();t.sceneInteractor.getRoomById(n);t.isDragging=!1},function(t){return console.log("error",t)}),r=this.eventBus.getObservable(l.EventType.WINDOW_RESIZE).subscribe(function(e){return t.onResize(e)},function(t){return console.log("EditSpaceFlat.onResize",t)});this.subscriptions.add(n),this.subscriptions.add(o),this.subscriptions.add(e),this.subscriptions.add(r)},e.prototype.onNewPropertyAdded=function(t){var e=this,n=h.Vector2.build(),o=v.denormalizePosition(n.getX(),n.getY()),r=this.transformScreenPositionTo3dNormal(o.getX(),o.getY()),i=this.sceneInteractor.getActiveRoomId();this.sceneInteractor.getPropertyById(i,t).setLocation(r),setTimeout(function(){e.roomIconComponentList.forEach(function(t){return e.updateRoomIconPosition(t)})})},e.prototype.render=function(){var t=this;this.svrControls.update(),this.roomIconComponentList.forEach(function(e){return t.updateRoomIconPosition(e)}),this.video3D&&this.video3D.attemptEditSpaceRender(),this.renderer.render(this.scene,this.camera),(this.isDragging||this.svrControls.hasMomentum())&&this.ngZone.runOutsideAngular(function(){t.animationRequest=requestAnimationFrame(t.render.bind(t))})},e.prototype.onMouseDown=function(t){this.isDragging=!0,this.render()},e.prototype.onMoveEnd=function(t){var e=this.transformScreenPositionTo3dNormal(t.x,t.y);t.setIconLocation(e.getX(),-e.getY()),this.render()},e.prototype.onResize=function(t){var e=this;y.onResize(this.camera,this.renderer).then(function(){e.roomIconComponentList.forEach(function(t){return t.setPixelLocation(99999,99999)}),e.render()}).catch(function(t){return console.log("edit-sphere resize error",t)})},e.prototype.updateRoomIconPosition=function(t){var e=t.getLocation(),n=v.getCoordinatePosition(e.getX(),e.getY());if(!(n.dot(this.camera.getWorldDirection())<0)){var o=r(n,this.camera,this.renderer.context);t.setPixelLocationWithBuffer(o.x,o.y)}},e.prototype.getItems=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomProperties(t)},e.prototype.roomHasBackgroundImage=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.roomHasBackgroundImage(t)},e.prototype.transformScreenPositionTo3dNormal=function(t,e){return i(t,e,this.camera,this.renderer.context)},a([c.ViewChildren("roomIcon"),s("design:type",Array)],e.prototype,"roomIconComponentList",void 0),a([c.ViewChild("editSpaceSphere"),s("design:type",Object)],e.prototype,"editSpaceSphere",void 0),a([c.ViewChild("globeCanvas"),s("design:type",Object)],e.prototype,"globeCanvas",void 0),e=a([c.Component({selector:"edit-space-sphere",styles:[n(1182)],template:n(1183)}),s("design:paramtypes",[p.SceneInteractor,d.CameraInteractor,l.EventBus,c.NgZone,f.CombinedHotspotUtil,m.AssetInteractor,g.MetaDataInteractor,u.Router])],e)}();e.EditSpaceSphere=b}).call(e,n(24))},function(t,e){t.exports=".edit-space{width:100%;height:100%;cursor:move}\n"},function(t,e){t.exports='<div\n  #editSpaceSphere\n  class="edit-space">\n\n  <canvas\n    #globeCanvas\n    (mousedown)="onMouseDown($event)">\n  </canvas>\n\n  <div *ngFor="let roomProperty of getItems()">\n    <room-icon\n      #roomIcon\n      [roomProperty]="roomProperty"\n      (onIconDragEnd)="onMoveEnd($event)">\n    </room-icon>\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(61),c=n(12),u=n(53),l=function(){function t(t,e,n){this.eventBus=t,this.fileLoaderUtil=e,this.sceneInteractor=n,this.onFileLoad=new i.EventEmitter}return t.prototype.onFileChange=function(t){var e=this,n=t.target.files&&t.target.files[0];if(!n)return void this.eventBus.onModalMessage("Error","No valid file selected");this.eventBus.onStartLoading(),this.fileLoaderUtil.validateFileLoadEvent(n,"image").then(this.fileLoaderUtil.getBinaryFileData.bind(this.fileLoaderUtil)).then(function(t){return u.resizeImage(t,"backgroundImage")}).then(function(t){var o=e.sceneInteractor.getActiveRoomId(),r=e.sceneInteractor.getRoomById(o);r.setFileData(n.name,t.backgroundImage),r.setThumbnail(n.name,t.thumbnail),e.onFileLoad&&e.onFileLoad.emit(),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Error",t)})},o([i.Output(),r("design:type",Object)],t.prototype,"onFileLoad",void 0),t=o([i.Component({selector:"default-overlay",styles:[n(1185)],template:n(1186)}),r("design:paramtypes",[a.EventBus,s.FileLoaderUtil,c.SceneInteractor])],t)}();e.DefaultOverlay=l},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.default-overlay{position:absolute;height:100%;width:100%;top:0;left:0;background-color:#616161;display:flex;justify-content:space-around;align-items:center}.default-overlay__background{width:100%;height:100%;background-image:url("assets/images/background_bosnia-waterfall.JPG");background-size:100% 100%;-webkit-filter:blur(5px);-moz-filter:blur(5px);-o-filter:blur(5px);-ms-filter:blur(5px);filter:blur(5px)}.default-overlay__hidden-input{display:none}.default-overlay__box{border:2px dashed #eee;border-radius:20px;padding:50px;margin:10px;font-size:1.6em;text-align:center;cursor:pointer}.default-overlay__logo{font-size:2em;font-weight:600;text-shadow:0 2px 2px rgba(0,0,0,0.62);position:absolute;top:50%;cursor:pointer;text-decoration:none !important}.default-overlay__logo:hover{color:#D8D8D8}.default-overlay__logo-social a:link{text-decoration:none !important}.default-overlay__logo-vr{color:#eee;font-weight:800}\n'},function(t,e){t.exports='<div class="default-overlay">\n\n\n  <input\n    type="file"\n    id="defaultOverlayInput"\n    (change)="onFileChange($event)"\n    class="default-overlay__hidden-input">\n\n  <p class="default-overlay__background">\n  </p>\n\n  <p class="default-overlay__logo font-header">\n    <span class="default-overlay__logo-social">\n      <a href="https://irl.studio/products/socialvr/">Social</a>\n    </span>\n    <span class="default-overlay__logo-vr">VR</span>\n  </p>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(e,n){function o(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(o.prototype=n.prototype,new o)}}(),r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),s=n(1188),c=n(6),u=n(109),l=n(138),p=n(186),d=n(14),h={text:"text_filled.png",image:"image_filled.png",audio:"audio_filled.png",door:"door_filled.png",link:"link_filled.png"},f={SMALL:"SMALL",MEDIUM:"MEDIUM",LARGE:"LARGE"},m=function(t){function e(e,n,o,r){var i=t.call(this,e,r)||this;return i.eventBus=e,i.propertyRemovalService=n,i.combinedHotspotUtil=o,i.ngZone=r,i.isPossibleCombinedHotspot=!1,i.hotspotIconSize=f.LARGE,i.deleteVisible=!1,i}return o(e,t),e.prototype.ngOnInit=function(){var e=this;this.propertyType=u.RoomPropertyTypeService.getTypeString(this.roomProperty),this.iconPath=""+d.ICON_PATH+h[this.propertyType],this.subscriptions.add(this.eventBus.getObservable(c.EventType.SELECT_PROPERTY).subscribe(function(t){t.shouldOpenEditor&&t.propertyId===e.roomProperty.getId()&&e.setPropertyEditorVisibility(!0)},function(t){return console.log("error",t)})),this.subscriptions.add(this.eventBus.getObservable(c.EventType.WINDOW_RESIZE).subscribe(function(t){return e.onResize(t)},function(t){return console.log("EditSpaceFlat.onResize",t)})),t.prototype.ngOnInit.call(this),this.onResize({x:window.innerWidth,y:window.innerHeight})},e.prototype.onResize=function(t){t.x<767?this.hotspotIconSize=f.SMALL:t.x<992?this.hotspotIconSize=f.MEDIUM:this.hotspotIconSize=f.LARGE},e.prototype.updatePosition=function(){t.prototype.setPosition.call(this,this.roomProperty.getLocation())},e.prototype.getName=function(){return this.roomProperty.getName()},e.prototype.onNameChange=function(t){this.roomProperty.setName(t.text),this.propertyIs("door")&&this.roomProperty.setNameIsCustom(!0)},e.prototype.propertyIs=function(t){return this.propertyType===t},e.prototype.onSelect=function(t){this.eventBus.onSelectProperty(this.roomProperty.getId(),!1)},e.prototype.onDeselect=function(t){this.propertyEditorIsVisible=!1,this.eventBus.onHotspotVisibility(this.propertyEditorIsVisible)},e.prototype.onDeleteClick=function(t){this.propertyRemovalService.removeProperty(this.roomProperty)},e.prototype.onMouseOver=function(t){console.log("mouseover"),this.deleteVisible=!0},e.prototype.isPossibleHotspot=function(){return this.roomProperty.getPossibleCombinedHotspot()},e.prototype.setIsPossibleHotsport=function(t){this.roomProperty.setPossibleCombinedHotspot(t)},e.prototype.getLocation=function(){return this.roomProperty.getLocation()},e.prototype.setLocation=function(t){this.roomProperty.setLocation(t)},r([a.Input(),i("design:type",Object)],e.prototype,"roomProperty",void 0),e=r([a.Component({selector:"room-icon",styles:[n(1189)],template:n(1190)}),i("design:paramtypes",[c.EventBus,l.PropertyRemovalService,p.CombinedHotspotUtil,a.NgZone])],e)}(s.IconBase);e.RoomIcon=m},function(t,e,n){"use strict";function o(t,e){return Math.round(t*e)/e}function r(t){return new u.Vector2(o(t.getX(),h),o(t.getY(),h))}var i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(2),c=n(6),u=n(75),l=n(92),p=n(14),d=function(){function t(t,e){this.eventBus=t,this.ngZone=e,this.onIconDragEnd=new s.EventEmitter,this.propertyEditorIsVisible=!1,this.screenPosition=new u.Vector2(0,0),this.subscriptions=new Set,this.windowDimensions=new u.Vector2(window.innerWidth,window.innerHeight),this.inspectorShift={up:!1,left:!1,right:!1}}return t.prototype.ngOnInit=function(){var t=this;this.updatePosition(),this.subscriptions.add(this.eventBus.getObservable(c.EventType.WINDOW_RESIZE).subscribe(function(e){t.windowDimensions.setX(e.x),t.windowDimensions.setY(e.y)},function(t){return console.log("EditSpaceFlat.onResize",t)}))},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.setPosition=function(t){var e=l.denormalizePosition(t.getX(),t.getY()),n=e.getX()-p.ROOM_ICON_BUFFER_WIDTH,o=e.getY()-p.ROOM_ICON_BUFFER_HEIGHT;this.setPixelLocation(n,o),this.setScreenPosition(e.getX(),e.getY())},t.prototype.onOffClick=function(t){t.isOffClick&&this.setPropertyEditorVisibility(!1)},t.prototype.setPixelLocation=function(t,e){this.iconElement.nativeElement.style.left=t+"px",this.iconElement.nativeElement.style.top=e+"px"},t.prototype.setPixelLocationWithBuffer=function(t,e){var n=t-p.ROOM_ICON_BUFFER_WIDTH,o=e-p.ROOM_ICON_BUFFER_HEIGHT;this.setScreenPosition(n,o),this.setPixelLocation(n,o)},t.prototype.setScreenPosition=function(t,e){var n=this,o={right:t<140,left:t>this.windowDimensions.getX()-140,up:e>this.windowDimensions.getY()-200};this.screenPosition.setPosition(t,e),this.onIconDragEnd.observers.length?this.inspectorShift=o:this.ngZone.run(function(){return n.inspectorShift=o})},t.prototype.onMove=function(t){var e=this,n=t.x+p.ROOM_ICON_BUFFER_WIDTH,o=t.y+p.ROOM_ICON_BUFFER_HEIGHT;if(t.shiftKey)if(this.onIconDragEnd.observers.length)this.onIconDragEnd.emit({setIconLocation:function(t,n){e.setLocation(r(new u.Vector2(t,n)))},x:n,y:o});else{var i=l.normalizeAbsolutePosition(n,o),a=r(i),s=l.denormalizePosition(a.getX(),a.getY());this.setScreenPosition(s.getX(),s.getY()),this.setPixelLocation(s.getX()-p.ROOM_ICON_BUFFER_WIDTH,s.getY()-p.ROOM_ICON_BUFFER_HEIGHT)}else this.setScreenPosition(n,o),this.setPixelLocation(t.x,t.y)},t.prototype.onMoveEnd=function(t){var e=this;if(!t.didMove)return void setTimeout(function(){e.setPropertyEditorVisibility(!0)},200);var n=t.x+p.ROOM_ICON_BUFFER_WIDTH,o=t.y+p.ROOM_ICON_BUFFER_HEIGHT;if(this.onIconDragEnd.observers.length)this.onIconDragEnd.emit({setIconLocation:function(n,o){var i=new u.Vector2(n,o);t.shiftKey||(i=r(i)),e.setLocation(i)},x:n,y:o});else{var i=l.normalizeAbsolutePosition(n,o);t.shiftKey||(i=r(i)),this.setLocation(i)}},t.prototype.getScreenPosition=function(){return this.screenPosition},t.prototype.setPropertyEditorVisibility=function(t){var e=this;this.propertyEditorIsVisible!==t&&this.ngZone.run(function(){e.propertyEditorIsVisible=t,e.eventBus.onHotspotVisibility(t)})},i([s.ViewChild("iconElement"),a("design:type",Object)],t.prototype,"iconElement",void 0),i([s.Output(),a("design:type",Object)],t.prototype,"onIconDragEnd",void 0),t}();e.IconBase=d;var h=.5},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.icon{position:absolute;display:flex;flex-direction:column;align-items:center;cursor:grab;width:80px}.icon:active{cursor:grabbing}.icon:hover .icon__delete{visibility:visible}.icon__image{height:48px;display:block;margin:0 auto;filter:drop-shadow(0 2px 2px rgba(0,0,0,0.5))}.icon__delete{background-image:url("assets/icons/delete_filled.png");background-color:transparent;background-size:90%;background-repeat:no-repeat;width:21px;height:21px;visibility:hidden}.icon__image--medium{height:33px}.icon__image--small{height:20px}.icon__label{text-align:center;text-shadow:0 2px 2px rgba(0,0,0,0.62);margin:2px 0 0 0}.icon__hotspot-sphere{position:absolute;border:2px dashed white;border-radius:50%;padding:60px;top:-32px;left:-18px}.icon__property-editor{position:absolute}.icon__property-editor--up-shift{margin-top:-300px}.icon__property-editor--left-shift{margin-left:-200px;margin-top:-140px}.icon__property-editor--right-shift{margin-left:200px;margin-top:-140px}\n'},function(t,e){t.exports='<div\n  #iconElement\n  id="icon-element"\n  class="icon"\n  hotspot-icon\n  off-click\n  (onMove)="onMove($event)"\n  (onMoveEnd)="onMoveEnd($event)"\n  (onOffClick)="onOffClick($event)">\n\n  <img\n    id="draggableIcon"\n    class="icon__image"\n    [attr.src]="iconPath"\n    [ngClass]="{\n      \'icon__image--small\': hotspotIconSize === \'SMALL\',\n      \'icon__image--medium\': hotspotIconSize === \'MEDIUM\'\n    }">\n\n  <text-input\n    [textModel]="getName()"\n    [isHotspot]="true"\n    (onTextChange)="onNameChange($event)">\n  </text-input>\n\n  <div\n    (click)="onDeleteClick($event)"\n    class="icon__delete">\n  </div>\n\n\n  <property-editor\n    *ngIf="propertyEditorIsVisible"\n    [roomProperty]="roomProperty"\n    (onDeselect)="onDeselect($event)"\n    class="icon__property-editor"\n    [ngClass]="{\n      \'icon__property-editor--right-shift\': inspectorShift.right,\n      \'icon__property-editor--left-shift\': inspectorShift.left,\n      \'icon__property-editor--up-shift\': inspectorShift.up\n    }">\n  </property-editor>\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(109),s=n(138),c=function(){function t(t){this.propertyRemovalService=t,this.onDeselect=new i.EventEmitter}return t.prototype.getName=function(){return this.roomProperty.getName()},t.prototype.onNameChange=function(t){this.roomProperty.setName(t.text)},t.prototype.deleteProperty=function(){this.roomProperty&&this.propertyRemovalService.removeProperty(this.roomProperty)},t.prototype.ngOnChanges=function(t){t.roomProperty&&t.roomProperty.currentValue&&(this.propertyType=a.RoomPropertyTypeService.getTypeString(this.roomProperty))},t.prototype.getPropertyName=function(){return this.roomProperty.getName()},t.prototype.propertyIs=function(t){return this.propertyType===t},t.prototype.showNameEditor=function(){return"door"!==this.propertyType},o([i.Input(),r("design:type",Object)],t.prototype,"roomProperty",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"onDeselect",void 0),t=o([i.Component({selector:"property-editor",styles:[n(1192)],template:n(1193)}),r("design:paramtypes",[s.PropertyRemovalService])],t)}();e.PropertyEditor=c},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.property-editor{z-index:5}.property-editor__old{display:flex;flex-direction:column;justify-content:space-between;height:200px;width:280px;position:absolute;left:-100px;padding:5px;background-color:#D8D8D8;z-index:5;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}@media (max-width: 767px){.property-editor__old{position:fixed;width:100%;left:0;top:0;margin-top:50px;z-index:5}}.property-editor__row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;padding:10px 0}.property-editor__title{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center}.property-editor__select{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin-top:10px}.property-editor__label{margin-right:10px;font-size:.8em;color:#616161}.property-editor__title-input{flex-grow:2;font-size:1.1em}.property-editor__content-editor{flex:2}.property-editor__delete-button{position:absolute;width:100%;background-color:#FF3571;color:#fff;text-align:center;padding:10px 0;cursor:pointer;bottom:0px}\n'},function(t,e){t.exports='<div class="modal-window property-editor">\n\n  <div class="modal-window__fields">\n\n    <text-editor\n      *ngIf="propertyIs(\'text\')"\n      [textProperty]="roomProperty">\n    </text-editor>\n\n    <image-editor\n      *ngIf="propertyIs(\'image\')"\n      [imageProperty]="roomProperty">\n    </image-editor>\n\n    <door-editor\n      *ngIf="propertyIs(\'door\')"\n      [doorProperty]="roomProperty">\n    </door-editor>\n\n    <audio-editor\n      *ngIf="propertyIs(\'audio\')"\n      [audioProperty]="roomProperty">\n    </audio-editor>\n\n    <link-editor\n      *ngIf="propertyIs(\'link\')"\n      [linkProperty]="roomProperty">\n    </link-editor>\n\n\n\n  </div>\n  <div\n    class="property-editor__delete-button"\n    (click)="deleteProperty()">\n    Delete {{ getPropertyName() }}\n  </div>\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(266),s=function(){function t(){}return o([i.Input(),r("design:type",a.Text)],t.prototype,"textProperty",void 0),t=o([i.Component({selector:"text-editor",styles:[n(1195)],template:n(1196)})],t)}();e.TextEditor=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.text-editor__text-area{resize:none;font-size:1.1em;width:100%;height:60vh}\n'},function(t,e){t.exports='<div class="text-editor">\n  <p class="hotspot-inspector__label">\n    Enter Text:\n  </p>\n  <textarea\n    name="textarea"\n    class="text-editor__text-area"\n    [(ngModel)]="textProperty.body">\n  </textarea>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(267),s=n(6),c=n(53),u=function(){function t(t){this.eventBus=t}return t.prototype.onFileLoad=function(t){var e=this;c.resizeImage(t.binaryFileData,"hotspotImage").then(function(n){return e.imageProperty.setFileData(t.file.name,n)}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)})},o([i.Input(),r("design:type",a.Image)],t.prototype,"imageProperty",void 0),t=o([i.Component({selector:"image-editor",styles:[n(1198)],template:n(1199)}),r("design:paramtypes",[s.EventBus])],t)}();e.ImageEditor=u},function(t,e){t.exports=".image-editor__file-loader{width:50%;display:inline-block;position:relative;left:50%;transform:translate(-50%, 0)}.image-editor__image-display{display:block;position:relative;max-height:300px;margin-left:auto;margin-right:auto;justify-content:center;overflow:hidde}\n"},function(t,e){t.exports='<div\n  droppable\n  (onFileLoad)="onFileLoad($event)"\n  [acceptedFileType]="\'image\'"\n  class="modal-window__fields">\n\n  <file-loader\n    (onFileLoad)="onFileLoad($event)"\n    [acceptedFileType]="\'image\'"\n    class="image-editor__file-loader">\n  </file-loader>\n\n  <img\n    [attr.src]="imageProperty.getBinaryFileData()"\n    class="image-editor__image-display">\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(269),s=n(12),c=n(14),u=n(6),l=function(){function t(t,e){this.sceneInteractor=t,this.eventBus=e,this.autoTimeViewModel=0}return t.prototype.ngOnInit=function(){this.lastAutogoValue=this.doorProperty.getAutoTime()||20,this.autoTimeViewModel=this.lastAutogoValue},t.prototype.ngOnChanges=function(t){var e=this;this.roomList=this.createRoomList(),this.roomList.length&&(this.selectedRoom=this.roomList.find(function(t){return t.id===e.doorProperty.getRoomId()})||this.roomList[0],this.onRoomChange(null))},t.prototype.createRoomList=function(){var t=this,e=this.sceneInteractor.getRoomIds().filter(function(e){return e!==t.sceneInteractor.getActiveRoomId()}).map(function(e){var n=t.sceneInteractor.getRoomById(e);return{id:n.getId(),name:n.getName(),disabled:!1}});return e.unshift({id:"",name:c.DEFAULT_DOOR_NAME,disabled:!0}),e},t.prototype.onRoomChange=function(t){this.selectedRoom&&(this.doorProperty.setRoomId(this.selectedRoom.id),t&&this.setDefaultRoomName())},t.prototype.setDefaultRoomName=function(){var t=this,e=this.sceneInteractor.getRoomById(this.selectedRoom.id).getName();setTimeout(function(){t.doorProperty.setName(e),t.doorProperty.setNameIsCustom(!1)})},t.prototype.showTransportButton=function(){return!!this.doorProperty.getRoomId()},t.prototype.onTransportClick=function(){var t=this.doorProperty.getRoomId();this.sceneInteractor.setActiveRoomId(t),this.eventBus.onSelectRoom(t,!1)},t.prototype.getDoorAutotime=function(){return this.doorProperty.getAutoTime()},t.prototype.setDoorAutotime=function(t){this.doorProperty.setAutoTime(parseInt(t.target.value))},t.prototype.onCheckboxChange=function(t){var e=t.value?this.lastAutogoValue:0;t.value||(this.lastAutogoValue=this.doorProperty.getAutoTime()),this.doorProperty.setAutoTime(e)},t.prototype.sliderIsVisible=function(){return this.doorProperty.getAutoTime()>0},t.prototype.getAutoTimeViewModel=function(){return this.autoTimeViewModel},t.prototype.onSecondsChange=function(t){this.autoTimeViewModel=parseFloat(t.text)},t.prototype.onSecondsBlur=function(t){Number.isNaN(this.autoTimeViewModel)&&(this.autoTimeViewModel=0);var e=Math.floor(this.autoTimeViewModel),n=Math.max(1,Math.min(60,e));this.lastAutogoValue=this.doorProperty.getAutoTime(),this.doorProperty.setAutoTime(n),this.autoTimeViewModel=n},o([i.Input(),r("design:type",a.Door)],t.prototype,"doorProperty",void 0),t=o([i.Component({selector:"door-editor",styles:[n(1201)],template:n(1202)}),r("design:paramtypes",[s.SceneInteractor,u.EventBus])],t)}();e.DoorEditor=l},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.property-editor{z-index:5}.property-editor__old{display:flex;flex-direction:column;justify-content:space-between;height:200px;width:280px;position:absolute;left:-100px;padding:5px;background-color:#D8D8D8;z-index:5;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}@media (max-width: 767px){.property-editor__old{position:fixed;width:100%;left:0;top:0;margin-top:50px;z-index:5}}.property-editor__row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;padding:10px 0}.property-editor__title{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center}.property-editor__select{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin-top:10px}.property-editor__label{margin-right:10px;font-size:.8em;color:#616161}.property-editor__title-input{flex-grow:2;font-size:1.1em}.property-editor__content-editor{flex:2}.property-editor__delete-button{position:absolute;width:100%;background-color:#FF3571;color:#fff;text-align:center;padding:10px 0;cursor:pointer;bottom:0px}.door-editor__select{margin-bottom:10px}.door-editor__go-button{margin-top:10px}.door-editor__transport{margin-top:35px;margin-top:10px}.auto-go{display:flex;flex-direction:row;justify-content:flex-start;align-items:center;margin-top:10px}.auto-go__input-box{flex-grow:1;margin-left:15px;opacity:0}.auto-go__input-box--visible{opacity:1}\n'},function(t,e){t.exports='<div class="modal-window__fields">\n    <div>\n      <p class="hotspot-inspector__label">\n        Door to:\n      </p>\n      <select\n        [(ngModel)]="selectedRoom"\n        (change)="onRoomChange($event)"\n        class="hotspot-inspector__select door-editor__select">\n        <option\n          *ngFor="let room of roomList"\n          [selected]="room.id === selectedRoom"\n          [disabled]="room.disabled"\n          [ngValue]="room">\n            {{room.name}}\n        </option>\n      </select>\n    </div>\n\n    <div class="button door-editor__go-button"\n      *ngIf="showTransportButton()">\n      <p\n        (click)="onTransportClick($event)">\n        Go!\n      </p>\n    </div>\n\n\n    <div class="auto-go">\n\n      <span class="hotspot-inspector__label width-auto">\n        Auto\n      </span>\n\n      <checkbox\n        [initialValue]="sliderIsVisible()"\n        (changeEmitter)="onCheckboxChange($event)">\n      </checkbox>\n\n      \x3c!-- This will become a slider when we have finish the slider component --\x3e\n      <text-input-material\n        [inputType]="\'number\'"\n        [inputLabel]="\'Seconds (between 1 and 60)\'"\n        [textModel]="getAutoTimeViewModel()"\n        (onTextChange)="onSecondsChange($event)"\n        (onBlurEvent)="onSecondsBlur($event)"\n        class="auto-go__input-box"\n        [ngClass]="{\'auto-go__input-box--visible\': sliderIsVisible()}">\n      </text-input-material>\n\n    </div>\n  </div>\n\n  \x3c!-- <div *ngIf="sliderIsVisible()">\n    <input\n      id="rangeSlider"\n      type="range"\n      min="1"\n      max="60"\n      step="1"\n      [value]="getDoorAutotime()"\n      (change)="setDoorAutotime($event)"/>\n    <span class="hotspot-inspector__label">\n      {{getDoorAutotime()}} Seconds\n    </span>\n  </div> --\x3e\n\n  \x3c!-- <slider></slider> --\x3e\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(270),s=function(){function t(){}return t.prototype.showLinkButton=function(){return!!this.linkProperty.body},t.prototype.onLinkClick=function(){var t=this.linkProperty.body;/^http[s]?:\/\//.test(t)||(t="http://"+t),window.open(t,"_blank")},o([i.Input(),r("design:type",a.Link)],t.prototype,"linkProperty",void 0),t=o([i.Component({selector:"link-editor",styles:[n(1204)],template:n(1205)})],t)}();e.LinkEditor=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.property-editor{z-index:5}.property-editor__old{display:flex;flex-direction:column;justify-content:space-between;height:200px;width:280px;position:absolute;left:-100px;padding:5px;background-color:#D8D8D8;z-index:5;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}@media (max-width: 767px){.property-editor__old{position:fixed;width:100%;left:0;top:0;margin-top:50px;z-index:5}}.property-editor__row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;padding:10px 0}.property-editor__title{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center}.property-editor__select{display:flex;flex-direction:row;flex-wrap:nowrap;align-items:center;margin-top:10px}.property-editor__label{margin-right:10px;font-size:.8em;color:#616161}.property-editor__title-input{flex-grow:2;font-size:1.1em}.property-editor__content-editor{flex:2}.property-editor__delete-button{position:absolute;width:100%;background-color:#FF3571;color:#fff;text-align:center;padding:10px 0;cursor:pointer;bottom:0px}.link-editor__text-area{resize:none;font-size:1.1em;width:274px;height:96px;background:transparent}.link-editor__go-button{width:278px}\n'},function(t,e){t.exports='<div class="link-editor">\n\n  <textarea\n    name="textarea"\n    class="link-editor__text-area"\n    [(ngModel)]="linkProperty.body">\n  </textarea>\n\n  <div class="button link-editor__go-button"\n    *ngIf="showLinkButton()">\n    <p\n      (click)="onLinkClick($event)">\n      Go!\n    </p>\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(14),s=n(268),c=n(187),u=function(){function t(){}return t.prototype.onFileLoad=function(t){this.audioProperty.setFileData(t.file.name,a.DEFAULT_VOLUME,t.binaryFileData)},t.prototype.hasAudioFile=function(){return this.audioProperty.getFileName()!==a.DEFAULT_FILE_NAME},t.prototype.onAudioRecorded=function(t){this.audioProperty.setFileData(t.fileName,a.DEFAULT_VOLUME,t.dataUrl)},t.prototype.showAudioRecorder=function(){return c.browserCanRecordAudio()},t.prototype.onVolumeChange=function(t){var e=t.currentTarget.volume;this.audioProperty.setVolume(e)},o([i.Input(),r("design:type",s.Audio)],t.prototype,"audioProperty",void 0),t=o([i.Component({selector:"audio-editor",styles:[n(1207)],template:n(1208)})],t)}();e.AudioEditor=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.audio-editor__record-button{display:inline-block;position:relative;margin-left:5px;margin-bottom:10px}.audio-editor__file-loader{position:relative;margin-bottom:10px;width:100%}.audio-editor__audio-player{width:100%;position:relative;margin-top:5px}\n'},function(t,e){t.exports='<div\n  droppable\n  (onFileLoad)="onFileLoad($event)"\n  [acceptedFileType]="\'audio\'"\n  class="modal-window__fields">\n\n\n  <div class="hotspot-inspector_row">\n    <file-loader\n      (onFileLoad)="onFileLoad($event)"\n      [acceptedFileType]="\'audio\'"\n      class="audio-editor__file-loader">\n    </file-loader>\n    \n    <audio-recorder\n      *ngIf="showAudioRecorder()"\n      (onRecorded)="onAudioRecorded($event)"\n      class="audio-editor__record-button">\n    </audio-recorder>\n  </div>\n\n\n\n  <audio\n    *ngIf="hasAudioFile()"\n    [attr.src]="audioProperty.getBinaryFileData()"\n    type="audio/mp3"\n    controls="controls"\n    [volume]="audioProperty.getVolume()"\n    (volumechange)="onVolumeChange($event)"\n    class="audio-editor__audio-player">\n  </audio>\n\n</div>\n'},function(t,e,n){"use strict";function o(t,e,n){var o=1-n;return{r:r(t[0],e[0],n,o),g:r(t[1],e[1],n,o),b:r(t[2],e[2],n,o)}}function r(t,e,n,o){return Math.floor(t*o+e*n)}var i=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},a=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var s=n(2),c=n(187),u=n(108),l=new Uint8Array([173,0,52]),p=new Uint8Array([255,53,113]),d=function(){function t(t,e){this.audioRecorderService=t,this.ngZone=e,this.onRecorded=new s.EventEmitter,this.isRecording=!1}return t.prototype.ngOnDestroy=function(){this.isRecording&&this.audioRecorderService.stopRecording().then(function(t){}).catch(function(t){return console.error(t)}),clearTimeout(this.timeoutId)},t.prototype.onClick=function(t){this.isRecording?this.stopRecording():this.startRecording()},t.prototype.startRecording=function(){var t=this;this.isRecording=!0,this.audioRecorderService.startRecording().then(function(e){t.ngZone.runOutsideAngular(t.animateRecordButton.bind(t))}).catch(function(t){return console.log("error getting mic node",t)}),this.timeoutId=setTimeout(function(){t.isRecording&&t.stopRecording()},2e4)},t.prototype.stopRecording=function(){var t=this;this.isRecording=!1,clearTimeout(this.timeoutId),this.audioRecorderService.stopRecording().then(function(e){var n=u.generateUniqueId();t.onRecorded.emit({fileName:n+".wav",dataUrl:e})}).catch(function(t){return console.error(t)}),this.setButtonColor("rgb("+l[0]+", "+l[1]+", "+l[2]+")")},t.prototype.animateRecordButton=function(){if(this.isRecording){var t=this.audioRecorderService.getFrequencyData(),e=t.reduce(function(t,e){return t+e},0),n=e/t.length,r=Math.min(n,100)/100,i=o(l,p,r),a="rgb("+i.r+", "+i.g+", "+i.b+")";this.setButtonColor(a),requestAnimationFrame(this.animateRecordButton.bind(this))}},t.prototype.setButtonColor=function(t){this.audioRecorderButton.nativeElement.setAttribute("style","background-color: "+t)},i([s.Output(),a("design:type",Object)],t.prototype,"onRecorded",void 0),i([s.ViewChild("audioRecorder"),a("design:type",Object)],t.prototype,"audioRecorderButton",void 0),t=i([s.Component({selector:"audio-recorder",styles:[n(1210)],template:n(1211)}),a("design:paramtypes",[c.AudioRecorderService,s.NgZone])],t)}();e.AudioRecorder=d},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.circle-beacon:before,.circle-beacon:after{width:40px;height:40px;content:\'\';position:absolute;top:0;left:0;border-radius:50%;border:2px solid #FF3571}.circle-beacon:before{animation:ripple 1.5s linear infinite}.circle-beacon:after{animation:ripple 1.5s linear 1s infinite}@keyframes ripple{0%{transform:scale(1);opacity:0}10%{transform:scale(1.05);opacity:1}100%{transform:scale(1.75);opacity:0}}.audio-recorder{position:relative;width:42px;height:42px;border-radius:50%;background-color:#AD0034}\n'},function(t,e){t.exports='<div \n  #audioRecorder\n  (click)="onClick($event)"\n  class="audio-recorder"\n  [ngClass]="{\'circle-beacon\': isRecording}">\n</div>\n'},function(t,e,n){"use strict";(function(t){var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17);n(24),n(466),n(467),n(514);var s=n(6),c=n(37),u=n(12),l=n(275),p=n(76),d=n(518),h=n(520),f=n(521),m=n(522),g=n(523),v=n(278),y=n(525),_=n(517),b=n(516),w=n(14),I=n(524),E=n(1214),R=new E;R.showPanel(0);var x=n(279),S=(n(1215),n(1216),function(){function e(t,e,n,o,r,i,a,s,c,u,l,p,d,h){this.metaDataInteractor=t,this.sceneInteractor=e,this.cameraInteractor=n,this.eventBus=o,this.ngZone=r,this.assetInteractor=i,this.route=a,this.router=s,this.multiViewService=c,this.audioManager=u,this.textureLoader=l,this.hotspotManager=p,this.menuManager=d,this.reticle=h,this.subscriptions=new Set,this.isInRenderLoop=!1,this.showVrModeButton=!1,this.isInVrMode=!1,this.lastRenderTime=performance.now(),this.meshList=[],this.roomHistory=[],this.shouldInit=!1,this.inRoomTween=!1}return e.prototype.ngOnInit=function(){var t=this.metaDataInteractor.projectIsEmpty(),e=this.router.url.includes("multiview=");if(t&&!e)return void this.router.navigate(["/editor",{outlets:{view:"flat"}}]);this.shouldInit=!0},e.prototype.ngAfterViewInit=function(){this.shouldInit&&(this.initScene(),this.subscribeToEvents(),Promise.all([this.audioManager.loadBuffers(),this.textureLoader.load(),this.initVrDisplay(),I.default.load()]).then(this.initRoom.bind(this)).catch(function(t){return console.log("EditSphereBaseInit",t)}))},e.prototype.ngOnDestroy=function(){if(this.camera){var e=new t.Vector3(0,0,-1);e.applyQuaternion(this.camera.quaternion),this.cameraInteractor.setCameraDirection(e.x,e.y,e.z)}cancelAnimationFrame(this.animationRequest),this.isInRenderLoop=!1,this.subscriptions.forEach(function(t){return t.unsubscribe()}),this.audioManager.stopAllAudio(),this.video3D&&this.video3D.destroy(),this.menuManager.destroy(),this.scene&&h.clearScene(this.scene)},e.prototype.initScene=function(){var e=this.globeCanvas.nativeElement,n=b.buildScene();this.sphereMesh=n.sphereMesh,this.camera=n.camera,this.vrCamera=n.vrCamera,this.scene=n.scene,this.reticle.init(this.camera,this.vrCamera),this.renderer=new t.WebGLRenderer({canvas:e,antialias:!0}),this.svrControls=new t.SvrControls(this.camera,e,this.cameraInteractor.getCameraDirection()),this.vrControls=new t.VRControls(this.vrCamera),this.vrEffect=new t.VREffect(this.renderer),this.vrEffect.setSize(window.innerWidth,window.innerHeight)},e.prototype.initRoom=function(){var t=this.sceneInteractor.getActiveRoomId(),e=this.sceneInteractor.getRoomById(t);this.sphereMesh.position.set(0,0,0),this.camera.position.x=0,this.camera.position.y=0,this.camera.position.z=1e-4,this.camera.updateProjectionMatrix(),e.getBackgroundIsVideo()?this.init3dRoom(e):this.init2dRoom(t),this.audioManager.stopAllAudio(),this.audioManager.playBackgroundAudio(),this.audioManager.playNarration(),this.audioManager.playSoundtrack(),this.isInRenderLoop=!0,this.roomHistory.push(t)},e.prototype.init2dRoom=function(e){var n=this.assetInteractor.getTextureById(e);this.sphereMesh.material=new t.MeshBasicMaterial({map:n,side:t.FrontSide}),this.hotspotManager.load(this.scene,this.camera,this.goToRoom.bind(this)),this.menuManager.exists()||this.menuManager.load(this.scene,this.camera.position,this.goToLastRoom.bind(this),this.goToHomeRoom.bind(this)),this.onResize(null)},e.prototype.init3dRoom=function(e){var n=this;this.video3D=new _.Video3D,this.video3D.init(e.getBackgroundVideo()).then(function(e){n.sphereMesh.material=new t.MeshBasicMaterial({map:e,side:t.FrontSide}),n.hotspotManager.load(n.scene,n.camera,n.goToRoom.bind(n)),n.menuManager.load(n.scene,n.camera.position,n.goToLastRoom.bind(n),n.goToHomeRoom.bind(n)),n.onResize(null)}).catch(function(t){return console.log("EditSpaceSphere.initVideo",t)})},e.prototype.animate=function(){var t=this;this.isInRenderLoop&&(R.begin(),this.ngZone.runOutsideAngular(function(){var e=performance.now(),n=e-t.lastRenderTime;t.lastRenderTime=e,t.update(n),t.render()}))},e.prototype.logCamLookat=function(e){var n=new t.Vector3(0,0,0);this.camera.getWorldDirection(n),console.log("lookAt: ",e,n)},e.prototype.update=function(t){var e=this.vrDisplay.isPresenting,n=this.reticle.getActiveReticle(e),o=e?this.vrCamera:this.camera;e?this.vrControls.update():this.svrControls.update(),this.inRoomTween||this.hotspotManager.update(n,t),this.menuManager.update(n,o),this.multiViewService.update(o),x.update()},e.prototype.render=function(){this.vrDisplay.isPresenting?(this.vrEffect.render(this.scene,this.vrCamera),this.animationRequest=this.vrDisplay.requestAnimationFrame(this.animate.bind(this))):(this.renderer.render(this.scene,this.camera),R.end(),this.animationRequest=requestAnimationFrame(this.animate.bind(this)))},e.prototype.debounce=function(t,e,n){var o;return function(){var r=this,i=arguments,a=function(){o=null,n||t.apply(r,i)},s=n&&!o;clearTimeout(o),o=setTimeout(a,e),s&&t.apply(r,i)}},e.prototype.goToLastRoom=function(){var t=this;this.roomHistory.pop();var e=this.roomHistory[this.roomHistory.length-1];this.isInRenderLoop=!1,setTimeout(function(){t.sceneInteractor.setActiveRoomId(e),t.eventBus.onSelectRoom(e,!1)})},e.prototype.goToHomeRoom=function(){var t=this.sceneInteractor.getHomeRoomId();this.sceneInteractor.setActiveRoomId(t),this.eventBus.onSelectRoom(t,!1)},e.prototype.goToRoom=function(e){var n=this;this.inRoomTween=!0,this.lookAtVector=new t.Vector3(0,0,0),this.vrDisplay.isPresenting?this.vrCamera.getWorldDirection(this.lookAtVector):this.camera.getWorldDirection(this.lookAtVector);new x.Tween(this.sphereMesh.position).to({x:-1*this.lookAtVector.x*w.THREE_CONST.TWEEN_ROOM_MOVE,y:-1*this.lookAtVector.y*w.THREE_CONST.TWEEN_ROOM_MOVE,z:-1*this.lookAtVector.z*w.THREE_CONST.TWEEN_ROOM_MOVE},w.THREE_CONST.TWEEN_ROOM_MOVETIMEIN).easing(x.Easing.Linear.None).onUpdate(function(){}).onComplete(function(){n.isInRenderLoop=!1,n.inRoomTween=!1,n.sceneInteractor.setActiveRoomId(e),n.eventBus.onSelectRoom(e,!1)}).start()},e.prototype.requestVrMode=function(t){this.isInRenderLoop=!1,this.vrDisplay.requestPresent([{source:this.renderer.domElement}]).catch(function(t){return console.log("requestVRMode error",t)})},e.prototype.initVrDisplay=function(){var t=this;return navigator.getVRDisplays().then(function(e){e.length>0&&(t.vrDisplay=e[0],t.showVrModeButton=t.vrDisplay.capabilities.canPresent)}).catch(function(t){return console.log("initVrDisplay",t)})},e.prototype.onMouseDown=function(t){},e.prototype.onResize=function(t){var e=this;this.isInRenderLoop=!1,setTimeout(function(){b.onResize(e.camera,e.renderer).then(function(){e.vrEffect.setSize(window.innerWidth,window.innerHeight),e.reticle.showVrReticle(e.vrDisplay.isPresenting),e.isInRenderLoop=!0,e.animate()}).catch(function(t){return console.log("preview-space resize error",t)})})},e.prototype.subscribeToEvents=function(){var t=this;if(!(this.subscriptions.size>0)){var e=this.eventBus.getObservable(s.EventType.SELECT_ROOM).subscribe(function(e){return t.initRoom()},function(t){return console.log("error",t)}),n=this.eventBus.getObservable(s.EventType.WINDOW_RESIZE).subscribe(function(e){return t.onResize(e)},function(t){return console.log("EditSpaceFlat.onResize",t)}),o=this.eventBus.getObservable(s.EventType.VR_DISPLAY_CHANGE).subscribe(function(e){return t.onResize(null)},function(t){return console.log("error",t)}),r=this.route.queryParams.filter(function(t){return!!t.multiview}).map(function(t){return t.multiview}).subscribe(function(e){t.multiViewService.openSharedValue(e).then(function(){t.ngAfterViewInit();var e=t.multiViewService.observeRoom().subscribe(function(e){e.forEach(function(e,n){t.multiViewService.updateUser(e,n),t.isInRenderLoop||t.animate()})},function(t){return console.log("error",t)});t.subscriptions.add(e)}).catch(function(t){return console.log("error",t)})},function(t){return console.log("error",t)});this.subscriptions.add(e),this.subscriptions.add(n),this.subscriptions.add(o),this.subscriptions.add(r)}},o([i.ViewChild("editSpaceSphere"),r("design:type",Object)],e.prototype,"editSpaceSphere",void 0),o([i.ViewChild("globeCanvas"),r("design:type",Object)],e.prototype,"globeCanvas",void 0),e=o([i.Component({selector:"preview-space",styles:[n(1217)],template:n(1218)}),r("design:paramtypes",[c.MetaDataInteractor,u.SceneInteractor,l.CameraInteractor,s.EventBus,i.NgZone,p.AssetInteractor,a.ActivatedRoute,a.Router,d.MultiViewService,f.AudioManager,m.TextureLoader,g.HotspotManager,v.MenuManager,y.Reticle])],e)}());e.PreviewSpace=S}).call(e,n(24))},function(t,e,n){"use strict";(function(t){function n(t,e,n,o,r,a){var s=[],c=e.split(/(\s+)/),u="";return c.forEach(function(e,c){var l=u+e+" ";t.measureText(l).width>r?(s.push(new i(n,o,u.trim())),u=e+" ",o+=a):u=l}),s.push(new i(n,o,u.trim())),s}function o(e){var o=document.createElement("canvas"),i=o.getContext("2d"),a=document.createElement("canvas"),s=a.getContext("2d");o.width=600,o.height=800,i.font=r+"pt Nunito",i.fillStyle="rgba(0, 0, 0, 0.7)",i.fillRect(0,0,o.width,o.height),i.fillStyle="white";var c=n(i,e,10,r+10,600,r+8),u=c[c.length-1].y+r;c.forEach(function(t){return i.fillText(t.text,t.x,t.y)}),a.width=600,a.height=u,s.drawImage(o,0,0,600,u,0,0,600,u);var l=new t.Texture(a);return l.needsUpdate=!0,{width:600,height:u,material:new t.MeshBasicMaterial({map:l,transparent:!0,side:t.FrontSide})}}Object.defineProperty(e,"__esModule",{value:!0});var r=26,i=function(){function t(t,e,n){this.x=t,this.y=e,this.text=n}return t}();e.buildMaterialFromText=o}).call(e,n(24))},function(t,e,n){!function(e,n){t.exports=n()}(0,function(){var t=function(){function e(t){return r.appendChild(t.dom),t}function n(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";o=t}var o=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",function(t){t.preventDefault(),n(++o%r.children.length)},!1);var i=(performance||Date).now(),a=i,s=0,c=e(new t.Panel("FPS","#0ff","#002")),u=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var l=e(new t.Panel("MB","#f08","#201"));return n(0),{REVISION:16,dom:r,addPanel:e,showPanel:n,begin:function(){i=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(u.update(t-i,200),t>a+1e3&&(c.update(1e3*s/(t-a),100),a=t,s=0,l)){var e=performance.memory;l.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){i=this.end()},domElement:r,setMode:n}};return t.Panel=function(t,e,n){var o=1/0,r=0,i=Math.round,a=i(window.devicePixelRatio||1),s=80*a,c=48*a,u=3*a,l=2*a,p=3*a,d=15*a,h=74*a,f=30*a,m=document.createElement("canvas");m.width=s,m.height=c,m.style.cssText="width:80px;height:48px";var g=m.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=n,g.fillRect(0,0,s,c),g.fillStyle=e,g.fillText(t,u,l),g.fillRect(p,d,h,f),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(p,d,h,f),{dom:m,update:function(c,v){o=Math.min(o,c),r=Math.max(r,c),g.fillStyle=n,g.globalAlpha=1,g.fillRect(0,0,s,d),g.fillStyle=e,g.fillText(i(c)+" "+t+" ("+i(o)+"-"+i(r)+")",u,l),g.drawImage(m,p+a,d,h-a,f,p,d,h-a,f),g.fillRect(p+h-a,d,a,f),g.fillStyle=n,g.globalAlpha=.9,g.fillRect(p+h-a,d,a,i((1-c/v)*f))}}},t})},function(t,e){t.exports="uniform sampler2D texture;\nvarying vec2 vUv;\n\nvoid main() {\n  gl_FragColor = texture2D( texture, vUv );\n}\n"},function(t,e){t.exports="uniform sampler2D texture;\nuniform float time; // 0 to 1, seconds\nvarying vec2 vUv;\n\nvoid main() {\n  vec3 p = position;\n  vec3 newPosition = p + normal * - texture2D( texture, uv ).y * 100.0;\n  gl_Position = projectionMatrix * modelViewMatrix * vec4( newPosition, 1.0 );\n  vUv = uv;\n}\n"},function(t,e){t.exports=".preview-space{width:100%;height:100%;cursor:default}.preview-space__vr-mode-button{position:absolute;bottom:0;right:0;margin-bottom:10px;margin-right:10px}\n"},function(t,e){t.exports='<div class="preview-space">\n\n  <canvas\n    #globeCanvas\n    (mousedown)="onMouseDown($event)">\n  </canvas>\n\n  <div\n    *ngIf="showVrModeButton"\n    class="preview-space__vr-mode-button"\n    (click)="requestVrMode($event)">\n    VR Mode\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(38),s=n(6),c=n(17),u=function(){function t(t,e,n,o){this.ngZone=t,this.eventBus=e,this.userInteractor=n,this.router=o,this.isInFlatMode=!0,this.menuState={about:!1}}return t.prototype.onMenuItemClick=function(t){void 0!==this.menuState[t]&&(this.menuState[t]=!this.menuState[t],this.eventBus.onHotspotVisibility(this.menuState[t]))},t.prototype.onOffMenuItemClick=function(t,e){var n=this;t.isOffClick&&void 0!==this.menuState[e]&&this.menuState[e]&&this.ngZone.run(function(){n.menuState[e]=!1,n.eventBus.onHotspotVisibility(n.menuState[e])})},t.prototype.userIsLoggedIn=function(){return this.userInteractor.isLoggedIn()},t.prototype.setEditPlaySliderIsVisible=function(){return!1},t=o([i.Component({selector:"topbar",styles:[n(1220)],template:n(1221)}),r("design:paramtypes",[i.NgZone,s.EventBus,a.UserInteractor,c.Router])],t)}();e.Topbar=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.topbar{display:flex;flex-direction:row;justify-content:space-between;margin-top:10px}.topbar__row{display:flex;flex-direction:row;justify-content:space-between}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.topbar__row-menus{flex-grow:2}.topbar__marginright{margin-right:15px}.topbar__marginleft{margin-left:15px}.topbar__row-story{justify-content:center}.topbar__position-absolute{position:absolute}.topbar__story-tab{position:fixed;transform:translateX(-110%);left:0;transition:transform 0.2s ease-out}@media (max-width: 767px){.topbar__story-tab{width:98%}}.topbar__story-tab--active{transform:translateX(0)}.topbar__user-tab{position:fixed;transform:translateX(110%);right:0;transition:transform 0.2s ease-out}@media (max-width: 767px){.topbar__user-tab{width:98%}}.topbar__user-tab--active{transform:translateX(0)}.topbar__about-tab{margin-left:-62.5px}\n'},function(t,e){t.exports='<div class="topbar topbar__row">\n\n  \x3c!-- Story--\x3e\n<div\n    class="topbar__sub-row topbar__marginleft"\n    title="Your current story...">\n    <p\n      *ngIf="userIsLoggedIn()"\n      [routerLink]="[\'/editor\', {outlets: {\'modal\': [\'story\']}}]"\n      class="topbar__row-label">\n      Story\n    </p>\n  </div>\n\n\n\n  \x3c!-- profile --\x3e\n  <div\n    class="topbar__marginright"\n    title="User login">\n\n    <p\n      [routerLink]="[\'/editor\', {outlets: {\'modal\': [\'profile\']}}]"\n      class="topbar__row-label">\n      Profile\n    </p>\n\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=function(){function t(){}return t=o([r.Component({selector:"about-tab",styles:[n(1223)],template:n(1224)})],t)}();e.AboutTab=i},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.about-tab{background-color:#eee;margin:15px;padding:10px;max-width:250px}.about-tab-heading{margin-bottom:10px;border-bottom:1px solid #fff;color:#616161}.about-tab-text{font-size:.8em;margin-bottom:10px;color:#616161}\n'},function(t,e){t.exports='<div class="about-tab">\n\n  <p class="about-tab-heading font-header">\n    Welcome\n  </p>\n\n\n  <p class="about-tab-text">\n    SocialVR is an easy-to-use Virtual Reality (VR) authoring tool.  It works in Chrome and Firefox, and all it allows you to create complex VR experiences using 360-photos and annotation.\n  </p>\n\n  <p class="about-tab-text">\n    To learn more about SocialVR, click <a href="http://socialvrlab.com/" target="_blank">here.</a>\n  </p>\n\n  <p class="about-tab-text">\n    If you need more help, please <a href="mailto:hi@socialvrlab.com" target="_blank">email us</a>\n  </p>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(38),s=n(17),c=function(){function t(t,e){this.userInteractor=t,this.router=e}return t.prototype.userIsLoggedIn=function(){return this.userInteractor.isLoggedIn()},t.prototype.onOffClick=function(t){t.isOffClick&&this.router.navigate(["/editor",{outlets:{modal:""}}])},t=o([i.Component({selector:"user-tab",styles:[n(1226)],template:n(1227),encapsulation:i.ViewEncapsulation.None}),r("design:paramtypes",[a.UserInteractor,s.Router])],t)}();e.UserTab=c},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.profile{width:95%;height:95%;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.user-view{margin:15px;padding:10px;width:250px}.user-view__description{margin-bottom:10px}.user-view__description-margin-top{border-top:1px solid #eee;margin-top:10px;padding-top:10px}.sign-in-button{margin-top:10px}.user-view__input{font-size:1.1em;min-width:0px;max-width:63%;flex-grow:1;color:#616161}\n'},function(t,e){t.exports='<div class="modal-window"\n  off-click\n  (onOffClick)="onOffClick($event)">\n\n  <unauth-user-tab *ngIf="!userIsLoggedIn()"></unauth-user-tab>\n  <auth-user-tab *ngIf="userIsLoggedIn()"></auth-user-tab>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(17),c=n(6),u=n(38),l=function(){function t(t,e,n,o){this.router=t,this.userInteractor=e,this.eventBus=n,this.route=o,this.isCreatingAccount=!1,this.createUserIsUnlocked=!1}return t.prototype.ngOnInit=function(){var t=this;this.resetFields(),this.route.queryParams.map(function(t){return"true"===t.createaccount}).subscribe(function(e){return t.createUserIsUnlocked=e},function(t){return console.log("error",t)})},t.prototype.resetFields=function(){this.viewModel={username:"",password:"",createUsername:"",createPassword:"",createFirstname:"",createLastname:"",createEmail:""},this.isCreatingAccount=!1},t.prototype.getViewModelProperty=function(t){return this.viewModel[t]},t.prototype.setViewModelProperty=function(t,e){this.viewModel[e]=t.text},t.prototype.logIn=function(t){var e=this;if(!this.viewModel.username||!this.viewModel.password){return void this.eventBus.onModalMessage("Username Password Error","Make sure to fill out both username and password fields!")}this.userInteractor.logIn(this.viewModel.username,this.viewModel.password).subscribe(function(t){return e.onLogin()},function(t){e.eventBus.onModalMessage("Sign in error","It looks like the username and password don't match.")})},t.prototype.createAccount=function(){var t=this;if(!this.isCreatingAccount)return void(this.isCreatingAccount=!0);if(!this.createAccountFieldsAreValid()){return void this.eventBus.onModalMessage("Create Account Error","Make sure to fill out all the fields")}var e=this.viewModel.createUsername,n=this.viewModel.createPassword,o=this.viewModel.createFirstname,r=this.viewModel.createLastname,i=this.viewModel.createEmail;this.userInteractor.createUser(o,r,e,n,i).subscribe(function(t){return console.log("response",t)},function(e){var n="",o={};try{o=JSON.parse(e._body),n=Object.keys(o).map(function(t){return o[t]}).join("\n\n")}catch(e){}console.error(e),t.eventBus.onModalMessage("Create Account Error","We had trouble creating an account for you.\n"+n)},function(){return t.isCreatingAccount=!1})},t.prototype.createAccountFieldsAreValid=function(){return!!(this.viewModel.createUsername&&this.viewModel.createPassword&&this.viewModel.createFirstname&&this.viewModel.createLastname&&this.viewModel.createEmail)},t.prototype.facebookLogin=function(){this.userInteractor.facebookLogin().subscribe(function(t){return console.log("facebook login success",t)},function(t){return console.log("facebook login error",t)})},t.prototype.googleLogin=function(){console.log("google login"),this.userInteractor.googleLogin().subscribe(function(t){return console.log("google login success",t)},function(t){return console.log("google login error",t)})},t.prototype.signOutTest=function(){},t.prototype.onLogin=function(){},t.prototype.onOpenClick=function(t){this.eventBus.onOpenFileLoader("zip"),this.router.navigate(["/editor",{outlets:{view:"flat",modal:null}}])},t=o([i.Component({selector:"unauth-user-tab",styles:[n(1229)],template:n(1230)}),r("design:paramtypes",[s.Router,u.UserInteractor,c.EventBus,a.ActivatedRoute])],t)}();e.UnauthUserTab=l},function(t,e){t.exports=".unauth-user-tab__fields{width:90%;position:absolute;top:50%;left:50%;transform:translate(-50%, -50%)}\n"},function(t,e){t.exports='<div class="unauth-user-tab__fields">\n  <div *ngIf="!isCreatingAccount">\n    <text-input-material\n      [inputLabel]="\'Username\'"\n      [textModel]="getViewModelProperty(\'username\')"\n      (onTextChange)="setViewModelProperty($event, \'username\')">\n    </text-input-material>\n\n    <text-input-material\n      [inputType]="\'password\'"\n      [inputLabel]="\'Password\'"\n      [textModel]="getViewModelProperty(\'password\')"\n      (onTextChange)="setViewModelProperty($event, \'password\')">\n    </text-input-material>\n\n    <div\n      (click)="logIn($event)"\n      class="button sign-in-button">\n      Sign In\n    </div>\n\n    <div\n        class="button"\n        title="Click to create new story, SHIFT-click to upload zip file"\n       (click)="onOpenClick($event)">\n      Open\n    </div>\n\n  </div>\n\n  <div *ngIf="isCreatingAccount">\n\n    \x3c!-- create username --\x3e\n    <text-input-material\n      [inputLabel]="\'Username\'"\n      [textModel]="getViewModelProperty(\'createUsername\')"\n      (onTextChange)="setViewModelProperty($event, \'createUsername\')">\n    </text-input-material>\n\n    \x3c!-- create password --\x3e\n    <text-input-material\n      [inputLabel]="\'Password\'"\n      [textModel]="getViewModelProperty(\'createPassword\')"\n      (onTextChange)="setViewModelProperty($event, \'createPassword\')">\n    </text-input-material>\n\n    \x3c!-- create firstname --\x3e\n    <text-input-material\n      [inputLabel]="\'First name\'"\n      [textModel]="getViewModelProperty(\'createFirstname\')"\n      (onTextChange)="setViewModelProperty($event, \'createFirstname\')">\n    </text-input-material>\n\n    \x3c!-- create firstname --\x3e\n    <text-input-material\n      [inputLabel]="\'Last name\'"\n      [textModel]="getViewModelProperty(\'createLastname\')"\n      (onTextChange)="setViewModelProperty($event, \'createLastname\')">\n    </text-input-material>\n\n    \x3c!-- create email --\x3e\n    <text-input-material\n      [inputLabel]="\'Email\'"\n      [textModel]="getViewModelProperty(\'createEmail\')"\n      (onTextChange)="setViewModelProperty($event, \'createEmail\')">\n    </text-input-material>\n\n\n  </div>\n  \x3c!-- create account button --\x3e\n  <div\n    *ngIf="createUserIsUnlocked"\n    (click)="createAccount($event)"\n    class="button user-view__button">\n    Create account\n  </div>\n\n\n  \x3c!-- reset button --\x3e\n  <div\n    *ngIf="isCreatingAccount"\n    (click)="resetFields($event)"\n    class="button user-view__button">\n    Cancel\n  </div>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17);n(251);var s=n(37),c=n(182),u=n(38),l=n(54),p=n(12),d=n(139),h=n(6),f=(n(526),function(){function t(t,e,n,o,r,i,a,s){this.userInteractor=t,this.projectInteractor=e,this.sceneInteractor=n,this.eventBus=o,this.storageInteractor=r,this.metaDataInteractor=i,this.adminInteractor=a,this.router=s,this.projectList=[]}return t.prototype.ngOnInit=function(){var t=this;setTimeout(function(){t.userInteractor.getUser().switchMap(function(e){return t.projectInteractor.getProjects(e.id)}).subscribe(function(e){return t.projectList=e},function(t){return console.error("GET /users",t)})})},t.prototype.getUserName=function(){return this.userInteractor.getUserName()},t.prototype.onLogOutClick=function(){this.userInteractor.logOut().subscribe(function(t){},function(t){return console.log("error",t)})},t.prototype.openProject=function(t){var e=this;console.log("openProject");var n=this.userInteractor.getUserId();this.eventBus.onStartLoading(),console.log("onStartLoading done"),this.projectInteractor.openProject(n,t).subscribe(function(t){console.log("observable done",t),e.sceneInteractor.setActiveRoomId(null),e.eventBus.onSelectRoom(null,!1),e.metaDataInteractor.setIsReadOnly(!1)},function(t){return console.error("error",t)},function(){return e.eventBus.onStopLoading()}),this.router.navigateByUrl("/editor")},t.prototype.createProject=function(t){var e=this,n=this.userInteractor.getUserId();this.eventBus.onStartLoading(),this.projectInteractor.createProject(n).subscribe(function(t){return e.projectList.push(t)},function(t){return console.error("error",t)},function(){return e.eventBus.onStopLoading()})},t.prototype.updateProject=function(){var t=this,e=this.userInteractor.getUserId(),n=this.projectInteractor.getProjectId();this.eventBus.onStartLoading(),this.projectInteractor.updateProject(e,n).subscribe(function(t){},function(t){return console.error("error",t)},function(){return t.eventBus.onStopLoading()})},t.prototype.requestDeleteProject=function(t){var e=this;this.eventBus.onModalMessage("Are you sure?","There is no way to undo this action.",!0,function(){},function(){return e.deleteProject(t)})},t.prototype.deleteProject=function(t){var e=this,n=this.userInteractor.getUserId();this.eventBus.onStartLoading(),this.projectInteractor.deleteProject(n,t).subscribe(function(t){e.eventBus.onStopLoading(),e.eventBus.onModalMessage("","Project has been deleted from the server.")},function(t){e.eventBus.onStopLoading(),e.eventBus.onModalMessage("error",t.message)})},t.prototype.shareProject=function(t){var e=this.userInteractor.getUserId();this.eventBus.onShareableModal(e,t+"")},t.prototype.openMultiView=function(t){console.log("onOpenMultiView");var e=this.userInteractor.getUserId(),n={multiview:e+"-"+t};this.router.navigate(["editor","preview"],{queryParams:n})},t.prototype.isWorkingOnSavedProject=function(){return this.projectInteractor.isWorkingOnSavedProject()},t.prototype.userHasProjects=function(){return!!this.projectList&&this.projectList.length},t.prototype.getActiveProjectName=function(){var t=this.projectInteractor.getProjectId(),e=this.projectList.find(function(e){return e.id===t});return e&&e.name},t.prototype.projectIsSelected=function(t){return this.projectInteractor.getProjectId()===t},t.prototype.userIsAdmin=function(){return this.adminInteractor.isAdmin()},t.prototype.onExploreClick=function(t){this.router.navigateByUrl("/explore")},t.prototype.onAdminClick=function(t){this.router.navigateByUrl("/admin")},t=o([i.Component({selector:"auth-user-tab",styles:[n(1234)],template:n(1235)}),r("design:paramtypes",[u.UserInteractor,l.ProjectInteractor,p.SceneInteractor,h.EventBus,c.StorageInteractor,s.MetaDataInteractor,d.AdminInteractor,a.Router])],t)}());e.AuthUserTab=f},function(t,e){t.exports=function(){throw new Error("define cannot be used indirect")}},function(t,e){(function(e){t.exports=e}).call(e,{})},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.user-view__project-list-header{font-weight:bold;color:#616161}.user-view__project-list{color:#616161;overflow-y:scroll;max-height:200px;font-size:.8em;margin-bottom:10px}.user-view__project{display:flex;flex-direction:column;justify-content:space-between;color:#616161;margin-top:3px;margin-bottom:6px;border-bottom:1px solid #616161;padding-bottom:3px}.user-view__project-title{cursor:pointer;font-size:1em}.user-view__project-title:hover{cursor:pointer;color:#FF3571;font-style:bold !important}.user-view__project-title--selected{background-color:#FF3571;color:#fff}.user-view__project-options{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-end;align-items:center}.user-view__project-option{margin-left:10px;cursor:pointer;border-color:#eee;border:1px;padding-left:3px;padding-right:3px;border-style:dashed;border-radius:4px}.user-view__project-option:hover{color:black;border-color:#616161;border:1px;border-style:solid}\n'},function(t,e){t.exports='<div class="modal-window__fields">\n  <div class="dropdown-title">\n      <p>Hello {{getUserName()}}!</p>\n  </div>\n\n  <div\n    *ngIf="!isWorkingOnSavedProject()"\n    class="dropdown-text">\n    <p class="dropdown-text__accent">\n      Your currect project is not saved.\n      To save it, click on \'Story\' and then \'Save\'.\n    </p>\n    \x3c!-- Divider --\x3e\n    <div class="horiz-line"></div>\n  </div>\n\n  <div\n    *ngIf="!userHasProjects()"\n    class="dropdown-text__bold">\n    <p>No saved projects.</p>\n  </div>\n\n  <div *ngIf="userHasProjects()">\n    <p class="dropdown-text__bold">\n      Projects:\n    </p>\n    \x3c!-- TODO: make scrollable --\x3e\n    <div class="user-view__project-list">\n      <div\n        *ngFor="let project of projectList"\n        class="user-view__project">\n\n        <p\n          class="user-view__project-title"\n          *ngIf="!projectIsSelected(project.id)"\n          (click)="openProject(project.id)"\n          [ngClass]="{\'user-view__project-title--selected\': projectIsSelected(project.id)}">\n          {{project.name}}\n        </p>\n\n        <p\n          class="user-view__project-title--selected"\n          *ngIf="projectIsSelected(project.id)"\n          [ngClass]="{\'user-view__project-title--selected\': projectIsSelected(project.id)}">\n          {{project.name}}\n        </p>\n\n        <p class="user-view__project-options">\n          <span\n            (click)="openProject(project.id)"\n            class="user-view__project-option user-view__project-option--margin">\n            Open\n          </span>\n          <span\n            (click)="shareProject(project.id)"\n            class="user-view__project-option user-view__project-option--margin">\n            Share\n          </span>\n          <span\n            (click)="openMultiView(project.id)"\n            class="user-view__project-option user-view__project-option--margin">\n            Multi-View\n          </span>\n          <span\n            (click)="requestDeleteProject(project.id)"\n            class="user-view__project-option user-view__project-option--margin">\n            Delete\n          </span>\n        </p>\n\n      </div>\n    </div>\n  </div>\n  \x3c!-- Logout and Explore buttons --\x3e\n\n\n  <div\n    (click)="onExploreClick($event)"\n    title="Click to explore other Social VR projects"\n    class="button">\n    Explore\n  </div>\n\n  <div\n    class="button"\n    title="Click to add a room to current story"\n    (click)="onLogOutClick($event)">\n    Sign Out\n  </div>\n\n  <div\n    *ngIf="userIsAdmin()"\n    (click)="onAdminClick($event)"\n    title="Click to administer your groups"\n    class="button">\n    Admin\n  </div>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(12),c=n(37),u=function(){function t(t,e,n){this.sceneInteractor=t,this.metaDataInteractor=e,this.eventBus=n,this.projectIsSelected=!0,this.subscriptions=new Set,this.activeRoomIsExpanded=!0}return t.prototype.ngOnInit=function(){this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.subscribeToEvents=function(){var t=this,e=this.eventBus.getObservable(a.EventType.SELECT_PROPERTY).subscribe(function(e){var n=e.propertyId,o=t.sceneInteractor.getActiveRoomId();t.activeProperty=t.sceneInteractor.getPropertyById(o,n)||t.sceneInteractor.getRoomById(o),t.projectIsSelected=!1,t.activeRoomIsExpanded=!0},function(t){return console.log("error",t)}),n=this.eventBus.getObservable(a.EventType.SELECT_ROOM).subscribe(function(e){var n=t.sceneInteractor.getActiveRoomId();t.activeProperty=t.sceneInteractor.getRoomById(n),t.projectIsSelected=!1},function(t){return console.log("error",t)});this.subscriptions.add(e),this.subscriptions.add(n)},t.prototype.onProjectSelect=function(){this.projectIsSelected=!0},t.prototype.getPropertyList=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomProperties(t)},t.prototype.getRoomIdList=function(){return this.sceneInteractor.getRoomIds()},t.prototype.getRoomById=function(t){return this.sceneInteractor.getRoomById(t)},t.prototype.onRoomSelect=function(t){var e=this.sceneInteractor.getActiveRoomId();this.activeRoomIsExpanded=t!==e||!this.activeRoomIsExpanded,this.sceneInteractor.setActiveRoomId(t),this.eventBus.onSelectRoom(t,!1)},t.prototype.onPropertySelect=function(t){var e=t&&t.getId()||null;this.eventBus.onSelectProperty(e,!1)},t.prototype.propertyIsSelected=function(t){return t===this.activeProperty},t.prototype.roomIsSelected=function(t){return 0!==this.sceneInteractor.getRoomIds().length&&t===this.sceneInteractor.getActiveRoomId()},t.prototype.roomIsExpanded=function(t){return this.roomIsSelected(t)&&this.activeRoomIsExpanded&&!!this.sceneInteractor.getRoomProperties(t).length},t.prototype.getProjectName=function(){return this.metaDataInteractor.getProjectName()},t=o([i.Component({selector:"tree-tab",styles:[n(1237)],template:n(1238)}),r("design:paramtypes",[s.SceneInteractor,c.MetaDataInteractor,a.EventBus])],t)}();e.TreeTab=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.tree-view{background-color:#eee;background:transparent;height:300px;overflow-y:scroll}.tree-view__room-container{display:block;overflow-y:auto}.tree-view__row-item{color:#616161;font-size:.8em}.tree-view__row-item:hover{color:#000}.tree-view__room{margin-left:0px}.tree-view__room-property-container{max-height:0;overflow:hidden;transition:max-height 0.1s;margin-left:10px}.tree-view__room-property-container--expanded{max-height:500px}\n'},function(t,e){t.exports='<div class="tree-view">\n\n    <div\n      *ngFor="let roomId of getRoomIdList()"\n      class="tree-view__room">\n\n      \x3c!-- Room Label --\x3e\n      <row-item\n        [roomProperty]="getRoomById(roomId)"\n        [caretIsExpanded]="roomIsExpanded(roomId)"\n        [isActive]="roomIsSelected(roomId)"\n        (click)="onRoomSelect(roomId)"\n        class="tree-view__row-item">\n      </row-item>\n\n      \x3c!-- Room Properties --\x3e\n      <div\n        class="tree-view__room-property-container"\n        [ngClass]="{\'tree-view__room-property-container--expanded\': roomIsExpanded(roomId)}">\n\n        \x3c!-- Room Property Label --\x3e\n        <row-item\n          *ngFor="let roomProperty of getPropertyList()"\n          (click)="onPropertySelect(roomProperty)"\n          [roomProperty]="roomProperty"\n          [isActive]="propertyIsSelected(roomProperty)"\n          class="tree-view__row-item tree-view__row-item--margin-left">\n        </row-item>\n\n      </div>\n\n    </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(109),s=n(138),c=n(12),u=function(){function t(t,e){this.propertyRemovalService=t,this.sceneInteractor=e,this.propertyIsRoom=!1}return t.prototype.ngOnInit=function(){this.propertyIsRoom="room"===a.RoomPropertyTypeService.getTypeString(this.roomProperty)},t.prototype.onDeleteClick=function(){this.isHomeRoom()&&this.sceneInteractor.setHomeRoomId(null),this.propertyRemovalService.removeProperty(this.roomProperty)},t.prototype.getLabelText=function(){return this.roomProperty.getName()},t.prototype.onLabelChange=function(t){this.propertyIsRoom?this.sceneInteractor.setRoomName(this.roomProperty.getId(),t.text):this.roomProperty.setName(t.text)},t.prototype.isHomeRoom=function(){var t=this.roomProperty.getId();return this.sceneInteractor.isHomeRoom(t)},t.prototype.setAsHomeRoom=function(){var t=this.roomProperty.getId();this.sceneInteractor.setHomeRoomId(t)},t.prototype.getBackgroundThumbnail=function(){var t=this.roomProperty.getId();return this.sceneInteractor.getRoomById(t).getThumbnailImage()},o([i.Input(),r("design:type",Object)],t.prototype,"roomProperty",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"caretIsExpanded",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"isActive",void 0),t=o([i.Component({selector:"row-item",styles:[n(1240)],template:n(1241)}),r("design:paramtypes",[s.PropertyRemovalService,c.SceneInteractor])],t)}();e.RowItem=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.row-item{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:flex-start;align-items:center;height:30px;width:100%;cursor:pointer;margin:0px 0}.row-item:hover .row-item__delete{visibility:visible}.row-item:hover .row-item__home-icon{width:21px;height:21px}.row-item__room--active{background-color:#FF3571;background-clip:content-box;padding:2px 0;color:white}.row-item__room-property{margin-left:10px;height:22px}.row-item__room-property--active{background-color:#616161;color:white}.row-item__icon{height:20px;width:20px}.row-item__text-input{margin-left:10px}.row-item__spacer{flex-grow:2}.row-item__delete{margin-right:10px;visibility:hidden}.row-item__caret{width:0;height:0;border-top:6px solid transparent;border-bottom:6px solid transparent;border-left:10.404px solid #616161;border-radius:2px;margin-right:5px;transition:.08s linear}.row-item__caret--selected{transform:rotate(90deg)}.row-item__home-icon{background-image:url("assets/icons/icon-home.png");background-color:transparent;background-size:90%;background-repeat:no-repeat;height:0px;width:0px;transition:height 0.1s ease-in-out, width 0.1s ease-in-out}.row-item__home-icon--active{width:21px;height:21px}.row-item__thumbnail{width:44px;height:22px;margin-left:5px}\n'},function(t,e){t.exports='<div\n  class="row-item"\n  [ngClass]="{\n    \'row-item__room-property\': !propertyIsRoom,\n    \'row-item__room--active\': isActive && propertyIsRoom,\n    \'row-item__room-property--active\': isActive && !propertyIsRoom\n  }">\n\n  <div\n    *ngIf="propertyIsRoom"\n    class="row-item__caret"\n    [ngClass]="{\'row-item__caret--selected\': caretIsExpanded}">\n  </div>\n\n  <img\n    *ngIf="propertyIsRoom"\n    [attr.src]="getBackgroundThumbnail()"\n    class="row-item__thumbnail">\n\n  <text-input\n    class="row-item__text-input"\n    [isRowItem]="true"\n    [isActive]="isActive"\n    [textModel]="getLabelText()"\n    (onTextChange)="onLabelChange($event)">\n  </text-input>\n\n  <span class="row-item__spacer"></span>\n\n  <span\n    *ngIf="propertyIsRoom"\n    (click)="setAsHomeRoom()"\n    class="row-item__home-icon"\n    [ngClass]="{\'row-item__home-icon--active\': isHomeRoom()}">\n  </span>\n\n  <close-button\n    class="row-item__delete"\n    (onButtonClick)="onDeleteClick($event)">\n  </close-button>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(12),c=n(182),u=n(54),l=n(37),p=n(6),d=n(38),h=n(137),f=n(14),m=n(526),g=function(){function t(t,e,n,o,r,i,a,s){this.router=t,this.sceneInteractor=e,this.storageInteractor=n,this.metaDataInteractor=o,this.userInteractor=r,this.projectInteractor=i,this.eventBus=a,this.slideshowBuilder=s}return t.prototype.addRoom=function(t){this.sceneInteractor.addRoom(),this.router.navigate(["/editor",{outlets:{view:"flat"}}]),this.eventBus.onSelectRoom(null,!0)},t.prototype.addSlideshow=function(t){var e=this;this.eventBus.onStartLoading(),this.slideshowBuilder.build(t.files).then(function(t){return e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("error",t)})},t.prototype.getProjectName=function(){var t=this.metaDataInteractor.getProjectName();return t===f.DEFAULT_PROJECT_NAME?void 0:t},t.prototype.setProjectName=function(t){this.metaDataInteractor.setProjectName(t.text)},t.prototype.getProjectTags=function(){return this.metaDataInteractor.getProjectTags()},t.prototype.setProjectTags=function(t){this.metaDataInteractor.setProjectTags(t.text)},t.prototype.getSoundtrack=function(){return this.metaDataInteractor.getSoundtrack()},t.prototype.removeSoundtrack=function(){this.metaDataInteractor.removeSoundtrack()},t.prototype.getSoundtrackVolume=function(){return this.metaDataInteractor.getSoundtrackVolume()},t.prototype.onSoundtrackLoad=function(t){this.metaDataInteractor.setSoundtrack(t.file.name,f.DEFAULT_VOLUME,t.binaryFileData)},t.prototype.onVolumeChange=function(t){var e=t.currentTarget.volume;this.metaDataInteractor.setSoundtrackVolume(e)},t.prototype.onNewStoryClick=function(t){var e=this;this.eventBus.onModalMessage("","If you do not save your changes before opening a new story file, those changes will be lost.",!0,function(){},function(){if(e.router.navigate(["/editor",{outlets:{modal:"upload"}}]),t.shiftKey)return void e.eventBus.onOpenFileLoader("zip");e.sceneInteractor.setActiveRoomId(null),e.sceneInteractor.resetRoomManager(),e.projectInteractor.setProjectId(null),e.eventBus.onSelectRoom(null,!1),e.metaDataInteractor.setIsReadOnly(!1)})},t.prototype.onOpenStoryLocallyClick=function(t){this.eventBus.onOpenFileLoader("zip"),this.router.navigate(["/editor",{outlets:{modal:null}}])},t.prototype.onSaveStoryClick=function(t){return this.metaDataInteractor.projectIsEmpty()?void this.eventBus.onModalMessage("Error","Cannot save an empty project"):this.userInteractor.isLoggedIn()?this.metaDataInteractor.getIsReadOnly()?void this.eventBus.onModalMessage("Permissions Error","It looks like you are working on a different user's project. You cannot save this to your account but you can save it locally by shift-clicking the save button."):void this.saveStoryFileToServer():void this.eventBus.onModalMessage("Error","You must be logged in to save to the server")},t.prototype.onSaveStroyLocallyClick=function(t){var e=this;if(this.metaDataInteractor.projectIsEmpty())return void this.eventBus.onModalMessage("Error","Cannot save an empty project");if(this.metaDataInteractor.getIsReadOnly())return void this.eventBus.onModalMessage("Permissions Error","It looks like you are working on a different user's project. You cannot save this to your account but you can save it locally by shift-clicking the save button.");var n=this.metaDataInteractor.getProjectName()||"StoryFile",o=n+".zip";this.eventBus.onStartLoading(),this.storageInteractor.serializeProject().subscribe(function(t){e.eventBus.onStopLoading(),m.saveAs(t,o)},function(t){e.eventBus.onStopLoading(),e.eventBus.onModalMessage("File Download Error",t)})},t.prototype.saveStoryFileToServer=function(){var t=this,e=this.userInteractor.getUserId(),n=this.projectInteractor.getProjectId(),o=this.projectInteractor.isWorkingOnSavedProject(),r=function(e){t.eventBus.onStopLoading(),t.eventBus.onModalMessage("","Your project has been saved.")},i=function(e){t.eventBus.onStopLoading(),t.eventBus.onModalMessage("Save error",e)};this.eventBus.onStartLoading(),o?this.projectInteractor.updateProject(e,n).subscribe(r,i):this.projectInteractor.createProject(e).subscribe(r,i)},t.prototype.onOffClick=function(t){t.isOffClick&&this.router.navigate(["/editor",{outlets:{modal:""}}])},t=o([i.Component({selector:"story",styles:[n(1243)],template:n(1244)}),r("design:paramtypes",[a.Router,s.SceneInteractor,c.StorageInteractor,l.MetaDataInteractor,d.UserInteractor,u.ProjectInteractor,p.EventBus,h.SlideshowBuilder])],t)}();e.Story=g},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.story__soundtrack__upload-button{margin-top:5px}.story__soundtrack__delete-button{background-color:#FF3571;color:#fff;text-align:center;padding:10px 0;cursor:pointer}.story__soundtrack__audio-player{width:100%;margin-top:5px}\n'},function(t,e){t.exports='<div class="modal-window"\n  off-click\n  (onOffClick)="onOffClick($event)">\n\n\n  <div class="modal-window__fields">\n\n    \x3c!-- Title --\x3e\n    <text-input-material\n      [inputLabel]="\'Title\'"\n      [textModel]="getProjectName()"\n      (onTextChange)="setProjectName($event)">\n    </text-input-material>\n\n    \x3c!-- Tags --\x3e\n    <text-input-material\n      [inputLabel]="\'Tags\'"\n      [textModel]="getProjectTags()"\n      (onTextChange)="setProjectTags($event)">\n    </text-input-material>\n\n    \x3c!-- Divider --\x3e\n    <div class="horiz-line-bottom"></div>\n\n    \x3c!-- Soundtrack --\x3e\n    <file-loader\n      *ngIf="!getSoundtrack().hasAsset()"\n        (onFileLoad)="onSoundtrackLoad($event)"\n        [acceptedFileType]="\'audio\'"\n        [displayText]="\'Add Soundtrack\'"\n        class="story__soundtrack__upload-button">\n    </file-loader>\n\n    <div\n      *ngIf="getSoundtrack().hasAsset()"\n      class="story__soundtrack__delete-button"\n      (click)="removeSoundtrack()">\n      Remove Soundtrack\n    </div>\n\n    <audio\n      *ngIf="getSoundtrack().hasAsset()"\n      [attr.src]="getSoundtrack().getBinaryFileData()"\n      type="audio/mp3"\n      controls="controls"\n      [volume]="getSoundtrackVolume()"\n      (volumechange)="onVolumeChange($event)"\n      class="story__soundtrack__audio-player">\n    </audio>\n\n    <div class="dropdown-row">\n      <div class="button dropdown-button-margin" title="Click to save current story to server"\n       (click)="onSaveStoryClick($event)">\n        Save to Server\n      </div>\n      <div\n        class="button"\n        title="Click to create new story"\n        (click)="onNewStoryClick($event)">\n        New\n      </div>\n    </div>\n\n    <div class="dropdown-row">\n      <div class="button dropdown-button-margin" title="Click to download story as zip file"\n       (click)="onSaveStroyLocallyClick($event)">\n        Save locally\n      </div>\n      <div\n        class="button"\n        title="Click to upload zip file"\n        (click)="onOpenStoryLocallyClick($event)">\n        Open local story\n      </div>\n    </div>\n\n  </div>\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=function(){function t(t){this.router=t}return t.prototype.onClose=function(t){this.router.navigate(["/editor",{outlets:{modal:""}}])},t=o([i.Component({selector:"modal-close",styles:[n(1246)],template:n(1247)}),r("design:paramtypes",[a.Router])],t)}();e.ModalClose=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.modal-close{width:100%;text-align:center;position:absolute;bottom:0}.modal-close__button{color:#616161;cursor:pointer}\n'},function(t,e){t.exports='<div class="modal-close">\n\n  <p\n    (click)="onClose($event)"\n    class="modal-close__button">\n    Close\n  </p>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(61),u=n(12),l=n(53),p=n(137),d=n(274),h=n(92),f=n(61),m=n(180),g=function(){function t(t,e,n,o,r,a,s){this.router=t,this.eventBus=e,this.fileLoaderUtil=n,this.slideshowBuilder=o,this.sceneInteractor=r,this.videoInteractor=a,this.zipFileReader=s,this.onFileLoad=new i.EventEmitter}return t.prototype.onDrop=function(t){var e=this;t.stopPropagation(),t.preventDefault(),this.eventBus.onStartLoading(),this.slideshowBuilder.build(t.dataTransfer.files).then(function(t){e.eventBus.onStopLoading(),e.requestRender()}).catch(function(t){return e.eventBus.onModalMessage("error",t)}),t.dataTransfer.files&&t.dataTransfer.files[0]},t.prototype.onFileChange=function(t){var e=this,n=t.target.files&&t.target.files[0];if(!n)return void this.eventBus.onModalMessage("Error","No valid file selected");this.eventBus.onStartLoading(),this.router.navigate(["/editor",{outlets:{modal:null}}]),this.fileLoaderUtil.validateFileLoadEvent(n,"image").then(this.fileLoaderUtil.getBinaryFileData.bind(this.fileLoaderUtil)).then(function(t){return l.resizeImage(t,"backgroundImage")}).then(function(t){var o=e.sceneInteractor.getActiveRoomId(),r=e.sceneInteractor.getRoomById(o);r.setFileData(n.name,t.backgroundImage),r.setThumbnail(n.name,t.thumbnail),e.onFileLoad&&e.onFileLoad.emit(),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Error",t)}),this.router.navigate(["/editor",{outlets:{modal:null}}])},t.prototype.onOffClick=function(t){t.isOffClick&&this.router.navigate(["/editor",{outlets:{modal:""}}])},t.prototype.requestRender=function(){var t=this;this.isFlat()||setTimeout(function(){t.editSpaceSphere.render()})},t.prototype.processDroppedFile=function(t,e,n){var o=this,r=(t.name,this.isFlat()?h.normalizeAbsolutePosition(e,n):this.editSpaceSphere.transformScreenPositionTo3dNormal(e,n)),i=Object.keys(f.mimeTypeMap).find(function(e){return f.mimeTypeMap[e].indexOf(t.type)>-1});if(!i){return void this.eventBus.onModalMessage("Incompatible File Type","Try using an image (.jpg, .jpeg, .png), an audio file (.mp3, .wav), or a story file (.zip)")}if("video"===i)return console.log("bam, video",t),void this.getFileTypeStrategy(i)(t,null,r);this.fileLoaderUtil.getBinaryFileData(t).then(function(e){return o.getFileTypeStrategy(i)(t,e,r)}).catch(function(t){return o.eventBus.onModalMessage("Error",t)})},t.prototype.isFlat=function(){return this.router.url.includes("view:flat")},t.prototype.getFileTypeStrategy=function(t){var e=this;return{audio:function(t,n,o){var r=e.sceneInteractor.getActiveRoomId(),i=e.sceneInteractor.addAudio(r);i.setFileName(t.name),i.setBinaryFileData(n),i.setLocation(o),e.requestRender()},image:function(t,n,o){var r=e.sceneInteractor.getActiveRoomId();if(!e.hasBackgroundImage())return e.eventBus.onStartLoading(),void l.resizeImage(n,"backgroundImage").then(function(n){var o=e.sceneInteractor.getRoomById(r);o.setFileData(t.name,n.backgroundImage),o.setThumbnail(t.name,n.thumbnail),e.requestRender(),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)});l.resizeImage(n,"hotspotImage").then(function(n){var i=e.sceneInteractor.addImage(r);i.setFileName(t.name),i.setBinaryFileData(n),i.setLocation(o),e.requestRender()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)})},zip:function(t,n,o){e.zipFileReader.loadFile(t)},video:function(t,n,o){e.videoInteractor.uploadVideo(t).subscribe(function(t){var n=e.sceneInteractor.getActiveRoomId();e.sceneInteractor.getRoomById(n).setBackgroundVideo("",t.downloadUrl),console.log("bam, success",t)},function(t){return console.log("damn",t)})}}[t]},t.prototype.hasBackgroundImage=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.roomHasBackgroundImage(t)},o([i.ViewChild("editSpaceSphere"),r("design:type",Object)],t.prototype,"editSpaceSphere",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"onFileLoad",void 0),o([i.HostListener("drop",["$event"]),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],t.prototype,"onDrop",null),t=o([i.Component({selector:"upload",styles:[n(1249)],template:n(1250)}),r("design:paramtypes",[a.Router,s.EventBus,c.FileLoaderUtil,p.SlideshowBuilder,u.SceneInteractor,d.VideoInteractor,m.ZipFileReader])],t)}();e.Upload=g},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.upload__fields{width:50%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.upload__hidden-input{display:none}.upload__box{display:flex;justify-content:center;align-items:center;color:#616161;font-size:3vw;text-align:center;border:2px dashed #616161;border-radius:20px;width:50%;height:50%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%);cursor:pointer}\n'},function(t,e){t.exports='<div class="modal-window"\n  off-click\n  (onOffClick)="onOffClick($event)">\n  <input\n    id="hiddenBackgroundInput"\n    type="file"\n    (change)="onFileChange($event)"\n    class="upload__hidden-input">\n  <label\n    for="hiddenBackgroundInput"\n    class="upload__box">\n    Drag in 360 photos\n    <br />\n    or\n    <br />\n    click to import\n  </label>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(t){this.ngZone=t,this.onMenuChange=new i.EventEmitter,this.isOpen=!1}return t.prototype.onOffClick=function(t){var e=this;t.isOffClick&&this.ngZone.run(function(){e.isOpen=!1,e.onMenuChange.emit({isOpen:e.isOpen})})},t.prototype.onFabClick=function(t){this.isOpen=!this.isOpen,this.onMenuChange.emit({isOpen:this.isOpen})},o([i.Output(),r("design:type",Object)],t.prototype,"onMenuChange",void 0),t=o([i.Component({selector:"hotspot-menu",styles:[n(1252)],template:n(1253)}),r("design:paramtypes",[i.NgZone])],t)}();e.HotspotMenu=a},function(t,e){t.exports=".hotspot-menu{display:flex;flex-direction:column-reverse;align-items:center}.hotspot-menu__fab{transition:margin-bottom .15s ease-in-out;margin-left:10px}.hotspot-menu__fab-open{margin-left:0px !important}\n"},function(t,e){t.exports='<div\n  off-click\n  (onOffClick)="onOffClick($event)"\n  class="hotspot-menu">\n\n\n  <fab\n    class="hotspot-menu__fab"\n    (click)="onFabClick($event)"\n    [isOpen]="isOpen"\n    [ngClass]="{\'hotspot-menu__fab-open\': isOpen}">\n  </fab>\n\n  <action-menu\n    class="hotspot-menu__action-menu"\n    [isOpen]="isOpen"\n    class="topbar__position-absolute">\n  </action-menu>\n\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){this.isOpen=!1}return o([i.Input(),r("design:type",Boolean)],t.prototype,"isOpen",void 0),t=o([i.Component({selector:"fab",styles:[n(1255)],template:n(1256)})],t)}();e.Fab=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.fab{width:40px;height:40px;border-radius:50%;background-color:white;position:relative;cursor:pointer}.fab__bar{display:block;position:absolute;height:4px;width:32px;border-radius:2px;background-color:#FF3571;left:4px;top:18px;transition:.15s ease-in-out}.fab :nth-child(1){transform:rotate(0deg)}.fab :nth-child(2){transform:rotate(60deg)}.fab :nth-child(3){transform:rotate(-60deg)}.fab--open :nth-child(1){transform:rotate(60deg)}.fab--open :nth-child(2){transform:rotate(120deg)}.fab--open :nth-child(3){transform:rotate(180deg)}\n'},function(t,e){t.exports='<div\n  class="fab"\n  [ngClass]="{\'fab--open\': isOpen}">\n  <span class="fab__bar"></span>\n  <span class="fab__bar"></span>\n  <span class="fab__bar"></span>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(12),c=function(){function t(t,e){this.sceneInteractor=t,this.eventBus=e,this.isOpen=!1}return t.prototype.addText=function(t){var e=this.sceneInteractor.getActiveRoomId(),n=this.sceneInteractor.addText(e);this.eventBus.onSelectProperty(n.getId(),!0)},t.prototype.addAudio=function(t){var e=this.sceneInteractor.getActiveRoomId(),n=this.sceneInteractor.addAudio(e);this.eventBus.onSelectProperty(n.getId(),!0)},t.prototype.addImage=function(t){var e=this.sceneInteractor.getActiveRoomId(),n=this.sceneInteractor.addImage(e);this.eventBus.onSelectProperty(n.getId(),!0)},t.prototype.addDoor=function(t){var e=this,n=this.sceneInteractor.getRoomIds().length;if(n<2)return void this.eventBus.onModalMessage("","There must be at least two rooms to add a door.");var o=this.sceneInteractor.getActiveRoomId(),r=this.sceneInteractor.addDoor(o);this.eventBus.onSelectProperty(r.getId(),!0),n>2&&setTimeout(function(){e.eventBus.onSelectProperty(r.getId(),!1,!0)})},t.prototype.addRoom=function(t){this.sceneInteractor.addRoom(),this.eventBus.onSelectRoom(null,!0)},t.prototype.addLink=function(t){var e=this.sceneInteractor.getActiveRoomId(),n=this.sceneInteractor.addLink(e);this.eventBus.onSelectProperty(n.getId(),!0)},o([i.Input(),r("design:type",Boolean)],t.prototype,"isOpen",void 0),t=o([i.Component({selector:"action-menu",styles:[n(1258)],template:n(1259)}),r("design:paramtypes",[s.SceneInteractor,a.EventBus])],t)}();e.ActionMenu=c},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.action-menu__list{display:flex;flex-direction:column;justify-content:space-between;margin-left:-40px;width:0;transition:width 0.15s ease-out, margin-left 0.15s ease-out;overflow:hidden}.action-menu__list--open{width:calc(30px + 40px);margin-left:0px}.action-menu__list-item{cursor:pointer;height:65px}.action-menu__list-item:hover{font-size:1.05em}.action-menu__list-icon{height:40px;width:40px;display:block;margin:0 auto;background-repeat:no-repeat;background-position:center center;background-size:100%;background-color:transparent;opacity:0.8;filter:drop-shadow(0 2px 2px rgba(0,0,0,0.5))}.action-menu__list-label{text-shadow:0 2px 2px rgba(0,0,0,0.62);transition:font-size .15s ease-out;text-align:center;font-size:.8em}.list-icon__text{background-image:url("assets/icons/text_filled.png")}.list-icon__audio{background-image:url("assets/icons/audio_filled.png")}.list-icon__image{background-image:url("assets/icons/image_filled.png")}.list-icon__door{background-image:url("assets/icons/door_filled.png")}.list-icon__room{background-image:url("assets/icons/room.png")}.list-icon__link{background-image:url("assets/icons/link_filled.png")}\n'},function(t,e){t.exports='<div\n  class="action-menu__list"\n  [ngClass]="{\'action-menu__list--open\': isOpen}">\n\n  <div (click)="addText($event)" class="action-menu__list-item">\n    <div class="action-menu__list-icon list-icon__text"></div>\n    <p class="action-menu__list-label">Text<p>\n  </div>\n\n  <div (click)="addAudio($event)" class="action-menu__list-item">\n    <div class="action-menu__list-icon list-icon__audio"></div>\n    <p class="action-menu__list-label">Audio<p>\n  </div>\n\n  <div (click)="addImage($event)" class="action-menu__list-item">\n    <div class="action-menu__list-icon list-icon__image"></div>\n    <p class="action-menu__list-label">Image<p>\n  </div>\n\n  <div (click)="addDoor($event)" class="action-menu__list-item">\n    <div class="action-menu__list-icon list-icon__door"></div>\n    <p class="action-menu__list-label">Doorway<p>\n  </div>\n\n\x3c!--\n  //Link Hotspot \n  <div (click)="addLink($event)" class="action-menu__list-item">\n    <div class="action-menu__list-icon list-icon__link"></div>\n    <p class="action-menu__list-label">Link<p>\n  </div>\n --\x3e\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(37),s=n(53),c=n(12),u=n(6),l=n(265),p=n(187),d=n(14),h=function(){function t(t,e,n){this.sceneInteractor=t,this.eventBus=e,this.metaDataInteractor=n,this.reverbOptions=l.reverbList}return t.prototype.onBackgroundImageLoad=function(t){var e=this,n=t.file.name,o=t.binaryFileData;this.eventBus.onStartLoading(),s.resizeImage(o,"backgroundImage").then(function(t){var o=e.getActiveRoom();o.setFileData(n,t.backgroundImage),o.setThumbnail(n,t.thumbnail),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)})},t.prototype.onBackgroundAudioLoad=function(t){this.getActiveRoom().setBackgroundAudio(t.file.name,d.DEFAULT_VOLUME,t.binaryFileData)},t.prototype.onIntroAudioLoad=function(t){this.getNarratorIntroAudio().setIntroAudio(t.file.name,d.DEFAULT_VOLUME,t.binaryFileData)},t.prototype.onReturnAudioLoad=function(t){this.getActiveRoom().getNarrator().setReturnAudio(t.file.name,t.binaryFileData)},t.prototype.getNarratorIntroAudio=function(){return this.getActiveRoom().getNarrator()},t.prototype.getBackgroundAudio=function(){return this.getActiveRoom().getBackgroundAudio()},t.prototype.getBackgroundAudioVolume=function(){return this.getActiveRoom().getBackgroundAudioVolume()},t.prototype.getNarratorIntroAudioFile=function(){return this.getNarratorIntroAudio().getIntroAudio()},t.prototype.getNarratorReturnAudio=function(){return this.getNarratorIntroAudio().getReturnAudio()},t.prototype.getActiveRoom=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomById(t)},t.prototype.onNarratorIntroRecorded=function(t){this.getActiveRoom().getNarrator().setIntroAudio(t.fileName,d.DEFAULT_VOLUME,t.dataUrl)},t.prototype.onNarratorReturnRecorded=function(t){this.getActiveRoom().getNarrator().setReturnAudio(t.fileName,t.dataUrl)},t.prototype.onReverbChange=function(t){this.getActiveRoom().setReverb(t.target.value)},t.prototype.getActiveReverb=function(){return this.getActiveRoom().getReverb()},t.prototype.removeBackgroundAudio=function(){this.getActiveRoom().removeBackgroundAudio()},t.prototype.removeNarratorIntroAudio=function(){this.getNarratorIntroAudio().removeIntroAudio()},t.prototype.showAudioRecorder=function(){return p.browserCanRecordAudio()},t.prototype.onNarrationVolumeChange=function(t){var e=t.currentTarget.volume;this.getNarratorIntroAudio().setVolume(e)},t.prototype.onBGAVolumeChange=function(t){var e=t.currentTarget.volume;this.getActiveRoom().setBackgroundAudioVolume(e)},t.prototype.getRoomName=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomById(t).getName()},t.prototype.setRoomName=function(t){var e=this.sceneInteractor.getActiveRoomId();this.sceneInteractor.getRoomById(e).setName(t.text)},t=o([i.Component({selector:"room-editor",styles:[n(1261)],template:n(1262)}),r("design:paramtypes",[c.SceneInteractor,u.EventBus,a.MetaDataInteractor])],t)}();e.RoomEditor=h},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.room-editor{display:flex;flex-direction:column;justify-content:space-between;width:280px;padding:5px;background-color:#D8D8D8;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.room-editor__audio-player{width:100%;margin-top:5px}.room-editor__audio-file-loader{width:220px}.room-editor__audio-record-button{margin-top:18px}.room-editor__delete-button{background-color:#FF3571;color:#fff;text-align:center;padding:10px 0;cursor:pointer}\n'},function(t,e){t.exports='<div class="room-editor">\n\n\t\x3c!-- Title --\x3e\n  <text-input-material\n    [inputLabel]="\'Room Name\'"\n    [textModel]="getRoomName()"\n    (onTextChange)="setRoomName($event)">\n  </text-input-material>\n  <br/>\n\t<p class="hotspot-inspector__label">\n\t\tRoom Background Image\n\t</p>\n\t<file-loader\n    \t(onFileLoad)="onBackgroundImageLoad($event)"\n\t    [acceptedFileType]="\'image\'">\n\t</file-loader>\n\n\t<p class="hotspot-inspector__label">Room Background Audio</p>\n\t<file-loader\n\t\t*ngIf="!getBackgroundAudio().hasAsset()"\n    \t(onFileLoad)="onBackgroundAudioLoad($event)"\n\t    [acceptedFileType]="\'audio\'">\n\t</file-loader>\n\n\t<div\n\t\t*ngIf="getBackgroundAudio().hasAsset()"\n\t\tclass="room-editor__delete-button"\n\t\t(click)="removeBackgroundAudio()">\n\t\tRemove Background Audio\n\t</div>\n\n\t<audio\n\t\t*ngIf="getBackgroundAudio().hasAsset()"\n\t\t[attr.src]="getBackgroundAudio().getBinaryFileData()"\n\t\ttype="audio/mp3"\n\t\tcontrols="controls"\n\t\t[volume]="getBackgroundAudioVolume()"\n    \t(volumechange)="onBGAVolumeChange($event)"\n\t\tclass="room-editor__audio-player">\n\t</audio>\n\n\t\x3c!-- <div>\n\t\t<p class="hotspot-inspector__label">Reverb</p>\n\n\t\t<select\n\t\t\t(change)="onReverbChange($event)"\n\t\t\tclass="hotspot-inspector__select room-editor__reverb-select">\n\t\t\t<option\n\t\t\t\t*ngFor="let reverb of reverbOptions"\n\t\t\t\t[selected]="reverb === getActiveReverb()">\n\t\t\t\t\t{{reverb}}\n\t\t\t</option>\n\t\t</select>\n\n\t</div> --\x3e\n\n  \t<div class="hotspot-inspector_row">\n\t\t<div>\n\t\t\t<p class="hotspot-inspector__label room-editor__audio-file-loader">Room Narration</p>\n\t\t\t<file-loader\n\t\t\t\t*ngIf="!getNarratorIntroAudioFile().hasAsset()"\n\t\t    \t(onFileLoad)="onIntroAudioLoad($event)"\n\t\t\t    [acceptedFileType]="\'audio\'"\n\t\t\t\t\tclass="room-editor__audio-file-loader">\n\t\t\t</file-loader>\n\t\t\t<div\n\t\t\t\t*ngIf="getNarratorIntroAudioFile().hasAsset()"\n\t\t\t\tclass="room-editor__delete-button"\n\t\t\t\t(click)="removeNarratorIntroAudio()">\n\t\t\t\tRemove Narration\n\t\t\t</div>\n\t\t</div>\n\t\t<audio-recorder\n\t\t\t*ngIf="showAudioRecorder()"\n      \t\t(onRecorded)="onNarratorIntroRecorded($event)"\n      \t\tclass="audio-editor__record-button room-editor__audio-record-button">\n    \t</audio-recorder>\n  \t</div>\n\t<audio\n\t\t*ngIf="getNarratorIntroAudioFile().hasAsset()"\n\t\t[attr.src]="getNarratorIntroAudioFile().getBinaryFileData()"\n\t\ttype="audio/mp3"\n\t\tcontrols="controls"\n\t\t[volume]="getNarratorIntroAudio().getVolume()"\n    \t(volumechange)="onNarrationVolumeChange($event)"\n\t\tclass="room-editor__audio-player">\n\t</audio>\n\n\t\t\x3c!--  disabled by ali, at aparna\'s request\n\t\t<div class="hotspot-inspector_row">\n\t\t\t<div>\n\t\t\t\t<p class="hotspot-inspector__label room-editor__audio-file-loader">Narration: Return</p>\n\t\t\t\t<file-loader\n\t\t\t    \t(onFileLoad)="onReturnAudioLoad($event)"\n\t\t\t\t    [acceptedFileType]="\'audio\'"\n\t\t\t\t\t\tclass="room-editor__audio-file-loader">\n\t\t\t\t</file-loader>\n\t\t\t</div>\n\t\t\t<audio-recorder\n\t\t\t\t(onRecorded)="onNarratorReturnRecorded($event)"\n\t\t\t\tclass="audio-editor__record-button room-editor__audio-record-button">\n\t\t\t</audio-recorder>\n\t\t</div>\n\t\t<audio\n\t\t\t*ngIf="getNarratorReturnAudio().hasAsset()"\n\t\t\t[attr.src]="getNarratorReturnAudio().getBinaryFileData()"\n\t\t\ttype="audio/mp3"\n\t\t\tcontrols="controls"\n\t\t\tclass="room-editor__audio-player room-editor__audio-record-button">\n\t\t</audio>\n\t\t--\x3e\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(t){this.ngZone=t,this.inspectorIsVisible=!1}return t.prototype.onSelect=function(t){this.inspectorIsVisible=!0},t.prototype.onOffClick=function(t){var e=this;t.isOffClick&&this.ngZone.run(function(){return e.inspectorIsVisible=!1})},t=o([i.Component({selector:"room-editor-icon",styles:[n(1264)],template:n(1265)}),r("design:paramtypes",[i.NgZone])],t)}();e.RoomEditorIcon=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.room-editor-icon{display:flex;flex-direction:column}.room-editor-icon__image{width:40px;height:40px;margin-bottom:10px}.room-editor-icon__editor{margin-left:-120px;margin-bottom:15px}\n'},function(t,e){t.exports='<div\n  id="icon-element"\n  class="room-editor-icon">\n\n  <room-editor\n    *ngIf="inspectorIsVisible"\n    class="room-editor-icon__editor">\n  </room-editor>\n\n  <img\n    (click)="onSelect($event)"\n    class="room-editor-icon__image"\n    src="assets/icons/room-pink.png">\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(12),u=n(53),l=function(){function t(t,e,n){this.sceneInteractor=t,this.eventBus=e,this.router=n,this.isInFlatMode=!0,this.isInFullscreen=!1,this.docElm=document.documentElement}return t.prototype.editorIsFlat=function(){return this.router.url.includes("view:flat")},t.prototype.editorIsSphere=function(){return this.router.url.includes("view:sphere")},t.prototype.editorIsPreview=function(){return this.router.url.includes("view:preview")},t.prototype.onFileLoad=function(t){var e=this,n=t.file.name,o=t.binaryFileData,r=this.sceneInteractor.getActiveRoomId();this.eventBus.onStartLoading(),u.resizeImage(o,"backgroundImage").then(function(t){var o=e.sceneInteractor.getRoomById(r);o.setFileData(n,t.backgroundImage),o.setThumbnail(n,t.thumbnail),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)})},t.prototype.onEditPlayChange=function(t){1==t.value?this.router.navigate(["editor",{outlets:{view:"preview"}}]):this.isInFlatMode?this.router.navigate(["/editor",{outlets:{view:"flat"}}]):this.router.navigate(["/editor",{outlets:{view:"sphere"}}])},t.prototype.setEditPlaySliderIsVisible=function(){return!1},t.prototype.on2d3dChange=function(t){1==t.value?(this.router.navigate(["editor",{outlets:{view:"sphere"}}]),this.isInFlatMode=!0):(this.router.navigate(["/editor",{outlets:{view:"flat"}}]),this.isInFlatMode=!1)},t.prototype.set2d3dSliderIsVisible=function(){return!1},t.prototype.onFullscreenClick=function(t){this.isInFullscreen?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.isInFullscreen=!1):(this.docElm.requestFullscreen?this.docElm.requestFullscreen():this.docElm.webkitRequestFullScreen&&this.docElm.webkitRequestFullScreen(),this.isInFullscreen=!0)},t.prototype.isFullscreen=function(){return this.isInFullscreen},t=o([i.Component({selector:"edit-space-toggle",styles:[n(1267)],template:n(1268)}),r("design:paramtypes",[c.SceneInteractor,s.EventBus,a.Router])],t)}();e.EditSpaceToggle=l},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}.toggler{margin-right:10px}.toggler__label{text-shadow:0 2px 2px rgba(0,0,0,0.62);margin-bottom:6px}.toggler__switches{height:100px;display:flex;flex-direction:column;align-items:center}\n'},function(t,e){t.exports='<div\n  droppable\n  [acceptedFileType]="\'image\'"\n  (onFileLoad)="onFileLoad($event)"\n  class="toggler">\n\n    <div class="toggler__switches">\n\n      <p class="toggler__label">Edit | Play</p>\n      <checkbox\n        [initialValue]="setEditPlaySliderIsVisible()"\n        (changeEmitter)="onEditPlayChange($event)">\n      </checkbox>\n      <br/>\n      <div *ngIf="!editorIsPreview()">\n        <p class="toggler__label">2D | 3D</p>\n        <checkbox\n          [initialValue]="set2d3dSliderIsVisible()"\n          (changeEmitter)="on2d3dChange($event)">\n        </checkbox>\n      </div>\n    </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(12),c=n(37),u=n(53),l=n(137),p=function(){function t(t,e,n,o,r){this.sceneInteractor=t,this.metaDataInteractor=e,this.eventBus=n,this.ngZone=o,this.slideshowBuilder=r,this.projectIsSelected=!0,this.subscriptions=new Set,this.activeRoomIsExpanded=!0,this.inspectorIsVisible=!1,this.isOpen=!1}return t.prototype.ngOnInit=function(){this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.subscribeToEvents=function(){var t=this,e=this.eventBus.getObservable(a.EventType.SELECT_PROPERTY).subscribe(function(e){var n=e.propertyId,o=t.sceneInteractor.getActiveRoomId();t.activeProperty=t.sceneInteractor.getPropertyById(o,n)||t.sceneInteractor.getRoomById(o),t.projectIsSelected=!1,t.activeRoomIsExpanded=!0},function(t){return console.log("error",t)}),n=this.eventBus.getObservable(a.EventType.SELECT_ROOM).subscribe(function(e){var n=t.sceneInteractor.getActiveRoomId();t.activeProperty=t.sceneInteractor.getRoomById(n),t.projectIsSelected=!1},function(t){return console.log("error",t)});this.subscriptions.add(e),this.subscriptions.add(n)},t.prototype.onProjectSelect=function(){this.projectIsSelected=!0},t.prototype.getPropertyList=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomProperties(t)},t.prototype.getRoomIdList=function(){return this.sceneInteractor.getRoomIds()},t.prototype.getRoomById=function(t){return this.sceneInteractor.getRoomById(t)},t.prototype.onRoomSelect=function(t){var e=this.sceneInteractor.getActiveRoomId();this.activeRoomIsExpanded=t!==e||!this.activeRoomIsExpanded,this.sceneInteractor.setActiveRoomId(t),this.eventBus.onSelectRoom(t,!1)},t.prototype.onPropertySelect=function(t){var e=t&&t.getId()||null;this.eventBus.onSelectProperty(e,!1)},t.prototype.propertyIsSelected=function(t){return t===this.activeProperty},t.prototype.roomIsSelected=function(t){return 0!==this.sceneInteractor.getRoomIds().length&&t===this.sceneInteractor.getActiveRoomId()},t.prototype.roomIsExpanded=function(t){return this.roomIsSelected(t)&&this.activeRoomIsExpanded&&!!this.sceneInteractor.getRoomProperties(t).length},t.prototype.getProjectName=function(){return this.metaDataInteractor.getProjectName()},t.prototype.onInfoClick=function(t){this.inspectorIsVisible=!0},t.prototype.onOffClick=function(t){var e=this;t.isOffClick&&this.ngZone.run(function(){return e.inspectorIsVisible=!1})},t.prototype.toggleOpen=function(t){this.isOpen=!this.isOpen},t.prototype.onFileLoad=function(t){var e=this,n=t.file.name,o=t.binaryFileData;this.eventBus.onStartLoading(),u.resizeImage(o,"backgroundImage").then(function(t){var o=e.sceneInteractor.addRoom(),r=e.sceneInteractor.getRoomById(o);r.setFileData(n,t.backgroundImage),r.setThumbnail(n,t.thumbnail),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("Image loading error",t)})},t.prototype.addSlideshow=function(t){var e=this;this.eventBus.onStartLoading(),this.slideshowBuilder.build(t.files).then(function(t){return e.eventBus.onStopLoading()}).catch(function(t){return e.eventBus.onModalMessage("error",t)})},t=o([i.Component({selector:"story-scroll",styles:[n(1270)],template:n(1271)}),r("design:paramtypes",[s.SceneInteractor,c.MetaDataInteractor,a.EventBus,i.NgZone,l.SlideshowBuilder])],t)}();e.StoryScroll=p},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.story-scroll{position:absolute;bottom:0;width:70%;left:15%;display:flex;flex-direction:column;justify-content:center;align-content:center;transform:translateY(85px);transition:transform 0.25s ease-in-out}.stroy-scroll--open{transform:translateY(0)}.story-scroll__toggle-button{position:relative;width:100px;height:30px;margin:auto auto -30px auto;cursor:pointer}.story-scroll__toggle-arrow{display:block;position:absolute;height:5px;width:30px;margin:1px;background:#fff;border-radius:10px;transition:transform 0.25s ease}.story-scroll__toggle-arrow-left{transform:rotate(-45deg);left:27%}.story-scroll__toggle-arrow-left--open{transform:rotate(45deg)}.story-scroll__toggle-arrow-right{transform:rotate(45deg);left:45%}.story-scroll__toggle-arrow-right--open{transform:rotate(-45deg)}.story-scroll__room-editor{justify-content:center;align-content:center;margin:auto}.story-scroll__scroll{background-color:#eee;display:flex;flex-direction:row;justify-content:center;background:transparent;max-width:100%;align-items:center}.story-scroll__room-group{display:flex;flex-direction:row;justify-content:flex-start;overflow-x:scroll;padding-left:80px}.story-scroll__room{flex-direction:row;margin-left:0px}.story-scroll__storymap-item{color:#616161;font-size:.8em}.story-scroll__storymap-item:hover{color:#000}.story-scroll__room-property-container{max-height:0;overflow:hidden;transition:max-height 0.1s;margin-left:10px}.story-scroll__room-property-container--expanded{max-height:500px}\n'},function(t,e){t.exports='<div\n  class="story-scroll"\n  [ngClass]="{\'stroy-scroll--open\': isOpen}">\n\n  <room-editor\n    *ngIf="inspectorIsVisible"\n    off-click\n    (onOffClick)="onOffClick($event)"\n    class="story-scroll__room-editor">\n  </room-editor>\n\n  <div *ngIf="!inspectorIsVisible">\n    <div\n      (click)="toggleOpen($event)"\n      class="story-scroll__toggle-button">\n      <span\n        class="story-scroll__toggle-arrow story-scroll__toggle-arrow-left"\n        [ngClass]="{\'story-scroll__toggle-arrow-left--open\': isOpen}">\n      </span>\n      <span\n      class="story-scroll__toggle-arrow story-scroll__toggle-arrow-right"\n      [ngClass]="{\'story-scroll__toggle-arrow-right--open\': isOpen}">\n      </span>\n    </div>\n  </div>\n\n\n  <div\n    droppable\n    [acceptedFileType]="\'image\'"\n    [acceptMultpleFiles]="true"\n    (onFileLoad)="addSlideshow($event)"\n    class="story-scroll__scroll">\n\n      <div class="story-scroll__room-group">\n        <div\n          *ngFor="let roomId of getRoomIdList()"\n          class="story-scroll__room">\n\n          \x3c!-- Room Label --\x3e\n          <storymap-item\n            [roomProperty]="getRoomById(roomId)"\n            [isActive]="roomIsSelected(roomId)"\n            (click)="onRoomSelect(roomId)"\n            (infoEvent)="onInfoClick($event)"\n            class="story-scroll__storymap-item">\n          </storymap-item>\n        </div>\n      </div>\n\n      <add-room></add-room>\n\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(109),s=n(138),c=n(12),u=function(){function t(t,e,n){this.propertyRemovalService=t,this.sceneInteractor=e,this.ngZone=n,this.infoEvent=new i.EventEmitter,this.deleteEvent=new i.EventEmitter,this.propertyIsRoom=!1,this.inspectorIsVisible=!1}return t.prototype.ngOnInit=function(){this.propertyIsRoom="room"===a.RoomPropertyTypeService.getTypeString(this.roomProperty)},t.prototype.onDeleteClick=function(){this.isHomeRoom()&&this.sceneInteractor.setHomeRoomId(null),this.propertyRemovalService.removeProperty(this.roomProperty)},t.prototype.onInfoClick=function(t){this.infoEvent.emit()},t.prototype.getLabelText=function(){return this.roomProperty.getName()},t.prototype.onLabelChange=function(t){this.propertyIsRoom?this.sceneInteractor.setRoomName(this.roomProperty.getId(),t.text):this.roomProperty.setName(t.text)},t.prototype.isHomeRoom=function(){var t=this.roomProperty.getId();return this.sceneInteractor.isHomeRoom(t)},t.prototype.setAsHomeRoom=function(){var t=this.roomProperty.getId();this.sceneInteractor.setHomeRoomId(t)},t.prototype.getBackgroundThumbnail=function(){var t=this.roomProperty.getId();return this.sceneInteractor.getRoomById(t).getThumbnailImage()},t.prototype.getRoomName=function(){var t=this.sceneInteractor.getActiveRoomId();return this.sceneInteractor.getRoomById(t).getName()},t.prototype.setRoomName=function(t){var e=this.sceneInteractor.getActiveRoomId();this.sceneInteractor.getRoomById(e).setName(t.text)},t.prototype.getName=function(){return this.roomProperty.getName()},t.prototype.onNameChange=function(t){this.roomProperty.setName(t.text)},o([i.Input(),r("design:type",Object)],t.prototype,"roomProperty",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"isActive",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"infoEvent",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"deleteEvent",void 0),t=o([i.Component({selector:"storymap-item",styles:[n(1273)],template:n(1274)}),r("design:paramtypes",[s.PropertyRemovalService,c.SceneInteractor,i.NgZone])],t)}();e.StorymapItem=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.storymap-item{display:flex;flex-direction:column;flex-wrap:nowrap;justify-content:flex-start;align-items:center;width:100%;cursor:pointer;margin:0px 0}.storymap-item:hover .story-map-item__buttons{visibility:visible}.story-map-item__buttons{display:flex;flex-direction:row;transform:translate(0%, 80px);visibility:hidden;z-index:1}.storymap-item__button{margin-left:5px;margin-right:5px;background-color:transparent;background-size:90%;background-repeat:no-repeat;width:21px;height:21px}.storymap-item__roomname{justify-content:center;margin:0px 0px 0px 0px;transform:translate(0%, 40px);z-index:1}.storymap-item__delete{background-image:url("assets/icons/delete_filled.png")}.storymap-item__info{background-image:url("assets/icons/info_filled.png")}.storymap-item__home-icon{background-image:url("assets/icons/home.png")}.storymap-item__home-icon:hover{background-image:url("assets/icons/home_filled.png")}.storymap-item__home-icon--active{background-image:url("assets/icons/home_filled.png")}.storymap-item__thumbnailbox{background-color:#eee;height:80px;margin:0 5px}.storymap-item__thumbnail{width:120px;height:80px;opacity:0.5;transition:opacity 0.25s ease-in-out}.storymap-item__thumbnail--active{opacity:1}\n'},function(t,e){t.exports='<div class="storymap-item">\n\n  <div class="storymap-item__roomname">\n    <text-input\n      [textModel]="getName()"\n      [isRoomName]="true"\n      (onTextChange)="onNameChange($event)">\n    </text-input>\n  </div>\n  \n  <div class="story-map-item__buttons">\n    <div\n      class="storymap-item__button storymap-item__delete"\n      (click)="onDeleteClick($event)">\n    </div>\n\n    <div\n      class="storymap-item__button storymap-item__info"\n      (click)="onInfoClick($event)">\n    </div>\n\n    <div\n      (click)="setAsHomeRoom()"\n      class="storymap-item__button storymap-item__home-icon"\n      [ngClass]="{\'storymap-item__home-icon--active\': isHomeRoom()}">\n    </div>\n\n  </div>\n\n  <div class=\'storymap-item__thumbnailbox\'>\n    <img\n      [attr.src]="getBackgroundThumbnail()"\n      class="storymap-item__thumbnail"\n      [ngClass]="{\'storymap-item__thumbnail--active\': isActive}">\n  </div>\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(12),u=function(){function t(t,e,n){this.router=t,this.sceneInteractor=e,this.eventBus=n}return t.prototype.addRoom=function(t){console.log("addRoom"),this.router.navigate(["/editor",{outlets:{modal:"upload"}}])},t=o([i.Component({selector:"add-room",styles:[n(1276)],template:n(1277)}),r("design:paramtypes",[a.Router,c.SceneInteractor,s.EventBus])],t)}();e.AddRoomButton=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.add-room{width:40px;height:40px;border-radius:50%;background-color:white;position:relative;cursor:pointer;margin-left:5px;transform:translate(0%, 20px)}.add-room__bar{display:block;position:absolute;height:4px;width:32px;border-radius:2px;background-color:#FF3571;left:4px;top:18px;transition:.15s ease-in-out}.add-room :nth-child(1){transform:rotate(0deg)}.add-room :nth-child(2){transform:rotate(90deg)}\n'},function(t,e){t.exports='<div\n  class="add-room"\n  (click)="addRoom($event)">\n  <span class="add-room__bar"></span>\n  <span class="add-room__bar"></span>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(12),u=function(){function t(t,e,n){this.sceneInteractor=t,this.eventBus=e,this.router=n,this.isInFlatMode=!0,this.isInFullscreen=!1,this.docElm=document.documentElement}return t.prototype.editorIsFlat=function(){return this.router.url.includes("view:flat")},t.prototype.editorIsSphere=function(){return this.router.url.includes("view:sphere")},t.prototype.editorIsPreview=function(){return this.router.url.includes("view:preview")},t.prototype.onFullscreenClick=function(t){this.isInFullscreen?(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen&&document.webkitExitFullscreen(),this.isInFullscreen=!1):(this.docElm.requestFullscreen?this.docElm.requestFullscreen():this.docElm.webkitRequestFullScreen&&this.docElm.webkitRequestFullScreen(),this.isInFullscreen=!0)},t.prototype.isFullscreen=function(){return this.isInFullscreen},t=o([i.Component({selector:"fullscreen",styles:[n(1279)],template:n(1280)}),r("design:paramtypes",[c.SceneInteractor,s.EventBus,a.Router])],t)}();e.Fullscreen=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html *{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale}*,*:after,*:before{-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box}.icon{width:40px;height:40px;display:block;overflow:show}.icon svg{max-width:100%}main{position:absolute}.fullscreen{width:100%;height:100%;margin:0 auto;display:block;position:relative}.fullscreen .fs-icon{-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out}.fullscreen .fs-icon .outline{fill:white}.fullscreen .fs-icon .arrow{fill:#FF3571;-webkit-transition:prefixed-for-transition(-webkit-, fill 1s ease);-moz-transition:prefixed-for-transition(-moz-, fill 1s ease);-ms-transition:prefixed-for-transition(-ms-, fill 1s ease);-o-transition:prefixed-for-transition(-o-, fill 1s ease);transition:fill 1s ease}.fullscreen .fs-icon .tl{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg);-webkit-transform-origin:50%;-moz-transform-origin:50%;-ms-transform-origin:50%;-o-transform-origin:50%;transform:50%;-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out;animation:tl 1s ease-in-out}.fullscreen .fs-icon .tr{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg);-webkit-transform-origin:50%;-moz-transform-origin:50%;-ms-transform-origin:50%;-o-transform-origin:50%;transform:50%;-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out;animation:tr 1s ease-in-out}.fullscreen .fs-icon .bl{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg);-webkit-transform-origin:50%;-moz-transform-origin:50%;-ms-transform-origin:50%;-o-transform-origin:50%;transform:50%;-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out;animation:bl 1s ease-in-out}.fullscreen .fs-icon .br{-webkit-transform:rotate(0deg);-moz-transform:rotate(0deg);-ms-transform:rotate(0deg);-o-transform:rotate(0deg);transform:rotate(0deg);-webkit-transform-origin:50%;-moz-transform-origin:50%;-ms-transform-origin:50%;-o-transform-origin:50%;transform:50%;-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out;animation:br 1s ease-in-out}.fullscreen:hover .fs-icon{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1);-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out}.fullscreen:hover .fs-icon .arrow{fill:#FF3571;-webkit-transition:prefixed-for-transition(-webkit-, fill 1s ease);-moz-transition:prefixed-for-transition(-moz-, fill 1s ease);-ms-transition:prefixed-for-transition(-ms-, fill 1s ease);-o-transition:prefixed-for-transition(-o-, fill 1s ease);transition:fill 1s ease;-webkit-transition:prefixed-for-transition(-webkit-, transform 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, transform 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, transform 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, transform 0.5s ease-out);transition:transform 0.5s ease-out}.fullscreen:hover .fs-icon .tl{-webkit-transform:translate(-4px, -4px);-moz-transform:translate(-4px, -4px);-ms-transform:translate(-4px, -4px);-o-transform:translate(-4px, -4px);transform:translate(-4px, -4px)}.fullscreen:hover .fs-icon .tr{-webkit-transform:translate(4px, -4px);-moz-transform:translate(4px, -4px);-ms-transform:translate(4px, -4px);-o-transform:translate(4px, -4px);transform:translate(4px, -4px)}.fullscreen:hover .fs-icon .bl{-webkit-transform:translate(-4px, 4px);-moz-transform:translate(-4px, 4px);-ms-transform:translate(-4px, 4px);-o-transform:translate(-4px, 4px);transform:translate(-4px, 4px)}.fullscreen:hover .fs-icon .br{-webkit-transform:translate(4px, 4px);-moz-transform:translate(4px, 4px);-ms-transform:translate(4px, 4px);-o-transform:translate(4px, 4px);transform:translate(4px, 4px)}.fullscreen:active .fs-icon{-webkit-transform:scale(1.1);-moz-transform:scale(1.1);-ms-transform:scale(1.1);-o-transform:scale(1.1);transform:scale(1.1);-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out}.fullscreen:active .fs-icon .arrow{fill:#FF3571;-webkit-transition:prefixed-for-transition(-webkit-, fill 1s ease);-moz-transition:prefixed-for-transition(-moz-, fill 1s ease);-ms-transition:prefixed-for-transition(-ms-, fill 1s ease);-o-transition:prefixed-for-transition(-o-, fill 1s ease);transition:fill 1s ease;opacity:0}.fullscreen:active .fs-icon .tl{-webkit-transform:translate(-60px, -60px);-moz-transform:translate(-60px, -60px);-ms-transform:translate(-60px, -60px);-o-transform:translate(-60px, -60px);transform:translate(-60px, -60px);-webkit-transition:prefixed-for-transition(-webkit-, 0.2s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.2s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.2s ease-out);-o-transition:prefixed-for-transition(-o-, 0.2s ease-out);transition:0.2s ease-out}.fullscreen:active .fs-icon .tr{-webkit-transform:translate(60px, -60px);-moz-transform:translate(60px, -60px);-ms-transform:translate(60px, -60px);-o-transform:translate(60px, -60px);transform:translate(60px, -60px);-webkit-transition:prefixed-for-transition(-webkit-, 0.2s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.2s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.2s ease-out);-o-transition:prefixed-for-transition(-o-, 0.2s ease-out);transition:0.2s ease-out}.fullscreen:active .fs-icon .bl{-webkit-transform:translate(-60px, 60px);-moz-transform:translate(-60px, 60px);-ms-transform:translate(-60px, 60px);-o-transform:translate(-60px, 60px);transform:translate(-60px, 60px);-webkit-transition:prefixed-for-transition(-webkit-, 0.2s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.2s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.2s ease-out);-o-transition:prefixed-for-transition(-o-, 0.2s ease-out);transition:0.2s ease-out}.fullscreen:active .fs-icon .br{-webkit-transform:translate(60px, 60px);-moz-transform:translate(60px, 60px);-ms-transform:translate(60px, 60px);-o-transform:translate(60px, 60px);transform:translate(60px, 60px);-webkit-transition:prefixed-for-transition(-webkit-, 0.2s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.2s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.2s ease-out);-o-transition:prefixed-for-transition(-o-, 0.2s ease-out);transition:0.2s ease-out}.fullscreen__full .fs-icon .tl,.fullscreen__full .fs-icon .br{-webkit-transform:rotate(-180deg);-moz-transform:rotate(-180deg);-ms-transform:rotate(-180deg);-o-transform:rotate(-180deg);transform:rotate(-180deg);-webkit-transform-origin:50%;-moz-transform-origin:50%;-ms-transform-origin:50%;-o-transform-origin:50%;transform:50%;-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out}.fullscreen__full .fs-icon .tr,.fullscreen__full .fs-icon .bl{-webkit-transform:rotate(180deg);-moz-transform:rotate(180deg);-ms-transform:rotate(180deg);-o-transform:rotate(180deg);transform:rotate(180deg);-webkit-transform-origin:50%;-moz-transform-origin:50%;-ms-transform-origin:50%;-o-transform-origin:50%;transform:50%;-webkit-transition:prefixed-for-transition(-webkit-, 0.5s ease-out);-moz-transition:prefixed-for-transition(-moz-, 0.5s ease-out);-ms-transition:prefixed-for-transition(-ms-, 0.5s ease-out);-o-transition:prefixed-for-transition(-o-, 0.5s ease-out);transition:0.5s ease-out}.fullscreen__full:hover .fs-icon{-webkit-transform:scale(1);-moz-transform:scale(1);-ms-transform:scale(1);-o-transform:scale(1);transform:scale(1)}.fullscreen__full:hover .fs-icon .tl{-webkit-transform:translate(-8px, -8px);-moz-transform:translate(-8px, -8px);-ms-transform:translate(-8px, -8px);-o-transform:translate(-8px, -8px);transform:translate(-8px, -8px)}.fullscreen__full:hover .fs-icon .tr{-webkit-transform:translate(8px, -8px);-moz-transform:translate(8px, -8px);-ms-transform:translate(8px, -8px);-o-transform:translate(8px, -8px);transform:translate(8px, -8px)}.fullscreen__full:hover .fs-icon .bl{-webkit-transform:translate(-8px, 8px);-moz-transform:translate(-8px, 8px);-ms-transform:translate(-8px, 8px);-o-transform:translate(-8px, 8px);transform:translate(-8px, 8px)}.fullscreen__full:hover .fs-icon .br{-webkit-transform:translate(8px, 8px);-moz-transform:translate(8px, 8px);-ms-transform:translate(8px, 8px);-o-transform:translate(8px, 8px);transform:translate(8px, 8px)}@keyframes tl{0%{transform:translate(8px, 8px);opacity:0}15%{opacity:0}40%{opacity:1}}@keyframes tr{0%{transform:translate(-8px, 8px);opacity:0}15%{opacity:0}40%{opacity:1}}@keyframes bl{0%{transform:translate(8px, -8px);opacity:0}15%{opacity:0}40%{opacity:1}}@keyframes br{0%{transform:translate(-8px, -8px);opacity:0}15%{opacity:0}40%{opacity:1}}\n'},function(t,e){t.exports='<div class="fullscreen"\n  (click)="onFullscreenClick($event)"\n  [ngClass]="{\'fullscreen__full\': isInFullscreen}">\n    <div class="icon">\n        <a class="fullscreen" href="#!"><svg class="fs-icon" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" x="0px" y="0px" viewBox="0 0 100 100" enable-background="new 0 0 100 100" xml:space="preserve">\n\n            \x3c!-- Top Right --\x3e\n            <path class="tr arrow" d="M74.6 33.6l0-4.3L63.2 40.7c-1.1 1.1-2.8 1.1-3.8 0c-1.1-1.1-1.1-2.8 0-3.9l11.4-11.4h-4.3 c-1.5 0-2.7-1.2-2.7-2.7c0-1.5 1.2-2.7 2.7-2.7h10.9c1.5 0 2.7 1.2 2.7 2.7v10.9c0 1.5-1.2 2.7-2.7 2.7 C75.8 36.3 74.6 35.1 74.6 33.6z"/>\n\n            \x3c!-- Top Left --\x3e\n            <path class="tl arrow" d="M33.6 25.4h-4.3l11.4 11.4c1.1 1.1 1.1 2.8 0 3.8c-1.1 1.1-2.8 1.1-3.8 0L25.4 29.3v4.3 c0 1.5-1.2 2.7-2.7 2.7c-1.5 0-2.7-1.2-2.7-2.7V22.7c0-1.5 1.2-2.7 2.7-2.7l10.9 0c1.5 0 2.7 1.2 2.7 2.7 C36.3 24.2 35.1 25.4 33.6 25.4z"/>\n\n            \x3c!-- Bottom Left --\x3e\n            <path class="bl arrow" d="M25.4 66.4l0 4.3l11.4-11.4c1.1-1.1 2.8-1.1 3.8 0c1.1 1.1 1.1 2.8 0 3.9L29.3 74.6h4.3 c1.5 0 2.7 1.2 2.7 2.7c0 1.5-1.2 2.7-2.7 2.7H22.7c-1.5 0-2.7-1.2-2.7-2.7V66.4c0-1.5 1.2-2.7 2.7-2.7 C24.2 63.7 25.4 64.9 25.4 66.4z"/>\n\n            \x3c!-- Bottom Right --\x3e\n            <path class="br arrow" d="M66.4 74.6h4.3L59.3 63.2c-1.1-1.1-1.1-2.8 0-3.8c1.1-1.1 2.8-1.1 3.8 0l11.4 11.4v-4.3 c0-1.5 1.2-2.7 2.7-2.7c1.5 0 2.7 1.2 2.7 2.7v10.9c0 1.5-1.2 2.7-2.7 2.7l-10.9 0c-1.5 0-2.7-1.2-2.7-2.7 C63.7 75.8 64.9 74.6 66.4 74.6z"/>\n\n            \x3c!-- Outline --\x3e\n            <path class="outline" d="M94 5c0.5 0 1 0.5 1 1v88c0 0.5-0.5 1-1 1H6c-0.5 0-1-0.5-1-1V6c0-0.5 0.5-1 1-1H94 M94 0H6C2.7 0 0 2.7 0 6v88 c0 3.3 2.7 6 6 6h88c3.3 0 6-2.7 6-6V6C100 2.7 97.3 0 94 0L94 0z"/>\n          </svg>\n        </a>\n    </div>\n</div>\n'},function(t,e,n){"use strict";function o(t,e,n,o){return Math.sqrt(Math.pow(t-e,2)+Math.pow(n-o,2))}var r=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},i=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var a=n(2),s=n(6),c=function(){function t(t,e){this.element=t,this.eventBus=e,this.onMove=new a.EventEmitter,this.onMoveEnd=new a.EventEmitter,this.isActive=!1,this.subscriptions=new Set,this.touchLocation={x:0,y:0}}return t.prototype.ngOnInit=function(){var t=this,e=this.eventBus.getObservable(s.EventType.MOUSE_UP).subscribe(function(e){return t.onMouseUp(e)},function(t){return console.log("error",t)});this.subscriptions.add(e)},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()}),this.unSubscribeToMouseMovements()},t.prototype.onMouseDown=function(t){if("draggableIcon"===t.target.id){t.preventDefault(),t.stopPropagation(),this.subscribeToMouseMovements();var e=this.element.nativeElement.getBoundingClientRect();return this.startX=t.clientX-e.left,this.startY=t.clientY-e.top,this.absoluteStartX=t.clientX,this.absoluteStartY=t.clientY,this.isActive=!0,!1}},t.prototype.onMouseMove=function(t){if(t.preventDefault(),this.isActive){var e=t.clientX-this.startX,n=t.clientY-this.startY;this.onMove.emit({x:e,y:n,shiftKey:t.shiftKey})}},t.prototype.subscribeToMouseMovements=function(){var t=this;this.mouseMoveSubscription=this.eventBus.getObservable(s.EventType.MOUSE_MOVE).subscribe(function(e){return t.onMouseMove(e)},function(t){return console.log("error",t)})},t.prototype.unSubscribeToMouseMovements=function(){this.mouseMoveSubscription&&(this.mouseMoveSubscription.unsubscribe(),this.mouseMoveSubscription=null)},t.prototype.onMouseUp=function(t){if(this.unSubscribeToMouseMovements(),this.isActive){var e=o(t.clientX,this.absoluteStartX,t.clientY,this.absoluteStartY),n=e>0;this.onMoveEnd.emit({x:t.clientX-this.startX,y:t.clientY-this.startY,shiftKey:t.shiftKey,didMove:n}),this.isActive=!1}},r([a.Output(),i("design:type",Object)],t.prototype,"onMove",void 0),r([a.Output(),i("design:type",Object)],t.prototype,"onMoveEnd",void 0),r([a.HostListener("mousedown",["$event"]),i("design:type",Function),i("design:paramtypes",[Object]),i("design:returntype",void 0)],t.prototype,"onMouseDown",null),t=r([a.Directive({selector:"[hotspot-icon]"}),i("design:paramtypes",[a.ElementRef,s.EventBus])],t)}();e.DraggableIcon=c},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=function(){function t(t,e){this.element=t,this.eventBus=e,this.onOffClick=new i.EventEmitter,this.subscriptions=new Set}return t.prototype.ngOnInit=function(){var t=this,e=this.eventBus.getObservable(a.EventType.MOUSE_DOWN).subscribe(function(e){var n=t.element.nativeElement.contains(e.target);t.onOffClick.emit({isOffClick:!n})},function(t){return console.log("error",t)});this.subscriptions.add(e)},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},o([i.Output(),r("design:type",Object)],t.prototype,"onOffClick",void 0),t=o([i.Directive({selector:"[off-click]"}),r("design:paramtypes",[i.ElementRef,a.EventBus])],t)}();e.OffClick=s},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(61),c=function(){function t(t,e){this.eventBus=t,this.fileLoaderUtil=e,this.onFileLoad=new i.EventEmitter,this.acceptMultpleFiles=!1}return t.prototype.onDragOver=function(t){t.stopPropagation(),t.preventDefault()},t.prototype.onDrop=function(t){var e=this;if(t.stopPropagation(),t.preventDefault(),this.acceptMultpleFiles)return void this.onFileLoad.emit({files:t.dataTransfer.files});var n=t.dataTransfer.files&&t.dataTransfer.files[0];return n?this.acceptedFileType?void this.fileLoaderUtil.validateFileLoadEvent(n,this.acceptedFileType).then(this.fileLoaderUtil.getBinaryFileData.bind(this.fileLoaderUtil)).then(function(t){e.onFileLoad.emit({binaryFileData:t,file:n})}).catch(function(t){return e.eventBus.onModalMessage("Error",t)}):void console.error("file-loader must have an accepted file type"):void this.eventBus.onModalMessage("Error","No valid file selected")},t.staticConstructor=function(){window.addEventListener("dragover",function(t){return t.preventDefault()}),window.addEventListener("drop",function(t){return t.preventDefault()})}(),o([i.Output(),r("design:type",Object)],t.prototype,"onFileLoad",void 0),o([i.Input(),r("design:type",String)],t.prototype,"acceptedFileType",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"acceptMultpleFiles",void 0),o([i.HostListener("dragover",["$event"]),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],t.prototype,"onDragOver",null),o([i.HostListener("drop",["$event"]),r("design:type",Function),r("design:paramtypes",[Object]),r("design:returntype",void 0)],t.prototype,"onDrop",null),t=o([i.Directive({selector:"[droppable]"}),r("design:paramtypes",[a.EventBus,s.FileLoaderUtil])],t)}();e.Droppable=c},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(61),c=n(108),u=function(){function t(t,e){this.eventBus=t,this.fileLoaderUtil=e,this.onFileLoad=new i.EventEmitter,this.displayText="Drag File...",this.inputId=c.generateUniqueId()}return t.prototype.onFileChange=function(t){var e=this,n=t.target.files&&t.target.files[0];return n?this.acceptedFileType?void this.fileLoaderUtil.validateFileLoadEvent(n,this.acceptedFileType).then(this.fileLoaderUtil.getBinaryFileData.bind(this.fileLoaderUtil)).then(function(t){e.onFileLoad.emit({binaryFileData:t,file:n})}).catch(function(t){return e.eventBus.onModalMessage("Error",t)}):void console.error("file-loader must have an accepted file type"):void this.eventBus.onModalMessage("Error","No valid file selected")},t.prototype.onFileDrop=function(t){this.onFileLoad.emit(t)},o([i.Output(),r("design:type",i.EventEmitter)],t.prototype,"onFileLoad",void 0),o([i.Input(),r("design:type",String)],t.prototype,"acceptedFileType",void 0),o([i.Input(),r("design:type",String)],t.prototype,"displayText",void 0),t=o([i.Component({selector:"file-loader",styles:[n(1285)],template:n(1286)}),r("design:paramtypes",[a.EventBus,s.FileLoaderUtil])],t)}();e.FileLoader=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.file-loader{width:100%;display:flex;flex-direction:row;justify-content:center;align-items:center;align-content:center}.file-loader__hidden-input{display:none}\n'},function(t,e){t.exports='<div \n  droppable\n  (onFileLoad)="onFileDrop($event)"\n  [acceptedFileType]="acceptedFileType"\n  class="file-loader">\n\n  <input\n    type="file"\n    [attr.id]="inputId"\n    (change)="onFileChange($event)"\n    class="file-loader__hidden-input">\n\n  <label\n    [attr.for]="inputId"\n    class="button">\n    {{displayText}}\n  </label>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(6),s=n(180),c=function(){function t(t,e){this.eventBus=t,this.zipFileReader=e,this.subscriptions=new Set}return t.prototype.ngOnInit=function(){var t=this,e=this.eventBus.getObservable(a.EventType.OPEN_FILE_LOADER).subscribe(function(e){return t.hiddenLabel.nativeElement.click()},function(t){return console.log("error",t)});this.subscriptions.add(e)},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.onFileChange=function(t){var e=t.target.files&&t.target.files[0];if(!e)return void this.eventBus.onModalMessage("Error","No valid file selected");this.zipFileReader.loadFile(e)},o([i.ViewChild("hiddenLabel"),r("design:type",Object)],t.prototype,"hiddenLabel",void 0),t=o([i.Component({selector:"hidden-file-loader",styles:[n(1288)],template:n(1289)}),r("design:paramtypes",[a.EventBus,s.ZipFileReader])],t)}();e.HiddenFileLoader=c},function(t,e){t.exports=".hidden-file-loader{display:none;width:0;height:0}\n"},function(t,e){t.exports='<div class="hidden-file-loader">\n\n  <input\n    type="file"\n    id="hiddenInput"\n    (change)="onFileChange($event)">\n\n  <label\n    #hiddenLabel\n    for="hiddenInput">\n  </label>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(108),s=function(){function t(){this.onFileLoad=new i.EventEmitter,this.displayText="Drag multiple...",this.inputId=a.generateUniqueId()}return t.prototype.onFileChange=function(t){this.onFileLoad.emit({files:t.target.files})},t.prototype.onFileDrop=function(t){this.onFileLoad.emit(t)},o([i.Output(),r("design:type",i.EventEmitter)],t.prototype,"onFileLoad",void 0),o([i.Input(),r("design:type",String)],t.prototype,"displayText",void 0),t=o([i.Component({selector:"file-loader-multi",styles:[n(1291)],template:n(1292)})],t)}();e.FileLoaderMulti=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.file-loader-multi{display:flex;flex-direction:row}.file-loader-multi__hidden-input{display:none}.file-loader-multi__label{width:100%}\n'},function(t,e){t.exports='<div \n  droppable\n  (onFileLoad)="onFileDrop($event)"\n  [acceptedFileType]="acceptedFileType"\n  [acceptMultpleFiles]="true"\n  class="file-loader-multi">\n\n  <input\n    type="file"\n    multiple\n    [attr.id]="inputId"\n    (change)="onFileChange($event)"\n    class="file-loader-multi__hidden-input">\n\n  <label\n    [attr.for]="inputId"\n    class="file-loader-multi__label">\n    {{displayText}}\n  </label>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){this.onButtonClick=new i.EventEmitter}return t.prototype.onClick=function(t){this.onButtonClick.emit(null)},o([i.Output(),r("design:type",Object)],t.prototype,"onButtonClick",void 0),t=o([i.Component({selector:"close-button",styles:[n(1294)],template:n(1295)})],t)}();e.CloseButton=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.close-button{width:18px;height:18px;border-radius:50%;background-color:#616161;position:relative;border:2px solid #fff}.close-button :nth-child(1){transform:rotate(45deg)}.close-button :nth-child(2){transform:rotate(-45deg)}.close-button__bar{display:block;position:absolute;height:2px;width:14px;border-radius:1px;background-color:#fff;left:2px;top:8px}\n'},function(t,e){t.exports='<div\n  class="close-button"\n  (click)="onClick()">\n  <span class="close-button__bar"></span>\n  <span class="close-button__bar"></span>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){this.onButtonClick=new i.EventEmitter}return t.prototype.onClick=function(t){this.onButtonClick.emit(null)},o([i.Output(),r("design:type",Object)],t.prototype,"onButtonClick",void 0),t=o([i.Component({selector:"info-button",styles:[n(1297)],template:n(1298)})],t)}();e.InfoButton=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.info-button{width:18px;height:18px;border-radius:50%;background-color:#616161;position:relative;border:2px solid #fff}.info-button :nth-child(1){transform:rotate(90deg)}.info-button__bar{display:block;position:absolute;height:2px;width:14px;border-radius:1px;background-color:#fff;left:2px;top:8px}\n'},function(t,e){t.exports='<div\n  class="info-button"\n  (click)="onClick()">\n  <span class="info-button__bar"></span>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=function(){function t(){}return t=o([r.Component({selector:"slider",styles:[n(1300)],template:n(1301)})],t)}();e.Slider=i},function(t,e){t.exports=".range{display:inline-block;margin:36px 20px 20px}input[type=range]{-webkit-appearance:none;position:relative}input[type=range]::-webkit-slider-runnable-track{width:300px;height:2px;border:none;border-radius:3px}input[type=range]::-webkit-slider-thumb{-webkit-appearance:none;border:none;height:12px;width:12px;border-radius:510%;background:#141414;border:2px solid #515151;margin-top:-5px;cursor:pointer}.focused::-webkit-slider-thumb{box-shadow:0 0 0 10px rgba(255,255,255,0.15)}.clicked::-webkit-slider-thumb{-webkit-transform:scale(1.5)}.disabled::-webkit-slider-thumb{-webkit-transform:scale(0.9);box-shadow:0 0 0 3px #141414;background:#515151 !important;border-color:#515151 !important}input[type=range]:focus{outline:none}.range:hover input[type=range]:before{color:white;content:'50';position:absolute;font-family:Roboto Slab;top:-49px;background:#3f51b5;padding:8px 0 3px;font-size:14px;width:30px;text-align:center;border-radius:100% 100% 0 0}.range:hover input[type=range]:after{content:'';position:absolute;top:-19px;left:50px;border-left:15px solid transparent;border-right:15px solid transparent;border-top:8px solid #3f51b5;font-family:Roboto Slab}\n"},function(t,e){t.exports='\n<input type="range" max="100" value="50">\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(108),s=function(){function t(){this.initialValue=!1,this.changeEmitter=new i.EventEmitter,this.uniqueId=a.generateUniqueId()}return t.prototype.onChange=function(t){this.changeEmitter.emit({value:t})},o([i.Input(),r("design:type",Boolean)],t.prototype,"initialValue",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"changeEmitter",void 0),o([i.ViewChild("input"),r("design:type",Object)],t.prototype,"inputElement",void 0),t=o([i.Component({selector:"checkbox",styles:[n(1303)],template:n(1304)})],t)}();e.Checkbox=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.checkbox__label{position:relative;display:block;height:20px;width:44px;background-color:#616161;border-radius:10px;cursor:pointer;transition:background-color .2s ease}.checkbox__input:checked ~ label{background-color:#FF87AA}.checkbox__label:after{position:absolute;left:0;top:-3px;display:block;width:26px;height:26px;border-radius:50%;background-color:#eee;content:\'\';transition:left .2s ease}.checkbox__input:checked ~ label:after{left:18px;background-color:#AD0034}.checkbox__input--hidden{display:none}\n'},function(t,e){t.exports='<div class="checkbox">\n  <input\n  \t#input\n  \ttype="checkbox"\n  \t[attr.id]="uniqueId"\n    [checked]="initialValue"\n  \t(change)="onChange($event.target.checked)"\n  \tclass="checkbox__input checkbox__input--hidden"/>\n  <label [attr.for]="uniqueId" class="checkbox__label"></label>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){this.isHotspot=!1,this.isRowItem=!1,this.isActive=!1,this.isRoomName=!1,this.onTextChange=new i.EventEmitter}return t.prototype.onModelChange=function(t){this.onTextChange.emit({text:t})},o([i.Input(),r("design:type",Boolean)],t.prototype,"isHotspot",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"isRowItem",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"isActive",void 0),o([i.Input(),r("design:type",Boolean)],t.prototype,"isRoomName",void 0),o([i.Input(),r("design:type",String)],t.prototype,"textModel",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"onTextChange",void 0),t=o([i.Component({selector:"text-input",styles:[n(1306)],template:n(1307)})],t)}();e.TextInput=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.text-input__input{outline:none;background:none;border:none;width:170px;color:#616161;font-size:1em;display:block;border-bottom:2px hidden #eee;text-shadow:0 1px 2px rgba(0,0,0,0.32);transition:border-bottom 0.1s linear;background:transparent}.text-input__input:focus{outline:none;border-bottom:2px solid #eee}.text-input__input--icon{color:#fff;border-bottom:2px hidden #eee;text-shadow:0 1px 2px rgba(0,0,0,0.32);text-align:center;margin:5px 0 0 0px}.text-input__input-row{width:110px}.text-input__input-row--active{color:#fff}.text-input__storymap--roomname{text-align:center;color:white;width:110px}\n'},function(t,e){t.exports='<div class="text-input">\n\n  <input\n    type="text"\n    [ngModel]="textModel"\n    (ngModelChange)="onModelChange($event)"\n    class="text-input__input"\n    [ngClass]="{\n      \'text-input__input--icon\': isHotspot,\n      \'text-input__input-row\': isRowItem,\n      \'text-input__input-row--active\': isActive,\n      \'text-input__storymap--roomname\': isRoomName\n    }">\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){this.inputType="text",this.inputLabel="",this.onTextChange=new i.EventEmitter,this.onBlurEvent=new i.EventEmitter}return t.prototype.onModelChange=function(t){this.onTextChange.emit({text:t})},t.prototype.onBlur=function(t){this.onBlurEvent.emit({text:t})},o([i.Input(),r("design:type",String)],t.prototype,"inputType",void 0),o([i.Input(),r("design:type",String)],t.prototype,"inputLabel",void 0),o([i.Input(),r("design:type",String)],t.prototype,"textModel",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"onTextChange",void 0),o([i.Output(),r("design:type",Object)],t.prototype,"onBlurEvent",void 0),t=o([i.Component({selector:"text-input-material",styles:[n(1309)],template:n(1310)})],t)}();e.TextInputMaterial=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.text-input-material{height:40px;position:relative;margin:0px 10px 0px 0px}.input{font-size:1em;display:block;width:100%;border:none;background:none;border-bottom:1px solid #616161;position:absolute;bottom:0;color:#616161;outline:none;box-shadow:none;-webkit-appearance:none;margin:0}.input:focus{outline:none}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{-webkit-appearance:none;margin:0}.label{color:#616161;font-weight:normal;position:absolute;pointer-events:none;top:10px;transition:0.2s ease all}.input:focus ~ .label,.input:valid ~ .label{top:0px;font-size:.8em}.bar{position:absolute;bottom:0;display:block;width:100%}.bar:before,.bar:after{content:\'\';height:2px;width:0;bottom:1px;position:absolute;background:#616161;transition:0.2s ease all}.bar:before{left:50%}.bar:after{right:50%}.input:focus ~ .bar:before,.input:focus ~ .bar:after{width:50%}.highlight{position:absolute;height:60%;width:100px;top:25%;left:0;pointer-events:none;opacity:0.5}.input:focus ~ .highlight{animation:inputHighlighter 0.3s ease}@keyframes inputHighlighter{from{background:#5264AE}to{width:0;background:transparent}}\n'},function(t,e){t.exports='<div class="text-input-material">\n\n  <input\n    [attr.type]="inputType"\n    [ngModel]="textModel"\n    (ngModelChange)="onModelChange($event)"\n    (blur)="onBlur(textModel)"\n    class="input"\n    required>\n  <span class="highlight"></span>\n  <span class="bar"></span>\n  <label class="label">{{inputLabel}}</label>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(2),s=n(6),c={MESSAGE:"MESSAGE",LOADER:"LOADER",SHARABLE:"SHARABLE",EXPLORE:"EXPLORE"},u=function(){function t(t){this.eventBus=t,this.messageData={headerText:"",bodyText:"",isMessage:!1},this.sharableId="",this.subscriptions=new Set}return t.prototype.ngOnInit=function(){this.clearValues(),this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.closeModal=function(t){!t.isAccepted&&this.onDismiss?this.onDismiss():t.isAccepted&&this.onAccept&&this.onAccept(),this.clearValues()},t.prototype.subscribeToEvents=function(){var t=this,e=this.eventBus.getObservable(s.EventType.MODAL_MESSAGE).subscribe(function(e){t.activeModalType=c.MESSAGE,t.isOpen=!0,t.messageData.headerText=e.header,t.messageData.bodyText=e.body,t.messageData.isMessage=e.isMessage,t.onDismiss=e.onDismiss,t.onAccept=e.onAccept},function(t){return console.log("error",t)}),n=this.eventBus.getObservable(s.EventType.START_LOADING).subscribe(function(e){t.isOpen=!0,t.activeModalType=c.LOADER},function(e){console.log("error",e),t.isOpen=!1}),o=this.eventBus.getObservable(s.EventType.STOP_LOADING).subscribe(function(e){return t.isOpen=!1},function(e){console.log("error",e),t.isOpen=!1}),r=this.eventBus.getObservable(s.EventType.SHAREABLE_MODAL).subscribe(function(e){t.isOpen=!0,t.activeModalType=c.SHARABLE,t.shareableData=e},function(e){console.log("error",e),t.isOpen=!1}),i=this.eventBus.getObservable(s.EventType.OPEN_EXPLORE_MODAL).subscribe(function(e){t.isOpen=!0,t.activeModalType=c.EXPLORE},function(e){console.log("error",e),t.isOpen=!1});this.subscriptions.add(r),this.subscriptions.add(n),this.subscriptions.add(o),this.subscriptions.add(e),this.subscriptions.add(i)},t.prototype.clearValues=function(){this.isOpen=!1,this.onDismiss=null,this.onAccept=null,this.messageData={headerText:"",bodyText:"",isMessage:!1},this.shareableData=null},t.prototype.isMessageModal=function(){return this.activeModalType===c.MESSAGE},t.prototype.isSharableModal=function(){return this.activeModalType===c.SHARABLE},t.prototype.isLoaderModal=function(){return this.activeModalType===c.LOADER},t=o([i.Component({selector:"modal",styles:[n(1312)],template:n(1313),encapsulation:a.ViewEncapsulation.None}),r("design:paramtypes",[s.EventBus])],t)}();e.Modal=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.modal{position:absolute;height:100%;width:100%;top:0;left:0;background-color:rgba(0,0,0,0.7);z-index:10}.modal__content{padding:25%}.modal__content-header{background-color:#616161;padding:10px}.modal__content-body{padding:10px;color:#616161;background-color:#fff}.modal__content-body-text{margin-top:5px}.modal__content-selector{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-around}.modal__content-selection{flex-grow:1;flex-basis:0;border:4px solid #eee;border-radius:4px;background-color:#eee;color:#fff;font-size:1.1em;padding:10px;margin:0 10px;text-align:center;cursor:pointer}.modal__content-body-options{display:flex;flex-direction:row;justify-content:flex-end}.modal__content-body-close{margin-top:20px;padding:10px;color:#616161;font-weight:600;text-align:right;cursor:pointer}\n'},function(t,e){t.exports='<div\n  *ngIf="isOpen"\n  class="modal">\n\n  <loading-modal\n    *ngIf="isLoaderModal()">\n  </loading-modal>\n\n  <message-modal\n    *ngIf="isMessageModal()"\n    (onClose)="closeModal($event)"\n    [messageData]="messageData">\n  </message-modal>\n\n  <shareable-modal\n    *ngIf="isSharableModal()"\n    (onClose)="closeModal($event)"\n    [shareableData]="shareableData">\n  </shareable-modal>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=function(){function t(){}return t=o([r.Component({selector:"loading-modal",styles:[n(1315)],template:n(1316)})],t)}();e.LoadingModal=i},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.modal__content__loader,.modal__content__loader:before,.modal__content__loader:after{border-radius:50%;width:25px;height:25px;animation-fill-mode:both;animation:loaderkeyframes 1.8s infinite ease-in-out}.modal__content__loader{color:#fff;margin:-25px auto 25px auto;transform:translateZ(0);animation-delay:-.16s}.modal__content__loader:before,.modal__content__loader:after{content:\'\';position:absolute;top:0}.modal__content__loader:before{left:-35px;animation-delay:-.32s}.modal__content__loader:after{left:35px}@keyframes loaderkeyframes{0%,80%,100%{box-shadow:0 25px 0 -12.5px}40%{box-shadow:0 25px 0 0}}\n'},function(t,e){t.exports='\n<div class="modal__content">\n  <div class="modal__content-header">\n    <div class=" modal__content__loader"></div>\n  </div>\n  <div class="modal__content-body">\n    <p class="modal__content-body-text">\n      Please be patient. Large projects can take a bit of time to process :-)\n    </p>\n  </div>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=function(){function t(){this.onClose=new i.EventEmitter}return t.prototype.closeModal=function(t,e){this.onClose.emit({isAccepted:e})},o([i.Output(),r("design:type",Object)],t.prototype,"onClose",void 0),o([i.Input(),r("design:type",Object)],t.prototype,"messageData",void 0),t=o([i.Component({selector:"message-modal",styles:[n(1318)],template:n(1319)})],t)}();e.MessageModal=a},function(t,e){t.exports=""},function(t,e){t.exports='<div class="modal__content">\n\n  <div class="modal__content-header">\n    {{ messageData.headerText }}\n  </div>\n\n  <div class="modal__content-body">\n    <p class="modal__content-body-text">\n      {{ messageData.bodyText }}\n    </p>\n\n    <div *ngIf="!messageData.isMessage">\n      <p\n        (click)="closeModal($event)"\n        class="modal__content-body-close">\n        Close\n      </p>\n    </div>\n\n    <div\n      *ngIf="messageData.isMessage"\n      class="modal__content-body-options">\n      <p\n        (click)="closeModal($event)"\n        class="modal__content-body-close">\n        Cancel\n      </p>\n      <p\n        (click)="closeModal($event, true)"\n        class="modal__content-body-close">\n        OK\n      </p>\n    </div>\n\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(263),s=n(1321),c=n(54),u=n(38),l=function(){function t(t,e){this.projectInteractor=t,this.userInteractor=e,this.onClose=new i.EventEmitter,this.isPublic=!1,this.publicLink="",this.projectName="",this.notificationIsVisible=!1}return t.prototype.ngOnInit=function(){var t=this,e=this.shareableData.userId,n=this.shareableData.projectId;this.projectInteractor.getProjectData(e,n).subscribe(function(e){if(t.isPublic=e.is_public,t.projectName=e.name,t.isPublic){var n=a.getShareableLink(e.public_url);t.publicLink=n}},function(t){return console.log("getProjectData error",t)})},t.prototype.closeModal=function(t,e){this.onClose.emit({isAccepted:e})},t.prototype.projectIsPublic=function(){return this.isPublic},t.prototype.onCheckboxChange=function(){var t=this,e=this.shareableData.userId,n=this.shareableData.projectId;this.isPublic=!this.isPublic,this.projectInteractor.updateSharableStatus(e,n,this.isPublic).subscribe(function(e){if(e.is_public){var n=a.getShareableLink(e.public_url);t.publicLink=n}else t.publicLink=""},function(t){return console.log("error",t)})},t.prototype.onPublicLinkClick=function(t){var e=this;s.copyToClipboard(this.publicLink),s.copyToClipboard(this.publicLink).then(function(t){e.notificationIsVisible=!0,setTimeout(function(){return e.notificationIsVisible=!1},2e3)}).catch(function(t){return console.log("copyToClipboard error",t)})},o([i.Output(),r("design:type",Object)],t.prototype,"onClose",void 0),o([i.Input(),r("design:type",Object)],t.prototype,"shareableData",void 0),t=o([i.Component({selector:"shareable-modal",styles:[n(1322)],template:n(1323)}),r("design:paramtypes",[c.ProjectInteractor,u.UserInteractor])],t)}();e.ShareableModal=l},function(t,e,n){"use strict";function o(t){return new Promise(function(e,n){document.addEventListener(i,function(o){try{o.clipboardData.setData(r.MIME_TYPE_TEXT,t),o.preventDefault(),e(t)}catch(t){n(t)}}),document.execCommand(i)})}Object.defineProperty(e,"__esModule",{value:!0});var r=n(14),i="copy";e.copyToClipboard=o},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.public-option-row{display:flex;flex-direction:row;justify-content:flex-start;align-items:center}.public-option-row__label{margin:5px 10px 5px 0}.public-option__text-block{margin:10px 0}.public-option__explanation{margin:10px 0}.public-option__explanation-list{margin:0;padding:0 30px}.public-option__link{overflow:hidden;white-space:nowrap;font-weight:800;text-overflow:ellipsis;cursor:pointer}.public-option__copy-notification{color:#FF3571;position:absolute;background-color:#eee;border:1px solid #616161;padding:10px;box-shadow:2px 1px 4px 1px rgba(0,0,0,0.5);width:225px;text-align:center;transform:scaleX(0);transform-origin:left;transition:transform 0.15s ease-out}.public-option__copy-notification--active{transform:scaleX(1)}\n'},function(t,e){t.exports='<div class="modal__content">\n\n  <div class="modal__content-header">\n    Shareable settings\n  </div>\n\n  <div class="modal__content-body">\n\n    <div class="public-option-row public-option__text-block">\n      <span class="public-option-row__label">Make public</span>\n      <checkbox\n        [initialValue]="projectIsPublic()"\n        (changeEmitter)="onCheckboxChange($event)">\n      </checkbox>\n    </div>\n\n    <div *ngIf="projectIsPublic()">\n      <p class="public-option__text-block">Your project titled "{{projectName}}" is public.</p>\n      <p>Here is your public project link. Click to copy the URL.</p>\n      <p\n        class="public-option__copy-notification"\n        [ngClass]="{\'public-option__copy-notification--active\': notificationIsVisible}">\n        Link copied to clipboard!\n      </p>\n      <p\n        class="public-option__link"\n        [attr.title]="publicLink"\n        (click)="onPublicLinkClick($event)">\n        {{ publicLink }}\n      </p>\n      <div class="public-option__text-block">\n        <p>This means:</p>\n        <ul class="public-option__explanation-list">\n          <li>Other people can look at this project using the link below.</li>\n          <li>Social VR users can find this project using the search tool.</li>\n          <li>Nobody else can modify this project.</li>\n        </ul>\n      </div>\n    </div>\n\n    <div *ngIf="!projectIsPublic()">\n      <p class="public-option__text-block">Your project titled "{{projectName}}" is not public.</p>\n      <p class="public-option__text-block">Only you can access this project.</p>\n    </div>\n\n    <p\n      (click)="closeModal($event)"\n      class="modal__content-body-close">\n      Close\n    </p>\n\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(222),a=n(93),s=n(181),c=n(515),u=n(94),l=n(185),p=n(183),d=n(512),h=n(272),f=n(273),m=n(511),g=n(136),v=n(519),y=function(){function t(){}return t=o([r.NgModule({declarations:[],imports:[i.HttpModule],providers:[a.RoomManager,u.ApiService,l.UserService,p.AuthenticationService,d.SocialAuthenticationService,h.DeserializationService,f.SerializationService,s.PropertyBuilder,m.ProjectService,g.AssetManager,v.ChatService,c.CameraService]})],t)}();e.DataModule=y},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(17),a=n(52),s=n(100),c=n(1326),u=n(1329),l=n(1332),p=n(188),d=n(189),h=i.RouterModule.forChild([{path:"admin",component:c.Admin}]),f=function(){function t(){}return t=o([r.NgModule({declarations:[c.Admin,u.AdminUserGroups,l.AdminSearchExplore],imports:[a.BrowserModule,d.CoreModule,p.CommonModule,s.FormsModule,h],providers:[]})],t)}();e.AdminModule=f},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(38),s=n(139),c=function(){function t(t,e){this.userInteractor=t,this.adminInteractor=e}return t.prototype.hasPermission=function(){return this.userInteractor.isLoggedIn()&&this.adminInteractor.isAdmin()},t.prototype.onAddProject=function(t){this.adminUserGroupsElement.onAddProject(t)},o([i.ViewChild("adminUserGroups"),r("design:type",Object)],t.prototype,"adminUserGroupsElement",void 0),t=o([i.Component({selector:"admin",styles:[n(1327)],template:n(1328)}),r("design:paramtypes",[a.UserInteractor,s.AdminInteractor])],t)}();e.Admin=c},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.admin{height:auto;min-height:100%;background-color:#eee;color:#616161;padding:15px}.admin__no-permissions{margin-top:20px;text-align:center}\n'},function(t,e){t.exports='<div class="admin">\n\n  <div\n    *ngIf="!hasPermission()"\n    class="admin__no-permissions">\n    Only authenticated admin users can view this page.\n  </div>\n\n  <div *ngIf="hasPermission()">\n\n    <admin-search-explore (onAddProject)="onAddProject($event)"></admin-search-explore>\n    <admin-user-groups #adminUserGroups></admin-user-groups>\n\n  </div>\n\n  <modal></modal>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(38),u=n(139),l=n(54),p=n(12),d=n(37),h=n(14),f=function(){function t(t,e,n,o,r,i,a){this.userInteractor=t,this.adminInteractor=e,this.projectInteractor=n,this.sceneInteractor=o,this.metaDataInteractor=r,this.router=i,this.eventBus=a,this.projects={}}return t.prototype.ngAfterViewInit=function(){var t=this;if(this.hasPermission()){this.getUserGroups().forEach(function(e){return t.fetchProjectsByGroup(e.id)})}},t.prototype.hasPermission=function(){return this.userInteractor.isLoggedIn()&&this.adminInteractor.isAdmin()},t.prototype.getUserGroups=function(){return this.adminInteractor.getAdminGroups()},t.prototype.openProject=function(t){var e=this,n=t.userId,o=t.projectId;this.eventBus.onStartLoading(),this.projectInteractor.openProject(n,o).subscribe(function(t){e.sceneInteractor.setActiveRoomId(null),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading(),e.metaDataInteractor.setIsReadOnly(!0),e.router.navigateByUrl("/editor")},function(t){e.eventBus.onStopLoading(),e.eventBus.onModalMessage(h.ERROR_OPENING_PROJECT,h.SERVER_ERROR)})},t.prototype.fetchProjectsByGroup=function(t){var e=this;return this.adminInteractor.getAllProjectsInGroup(t).subscribe(function(n){return e.projects[t]=n.results},function(t){return console.log("error",t)})},t.prototype.getGroupProjects=function(t){return this.projects[t]&&this.projects[t].projects_from_users||[]},t.prototype.getExternalProjects=function(t){return this.projects[t]&&this.projects[t].external_projects||[]},t.prototype.onCheckboxChange=function(t,e,n,o){this.adminInteractor.setProjectInGroup(e,n,t.value,h.GROUP_TYPE.FEATURED).subscribe(function(e){return o.isFeatured=t.value},function(t){return console.log("error",t)})},t.prototype.removeExternalProject=function(t,e){var n=this;this.adminInteractor.setProjectInGroup(t,e,!1,h.GROUP_TYPE.EXTERNAL).subscribe(function(o){n.projects[t].external_projects=n.projects[t].external_projects.filter(function(t){return t.projectId!==e})},function(t){return console.log("error",t)})},t.prototype.onAddProject=function(t){this.projects[t.groupId].external_projects.some(function(e){return e.projectId===t.project.id})||this.projects[t.groupId].external_projects.push(t.project)},t=o([i.Component({selector:"admin-user-groups",styles:[n(1330)],template:n(1331)}),r("design:paramtypes",[c.UserInteractor,u.AdminInteractor,l.ProjectInteractor,p.SceneInteractor,d.MetaDataInteractor,a.Router,s.EventBus])],t)}();e.AdminUserGroups=f},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.admin-user-groups{margin-top:40px}.visibility-explanation{margin-top:10px}.remove-button{background-color:#eee}\n'},function(t,e){t.exports='\n<div\n  *ngIf="getUserGroups()"\n  class="admin-user-groups">\n  <p>Groups you can edit:</p>\n  <div *ngFor="let userGroup of getUserGroups()">\n    <p class="story-collection__header"> {{ userGroup.name }} </p>\n\n      \x3c!-- PROJECTS FROM USERS IN GROUP --\x3e\n      <p *ngIf="getGroupProjects(userGroup.id).length">\n        Stories from users in {{ userGroup.name }}\n      </p>\n      <div class="story-collection">\n\n        <div\n          *ngFor="let project of getGroupProjects(userGroup.id)"\n          class="story-collection__project">\n          <p>\n            <span class="text-bold">Project: </span>\n            <span>{{ project.name }}</span>\n          </p>\n          <p>\n            <span class="text-bold">User: </span>\n            <span>{{ project.user }}</span>\n          </p>\n          <p>\n            <span class="text-bold">Tags: </span>\n            <span>{{ project.tags }}</span>\n          </p>\n          <img\n            *ngIf="project.thumbnailUrl"\n            [attr.src]="project.thumbnailUrl"\n            (click)="openProject(project)"\n            class="story-collection__thumbnail" />\n\n          <div class="flex-row-start">\n\n            <checkbox\n              [initialValue]="project.isFeatured"\n              (changeEmitter)="onCheckboxChange($event, userGroup.id, project.projectId, project)">\n            </checkbox>\n\n            <p class="visibility-explanation">\n              Story is {{ project.isFeatured ? \'\' : \'not\' }} visible to {{ userGroup.name }}\n            </p>\n\n          </div>\n\n        </div>\n\n      </div>\n\n\n      \x3c!-- EXTERNAL PROJECTS --\x3e\n      <p *ngIf="getExternalProjects(userGroup.id).length">\n        External projects\n      </p>\n      <div class="story-collection">\n\n        <div\n          *ngFor="let project of getExternalProjects(userGroup.id)"\n          class="story-collection__project">\n          <p>\n            <span class="text-bold">Project: </span>\n            <span>{{ project.name }}</span>\n          </p>\n          <p>\n            <span class="text-bold">User: </span>\n            <span>{{ project.user }}</span>\n          </p>\n          <p>\n            <span class="text-bold">Tags: </span>\n            <span>{{ project.tags }}</span>\n          </p>\n          <img\n            *ngIf="project.thumbnailUrl"\n            [attr.src]="project.thumbnailUrl"\n            (click)="openProject(project)"\n            class="story-collection__thumbnail" />\n\n          <div\n            (click)="removeExternalProject(userGroup.id, project.projectId)"\n            class="button remove-button">\n            Remove project from group\n          </div>\n\n        </div>\n\n      </div>\n\n\n\n  </div>\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(54),s=n(280),c=n(184),u=n(38),l=n(139),p=n(14),d=function(){function t(t,e,n,o,r){this.projectInteractor=t,this.searchInteractor=e,this.shareableLoader=n,this.userInteractor=o,this.adminInteractor=r,this.onAddProject=new i.EventEmitter,this.searchTerm="",this.matchingResults=[],this.searchLabel=""}return t.prototype.ngAfterViewInit=function(){this.hasPermission()},t.prototype.hasPermission=function(){return this.userInteractor.isLoggedIn()&&this.adminInteractor.isAdmin()},t.prototype.getUserGroups=function(){return this.adminInteractor.getAdminGroups()},t.prototype.getSearchModelProperty=function(){return""},t.prototype.setSearchViewModel=function(t){this.searchTerm=t.text},t.prototype.onSearchClick=function(t){if(this.searchTerm){var e=this.searchTerm.split(",").map(function(t){return t.trim()}).join(",");this.searchPublicProjects(e),this.searchLabel=this.searchTerm}},t.prototype.onProjectClick=function(t){this.shareableLoader.openDecodedProject(t)},t.prototype.searchPublicProjects=function(t){var e=this;this.searchInteractor.searchPublicProjects(t).subscribe(function(t){return e.matchingResults=t.results},function(t){return console.log("error",t)})},t.prototype.showNoResults=function(){return this.searchLabel&&!this.matchingResults.length},t.prototype.getSearchResultTitle=function(){var t=this.matchingResults.length;return t+" search result"+(1===t?"":"s")+" for"},t.prototype.toggleProjectInGroup=function(t,e){var n=this,o=t.projectId,r=e.id;this.adminInteractor.setProjectInGroup(r,o,!0,p.GROUP_TYPE.EXTERNAL).subscribe(function(e){return n.onAddProject.emit({groupId:r,project:t})},function(t){return console.log("error",t)})},o([i.Output(),r("design:type",Object)],t.prototype,"onAddProject",void 0),t=o([i.Component({selector:"admin-search-explore",styles:[n(1333)],template:n(1334)}),r("design:paramtypes",[a.ProjectInteractor,s.SearchInteractor,c.ShareableLoader,u.UserInteractor,l.AdminInteractor])],t)}();e.AdminSearchExplore=d},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.search-input-box{flex-grow:2}.search-button{max-width:70px}.search-results{max-height:200px;overflow-y:scroll;margin:5px 0 15px 0;background-color:#eee}.search-row{padding:5px 0;border-bottom:1px solid #000;cursor:pointer}.search-text-row{margin:4px 0}.search-image-empty{border:1px solid #000}\n'},function(t,e){t.exports='<div class="search-explore">\n\n  <p>Find stories to add to your groups.</p>\n\n  <div class="row-flex-start">\n    <text-input-material\n      [inputLabel]="\'Search tags\'"\n      [textModel]="getSearchModelProperty()"\n      (onTextChange)="setSearchViewModel($event)"\n      class="search-input-box">\n    </text-input-material>\n    <div\n      class="button search-button"\n      (click)="onSearchClick($event)">\n      Search\n    </div>\n  </div>\n\n  <p *ngIf="showNoResults()">\n    No results found for {{ searchLabel }}\n  </p>\n\n  <p\n    *ngIf="searchLabel"\n    class="story-collection__header">\n    <span>\n      {{ getSearchResultTitle() }}\n    </span>\n    <span class="text-bold">\n      {{ searchLabel }}\n    </span>\n  </p>\n\n  <div class="story-collection">\n    <div\n      *ngFor="let project of matchingResults"\n      class="story-collection__project">\n      <p>\n        <span class="text-bold">Project: </span>\n        <span>{{ project.name }}</span>\n      </p>\n      <p>\n        <span class="text-bold">User: </span>\n        <span>{{ project.user }}</span>\n      </p>\n      <p>\n        <span class="text-bold">Tags: </span>\n        <span>{{ project.tags }}</span>\n      </p>\n\n      <img\n        *ngIf="project.thumbnailUrl"\n        [attr.src]="project.thumbnailUrl"\n        (click)="openProject(project)"\n        class="story-collection__thumbnail" />\n      <div\n        *ngIf="!project.thumbnailUrl"\n        (click)="openProject(project)"\n        class="story-collection__thumbnail search-image-empty">\n      </div>\n\n      <p>Add story to group</p>\n      <div\n        *ngFor="let group of getUserGroups()">\n         <p (click)="toggleProjectInGroup(project, group)">\n          Group: {{ group.name }}\n        </p>\n      </div>\n\n    </div>\n  </div>\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(17),a=n(52),s=n(100),c=n(1336),u=n(1339),l=n(1342),p=n(188),d=n(189),h=i.RouterModule.forChild([{path:"explore",component:c.Explore}]),f=function(){function t(){}return t=o([r.NgModule({declarations:[c.Explore,u.SearchExplore,l.UserGroups],imports:[a.BrowserModule,d.CoreModule,p.CommonModule,s.FormsModule,h]})],t)}();e.ExploreModule=f},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(38),s=function(){function t(t){this.userInteractor=t}return t.prototype.hasPermission=function(){return this.userInteractor.isLoggedIn()},t=o([i.Component({selector:"explore",styles:[n(1337)],template:n(1338)}),r("design:paramtypes",[a.UserInteractor])],t)}();e.Explore=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.explore{height:auto;min-height:100%;background-color:#eee;color:#616161;padding:15px}.explore__no-permissions{margin-top:20px;text-align:center}\n'},function(t,e){t.exports='<div class="explore">\n\n  <div\n    *ngIf="!hasPermission()"\n    class="explore__no-permissions">\n    You don\'t have permission to view this page. Only authenticated users can explore.\n  </div>\n\n  <div *ngIf="hasPermission()">\n\n    <search-explore class="explore__search-explore"></search-explore>\n    <user-groups class="explore__user-groups"></user-groups>\n\n  </div>\n\n  <modal></modal>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(54),s=n(280),c=n(184),u=function(){function t(t,e,n){this.projectInteractor=t,this.searchInteractor=e,this.shareableLoader=n,this.searchTerm="",this.matchingResults=[],this.searchLabel=""}return t.prototype.getSearchModelProperty=function(){return""},t.prototype.setSearchViewModel=function(t){this.searchTerm=t.text},t.prototype.onSearchClick=function(t){if(this.searchTerm){var e=this.searchTerm.split(",").map(function(t){return t.trim()}).join(",");this.searchPublicProjects(e),this.searchLabel=this.searchTerm}},t.prototype.openProject=function(t){this.shareableLoader.openDecodedProject(t)},t.prototype.searchPublicProjects=function(t){var e=this;this.searchInteractor.searchPublicProjects(t).subscribe(function(t){return e.matchingResults=t.results},function(t){return console.log("error",t)})},t.prototype.showNoResults=function(){return this.searchLabel&&!this.matchingResults.length},t.prototype.getSearchResultTitle=function(){var t=this.matchingResults.length;return t+" search result"+(1===t?"":"s")+" for"},t=o([i.Component({selector:"search-explore",styles:[n(1340)],template:n(1341)}),r("design:paramtypes",[a.ProjectInteractor,s.SearchInteractor,c.ShareableLoader])],t)}();e.SearchExplore=u},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.search-input-box{flex-grow:2}.search-button{max-width:70px}.search-results{max-height:200px;overflow-y:scroll;margin:5px 0 15px 0;background-color:#eee}.search-row{padding:5px 0;border-bottom:1px solid #000;cursor:pointer}.search-text-row{margin:4px 0}.search-image-empty{border:1px solid #000}\n'},function(t,e){t.exports='<div class="search-explore">\n\n  <p>Explore other Social VR stories</p>\n\n  <div class="row-flex-start">\n    <text-input-material\n      [inputLabel]="\'Search tags\'"\n      [textModel]="getSearchModelProperty()"\n      (onTextChange)="setSearchViewModel($event)"\n      class="search-input-box">\n    </text-input-material>\n    <div\n      class="button search-button"\n      (click)="onSearchClick($event)">\n      Search\n    </div>\n  </div>\n\n  <p *ngIf="showNoResults()">\n    No results found for {{ searchLabel }}\n  </p>\n\n  <p\n    *ngIf="searchLabel"\n    class="story-collection__header">\n    <span>\n      {{ getSearchResultTitle() }}\n    </span>\n    <span class="text-bold">\n      {{ searchLabel }}\n    </span>\n  </p>\n\n  <div class="story-collection">\n    <div\n      *ngFor="let project of matchingResults"\n      class="story-collection__project">\n      <p>\n        <span class="text-bold">Project: </span>\n        <span>{{ project.name }}</span>\n      </p>\n      <p>\n        <span class="text-bold">User: </span>\n        <span>{{ project.user }}</span>\n      </p>\n      <p>\n        <span class="text-bold">Tags: </span>\n        <span>{{ project.tags }}</span>\n      </p>\n\n      <img\n        *ngIf="project.thumbnailUrl"\n        [attr.src]="project.thumbnailUrl"\n        (click)="openProject(project.projectUrl)"\n        class="story-collection__thumbnail" />\n      <div\n        *ngIf="!project.thumbnailUrl"\n        (click)="openProject(project.projectUrl)"\n        class="story-collection__thumbnail search-image-empty">\n      </div>\n    </div>\n  </div>\n\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(17),s=n(6),c=n(38),u=n(527),l=n(54),p=n(12),d=n(37),h=n(14),f=function(){function t(t,e,n,o,r,i,a){this.userInteractor=t,this.groupInteractor=e,this.projectInteractor=n,this.sceneInteractor=o,this.metaDataInteractor=r,this.router=i,this.eventBus=a,this.projects={}}return t.prototype.ngAfterViewInit=function(){var t=this;this.getUserGroups().forEach(function(e){return t.fetchGroup(e.id)})},t.prototype.getUserGroups=function(){return this.userInteractor.getUserGroups()},t.prototype.getProjectsByGroup=function(t){return this.projects[t]||[]},t.prototype.fetchGroup=function(t){var e=this;return this.groupInteractor.getGroup(t).subscribe(function(n){return e.projects[t]=n.projects},function(t){return console.log("error",t)})},t.prototype.openProject=function(t){var e=this,n=t.userId,o=t.projectId;this.eventBus.onStartLoading(),this.projectInteractor.openProject(n,o).subscribe(function(t){e.sceneInteractor.setActiveRoomId(null),e.eventBus.onSelectRoom(null,!1),e.eventBus.onStopLoading(),e.metaDataInteractor.setIsReadOnly(!0),e.router.navigateByUrl("/editor")},function(t){e.eventBus.onStopLoading(),e.eventBus.onModalMessage(h.ERROR_OPENING_PROJECT,h.SERVER_ERROR)})},t=o([i.Component({selector:"user-groups",styles:[n(1343)],template:n(1344)}),r("design:paramtypes",[c.UserInteractor,u.GroupInteractor,l.ProjectInteractor,p.SceneInteractor,d.MetaDataInteractor,a.Router,s.EventBus])],t)}();e.UserGroups=f},function(t,e){t.exports=".user-groups{margin-top:80px}\n"},function(t,e){t.exports='<div\n  div *ngIf="getUserGroups()"\n  class="user-groups">\n\n  <div *ngFor="let userGroup of getUserGroups()">\n    <p class="story-collection__header"> {{ userGroup.name }} </p>\n    <div class="story-collection">\n      <div\n        *ngFor="let project of getProjectsByGroup(userGroup.id)"\n        class="story-collection__project">\n        <p>\n          <span class="text-bold">Project: </span>\n          <span>{{ project.name }}</span>\n        </p>\n        <p>\n          <span class="text-bold">User: </span>\n          <span>{{ project.user }}</span>\n        </p>\n        <p>\n          <span class="text-bold">Tags: </span>\n          <span>{{ project.tags }}</span>\n        </p>\n        <img\n          *ngIf="project.thumbnailUrl"\n          [attr.src]="project.thumbnailUrl"\n          (click)="openProject(project)"\n          class="story-collection__thumbnail" />\n      </div>\n    </div>\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(17),a=n(52),s=n(100),c=n(1346),u=n(188),l=n(189),p=i.RouterModule.forChild([{path:"chat",component:c.Chat}]),d=function(){function t(){}return t=o([r.NgModule({declarations:[c.Chat],imports:[a.BrowserModule,l.CoreModule,u.CommonModule,s.FormsModule,p]})],t)}();e.ChatModule=d},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a},r=this&&this.__metadata||function(t,e){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(t,e)};Object.defineProperty(e,"__esModule",{value:!0});var i=n(2),a=n(276),s=function(){function t(t){this.chatInteractor=t,this.activeRoom=null,this.userName=Math.round(1e3*Math.random())+"",this.roomList=[],this.subscriptions=new Set}return t.prototype.ngOnInit=function(){this.subscribeToEvents()},t.prototype.ngOnDestroy=function(){this.subscriptions.forEach(function(t){return t.unsubscribe()})},t.prototype.subscribeToEvents=function(){var t=this,e=this.chatInteractor.getRooms().subscribe(function(e){var n=Object.keys(e).map(function(t){return{id:t,name:e[t].name}});t.roomList=n},function(t){return console.log("onRoomChangeError",t)});this.subscriptions.add(e)},t.prototype.createRoom=function(){var t="RoomName_"+Math.random();this.chatInteractor.createRoom(t,this.userName,Math.random()+"").subscribe(function(t){return console.log("roomCreated: "+t)},function(t){return console.log("create room error",t)})},t.prototype.userIsInRoom=function(){return!!this.activeRoom},t=o([i.Component({selector:"chat",styles:[n(1347)],template:n(1348)}),r("design:paramtypes",[a.ChatInteractor])],t)}();e.Chat=s},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");.chat{height:auto;min-height:100%;background-color:#eee;color:#616161;padding:15px}\n'},function(t,e){t.exports='<div class="chat">\n\n  <p>Welcome to the chat manager</p>\n\n  <div (click)="createRoom($event)">\n    CreateRoom\n  </div>\n\n  <p>Rooms</p>\n  <div *ngFor="let room of roomList">\n    <p>Room: <span>{{ room.name }}</span>, <span>{{ room.id }}</span></p>\n  </div>\n\n  <div *ngIf="userIsInRoom()">\n    <p>Room: {{this.activeRoom}}</p>\n  </div>\n\n</div>\n'},function(t,e,n){"use strict";var o=this&&this.__decorate||function(t,e,n,o){var r,i=arguments.length,a=i<3?e:null===o?o=Object.getOwnPropertyDescriptor(e,n):o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,n,o);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,n,a):r(e,n))||a);return i>3&&a&&Object.defineProperty(e,n,a),a};Object.defineProperty(e,"__esModule",{value:!0});var r=n(2),i=n(2),a=function(){function t(){}return t=o([r.Component({selector:"app",styles:[n(1350)],template:n(1351),encapsulation:i.ViewEncapsulation.None})],t)}();e.Ui=a},function(t,e){t.exports='@import url("https://fonts.googleapis.com/css?family=Montserrat");@import url("https://fonts.googleapis.com/css?family=Nunito");html,body{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:16px;color:#fff}p{margin:0}a:link{color:inherit;text-decoration:none;border-bottom:1px solid #fff}a:active{color:inherit;text-decoration:none}a:visited{color:inherit;text-decoration:none}a:hover{color:inherit;text-decoration:none}.text-bold{font-weight:700}.button{border-radius:4px;background-color:#eee;color:#616161;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid;background:transparent}.button:hover{background-color:#eee;color:#FF3571;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#212121 !important;border:1px;border-style:solid}.button:active{background-color:#616161;color:#eee;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border-color:#616161 !important;border:1px;border-style:solid}.button-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-save{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-save-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.button-delete{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px}.button-delete-drag-drop{background-color:#eee;color:#fff;text-align:center;padding:10px 0;margin-bottom:5px;width:100%;cursor:pointer;border:1px;border-style:dashed}.font-header{font-family:"Montserrat","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif}.font-tiny{font-family:"Nunito","HelveticaNeue-Light","Helvetica Neue Light","Helvetica Neue",Helvetica,Arial,sans-serif;font-size:.8em;color:#616161}.cursor-pointer{cursor:pointer}.user-field-text-entry{margin-left:10px}.horiz-line{border-bottom:1px dotted #616161;width:100%;margin-top:5px;margin-bottom:10px}.horiz-line-bottom{border-bottom:1px dotted #616161;width:100%;margin-top:25px;margin-bottom:10px}.dropdown{background-color:#eee;margin:15px;padding:10px;width:250px;border-radius:4px;background:rgba(238,238,238,0.8);backdrop-filter:blur(4px)}.dropdown-title{font-size:1.2em;margin-bottom:10px;border-bottom:1px solid #616161;color:#616161}.dropdown-heading{font-size:1.0em;margin-bottom:10px;color:#616161}.dropdown-text{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-text__bold{font-size:1em;font-weight:bold !important;margin-bottom:10px;color:#616161}.dropdown-text__accent{font-size:.8em;margin-bottom:10px;color:#FF3571}.dropdown-label{font-size:.8em;margin-bottom:10px;color:#616161}.dropdown-button-margin{margin-right:8px}.dropdown-input-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center;margin:10px 0}.dropdown-row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between;align-items:center}.dropdown-input-label{font-size:1.1em;min-width:0px;max-width:63%;margin-left:10px;flex-grow:1}.dropdown-select-box{font-size:1.1em;flex-grow:2}.hotspot-inspector_row{display:flex;flex-direction:row;flex-wrap:nowrap;justify-content:space-between}.hotspot-inspector__label{margin-right:10px;width:100%;font-size:.8em;color:#616161}.hotspot-inspector__select{flex-direction:row;width:100%;flex-wrap:nowrap;align-items:center}.row-flex-start{display:flex;flex-direction:row;justify-content:flex-start}.width-auto{width:auto}.story-collection{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:space-around}.story-collection__header{margin-top:20px;font-size:1.2em;border-bottom:2px solid #616161}.story-collection__project{margin:10px;padding:10px;border:1px solid black;background-color:#979797;color:#fff}.story-collection__thumbnail{width:336px;cursor:pointer}.modal-window{display:inline-block;width:80%;min-height:80%;overflow:hidden;position:fixed;top:50%;left:50%;border-radius:4px;transform:translate(-50%, -50%);background-color:rgba(255,255,255,0.93)}.modal-window__fields{width:90%;position:fixed;top:50%;left:50%;transform:translate(-50%, -50%)}.topbar__row-label{cursor:pointer;text-shadow:0 2px 2px rgba(0,0,0,0.62)}.topbar__row-label:hover{color:#D8D8D8}\n'},function(t,e){t.exports="<router-outlet></router-outlet>\n"}],[1092]);
//# sourceMappingURL=main.map